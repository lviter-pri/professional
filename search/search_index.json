{"config":{"lang":["en","zh"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"\u6280\u672f\u4e0e\u4e1a\u52a1\u5171\u540c\u9a71\u52a8","text":""},{"location":"#github","title":"(\u521d\u6b21\u6253\u5f00\u8bf7\u8010\u5fc3\uff0cgithub\u6e90\u52a0\u8f7d\u8f83\u6162)","text":"<p>\u8131\u79bb\u4e86\u4e1a\u52a1\u7a7a\u8c08\u6280\u672f\u90fd\u662f\u800d\u6d41\u6c13</p>"},{"location":"#1","title":"1. \u7cbe\u6df1\u8bad\u7ec3\u7684\u7406\u5ff5","text":"<p>\u70ed\u7231 | \u91cd\u590d | \u575a\u6301</p> <p>\u4e0d\u65ad\u91cd\u590d\uff0c\u4ece\u4e0d\u505c\u6b62\u3002</p> <p>\u6c38\u8fdc\u8ffd\u6c42\u505a\u4e00\u4e2a\u6781\u81f4\u7684\u4ea7\u54c1\uff0c\u5173\u6ce8\u7ec6\u8282\u3002</p> <p>\u6df1\u5ea6\uff0c\u5e7f\u5ea6\uff0c\u9ad8\u5ea6\uff0c\u5747\u80fd\u8fbe\u5230\u3002</p> <p>\u5927\u4e8b\u7b80\u5355\u505a\uff0c\u5c0f\u4e8b\u7ec6\u5fc3\u505a</p> <p>\u590d\u6742\u7684\u4e8b\u5efa\u5355\u5316\uff0c\u5efa\u5355\u7684\u4e8b\u6d41\u7a0b\u5316</p>"},{"location":"#2","title":"2. \u5b9a\u4e49\u5408\u7406\u8fb9\u754c\u2014\u2014\u7248\u672c","text":"<p>\u8fb9\u754c\uff0c\u4ee3\u8868\u4e00\u7c7b\u8bad\u7ec3\u7684\u8303\u56f4\uff0c\u540c\u65f6\u4e5f\u51b3\u5b9a\u7740\u8bad\u7ec3\u80fd\u5e26\u6765\u7684\u6548\u679c\u3002\u8fd9\u91cc\u4f7f\u7528\u7248\u672c\u68af\u5ea6\u6765\u8868\u793a\u8fb9\u754c\u3002</p> <p>\u4e3a\u6bcf\u4e00\u7c7b\u8bad\u7ec3\u6307\u5b9a\u4e00\u4e2a\u5408\u7406\u7684\u7248\u672c\u4ee5\u53ca\u7248\u672c\u5185\u5bb9\u7684\u89c4\u5212\u3002</p> <p>\u8bad\u7ec3\u8bc4\u6d4b\u2014\u2014\u80fd\u591f\u5206\u4eab\uff0c\u4ee3\u8868\u7740\u5bf9\u4e00\u4e2a\u8bad\u7ec3\u7684\u638c\u63e1\u3002\u5e38\u89c1\u7684\u81ea\u8bdd\u5f0f\u5206\u4eab\uff0cPPT\u5f0f\u5206\u4eab\u3002</p> <p>\u5b9a\u4e49\u4e00\u4e2a\u5408\u7406\u7684\u7248\u672c\u76ee\u6807\u3002</p>"},{"location":"#3","title":"3. \u5185\u5bb9\u8bf4\u660e","text":"<p>\u5b66\u4e60\u522b\u4eba\u4f18\u79c0\u8bfe\u7a0b\u7ed3\u5408\u4e2a\u4eba\u603b\u7ed3\uff0c\u53ea\u7528\u4e8e\u5b66\u4e60\u4f7f\u7528\uff0c\u65e0\u4efb\u4f55\u5546\u4e1a\u4ef7\u503c\uff0c\u8f6c\u8f7d\u8bf7\u8054\u7cfb\u4f5c\u8005\u83b7\u5f97\u6388\u6743\uff0c\u5e76\u6ce8\u660e\u51fa\u5904</p>"},{"location":"#4","title":"4.\u5171\u52c9","text":"<p>\u6709\u4e00\u4e2a\u591c\u665a\uff0c\u6211\u70e7\u6bc1\u4e86\u6240\u6709\u7684\u8bb0\u5fc6\uff0c</p> <p>\u4ece\u6b64\u6211\u7684\u68a6\u5c31\u900f\u660e\u4e86\uff1b</p> <p>\u6709\u4e2a\u65e9\u6668\u6211\u6254\u6389\u4e86\u6240\u6709\u7684\u6628\u5929\uff0c</p> <p>\u4ece\u6b64\u6211\u7684\u811a\u6b65\u5c31\u8f7b\u76c8\u4e86\uff01</p> <p>\u8d8a\u8fc7\u5c71\u4e18\uff0c\u624d\u53d1\u73b0\u65e0\u4eba\u7b49\u5019\uff01</p> <p>-- \u6cf0\u6208\u5c14</p>"},{"location":"#_2","title":"\u6709\u4efb\u4f55\u95ee\u9898\u8054\u7cfb\u6211","text":"<ul> <li>\u90ae\u7bb1\uff1alviter@163.com</li> <li>\u611f\u8c22\u5927\u5bb6\uff0c\u6253\u8d4f\u7801\u652f\u6301</li> <li> <p>\u4f18\u79c0\u7684\u6587\u6863\u5927\u5bb6\u4e00\u8d77\u5b66\u4e60\uff0c\u63a8\u8350\u51e0\u4e2a\u5730\u5740\uff1a</p> <ul> <li>\u7f8e\u56e2\u6280\u672f\u56e2\u961f</li> <li>\u963f\u91cc\u4e91\u5185\u6838\u6708\u62a5</li> </ul> <p></p> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/","title":"Index","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/#java-core","title":"Java core","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%B8%B8%E7%94%A8lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/","title":"lambda\u8868\u8fbe\u5f0f\u6c47\u603b","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%B8%B8%E7%94%A8lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_1","title":"\u53bb\u91cd","text":"<pre><code>List&lt;AffiliationLocationDTO&gt; lists = list.stream().collect(\n                            Collectors.collectingAndThen(\n                                    Collectors.toCollection(\n                                            () -&gt; new TreeSet&lt;&gt;(Comparator.comparing(AffiliationLocationDTO::getCreationDate))\n                                    ), ArrayList::new\n                            )\n                    );\n</code></pre>"},{"location":"Java-%E6%A0%B8%E5%BF%83/IO%E6%A8%A1%E5%9E%8B/","title":"IO\u6a21\u578b","text":"<p>\u4e3b\u8981\u6709\u56db\u79cd\u57fa\u672c\u7684I/O\u6a21\u578b\uff1a\u540c\u6b65\u963b\u585eI/O\uff08Synchronous Blocking I/O\uff09\u3001\u540c\u6b65\u975e\u963b\u585eI/O\uff08Synchronous Non-Blocking I/O\uff09\u3001\u5f02\u6b65I/O\uff08Asynchronous I/O\uff09\uff0c\u4ee5\u53ca\u4fe1\u53f7\u9a71\u52a8I/O\uff08Signal-driven I/O\uff09\u3002\u4f46\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u901a\u5e38\u662f\u524d\u4e09\u79cd\u6a21\u578b</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/IO%E6%A8%A1%E5%9E%8B/#bionioaio","title":"BIO/NIO/AIO\u533a\u522b","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/IO%E6%A8%A1%E5%9E%8B/#iobio","title":"\u540c\u6b65\u963b\u585eIO\uff0cBIO","text":"<p>\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u53d1\u8d77\u4e00\u4e2aI/O\u8bf7\u6c42\u65f6\uff0c\u5b83\u4f1a\u963b\u585e\u5e76\u7b49\u5f85\u76f4\u5230I/O\u64cd\u4f5c\u5b8c\u6210\u3002\u5728\u6b64\u671f\u95f4\uff0c\u7ebf\u7a0b\u4e0d\u80fd\u6267\u884c\u5176\u4ed6\u4efb\u52a1\u3002\u8fd9\u79cd\u6a21\u578b\u9002\u7528\u4e8eI/O\u64cd\u4f5c\u8f83\u5c11\u4e14\u64cd\u4f5c\u65f6\u95f4\u8f83\u77ed\u7684\u573a\u666f\u3002</p> <ul> <li>java\u4e2d\u5e94\u7528\uff1a\u4f7f\u7528java.io\u5305\u4e2d\u7684\u7c7b\uff0c\u5982InputStream\u548cOutputStream\u3002\u5b83\u662f\u57fa\u4e8e\u540c\u6b65\u963b\u585eI/O\u7684</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/IO%E6%A8%A1%E5%9E%8B/#ionio","title":"\u540c\u6b65\u975e\u963b\u585eIO\uff0cNIO","text":"<p>\u5728\u8fd9\u79cd\u6a21\u578b\u4e2d\uff0c\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u53d1\u8d77\u4e00\u4e2aI/O\u8bf7\u6c42\u65f6\uff0c\u5b83\u4e0d\u4f1a\u7acb\u5373\u963b\u585e\u3002\u5982\u679cI/O\u64cd\u4f5c\u4e0d\u80fd\u7acb\u5373\u5b8c\u6210\uff0c\u7ebf\u7a0b\u4f1a\u7acb\u5373\u8fd4\u56de\u5e76\u7ee7\u7eed\u6267\u884c\u5176\u4ed6\u4efb\u52a1\u3002\u7ebf\u7a0b\u9700\u8981\u5b9a\u671f\u8f6e\u8be2I/O\u64cd\u4f5c\u7684\u72b6\u6001\uff0c\u76f4\u5230\u64cd\u4f5c\u5b8c\u6210\u3002\u8fd9\u79cd\u6a21\u578b\u9002\u7528\u4e8eI/O\u64cd\u4f5c\u9891\u7e41\u4f46\u6bcf\u4e2a\u64cd\u4f5c\u65f6\u95f4\u8f83\u77ed\u7684\u573a\u666f\uff0c\u4f8b\u5982\u7f51\u7edc\u670d\u52a1\u5668</p> <ul> <li>java\u4e2d\u5e94\u7528\uff1a\u7528java.nio\u5305\u4e2d\u7684\u7c7b\uff0c\u5982Buffer\u3001Channel\u548cSelector\u3002NIO\u652f\u6301\u540c\u6b65\u975e\u963b\u585eI/O\uff0c\u5141\u8bb8\u5355\u4e2a\u7ebf\u7a0b\u5904\u7406\u591a\u4e2aI/O\u8fde\u63a5\u3002</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/IO%E6%A8%A1%E5%9E%8B/#ioaio","title":"\u5f02\u6b65IO,AIO","text":"<p>\u5f02\u6b65I/O\u662f\u6700\u9ad8\u6548\u7684I/O\u6a21\u578b\u4e4b\u4e00\u3002\u5728\u8fd9\u79cd\u6a21\u578b\u4e2d\uff0c\u7ebf\u7a0b\u53d1\u8d77\u4e00\u4e2aI/O\u8bf7\u6c42\u540e\u7acb\u5373\u8fd4\u56de\uff0c\u7ee7\u7eed\u6267\u884c\u5176\u4ed6\u4efb\u52a1\u3002\u5f53I/O\u64cd\u4f5c\u5b8c\u6210\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u901a\u77e5\u7ebf\u7a0b\uff08\u901a\u5e38\u662f\u901a\u8fc7\u56de\u8c03\u51fd\u6570\u6216\u4e8b\u4ef6\u901a\u77e5\uff09\u3002\u8fd9\u79cd\u6a21\u578b\u9002\u7528\u4e8e\u9ad8\u5e76\u53d1\u7684\u573a\u666f\uff0c\u5982\u9ad8\u6027\u80fdWeb\u670d\u52a1\u5668</p> <ul> <li>java\u4e2d\u5e94\u7528\uff1a\u4f7f\u7528java.nio.channels\u5305\u4e2d\u7684AsynchronousFileChannel\u548cAsynchronousSocketChannel\u7b49\u7c7b\u3002AIO\u652f\u6301\u771f\u6b63\u7684\u5f02\u6b65I/O\u64cd\u4f5c\uff0c\u5373\u64cd\u4f5c\u5b8c\u6210\u540e\u7531\u7cfb\u7edf\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/IO%E6%A8%A1%E5%9E%8B/#nmap","title":"nmap","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/","title":"JVM","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/#_1","title":"\u8fd0\u884c\u65f6\u6570\u636e\u533a","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/#_2","title":"\u5bf9\u8c61","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/#_3","title":"\u5185\u5b58\u6ea2\u51fa/\u5185\u5b58\u6cc4\u9732","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/#gc","title":"GC","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/#_4","title":"\u7c7b\u52a0\u8f7d\u673a\u5236","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/","title":"Index","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/#jdk-17","title":"JDK-1.7","text":"<p>\u4e0d\u4e86\u89e3jdk1.7\u5982\u4f55\u53bb\u5206\u6790jdk1.8?</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/#_1","title":"\u5b66\u4e60\u4e66\u7c4d","text":"<p>\u300a\u6df1\u5165\u7406\u89e3JVM\u300b--\u5468\u5fd7\u660e</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/HotSpot%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AF%B9%E8%B1%A1%E6%8E%A2%E7%A7%98/","title":"HotSpot\u865a\u62df\u673a\u5bf9\u8c61\u63a2\u79d8","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/HotSpot%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AF%B9%E8%B1%A1%E6%8E%A2%E7%A7%98/#hotspot","title":"HotSpot\u865a\u62df\u673a\u5bf9\u8c61\u63a2\u79d8","text":"<p>\u5982\u4f55\u521b\u5efa \u3001\u5982\u4f55\u5e03\u5c40\u3001\u4ee5\u53ca\u5982\u4f55\u8bbf\u95ee</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/HotSpot%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AF%B9%E8%B1%A1%E6%8E%A2%E7%A7%98/#_1","title":"\u5bf9\u8c61\u521b\u5efa\u6d41\u7a0b","text":"<ol> <li>\u865a\u62df\u673a\u9047\u5230\u4e00\u4e2anew\u6307\u4ee4\u65f6\uff0c\u9996\u5148\u53bb\u68c0\u67e5\u6307\u4ee4\u7684\u53c2\u6570\u662f\u5426\u80fd\u5728\u5e38\u91cf\u6c60\u4e2d\u5b9a\u4f4d\u5230\u4e00\u4e2a\u7c7b\u7684\u7b26\u53f7\u5f15\u7528\uff0c\u5e76\u4e14\u68c0\u67e5\u8fd9\u4e2a\u7b26\u53f7\u5f15\u7528\u4ee3\u8868\u7684\u7c7b\u662f\u5426\u5df2\u7ecf\u88ab\u52a0\u8f7d\u3001\u89e3\u6790\u548c\u521d\u59cb\u5316\u8fc7\u3002</li> <li>\u7c7b\u52a0\u8f7d\u68c0\u67e5\u540e\uff0c\u865a\u62df\u673a\u5c06\u4e3a\u65b0\u751f\u5bf9\u8c61\u5206\u914d\u5185\u5b58\uff08\u5bf9\u8c61\u6240\u9700\u5185\u5b58\u7684\u5927\u5c0f\u5728\u7c7b\u52a0\u8f7d\u5b8c\u6210\u540e\u4fbf\u53ef\u5b8c\u5168\u786e\u5b9a\uff09\uff0c\u4e3a\u5bf9\u8c61\u5206\u914d\u7a7a\u95f4\u7684\u4efb\u52a1\u7b49\u4e8e\u628a\u4e00\u5757\u786e\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\u4ece\u5806\u5185\u5212\u5206\u51fa\u6765\u3002 3.<ul> <li>\u5047\u8bbe\u5806\u4e2d\u5185\u5b58\u89c4\u6574\uff0c\u6240\u6709\u7528\u8fc7\u7684\u5185\u5b58\u653e\u4e00\u8fb9\uff0c\u7a7a\u95f2\u7684\u5185\u5b58\u653e\u53e6\u4e00\u8fb9\uff0c\u4e2d\u95f4\u653e\u7740\u4e00\u4e2a\u6307\u9488\u4f5c\u4e3a\u5206\u754c\u70b9\u7684\u6307\u793a\u5668\uff0c\u90a3\u5206\u914d\u5185\u5b58\u5c31\u4ec5\u4ec5\u662f\u628a\u6307\u9488\u5411\u7a7a\u95f2\u7a7a\u95f4\u90a3\u8fb9\u632a\u52a8\u4e00\u6bb5\u4e0e\u5bf9\u8c61\u5927\u5c0f\u76f8\u7b49\u7684\u8ddd\u79bb\uff0c\u8fd9\u79cd\u5206\u914d\u65b9\u5f0f\u79f0\u4e3a--\u6307\u9488\u78b0\u649e\uff08Bump the   Pointer\uff09 - \u5982\u679c\u5806\u5185\u5b58\u4e0d\u89c4\u6574\uff0c\u5df2\u4f7f\u7528\u7684\u5185\u5b58\u548c\u7a7a\u95f2\u5185\u5b58\u76f8\u4e92\u4ea4\u9519\uff0c\u90a3\u5c31\u6ca1\u529e\u6cd5\u8fdb\u884c\u7b80\u5355\u7684\u78b0\u649e\u4e86\uff0c\u865a\u62df\u673a\u5c31\u5fc5\u987b\u7ef4\u62a4\u4e00\u4e2a\u5217\u8868\uff0c\u8bb0\u5f55\u54ea\u5757\u5185\u5b58\u53ef\u7528\uff0c\u5206\u914d\u7684\u65f6\u5019\u4ece\u5217\u8868\u4e2d\u627e\u5230\u4e00\u5757\u8db3\u591f\u5927\u7684\u7a7a\u95f4\u5212\u5206\u7ed9\u5bf9\u8c61\u5b9e\u4f8b\uff0c\u5e76\u66f4\u65b0\u8868\u4e0a\u7684\u8bb0\u5f55\uff0c\u8fd9\u79cd\u5206\u914d\u65b9\u5f0f\u79f0\u4e3a--\u7a7a\u95f2\u5217\u8868\uff08Free List\uff09 4. \u9009\u62e9\u54ea\u79cd\u5206\u914d\u65b9\u5f0f\u7531Java\u5806\u662f\u5426\u89c4\u6574\u51b3\u5b9a\uff0cJava\u5806\u662f\u5426\u89c4\u6574\u7531\u6240\u7528\u7684\u5783\u573e\u6536\u96c6\u5668\u662f\u5426\u5e26\u6709\u538b\u7f29\u6574\u7406\u529f\u80fd\u51b3\u5b9a\u3002\u56e0\u6b64\uff0c\u5728\u4f7f\u7528Serial\u3001ParNew\u7b49\u5e26Compact\u8fc7\u7a0b\u7684\u6536\u96c6\u5668\u65f6\uff0c\u7cfb\u7edf\u91c7\u7528\u7684\u5206\u914d\u7b97\u6cd5\u662f\u6307\u9488\u78b0\u649e\uff0c\u800c\u4f7f\u7528CMS\u8fd9\u79cd\u57fa\u4e8eMark-Sweep\u7b97\u6cd5\u7684\u6536\u96c6\u5668\u65f6\uff0c\u901a\u5e38\u91c7\u7528\u7a7a\u95f2\u5217\u8868\u3002</li> </ul> </li> <li>\u5bf9\u8c61\u521b\u5efa\u5728\u865a\u62df\u673a\u4e2d\u662f\u975e\u5e38\u9891\u7e41\u7684\u884c\u4e3a\uff0c\u6240\u4ee5\u5728\u6307\u9488\u78b0\u649e\u65f6\u5e76\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u53ef\u80fd\u51fa\u73b0\u5728\u7ed9A\u5bf9\u8c61\u5206\u914d\u5185\u5b58\u65f6\uff0c\u6307\u9488\u8fd8\u6ca1\u6765\u5f97\u53ca\u4fee\u6539\uff0c\u5bf9\u8c61B\u53c8\u540c\u65f6\u4f7f\u7528\u4e86\u539f\u6765\u7684\u6307\u9488\u6765\u5206\u914d\u5185\u5b58\u3002\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u6709\u4e24\u79cd\u65b9\u6848\uff1a<ul> <li>\u65b9\u6848\u4e00\uff1a\u5bf9\u5206\u914d\u5185\u5b58\u7a7a\u95f4\u7684\u52a8\u4f5c\u8fdb\u884c\u540c\u6b65\u5904\u7406\uff0c----\u865a\u62df\u673a\u91c7\u7528CAS\u914d\u4e0a\u5931\u8d25\u91cd\u8bd5\u7684\u65b9\u5f0f\u4fdd\u8bc1\u66f4\u65b0\u64cd\u4f5c\u7684\u539f\u5b50\u6027</li> <li>\u65b9\u6848\u4e8c\uff1a\u628a\u5185\u5b58\u5206\u914d\u52a8\u4f5c\u6309\u7167\u7ebf\u7a0b\u5212\u5206\u5728\u4e0d\u540c\u7684\u7a7a\u95f4\u4e2d\u8fdb\u884c\uff0c\u5373\u6bcf\u4e2a\u7ebf\u7a0b\u5728Java\u5806\u4e2d\u9884\u5148\u5206\u914d\u4e00\u5c0f\u5757\u5185\u5b58\uff0c\u79f0\u4e3a\u672c\u5730\u7ebf\u7a0b\u5206\u914d\u7f13\u51b2\uff08Thread Local Allocation   Buffer,TLAB\uff09\u3002\u54ea\u4e2a\u7ebf\u7a0b\u8981\u5206\u914d\u5185\u5b58\uff0c\u5c31\u5728\u54ea\u4e2a\u7ebf\u7a0b\u5f97TLAB\u4e0a\u5206\u914d\uff0c\u53ea\u6709TLAB\u7528\u5b8c\u5e76\u5206\u914d\u65b0\u7684TLAB\u65f6\uff0c\u624d\u9700\u8981\u540c\u6b65\u9501\u5b9a\u3002\u53ef\u4ee5\u901a\u8fc7-XX\uff1a+/-UseTLAB\u53c2\u6570\u6765\u8bbe\u5b9a\u662f\u5426\u4f7f\u7528TLAB\u3002</li> </ul> </li> <li>\u5185\u5b58\u5206\u914d\u5b8c\u6bd5\uff0c\u865a\u62df\u673a\u9700\u8981\u5c06\u5206\u914d\u5230\u5f97\u5185\u5b58\u7a7a\u95f4\u90fd\u521d\u59cb\u5316\u4e3a\u96f6\u503c\uff08\u4e0d\u5305\u62ec\u5bf9\u8c61\u5934\uff09\uff0c\u4f7f\u7528TLAB\u65f6\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u4e5f\u53ef\u4ee5\u63d0\u524d\u81f3TLAB\u5206\u914d\u65f6\u8fdb\u884c\u3002\u8fd9\u4e00\u6b65\u64cd\u4f5c\u4fdd\u8bc1\u4e86\u5bf9\u8c61\u7684\u5b9e\u4f8b\u5b57\u6bb5\u5728java\u4ee3\u7801\u4e2d\u53ef\u4ee5\u4e0d\u8d4b\u521d\u59cb\u503c\u76f4\u63a5\u4f7f\u7528\u3002</li> <li>\u865a\u62df\u673a\u7ee7\u7eed\u8fdb\u884c\u5fc5\u8981\u8bbe\u7f6e\uff0c\u5982\u8fd9\u4e2a\u5bf9\u8c61\u662f\u54ea\u4e2a\u7c7b\u7684\u5b9e\u4f8b\u3001\u5982\u4f55\u624d\u80fd\u627e\u5230\u7c7b\u7684\u5143\u6570\u636e\u4fe1\u606f\u3001\u5bf9\u8c61\u7684\u54c8\u5e0c\u7801\u3001\u5bf9\u8c61\u7684GC\u5206\u4ee3\u5e74\u9f84\u7b49\u4fe1\u606f\u3002\u4fe1\u606f\u5b58\u653e\u5728\u5bf9\u8c61\u5934\u4e2d\uff0c</li> <li> <p>\u4e0a\u9762\u6b65\u9aa4\u5b8c\u6210\uff0c\u4ece\u865a\u62df\u673a\u7684\u89c6\u89d2\u770b\uff0c\u4e00\u4e2a\u65b0\u7684\u5bf9\u8c61\u5df2\u7ecf\u4ea7\u751f\uff0c\u4f46\u4ecejava\u7a0b\u5e8f\u7684\u89c6\u89d2\u6765\u770b\uff0c\u5bf9\u8c61\u521b\u5efa\u624d\u521a\u521a\u5f00\u59cb\uff0c\u5c1a\u672ainit\u521d\u59cb\u5316\uff0c\u6240\u6709\u5b57\u6bb5\u90fd\u4e3a\u96f6\u3002\u6267\u884cnew\u6307\u4ee4\u540e\u4f1a\u63a5\u7740\u6267\u884cinit\u65b9\u6cd5\u3002</p> </li> <li> <p>\u4e0b\u9762\u4ee3\u7801\u6e05\u5355\u662fHotSpot\u865a\u62df\u673abytecodeInterpreter.cpp\u4e2d\u7684\u4ee3\u7801\u7247\u6bb5\uff0c\u53ef\u4ee5\u5f15\u5bfc\u4e86\u89e3HotSpot\u7684\u8fd0\u4f5c\u8fc7\u7a0b</p> </li> </ol> <pre><code>//\u786e\u4fdd\u5e38\u91cf\u6c60\u4e2d\u5b58\u653e\u7684\u662f\u5df2\u89e3\u91ca\u7684\u7c7b\nif\uff08\uff01constants-\uff1etag_at\uff08index\uff09.is_unresolved_klass\uff08\uff09\uff09{\n//\u65ad\u8a00\u786e\u4fdd\u662fklassOop\u548cinstanceKlassOop\uff08\u8fd9\u90e8\u5206\u4e0b\u4e00\u8282\u4ecb\u7ecd\uff09\noop entry=\uff08klassOop\uff09*constants-\uff1eobj_at_addr\uff08index\uff09\uff1b\nassert\uff08entry-\uff1eis_klass\uff08\uff09\uff0c\"Should be resolved klass\"\uff09\uff1b\nklassOop k_entry=\uff08klassOop\uff09entry\uff1b\nassert\uff08k_entry-\uff1eklass_part\uff08\uff09-\uff1eoop_is_instance\uff08\uff09\uff0c\"Should be instanceKlass\"\uff09\uff1b\ninstanceKlass * ik=\uff08instanceKlass*\uff09k_entry-\uff1eklass_part\uff08\uff09\uff1b\n//\u786e\u4fdd\u5bf9\u8c61\u6240\u5c5e\u7c7b\u578b\u5df2\u7ecf\u7ecf\u8fc7\u521d\u59cb\u5316\u9636\u6bb5\nif\uff08ik-\uff1eis_initialized\uff08\uff09\uff06\uff06ik-\uff1ecan_be_fastpath_allocated\uff08\uff09\uff09\n{/\n/\u53d6\u5bf9\u8c61\u957f\u5ea6\nsize_t obj_size=ik-\uff1esize_helper\uff08\uff09\uff1b\noop result=NULL\uff1b\n//\u8bb0\u5f55\u662f\u5426\u9700\u8981\u5c06\u5bf9\u8c61\u6240\u6709\u5b57\u6bb5\u7f6e\u96f6\u503c\nbool need_zero=\uff01ZeroTLAB\uff1b\n//\u662f\u5426\u5728TLAB\u4e2d\u5206\u914d\u5bf9\u8c61\nif\uff08UseTLAB\uff09{\nresult=\uff08oop\uff09THREAD-\uff1etlab\uff08\uff09.allocate\uff08obj_size\uff09\uff1b\n}i\nf\uff08result==NULL\uff09{\nneed_zero=true\uff1b\n//\u76f4\u63a5\u5728eden\u4e2d\u5206\u914d\u5bf9\u8c61\nretry\uff1a\nHeapWord * compare_to=*Universe\uff1aheap\uff08\uff09-\uff1etop_addr\uff08\uff09\uff1b\nHeapWord * new_top=compare_to+obj_size\uff1b\n/*cmpxchg\u662fx86\u4e2d\u7684CAS\u6307\u4ee4\uff0c\u8fd9\u91cc\u662f\u4e00\u4e2aC++\u65b9\u6cd5\uff0c\u901a\u8fc7CAS\u65b9\u5f0f\u5206\u914d\u7a7a\u95f4\uff0c\u5982\u679c\u5e76\u53d1\u5931\u8d25\uff0c\n\u8f6c\u5230retry\u4e2d\u91cd\u8bd5\uff0c\u76f4\u81f3\u6210\u529f\u5206\u914d\u4e3a\u6b62*/\nif\uff08new_top\uff1c=*Universe\uff1aheap\uff08\uff09-\uff1eend_addr\uff08\uff09\uff09{\nif\uff08Atomic\uff1acmpxchg_ptr\uff08new_top,Universe\uff1aheap\uff08\uff09-\uff1etop_addr\uff08\uff09\uff0ccompare_to\uff09\uff01=compare_to\uff09{\ngoto retry\uff1b\n}r\nesult=\uff08oop\uff09compare_to\uff1b\n}}i\nf\uff08result\uff01=NULL\uff09{\n//\u5982\u679c\u9700\u8981\uff0c\u5219\u4e3a\u5bf9\u8c61\u521d\u59cb\u5316\u96f6\u503c\nif\uff08need_zero\uff09{\nHeapWord * to_zero=\uff08HeapWord*\uff09result+sizeof\uff08oopDesc\uff09/oopSize\uff1b\nobj_size-=sizeof\uff08oopDesc\uff09/oopSize\uff1b\nif\uff08obj_size\uff1e0\uff09{\nmemset\uff08to_zero\uff0c0\uff0cobj_size * HeapWordSize\uff09\uff1b\n}}/\n/\u6839\u636e\u662f\u5426\u542f\u7528\u504f\u5411\u9501\u6765\u8bbe\u7f6e\u5bf9\u8c61\u5934\u4fe1\u606f\nif\uff08UseBiasedLocking\uff09{\nresult-\uff1eset_mark\uff08ik-\uff1eprototype_header\uff08\uff09\uff09\uff1b\n}else{\nresult-\uff1eset_mark\uff08markOopDesc\uff1aprototype\uff08\uff09\uff09\uff1b\n}r\nesult-\uff1eset_klass_gap\uff080\uff09\uff1b\nresult-\uff1eset_klass\uff08k_entry\uff09\uff1b\n//\u5c06\u5bf9\u8c61\u5f15\u7528\u5165\u6808\uff0c\u7ee7\u7eed\u6267\u884c\u4e0b\u4e00\u6761\u6307\u4ee4\nSET_STACK_OBJECT\uff08result\uff0c0\uff09\uff1b\nUPDATE_PC_AND_TOS_AND_CONTINUE\uff083\uff0c1\uff09\uff1b\n}}}\n</code></pre>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/HotSpot%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AF%B9%E8%B1%A1%E6%8E%A2%E7%A7%98/#_2","title":"\u5bf9\u8c61\u7684\u5185\u5b58\u5e03\u5c40","text":"<ul> <li>HotSpot\u865a\u62df\u673a\u4e2d\uff0c\u5bf9\u8c61\u5728\u5185\u5b58\u4e2d\u5b58\u50a8\u7684\u5e03\u5c40\u53ef\u4ee5\u5206\u4e3a3\u5757\u533a\u57df\uff1a\u5bf9\u8c61\u5934\uff08Header\uff09\u3001\u5b9e\u4f8b\u6570\u636e\uff08Instance Data\uff09\u548c\u5bf9\u9f50\u586b\u5145\uff08Padding\uff09</li> <li>HotSpot\u865a\u62df\u673a\u7684\u5bf9\u8c61\u5934\u5305\u62ec\u4e24\u90e8\u5206\u4fe1\u606f:<ul> <li>\u7528\u4e8e\u5b58\u50a8\u5bf9\u8c61\u81ea\u8eab\u7684\u8fd0\u884c\u65f6\u6570\u636e\uff0c\u5982\u54c8\u5e0c\u7801\uff08HashCode\uff09\u3001GC\u5206\u4ee3\u5e74\u9f84\u3001\u9501\u72b6\u6001\u6807\u5fd7\u3001\u7ebf\u7a0b\u6301\u6709\u7684\u9501\u3001\u504f\u5411\u7ebf\u7a0bID\u3001\u504f\u5411\u65f6\u95f4\u6233\u7b49<ul> <li>\u88ab\u8bbe\u8ba1\u6210\u4e00\u4e2a\u975e\u56fa\u5b9a\u7684\u6570\u636e\u7ed3\u6784\u4ee5\u4fbf\u5728\u6781\u5c0f\u7684\u7a7a\u95f4\u5185\u5b58\u50a8\u5c3d\u91cf\u591a\u7684\u4fe1\u606f\uff0c\u5b83\u4f1a\u6839\u636e\u5bf9\u8c61\u7684\u72b6\u6001\u590d\u7528\u81ea\u5df1\u7684\u5b58\u50a8\u7a7a\u95f4\u3002</li> </ul> </li> <li>\u7c7b\u578b\u6307\u9488\uff0c\u5373\u5bf9\u8c61\u6307\u5411\u5b83\u7684\u7c7b\u5143\u6570\u636e\u7684\u6307\u9488\uff0c\u865a\u62df\u673a\u901a\u8fc7\u8fd9\u4e2a\u6307\u9488\u6765\u786e\u5b9a\u8fd9\u4e2a\u5bf9\u8c61\u662f\u54ea\u4e2a\u7c7b\u7684\u5b9e\u4f8b</li> <li> </li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/HotSpot%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AF%B9%E8%B1%A1%E6%8E%A2%E7%A7%98/#javajavajava","title":"\u7279\u6b8a\uff1a\u5982\u679c\u5bf9\u8c61\u662f\u4e00\u4e2aJava\u6570\u7ec4\uff0c\u90a3\u5728\u5bf9\u8c61\u5934\u4e2d\u8fd8\u5fc5\u987b\u6709\u4e00\u5757\u7528\u4e8e\u8bb0\u5f55\u6570\u7ec4\u957f\u5ea6\u7684\u6570\u636e\uff0c\u56e0\u4e3a\u865a\u62df\u673a\u53ef\u4ee5\u901a\u8fc7\u666e\u901aJava\u5bf9\u8c61\u7684\u5143\u6570\u636e\u4fe1\u606f\u786e\u5b9aJava\u5bf9\u8c61\u7684\u5927\u5c0f\uff0c\u4f46\u662f\u4ece\u6570\u7ec4\u7684\u5143\u6570\u636e\u4e2d\u5374\u65e0\u6cd5\u786e\u5b9a\u6570\u7ec4\u7684\u5927\u5c0f\u3002","text":"\u5b9e\u4f8b\u6570\u636e\u90e8\u5206\u662f\u5bf9\u8c61\u771f\u6b63\u5b58\u50a8\u7684\u6709\u6548\u4fe1\u606f\uff0c\u4e5f\u662f\u5728\u7a0b\u5e8f\u4ee3\u7801\u4e2d\u6240\u5b9a\u4e49\u7684\u5404\u79cd\u7c7b\u578b\u7684\u5b57\u6bb5\u5185\u5bb9\u3002\u65e0\u8bba\u662f\u4ece\u7236\u7c7b\u7ee7\u627f\u4e0b\u6765\u7684\uff0c\u8fd8\u662f\u5728\u5b50\u7c7b\u4e2d\u5b9a\u4e49\u7684\uff0c\u90fd\u9700\u8981\u8bb0\u5f55\u8d77\u6765\u3002\u5b58\u50a8\u987a\u5e8f\u4f1a\u53d7\u5230\u865a\u62df\u673a\u5206\u914d\u7b56\u7565\u53c2\u6570\uff08FieldsAllocationStyle\uff09\u548c\u5b57\u6bb5\u5728Java\u6e90\u7801\u4e2d\u5b9a\u4e49\u987a\u5e8f\u7684\u5f71\u54cd\u3002HotSpot\u865a\u62df\u673a\u9ed8\u8ba4\u7684\u5206\u914d\u7b56\u7565\u4e3alongs/doubles\u3001ints\u3001shorts/chars\u3001bytes/booleans\u3001oops\uff08Ordinary Object Pointers\uff09\uff0c\u4ece\u5206\u914d\u7b56\u7565\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c\u76f8\u540c\u5bbd\u5ea6\u7684\u5b57\u6bb5\u603b\u662f\u88ab\u5206\u914d\u5230\u4e00\u8d77 - \u5bf9\u9f50\u586b\u5145\u5e76\u4e0d\u662f\u5fc5\u7136\u5b58\u5728\u7684\uff0c\u4ec5\u4ec5\u53c8\u5360\u4f4d\u7b26\u7684\u4f5c\u7528\u3002\u7531\u4e8eHotSpot\u865a\u62df\u673a\u5185\u5b58\u7ba1\u7406\u7cfb\u7edf\u8981\u6c42\u5bf9\u8c61\u8d77\u59cb\u5730\u5740\u5fc5\u987b\u662f8\u5b57\u8282\u7684\u6574\u6570\u500d\uff0c\u5c31\u662f\u5bf9\u8c61\u5927\u5c0f\u5fc5\u987b\u662f8\u5b57\u8282\u7684\u6574\u6570\u500d\u3002\u5bf9\u8c61\u5934\u90e8\u5206\u6b63\u597d\u662f8\u5b57\u8282\u7684\u500d\u6570\uff081\u500d\u6216\u80052\u500d\uff09\u56e0\u6b64\uff0c\u5f53\u5bf9\u8c61\u5b9e\u4f8b\u6570\u636e\u90e8\u5206\u6ca1\u6709\u5bf9\u9f50\u65f6\uff0c\u5c31\u9700\u8981\u901a\u8fc7\u5bf9\u9f50\u586b\u5145\u6765\u8865\u5168\u3002"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/HotSpot%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AF%B9%E8%B1%A1%E6%8E%A2%E7%A7%98/#_3","title":"\u5bf9\u8c61\u7684\u8bbf\u95ee\u5b9a\u4f4d","text":"<p>\u5728Java\u6808\u4e2d\u4fdd\u5b58\u4e86\u672c\u5730\u53d8\u91cf\u8868\uff0c\u672c\u5730\u53d8\u91cf\u8868\u5185\u53c8reference\u6570\u636e\uff0c\u901a\u8fc7reference\u6570\u636e\u6765\u64cd\u4f5c\u5806\u4e0a\u7684\u5177\u4f53\u5bf9\u8c61\u3002\u7531\u4e8ereference\u7c7b\u578b\u5728Java\u865a\u62df\u673a\u89c4\u8303\u4e2d\u53ea\u89c4\u5b9a\u4e86\u4e00\u4e2a\u6307\u5411\u5bf9\u8c61\u7684\u5f15\u7528\uff0c\u5e76\u6ca1\u6709\u5b9a\u4e49\u8fd9\u4e2a\u5f15\u7528\u5e94\u8be5\u901a\u8fc7\u4f55\u79cd\u65b9\u5f0f\u53bb\u5b9a\u4f4d\u3001\u8bbf\u95ee\u5806\u4e2d\u7684\u5bf9\u8c61\u7684\u5177\u4f53\u4f4d\u7f6e\uff0c\u6240\u4ee5\u5bf9\u8c61\u8bbf\u95ee\u65b9\u5f0f\u4e5f\u662f\u53d6\u51b3\u4e8e\u865a\u62df\u673a\u5b9e\u73b0\u800c\u5b9a\u7684\u3002\u76ee\u524d\u4e3b\u6d41\u7684\u8bbf\u95ee\u65b9\u5f0f\u6709\u4f7f\u7528 \u53e5\u67c4\u548c\u76f4\u63a5\u6307\u9488\u4e24\u79cd\u3002</p> <ul> <li>\u53e5\u67c4\u8bbf\u95ee<ul> <li>\u5728java\u5806\u4e2d\u4f1a\u5212\u5206\u51fa\u4e00\u5757\u5185\u5b58\u4f5c\u4e3a\u53e5\u67c4\u6c60\uff0creference\u4e2d\u5b58\u50a8\u7684\u4fe1\u606f\u5c31\u662f\u5bf9\u8c61\u7684\u53e5\u67c4\u5730\u5740\uff0c\u53e5\u67c4\u4e2d\u5305\u542b\u4e86\u5bf9\u8c61\u5b9e\u4f8b\u6570\u636e\u4e0e\u7c7b\u578b\u6570\u636e\u5404\u81ea\u7684\u5177\u4f53\u5730\u5740\u4fe1\u606f      \u4f7f\u7528\u53e5\u67c4\u6765\u8bbf\u95ee\u7684\u6700\u5927\u597d\u5904\u5c31\u662freference\u4e2d\u5b58\u50a8\u7684\u662f\u7a33\u5b9a\u7684\u53e5\u67c4\u5730\u5740\uff0c\u5728\u5bf9\u8c61\u88ab\u79fb\u52a8\uff08\u5783\u573e\u6536\u96c6\u65f6\u79fb\u52a8\u5bf9\u8c61\u662f\u975e\u5e38\u666e\u904d\u7684\u884c\u4e3a\uff09\u65f6\u53ea\u4f1a\u6539\u53d8\u53e5\u67c4\u4e2d\u7684\u5b9e\u4f8b\u6570\u636e\u6307\u9488\uff0c\u800creference\u672c\u8eab\u4e0d\u9700\u8981\u4fee\u6539</li> </ul> </li> <li>\u76f4\u63a5\u6307\u9488\u8bbf\u95ee<ul> <li>reference\u4e2d\u5b58\u50a8\u7684\u76f4\u63a5\u5c31\u662f\u5bf9\u8c61\u5730\u5740      \u4f7f\u7528\u76f4\u63a5\u6307\u9488\u8bbf\u95ee\u65b9\u5f0f\u7684\u6700\u5927\u597d\u5904\u5c31\u662f\u901f\u5ea6\u66f4\u5feb\uff0c\u5b83\u8282\u7701\u4e86\u4e00\u6b21\u6307\u9488\u5b9a\u4f4d\u7684\u65f6\u95f4\u5f00\u9500\uff0c\u7531\u4e8e\u5bf9\u8c61\u7684\u8bbf\u95ee\u5728Java\u4e2d\u975e\u5e38\u9891\u7e41\uff0c\u56e0\u6b64\u8fd9\u7c7b\u5f00\u9500\u79ef\u5c11\u6210\u591a\u540e\u4e5f\u662f\u4e00\u9879\u975e\u5e38\u53ef\u89c2\u7684\u6267\u884c\u6210\u672c</li> </ul> </li> <li>\u6ce8\u610f\uff1a\u6211\u4eec\u4f7f\u7528\u7684HotSpot\u4f7f\u7528\u7684\u5c31\u662f\u7b2c\u4e8c\u79cd\u8fdb\u884c\u5bf9\u8c61\u8bbf\u95ee\u7684\u3002</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/JVM%E8%B0%83%E4%BC%98-jdk1.8/","title":"JVM\u8c03\u4f18 jdk1.8","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/JVM%E8%B0%83%E4%BC%98-jdk1.8/#jvm","title":"JVM\u4e00\u4e9b\u547d\u4ee4\u4ee5\u53ca\u89e3\u91ca","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/JVM%E8%B0%83%E4%BC%98-jdk1.8/#1-jmap","title":"1. jmap\u547d\u4ee4\u6982\u8ff0","text":"<pre><code>jmap\u53ef\u4ee5\u8f93\u51fa\u6240\u6709\u5185\u5b58\u4e2d\u5bf9\u8c61\uff0c\u751a\u81f3\u53ef\u4ee5\u5c06VM\u4e2d\u7684heap\u8f93\u51fa\uff0c\u6253\u5370\u51fa\u67d0\u4e2ajava\u8fdb\u7a0b(pid)\u5185\u5b58\u5185\u7684\u6240\u6709\u5bf9\u8c61\u60c5\u51b5\n</code></pre>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/JVM%E8%B0%83%E4%BC%98-jdk1.8/#2-jmap","title":"2. jmap\u4f8b\u5b50\u8be6\u89e3","text":"<pre><code>```shell\n    jmap -heap 17100\n```\n\u6253\u5370\u8f93\u51fa\u5185\u5bb9\u4e3a\uff1a\n```shell\nAttaching to process ID 17100, please wait...\nDebugger attached successfully.\nServer compiler detected.\nJVM version is 25.202-b08\n\nusing thread-local object allocation.\nParallel GC with 8 thread(s) ##\u65b0\u751f\u4ee3\u91c7\u7528\u5e76\u884c\u7ebf\u7a0b\u5904\u7406\u65b9\u5f0f\u6267\u884c\u5783\u573e\u56de\u6536\n\nHeap Configuration: ##\u5806\u914d\u7f6e\n   MinHeapFreeRatio         = 0 \n   MaxHeapFreeRatio         = 100\n   MaxHeapSize              = 4257218560 (4060.0MB)\n   NewSize                  = 88604672 (84.5MB)\n   MaxNewSize               = 1418723328 (1353.0MB)\n   OldSize                  = 177733632 (169.5MB)\n   NewRatio                 = 2\n   SurvivorRatio            = 8\n   MetaspaceSize            = 21807104 (20.796875MB)\n   CompressedClassSpaceSize = 1073741824 (1024.0MB)\n   MaxMetaspaceSize         = 17592186044415 MB\n   G1HeapRegionSize         = 0 (0.0MB)\n\nHeap Usage:\nPS Young Generation\nEden Space:\n   capacity = 53477376 (51.0MB)\n   used     = 2714632 (2.5888748168945312MB)\n   free     = 50762744 (48.41112518310547MB)\n   5.076225131165748% used\nFrom Space:\n   capacity = 1048576 (1.0MB)\n   used     = 425984 (0.40625MB)\n   free     = 622592 (0.59375MB)\n   40.625% used\nTo Space:\n   capacity = 1048576 (1.0MB)\n   used     = 0 (0.0MB)\n   free     = 1048576 (1.0MB)\n   0.0% used\nPS Old Generation\n   capacity = 265289728 (253.0MB)\n   used     = 76556600 (73.01006317138672MB)\n   free     = 188733128 (179.98993682861328MB)\n   28.85773247880898% used\n\n27666 interned Strings occupying 2848840 bytes.\n```\n</code></pre>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/JVM%E8%B0%83%E4%BC%98-jdk1.8/#21-heap-configuration","title":"2.1 Heap Configuration:","text":"<ul> <li>MinHeapFreeRatio: \u7a7a\u95f4\u5806\u7a7a\u95f4\u7684\u6700\u5c0f\u767e\u5206\u6bd4\uff0c\u516c\u5f0f\uff1aHeapFreeRatio =(CurrentFreeHeapSize/CurrentTotalHeapSize) *   100\uff0c\u503c\u533a\u95f40-100\uff0c\u9ed8\u8ba4\u503c\u4e3a40\uff0c\u5982\u679cHeapFreeRatio &lt; MinHeapFreeRatio\uff0c\u5219\u9700\u8981\u8fdb\u884c\u5806\u6269\u5bb9\uff0c\u6269\u5bb9\u7684\u65f6\u673a\u5e94\u8be5\u5728\u6bcf\u6b21\u5783\u573e\u56de\u6536\u4e4b\u540e</li> <li>MaxHeapFreeRatio\uff1a\u89e3\u91ca\u5982\u4e0a\uff0c\u9ed8\u8ba4\u503c\u4e3a 70\u3002\u5982\u679cHeapFreeRatio &gt; MaxHeapFreeRatio\uff0c\u5219\u9700\u8981\u8fdb\u884c\u5806\u7f29\u5bb9\uff0c\u7f29\u5bb9\u7684\u65f6\u673a\u5e94\u8be5\u5728\u6bcf\u6b21\u5783\u573e\u56de\u6536\u4e4b\u540e\u3002</li> <li>MaxHeapSize\uff1aJVM\u5806\u7a7a\u95f4\u5141\u8bb8\u7684\u6700\u5927\u503c</li> <li>NewSize\uff1aJava\u65b0\u751f\u4ee3\u5806\u7a7a\u95f4\u7684\u9ed8\u8ba4\u503c</li> <li>MaxNewSize\uff1aJava\u65b0\u751f\u4ee3\u5806\u7a7a\u95f4\u5141\u8bb8\u7684\u6700\u5927\u503c</li> <li>OldSize\uff1aJava\u8001\u5e74\u4ee3\u5806\u7a7a\u95f4\u7684\u9ed8\u8ba4\u503c</li> <li>NewRatio\uff1a\u65b0\u751f\u4ee3\uff082\u4e2asurvivor\u533a\u548cEden\u533a\uff09\u4e0e\u8001\u5e74\u4ee3\uff08\u4e0d\u5305\u62ec\u6c38\u4e45\u533a\uff09\u7684\u5806\u7a7a\u95f4\u6bd4\u503c\u3002\u503c\u4e3a2\u8868\u793a\u65b0\u751f\u4ee3\uff1a\u8001\u5e74\u4ee3=1:2</li> <li>SurvivorRatio\uff1a\u4e24\u4e2asurvivor\u533a\u548ceden\u533a\u7684\u5806\u7a7a\u95f4\u6bd4\u503c\u4e3a8\uff0c\u8868\u793aS0:S1:Eden = 1:1:8</li> <li>MetaspaceSize\uff1aJVM\u5143\u7a7a\u95f4\u9ed8\u8ba4\u503c</li> <li>CompressedClassSpaceSize/MaxMetaspaceSize\uff1aJVM\u5143\u7a7a\u95f4\u5141\u8bb8\u7684\u6700\u5927\u503c</li> <li>G1HeapRegionSize\uff1a\u4f7f\u7528G1\u5783\u573e\u56de\u6536\u7b97\u6cd5\u65f6\uff0cJVM\u5c06Heap\u7a7a\u95f4\u5206\u5272\u82e5\u5e72\u4e2aRegion,\u8be5\u53c2\u6570\u6307\u5b9a\u6bcf\u4e2aRegion\u7a7a\u95f4\u5927\u5c0f</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/JVM%E8%B0%83%E4%BC%98-jdk1.8/#22-heap-usage","title":"2.2 Heap Usage:","text":"<p>PS Young Generation \u65b0\u751f\u4ee3\u60c5\u51b5</p> <ul> <li>Eden\u533a\uff1acapacity\u4f0a\u7538\u533a\u5bb9\u91cf\uff0cused\u4f7f\u7528\u5bb9\u91cf\uff0cfree\u7a7a\u95f2\u5bb9\u91cf\uff0c5.076225131165748% used\u4f7f\u7528\u6bd4\u4f8b</li> <li>From Space:survivor1\u533a\uff0c\u53c2\u8003eden\u533a</li> <li>To Space:survivor2\u533a\uff0c\u53c2\u8003eden\u533a</li> <li>PS Old Generation\uff1a\u8001\u5e74\u4ee3\u4f7f\u7528\u60c5\u51b5 \u8001\u5e74\u4ee3\u53c2\u8003\u65b0\u751f\u4ee3eden\u533a\u8bf4\u660e</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/JVM%E8%B0%83%E4%BC%98-jdk1.8/#3-histolive-class-vm-live","title":"3. -histo[:live] \u6253\u5370\u6bcf\u4e2aclass\u7684\u5b9e\u4f8b\u6570\u76ee,\u5185\u5b58\u5360\u7528,\u7c7b\u5168\u540d\u4fe1\u606f. VM\u7684\u5185\u90e8\u7c7b\u540d\u5b57\u5f00\u5934\u4f1a\u52a0\u4e0a\u524d\u7f00\u201d*\u201d. \u5982\u679clive\u5b50\u53c2\u6570\u52a0\u4e0a\u540e,\u53ea\u7edf\u8ba1\u6d3b\u7684\u5bf9\u8c61\u6570\u91cf.","text":"<p>\u793a\u4f8b\uff1a</p> <pre><code> jmap -histo:live 17100\n</code></pre> <p>\u6253\u5370\u4fe1\u606f\u90e8\u5206\u5982\u4e0b\uff1a</p> <pre><code> num     #instances         #bytes  class name\n----------------------------------------------\n   1:         87032        9908272  [C\n   2:         14488        2776152  [I\n   3:         19405        2209944  [Ljava.lang.Object;\n   4:         86495        2075880  java.lang.String\n   5:         23264        2047232  java.lang.reflect.Method\n   6:         12563        1400192  java.lang.Class\n   7:         42188        1350016  java.util.concurrent.ConcurrentHashMap$Node\n   8:          6467        1089560  [B\n   9:          6806         510600  [Ljava.util.HashMap$Node;\n  10:         15589         498848  java.util.HashMap$Node\n  11:         12411         496440  java.util.LinkedHashMap$Entry\n  12:          8327         466312  java.util.LinkedHashMap\n  13:          8346         400608  org.aspectj.weaver.reflect.ShadowMatchImpl\n  14:           810         374336  [J\n  15:           316         362224  [Ljava.util.concurrent.ConcurrentHashMap$Node;\n  16:           546         358176  io.netty.util.internal.shaded.org.jctools.queues.MpscArrayQueue\n  17:         13957         316720  [Ljava.lang.Class;\n  18:         18467         295472  java.lang.Object\n  19:          8346         267072  org.aspectj.weaver.patterns.ExposedState\n  20:         10817         259608  java.util.ArrayList\n  21:          3748         160800  [Ljava.lang.String;\n  22:          4669         149408  java.lang.ref.WeakReference\n  23:          1517         145632  org.springframework.beans.GenericTypeAwarePropertyDescriptor\n  24:          5889         141336  org.springframework.core.MethodClassKey\n  25:          2925         140400  java.util.HashMap\n  26:          2890         138720  org.springframework.core.ResolvableType\n  27:          3332         133280  java.lang.ref.SoftReference\n  28:          2067         132288  org.springframework.core.annotation.TypeMappedAnnotation\n  29:          1502         120160  java.lang.reflect.Constructor\n  30:          3564         114048  java.util.LinkedList\n  31:          3272         104704  java.util.Hashtable$Entry\n  32:          2514         100560  java.util.WeakHashMap$Entry\n  33:          4074          97776  sun.reflect.generics.tree.SimpleClassTypeSignature\n  34:          3815          91560  java.beans.MethodRef\n  35:          1313          84032  io.netty.buffer.PoolSubpage\n  36:          1499          83944  java.lang.invoke.MemberName\n\n \u00b7\u00b7\u00b7\u00b7\u00b7\u00b7\n</code></pre> <ul> <li>instances:\u5b9e\u4f8b\u6570\u91cf</li> <li>bytes:\u5b57\u8282\u5927\u5c0f</li> <li>class name:\u7c7b\u540d</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/JVM%E8%B0%83%E4%BC%98-jdk1.8/#4-clstatsclassloadjvm-heapclassloaderclassloaderclass","title":"4. -clstats\u6253\u5370classload\u548cjvm heap\u6301\u4e45\u5c42\u7684\u4fe1\u606f\uff0c\u5305\u62ec\u6bcf\u4e2aclassloader\u540d\u5b57\uff0c\u6d3b\u6cfc\u578b\uff0c\u5730\u5740\uff0c\u7236classloader\u548c\u52a0\u8f7d\u7684class\u6570\u91cf","text":"<p>\u793a\u4f8b\uff1a</p> <pre><code> jmap -clstats 17100\n</code></pre> <p>\u6253\u5370\u90e8\u5206\u4fe1\u606f\u5982\u4e0b\uff1a</p> <pre><code>Attaching to process ID 17100, please wait...\nDebugger attached successfully.\nServer compiler detected.\nJVM version is 25.202-b08\nfinding class loader instances ..done.\ncomputing per loader stat ..done.\nplease wait.. computing liveness.liveness analysis may be inaccurate ...\nclass_loader    classes bytes   parent_loader   alive?  type\n\n&lt;bootstrap&gt;     3284    5999233   null          live    &lt;internal&gt;\n0x00000006c3d21dd0      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c3d221d0      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c41a6c18      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c395c390      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c395d190      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c2f004f8      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c3d1c7d8      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c40af400      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c39c3390      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c3d4b5d8      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c43e3e30      1       880       null          dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c2f008e0      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c3d207c0      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c40af018      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c41a8408      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c3d4b9c0      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c3d4bdc0      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c395cf80      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c3bd4fa8      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c3bd5da8      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c241ac58      7119    12028309        0x00000006c241acb8      dead    sun/misc/Launcher$AppClassLoader@0x00000007c000f8d8\n0x00000006c3d1e3c8      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c3d233c8      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c41a7000      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c3d4a7c8      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c3d1c3f0      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c41a7c38      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c3d4b1f0      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c3d22bf8      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c41a6830      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c41b5430      1       1474      null          dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c3fdb5d0      1       1476    0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c4151038      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c2f01ec0      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c3d22fe0      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n0x00000006c41a7a28      1       880     0x00000006c241ac58      dead    sun/reflect/DelegatingClassLoader@0x00000007c000a028\n\u00b7\u00b7\u00b7\u00b7\ntotal = 308     10750   18404333            N/A         alive=1, dead=307           N/A\n</code></pre>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/JVM%E8%B0%83%E4%BC%98-jdk1.8/#5","title":"5. \u5c06\u5185\u5b58\u8be6\u7ec6\u4f7f\u7528\u60c5\u51b5\u6253\u5370\u6587\u4ef6","text":"<pre><code>  jmap -dump:format=b,file=m.dat pid\n</code></pre> <p>\u7136\u540e\u53ef\u4ee5\u4f7f\u7528jhat\u547d\u4ee4\u53d1\u5e03\u5230\u672c\u57305000\u7aef\u53e3\u4e0a</p> <pre><code>jhat -port 5000 m.dat\n</code></pre>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/OutOfMemoryError%E5%BC%82%E5%B8%B8/","title":"OutOfMemoryError\u5f02\u5e38","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/OutOfMemoryError%E5%BC%82%E5%B8%B8/#outofmemoryerror","title":"OutOfMemoryError\u5f02\u5e38","text":"<ul> <li>\u6ce8\uff1a\u672c\u4eba\u6d4b\u8bd5\u57fa\u4e8ejdk1.8\u6d4b\u8bd5\uff0c\u6709\u90e8\u5206\u4e0d\u540c\u4f46\u662f\u539f\u7406\u53ef\u4ee5\u4e86\u89e3\uff0c\u611f\u5174\u8da3\u53ef\u4ee5\u4e0b\u8f7djdk1.7\u914d\u5957\u6d4b\u8bd5</li> <li>Java\u865a\u62df\u673a\u89c4\u8303\u4e2d\u63cf\u8ff0\uff0c\u9664\u4e86\u7a0b\u5e8f\u8ba1\u6570\u5668\uff0c\u865a\u62df\u673a\u7684\u5176\u4ed6\u51e0\u4e2a\u8fd0\u884c\u65f6\u533a\u57df\u90fd\u6709\u53d1\u751fOOM\u5f02\u5e38\u7684\u53ef\u80fd\u3002 \u4e0b\u9762\u7684\u793a\u4f8b\u4ee3\u7801\u90fd\u57fa\u4e8eHotSpot\u865a\u62df\u673a\u8fd0\u884c\uff0c\u8bbe\u7f6eVM\u53c2\u6570\u53ef\u4ee5\u5728IDE\u7684VM options\u5185\u8bbe\u7f6e,\u5982\u56fe   </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/OutOfMemoryError%E5%BC%82%E5%B8%B8/#java","title":"Java\u5806\u6ea2\u51fa","text":"<p>\u5f15\u53d1\u601d\u8def\uff1aJava\u5806\u7528\u4e8e\u5b58\u50a8\u5bf9\u8c61\u5b9e\u4f8b\uff0c\u53ea\u8981\u4e0d\u65ad\u5730\u521b\u5efa\u5bf9\u8c61\uff0c\u5e76\u4e14\u4fdd\u8bc1GC Roots\u5230\u5bf9\u8c61\u4e4b\u95f4\u6709\u53ef\u8fbe\u8def\u5f84\u6765\u907f\u514d\u5783\u573e\u56de\u6536\u673a\u5236\u6e05\u9664\u8fd9\u4e9b\u5bf9\u8c61\uff0c\u90a3\u4e48\u5728\u5bf9\u8c61\u6570\u91cf\u5230\u8fbe\u6700\u5927\u5806\u7684\u5bb9\u91cf\u9650\u5236\u540e\u5c31\u4f1a\u4ea7\u751f\u5185\u5b58\u6ea2\u51fa\u5f02\u5e38\u3002</p> <p>- \u4ee5\u4e0b\u4ee3\u7801\u9700\u8981\u914d\u7f6eVM\uff0c\u8bbe\u7f6ejava\u5806\u5927\u5c0f20MB,\u4e0d\u53ef\u6269\u5c55\uff08\u5c06\u5806\u7684\u6700\u5c0f\u503c-Xms\u53c2\u6570\u4e0e\u6700\u5927\u503c-Xmx\u53c2\u6570\u8bbe\u7f6e\u4e3a\u4e00\u6837\u5373\u53ef\u907f\u514d\u5806\u81ea\u52a8\u6269\u5c55\uff09\uff0c-XX\uff1a+HeapDumpOnOutOfMemoryError\u53ef\u4ee5\u8ba9\u865a\u62df\u673a\u5728\u51fa\u73b0\u5185\u5b58\u6ea2\u51fa\u5f02\u5e38\u65f6Dump\u51fa\u5f53\u524d\u7684\u5185\u5b58\u5806\u8f6c\u50a8\u5feb\u7167\u4ee5\u4fbf\u4e8b\u540e\u8fdb\u884c\u5206\u6790 -Xmx\uff1a\u6700\u5927\u5806\u5927\u5c0f</p> <pre><code>-Xmx20M -Xms20M -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=E:\\jvmlog\\oom.hprof\n  ```z\n  \u53ef\u4ee5\u6307\u5b9ahprof\u6587\u4ef6\u5b58\u653e\u4f4d\u7f6e\uff0c\u4e4b\u540e\u4f7f\u7528jdk\u81ea\u5e26\u5de5\u5177jvisualvm.exe\u6253\u5f00\u5206\u6790\u5373\u53ef\n\n  ```java\n  import java.util.ArrayList;\n  import java.util.List;\n\n  public class HeapOOM {\n  static class OOMObject {\n  }\n  public static void main(\n  String[] args) {\n  List&lt;OOMObject&gt; list = new ArrayList&lt;OOMObject&gt;();\n  while (true) {\n  list.add(new OOMObject());\n  }\n  }\n}\n</code></pre> <p>\u8fd0\u884c\u7ed3\u679c\uff1a</p> <pre><code>java.lang.OutOfMemoryError: Java heap space\nDumping heap to java_pid12092.hprof ...\nHeap dump file created [28256955 bytes in 0.096 secs]\nException in thread \"main\" java.lang.OutOfMemoryError: Java heap space\n    at java.util.Arrays.copyOf(Arrays.java:3210)\n    at java.util.Arrays.copyOf(Arrays.java:3181)\n    at java.util.ArrayList.grow(ArrayList.java:267)\n    at java.util.ArrayList.ensureExplicitCapacity(ArrayList.java:241)\n    at java.util.ArrayList.ensureCapacityInternal(ArrayList.java:233)\n    at java.util.ArrayList.add(ArrayList.java:464)\n    at com.llh.jdk.map.HeapOOM.main(HeapOOM.java:14)\n</code></pre> <p>Java\u5806\u5185\u5b58\u7684OOM\u5f02\u5e38\u662f\u5b9e\u9645\u5e94\u7528\u4e2d\u5e38\u89c1\u7684\u5185\u5b58\u6ea2\u51fa\u5f02\u5e38\u60c5\u51b5\u3002\u5f53\u51fa\u73b0Java\u5806\u5185\u5b58\u6ea2\u51fa\u65f6\uff0c\u5f02\u5e38\u5806\u6808\u4fe1\u606f\u201cjava.lang.OutOfMemoryError\u201d\u4f1a\u8ddf\u7740\u8fdb\u4e00\u6b65\u63d0\u793a\u201cJava heap space\u201d\u3002</p> <p></p> <ul> <li>\u5982\u679c\u662f\u5185\u5b58\u6cc4\u9732\uff0c\u53ef\u8fdb\u4e00\u6b65\u901a\u8fc7\u5de5\u5177\u67e5\u770b\u6cc4\u9732\u5bf9\u8c61\u5230GC Roots\u7684\u5f15\u7528\u94fe\u3002\u4e8e\u662f\u5c31\u80fd\u627e\u5230\u6cc4\u9732\u5bf9\u8c61\u662f\u901a\u8fc7\u600e\u6837\u7684\u8def\u5f84\u4e0eGC Roots\u76f8\u5173\u8054\u5e76\u5bfc\u81f4\u5783\u573e\u6536\u96c6\u5668\u65e0\u6cd5\u81ea\u52a8\u56de\u6536\u5b83\u4eec\u7684\u3002\u638c\u63e1\u4e86\u6cc4\u9732\u5bf9\u8c61\u7684\u7c7b\u578b\u4fe1\u606f\u53caGC   Roots\u5f15\u7528\u94fe\u7684\u4fe1\u606f\uff0c\u5c31\u53ef\u4ee5\u6bd4\u8f83\u51c6\u786e\u5730\u5b9a\u4f4d\u51fa\u6cc4\u9732\u4ee3\u7801\u7684\u4f4d\u7f6e\u3002 -</li> </ul> <p>\u5982\u679c\u4e0d\u5b58\u5728\u6cc4\u9732\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u5c31\u662f\u5185\u5b58\u4e2d\u7684\u5bf9\u8c61\u786e\u5b9e\u90fd\u8fd8\u5fc5\u987b\u5b58\u6d3b\u7740\uff0c\u90a3\u5c31\u5e94\u5f53\u68c0\u67e5\u865a\u62df\u673a\u7684\u5806\u53c2\u6570\uff08-Xmx\u4e0e-Xms\uff09\uff0c\u4e0e\u673a\u5668\u7269\u7406\u5185\u5b58\u5bf9\u6bd4\u770b\u662f\u5426\u8fd8\u53ef\u4ee5\u8c03\u5927\uff0c\u4ece\u4ee3\u7801\u4e0a\u68c0\u67e5\u662f\u5426\u5b58\u5728\u67d0\u4e9b\u5bf9\u8c61\u751f\u547d\u5468\u671f\u8fc7\u957f\u3001\u6301\u6709\u72b6\u6001\u65f6\u95f4\u8fc7\u957f\u7684\u60c5\u51b5\uff0c\u5c1d\u8bd5\u51cf\u5c11\u7a0b\u5e8f\u8fd0\u884c\u671f\u7684\u5185\u5b58\u6d88\u8017\u3002</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/OutOfMemoryError%E5%BC%82%E5%B8%B8/#_1","title":"\u865a\u62df\u673a\u6808\u548c\u672c\u5730\u65b9\u6cd5\u6808\u6ea2\u51fa","text":"<ol> <li>\u5728java\u865a\u62df\u673a\u6808\u4e2d\u63cf\u8ff0\u4e86\u4e24\u79cd\u5f02\u5e38\uff1a<ul> <li>\u5982\u679c\u7ebf\u7a0b\u8bf7\u6c42\u7684\u6808\u6df1\u5ea6\u5927\u4e8e\u865a\u62df\u673a\u6240\u5141\u8bb8\u7684\u6700\u5927\u6df1\u5ea6\uff0c\u5c06\u629b\u51faStackOverflowError\u5f02\u5e38</li> <li>\u5982\u679c\u865a\u62df\u673a\u5728\u6269\u5c55\u6808\u65f6\u65e0\u6cd5\u7533\u8bf7\u5230\u8db3\u591f\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u5219\u629b\u51faOutOfMemoryError\u5f02\u5e38</li> </ul> </li> <li>\u5b9a\u4e49\u5927\u91cf\u7684\u672c\u5730\u53d8\u91cf\uff0c\u589e\u5927\u6b64\u65b9\u6cd5\u6808\u4e2d\u672c\u5730\u53d8\u91cf\u8868\u7684\u957f\u5ea6\uff0c\u8bbe\u7f6e-Xss\u53c2\u6570\u51cf\u5c11\u6808\u5185\u5b58\u5bb9\u91cf     <pre><code>-Xss20M -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=E:\\jvmlog\\sof.hprof\n</code></pre> <pre><code>public class JavaVMStackSOF {\n    private int stackLength = 1;\n\n    public void stackLeak() {\n        stackLength++;\n        stackLeak();\n    }\n    public static void main(String[] args) throws Throwable {\n        JavaVMStackSOF oom = new JavaVMStackSOF();\n        try {\n            oom.stackLeak();\n        } catch (Throwable e) {\n            System.out.println(\"stack length\uff1a\" + oom.stackLength);\n            throw e;\n        }\n    }\n}\n</code></pre>    \u8fd0\u884c\u7ed3\u679c     <pre><code>stack length\uff1a1271382\nException in thread \"main\" java.lang.StackOverflowError\n    at com.llh.jdk.map.JavaVMStackSOF.stackLeak(JavaVMStackSOF.java:8)\n    at com.llh.jdk.map.JavaVMStackSOF.stackLeak(JavaVMStackSOF.java:8)\n    at com.llh.jdk.map.JavaVMStackSOF.stackLeak(JavaVMStackSOF.java:8)\n    at com.llh.jdk.map.JavaVMStackSOF.stackLeak(JavaVMStackSOF.java:8)\n    at com.llh.jdk.map.JavaVMStackSOF.stackLeak(JavaVMStackSOF.java:8)\n    at com.llh.jdk.map.JavaVMStackSOF.stackLeak(JavaVMStackSOF.java:8)\n    at com.llh.jdk.map.JavaVMStackSOF.stackLeak(JavaVMStackSOF.java:8)\n    at com.llh.jdk.map.JavaVMStackSOF.stackLeak(JavaVMStackSOF.java:8)\n\u00b7\u00b7\u00b7\n</code></pre>    \u5b9e\u9a8c\u7ed3\u679c\uff1a \u5355\u7ebf\u7a0b\u4e0b\uff0c\u65e0\u8bba\u662f\u7531\u4e8e\u6808\u5e27\u592a\u5927\u8fd8\u662f\u865a\u62df\u673a\u6808\u5bb9\u91cf\u592a\u5c0f\uff0c\u5f53\u5185\u5b58\u65e0\u6cd5\u5206\u914d\u7684\u65f6\u5019\uff0c\u865a\u62df\u673a\u629b\u51fa\u7684\u90fd\u662fStackOverflowError\u5f02\u5e38\u3002</li> </ol> <p>3.\u5982\u679c\u4e0d\u9650\u4e8e\u5355\u7ebf\u7a0b\uff0c\u901a\u8fc7\u4e0d\u65ad\u5efa\u7acb\u7ebf\u7a0b\u7684\u65b9\u5f0f\u53ef\u4ee5\u4ea7\u751f\u5185\u5b58\u6ea2\u51fa\u5f02\u5e38\uff0c\u8fd9\u6837\u4ea7\u751f\u7684\u5185\u5b58\u6ea2\u51fa\u5f02\u5e38\u4e0e\u6808\u7a7a\u95f4\u662f\u5426\u8db3\u591f\u5927\u5e76\u4e0d\u5b58\u5728\u4efb\u4f55\u8054\u7cfb\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u6808\u5206\u914d\u7684\u5185\u5b58\u8d8a\u5927\uff0c\u53cd\u800c\u8d8a\u5bb9\u6613\u4ea7\u751f\u5185\u5b58\u6ea2\u51fa\u5f02\u5e38\u3002</p> <ul> <li>\u539f\u56e0\uff1a\u64cd\u4f5c\u7cfb\u7edf\u5206\u914d\u7ed9\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u5185\u5b58\u662f\u6709\u9650\u5236\u7684\uff0c\u865a\u62df\u673a\u63d0\u4f9b\u53c2\u6570\u6765\u63a7\u5236Java\u5806\u548c\u65b9\u6cd5\u533a\u7684\u8fd9\u4e24\u90e8\u5206\u5185\u5b58\u7684\u6700\u5927\u503c\u3002\u5269\u4f59\u7684\u5185\u5b58\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u9650\u5236\u51cf\u53bbXmx(\u6700\u5927\u5806\u5bb9\u91cf)\uff0c\u518d\u51cf\u53bbMaxPermSize(\u6700\u5927\u65b9\u6cd5\u533a\u5bb9\u91cf)   \u3002\u5982\u679c\u865a\u62df\u673a\u8fdb\u7a0b\u672c\u8eab\u8017\u8d39\u7684\u5185\u5b58\u4e0d\u8ba1\u7b97\u5728\u5185\uff0c\u5269\u4e0b\u7684\u5185\u5b58\u7531\u865a\u62df\u673a\u6808\u548c\u672c\u5730\u65b9\u6cd5\u6808\u74dc\u5206\u3002\u6bcf\u4e2a\u7ebf\u7a0b\u5206\u914d\u5230\u7684\u6808\u5bb9\u91cf\u8d8a\u5927\uff0c\u53ef\u4ee5\u5efa\u7acb\u7684\u7ebf\u7a0b\u6570\u91cf\u8d8a\u5c11\uff0c\u5efa\u7acb\u7ebf\u7a0b\u65f6\u8d8a\u5bb9\u6613\u628a\u5269\u4e0b\u7684\u5185\u5b58\u8017\u5c3d</li> <li>\u89e3\u51b3\uff1a\u5982\u679c\u662f\u5efa\u7acb\u591a\u7ebf\u7a0b\u5bfc\u81f4\u5185\u5b58\u6ea2\u51fa\uff0c\u5728\u4e0d\u80fd\u51cf\u5c11\u7ebf\u7a0b\u6570\u6216\u8005\u66f4\u6362\u865a\u62df\u673a\u7684\u60c5\u51b5\u4e0b\uff0c\u901a\u8fc7\u51cf\u5c11\u5806\u7684\u6700\u5927\u5806\u548c\u51cf\u5c11\u6808\u5bb9\u91cf\u6765\u6362\u53d6\u66f4\u591a\u7684\u7ebf\u7a0b\u3002</li> </ul> <p>\u521b\u5efa\u7ebf\u7a0b\u5bfc\u81f4\u5185\u5b58\u6ea2\u51fa</p> <pre><code>-Xss20M\n</code></pre> <pre><code>public class JavaVMStackOOM {\n    private void dontStop() {\n        while (true) {\n        }\n    }\n\n    public void stackLeakByThread() {\n        while (true) {\n            Thread thread = new Thread(this::dontStop);\n            thread.start();\n        }\n    }\n\n    public static void main(String[] args) throws Throwable {\n        JavaVMStackOOM oom = new JavaVMStackOOM();\n        oom.stackLeakByThread();\n    }\n}\n</code></pre> <p>\u8fd0\u884c\u7ed3\u679c</p> <pre><code>Exception in thread\"main\"java.lang.OutOfMemoryError\uff1aunable to create new native thread\n</code></pre> <p>\u6ce8\u610f\uff1a\u5728windows\u4e0a\uff0cJava\u7ebf\u7a0b\u662f\u6620\u5c04\u5230\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u6838\u7ebf\u7a0b\u4e0a\u7684\uff0c\u6267\u884c\u6b64\u4ee3\u7801\u4f1a\u5bfc\u81f4\u64cd\u4f5c\u7cfb\u7edf\u5047\u6b7b\u3002</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/OutOfMemoryError%E5%BC%82%E5%B8%B8/#_2","title":"\u65b9\u6cd5\u533a\u548c\u8fd0\u884c\u65f6\u5e38\u91cf\u6c60\u5185\u5b58\u6ea2\u51fa","text":"<ul> <li>String.intern\uff08\uff09\u662f\u4e00\u4e2aNative\u65b9\u6cd5<ul> <li>\u4f5c\u7528\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u5e38\u91cf\u6c60\u4e2d\u5df2\u7ecf\u5305\u542b\u4e00\u4e2a\u7b49\u4e8e\u6b64String\u5bf9\u8c61\u7684\u5b57\u7b26\u4e32\uff0c\u5219\u8fd4\u56de\u4ee3\u8868\u6c60\u4e2d\u8fd9\u4e2a\u5b57\u7b26\u4e32\u7684String\u5bf9\u8c61\uff1b \u5426\u5219\uff0c\u5c06\u6b64String\u5bf9\u8c61\u5305\u542b\u7684\u5b57\u7b26\u4e32\u6dfb\u52a0\u5230\u5e38\u91cf\u6c60\u4e2d\uff0c\u5e76\u4e14\u8fd4\u56de\u6b64String\u5bf9\u8c61\u7684\u5f15\u7528\u3002</li> </ul> </li> <li> <p>\u8fd0\u884c\u65f6\u5e38\u91cf\u6c60\u5bfc\u81f4\u7684\u5185\u5b58\u6ea2\u51fa(\u56e0\u4e3a\u7b14\u8005\u4f7f\u7528\u7684jdk1.8\uff0c\u6240\u4ee5\u8bbe\u7f6e\u5143\u7a7a\u95f4\u6765\u6d4b\u8bd5\u5e38\u91cf\u6c60\u5185\u5b58\u6ea2\u51fa\u60c5\u51b5)     <pre><code>-XX:MetaspaceSize=10M -XX:MaxMetaspaceSize=10M\n</code></pre> <pre><code>import java.util.ArrayList;\nimport java.util.List;\npublic class RuntimeConstantPoolOOM {\n    public static void main(String[] args) {\n//\u4f7f\u7528List\u4fdd\u6301\u7740\u5e38\u91cf\u6c60\u5f15\u7528\uff0c\u907f\u514dFull GC\u56de\u6536\u5e38\u91cf\u6c60\u884c\u4e3a\n        List&lt;String&gt; list = new ArrayList&lt;String&gt;();\n//10MB\u7684PermSize\u5728integer\u8303\u56f4\u5185\u8db3\u591f\u4ea7\u751fOOM\u4e86\n        int i = 0;\n        while (true) {\n            list.add(String.valueOf(i++).intern());\n        }\n    }\n}\n</code></pre>   \u5728jdk1.7\u4e0b\u4f1a\u4e00\u76f4\u8fd0\u884c\u4e0b\u53bb\uff0c\u5728\u770b\u4e00\u6bb5\u4ee3\u7801\u6d4b\u8bd5String.intern()\u65b9\u6cd5     <pre><code>import java.util.ArrayList;\nimport java.util.List;\npublic class RuntimeConstantPoolOOM {\n   public static void main(String[] args) {\n        String str1 = new StringBuilder(\"\u8ba1\u7b97\u673a\").append(\"\u8f6f\u4ef6\").toString();\n        System.out.println(str1.intern() == str1);\n        String str2 = new StringBuilder(\"ja\").append(\"va\").toString();\n        System.out.println(str2.intern() == str2);\n    }\n}\n</code></pre>   \u57281.7\u4e0e1.8\u7248\u672c\u7684jdk\u4e2d\uff0c\u8fd9\u4e2a\u4ee3\u7801\u6267\u884c\u4f1a\u5f97\u5230\u4e00\u4e2atrue,\u4e00\u4e2afalse,jdk1.7\u7684intern()   \u65b9\u6cd5\u4f1a\u5728\u5e38\u91cf\u6c60\u4e2d\u8bb0\u5f55\u9996\u5148\u51fa\u73b0\u7684\u5b9e\u4f8b\u5f15\u7528\uff0c\u56e0\u6b64intern\uff08\uff09\u8fd4\u56de\u7684\u5f15\u7528\u548c\u7531StringBuilder\u521b\u5efa\u7684\u90a3\u4e2a\u5b57\u7b26\u4e32\u5b9e\u4f8b\u662f\u540c\u4e00\u4e2a\u3002\u5bf9str2\u6bd4\u8f83\u8fd4\u56defalse\u662f\u56e0\u4e3a\u201cjava\u201d\u8fd9\u4e2a\u5b57\u7b26\u4e32\u5728\u6267\u884cStringBuilder.toString\uff08\uff09\u4e4b\u524d\u5df2\u7ecf\u51fa\u73b0\u8fc7\uff0c\u5b57\u7b26\u4e32\u5e38\u91cf\u6c60\u4e2d\u5df2\u7ecf\u6709\u5b83\u7684\u5f15\u7528\u4e86\uff0c\u4e0d\u7b26\u5408\u201c\u9996\u6b21\u51fa\u73b0\u201d\u7684\u539f\u5219\uff0c\u800c\u201c\u8ba1\u7b97\u673a\u8f6f\u4ef6\u201d\u8fd9\u4e2a\u5b57\u7b26\u4e32\u5219\u662f\u9996\u6b21\u51fa\u73b0\u7684\uff0c\u56e0\u6b64\u8fd4\u56detrue\u3002</p> </li> <li> <p>\u65b9\u6cd5\u533a\u7528\u4e8e\u5b58\u653eClass\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u5982\u7c7b\u540d\u3001\u8bbf\u95ee\u4fee\u9970\u7b26\u3001\u5e38\u91cf\u6c60\u3001\u5b57\u6bb5\u63cf\u8ff0\u3001\u65b9\u6cd5\u63cf\u8ff0\u7b49\uff0c\u8fd9\u4e2a\u533a\u57df\u7684\u6d4b\u8bd5\u601d\u8def\u662f\uff1a\u8fd0\u884c\u65f6\u4ea7\u751f\u5927\u91cf\u7684\u7c7b\u53bb\u586b\u6ee1\u65b9\u6cd5\u533a\uff0c\u76f4\u5230\u6ea2\u51fa</p> </li> <li>\u7b14\u8005\u91c7\u7528CGLIB\u76f4\u63a5\u64cd\u4f5c\u5b57\u8282\u7801\u8fd0\u884c\u65f6\u4ea7\u751f\u5927\u91cf\u7684\u52a8\u6001\u7c7b\u3002\u5f88\u591a\u4e3b\u6d41\u6846\u67b6\uff0c\u5982Spring\u3001Hibernate\uff0c\u5728\u5bf9\u7c7b\u8fdb\u884c\u589e\u5f3a\u65f6\uff0c\u90fd\u4f1a\u4f7f\u7528\u5230CGLib\u8fd9\u7c7b\u5b57\u8282\u7801\u6280\u672f\uff0c\u589e\u5f3a\u7684\u7c7b\u8d8a\u591a\uff0c\u5c31\u9700\u8981\u8d8a\u5927\u7684\u65b9\u6cd5\u533a\u6765\u4fdd\u8bc1\u52a8\u6001\u751f\u6210\u7684Class\u53ef\u4ee5\u52a0\u8f7d\u5165\u5185\u5b58\u3002</li> </ul> <pre><code>-XX:MetaspaceSize=10M -XX:MaxMetaspaceSize=10M -XX:+PrintGCDetails\n</code></pre> <pre><code>import org.springframework.cglib.proxy.Enhancer;\nimport org.springframework.cglib.proxy.MethodInterceptor;\n\npublic class JavaMethodAreaOOM {\n    public static void main(\n            String[] args) {\n        while (true) {\n            Enhancer enhancer = new Enhancer();\n            enhancer.setSuperclass(OOMObject.class);\n            enhancer.setUseCache(false);\n            enhancer.setCallback((MethodInterceptor) (obj, method, args1, proxy) -&gt; proxy.invokeSuper(obj, args1));\n            enhancer.create();\n        }\n    }\n\n    static class OOMObject {\n    }\n}\n</code></pre> <p>\u8fd0\u884c\u7ed3\u679c</p> <pre><code>Exception in thread \"main\" org.springframework.cglib.core.CodeGenerationException: java.lang.OutOfMemoryError--&gt;Metaspace\n    at org.springframework.cglib.core.ReflectUtils.defineClass(ReflectUtils.java:538)\n    at org.springframework.cglib.core.AbstractClassGenerator.generate(AbstractClassGenerator.java:363)\n    at org.springframework.cglib.proxy.Enhancer.generate(Enhancer.java:585)\n    at org.springframework.cglib.core.AbstractClassGenerator$ClassLoaderData.get(AbstractClassGenerator.java:131)\n    at org.springframework.cglib.core.AbstractClassGenerator.create(AbstractClassGenerator.java:319)\n    at org.springframework.cglib.proxy.Enhancer.createHelper(Enhancer.java:572)\n    at org.springframework.cglib.proxy.Enhancer.create(Enhancer.java:387)\n    at com.llh.jdk.map.JavaMethodAreaOOM.main(JavaMethodAreaOOM.java:14)\n</code></pre> <p>-</p> <p>\u65b9\u6cd5\u533a\u6ea2\u51fa\u4e5f\u662f\u4e00\u79cd\u5e38\u89c1\u7684\u5185\u5b58\u6ea2\u51fa\u5f02\u5e38\uff0c\u4e00\u4e2a\u7c7b\u8981\u88ab\u5783\u573e\u6536\u96c6\u5668\u56de\u6536\u6389\uff0c\u5224\u5b9a\u6761\u4ef6\u662f\u6bd4\u8f83\u82db\u523b\u7684\u3002\u5728\u7ecf\u5e38\u52a8\u6001\u751f\u6210\u5927\u91cfClass\u7684\u5e94\u7528\u4e2d\uff0c\u9700\u8981\u7279\u522b\u6ce8\u610f\u7c7b\u7684\u56de\u6536\u72b6\u51b5\u3002\u8fd9\u7c7b\u573a\u666f\u9664\u4e86\u4e0a\u9762\u63d0\u5230\u7684\u7a0b\u5e8f\u4f7f\u7528\u4e86CGLib\u5b57\u8282\u7801\u589e\u5f3a\u548c\u52a8\u6001\u8bed\u8a00\u4e4b\u5916\uff0c\u5e38\u89c1\u7684\u8fd8\u6709\uff1a\u5927\u91cfJSP\u6216\u52a8\u6001\u4ea7\u751fJSP\u6587\u4ef6\u7684\u5e94\u7528\uff08JSP\u7b2c\u4e00\u6b21\u8fd0\u884c\u65f6\u9700\u8981\u7f16\u8bd1\u4e3aJava\u7c7b\uff09\u3001\u57fa\u4e8eOSGi\u7684\u5e94\u7528\uff08\u5373\u4f7f\u662f\u540c\u4e00\u4e2a\u7c7b\u6587\u4ef6\uff0c\u88ab\u4e0d\u540c\u7684\u52a0\u8f7d\u5668\u52a0\u8f7d\u4e5f\u4f1a\u89c6\u4e3a\u4e0d\u540c\u7684\u7c7b\uff09\u7b49\u3002</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/OutOfMemoryError%E5%BC%82%E5%B8%B8/#_3","title":"\u672c\u5730\u76f4\u63a5\u5185\u5b58\u6ea2\u51fa","text":"<p>DirectMemory\u5bb9\u91cf\u53ef\u901a\u8fc7-XX\uff1aMaxDirectMemorySize\u6307\u5b9a\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u5219\u9ed8\u8ba4\u4e0eJava\u5806\u6700\u5927\u503c\uff08-Xmx\u6307\u5b9a\uff09\u4e00\u6837</p> <ul> <li>\u4f7f\u7528unsafe\u5206\u914d\u672c\u673a\u5185\u5b58</li> </ul> <pre><code>-XX:MaxDirectMemorySize=50M -XX:+PrintGCDetails\n</code></pre> <pre><code>import sun.misc.Unsafe;\n\nimport java.lang.reflect.Field;\n\npublic class DirectMemoryOOM {\n    private static final int _1MB = 1024 * 1024;\n\n    public static void main(String[] args) throws Exception {\n        Field unsafeField = Unsafe.class.getDeclaredFields()[0];\n        unsafeField.setAccessible(true);\n        Unsafe unsafe = (Unsafe) unsafeField.get(null);\n        while (true) {\n            unsafe.allocateMemory(_1MB);\n        }\n    }\n}\n</code></pre> <p>\u8fd0\u884c\u7ed3\u679c</p> <pre><code>Exception in thread \"main\" java.lang.OutOfMemoryError\n    at sun.misc.Unsafe.allocateMemory(Native Method)\n    at com.llh.jdk.map.DirectMemoryOOM.main(DirectMemoryOOM.java:15)\nHeap\n PSYoungGen      total 75264K, used 5161K [0x000000076ca00000, 0x0000000771e00000, 0x00000007c0000000)\n  eden space 64512K, 8% used [0x000000076ca00000,0x000000076cf0a638,0x0000000770900000)\n  from space 10752K, 0% used [0x0000000771380000,0x0000000771380000,0x0000000771e00000)\n  to   space 10752K, 0% used [0x0000000770900000,0x0000000770900000,0x0000000771380000)\n ParOldGen       total 172032K, used 0K [0x00000006c5e00000, 0x00000006d0600000, 0x000000076ca00000)\n  object space 172032K, 0% used [0x00000006c5e00000,0x00000006c5e00000,0x00000006d0600000)\n Metaspace       used 3348K, capacity 4496K, committed 4864K, reserved 1056768K\n  class space    used 366K, capacity 388K, committed 512K, reserved 1048576K\n</code></pre> <p>\u7531DirectMemory\u5bfc\u81f4\u7684\u5185\u5b58\u6ea2\u51fa\uff0c\u4e00\u4e2a\u660e\u663e\u7684\u7279\u5f81\u662f\u5728Heap Dump\u6587\u4ef6\u4e2d\u4e0d\u4f1a\u770b\u89c1\u660e\u663e\u7684\u5f02\u5e38\uff0c\u5982\u679c\u8bfb\u8005\u53d1\u73b0OOM\u4e4b\u540eDump\u6587\u4ef6\u5f88\u5c0f\uff0c\u800c\u7a0b\u5e8f\u4e2d\u53c8\u76f4\u63a5\u6216\u95f4\u63a5\u4f7f\u7528\u4e86NIO\uff0c\u90a3\u5c31\u53ef\u4ee5\u8003\u8651\u68c0\u67e5\u4e00\u4e0b\u662f\u4e0d\u662f\u8fd9\u65b9\u9762\u7684\u539f\u56e0\u3002</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/","title":"\u5783\u573e\u6536\u96c6\u5668\u4e0e\u5185\u5b58\u5206\u914d\u7b56\u7565","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#_1","title":"\u5783\u573e\u6536\u96c6\u5668\u4e0e\u5185\u5b58\u5206\u914d\u7b56\u7565","text":"<p>Java\u4e0eC++\u4e4b\u95f4\u6709\u4e00\u5835\u7531\u5185\u5b58\u52a8\u6001\u5206\u914d\u548c\u5783\u573e\u6536\u96c6\u6280\u672f\u6240\u56f4\u6210\u7684\u201c\u9ad8\u5899\u201d\uff0c\u5899\u5916\u9762\u7684\u4eba\u60f3\u8fdb\u53bb\uff0c\u5899\u91cc\u9762\u7684\u4eba\u5374\u60f3\u51fa\u6765</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#_2","title":"\u6982\u8ff0","text":"<p>\u5783\u573e\u6536\u96c6\uff08Garbage Collection,GC\uff09</p> <ul> <li>\u5783\u573e\u6536\u96c6\u9700\u8981\u89e3\u51b3\u7684\u95ee\u9898<ul> <li>\u54ea\u4e9b\u5185\u5b58\u9700\u8981\u56de\u6536\uff1f</li> <li>\u4ec0\u4e48\u65f6\u5019\u56de\u6536\uff1f</li> <li>\u5982\u4f55\u56de\u6536\uff1f</li> </ul> </li> <li>\u4e3a\u4ec0\u4e48\u9700\u8981\u4e86\u89e3\u5783\u573e\u56de\u6536</li> <li>\u800cJava\u5806\u548c\u65b9\u6cd5\u533a\u4e0d\u4e00\u6837\uff0c\u4e00\u4e2a\u63a5\u53e3\u4e2d\u7684\u591a\u4e2a\u5b9e\u73b0\u7c7b\u9700\u8981\u7684\u5185\u5b58\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u4e00\u4e2a\u65b9\u6cd5\u4e2d\u7684\u591a\u4e2a\u5206\u652f\u9700\u8981\u7684\u5185\u5b58\u4e5f\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u6211\u4eec\u53ea\u6709\u5728\u7a0b\u5e8f\u5904\u4e8e\u8fd0\u884c\u671f\u95f4\u65f6\u624d\u80fd\u77e5\u9053\u4f1a\u521b\u5efa\u54ea\u4e9b\u5bf9\u8c61\uff0c\u8fd9\u90e8\u5206\u5185\u5b58\u7684\u5206\u914d\u548c\u56de\u6536\u90fd\u662f\u52a8\u6001\u7684\uff0c\u5783\u573e\u6536\u96c6\u5668\u5173\u6ce8\u7684\u5c31\u662f\u8fd9\u90e8\u5206\u5185\u5b58\u3002</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#-","title":"- \u9700\u8981\u6392\u67e5\u5404\u79cd\u5185\u5b58\u6ea2\u51fa\uff0c\u6cc4\u9732\u65f6\uff0c\u5f53\u5783\u573e\u6536\u96c6\u6210\u4e3a\u7cfb\u7edf\u8fbe\u5230\u66f4\u9ad8\u5e76\u53d1\u91cf\u7684\u74f6\u9888\u65f6\uff0c\u6211\u4eec\u5c31\u9700\u8981\u5806\u5783\u573e\u6536\u96c6\u4ee5\u53ca\u5185\u5b58\u5206\u914d\u5b9e\u65bd\u5fc5\u8981\u7684\u76d1\u63a7\u548c\u8c03\u8282","text":"<p>\u4e4b\u524d\u4e86\u89e3\u5230\u4e86Java\u5185\u5b58\u8fd0\u884c\u65f6\u533a\u57df\u7684\u5404\u4e2a\u90e8\u5206\uff0c\u5176\u4e2d\u7a0b\u5e8f\u8ba1\u6570\u5668\u3001\u865a\u62df\u673a\u6808\u3001\u672c\u5730\u65b9\u6cd5\u68083\u4e2a\u533a\u57df\u662f\u968f\u7ebf\u7a0b\u800c\u751f\uff0c\u968f\u7ebf\u7a0b\u800c\u706d\uff1b\u6808\u4e2d\u7684\u6808\u5e27\u968f\u7740\u65b9\u6cd5\u7684\u8fdb\u5165\u548c\u9000\u51fa\u6267\u884c\u8005\u51fa\u6808\u548c\u5165\u6808\u7684\u64cd\u4f5c\u3002\u6bcf\u4e00\u4e2a\u6808\u5e27\u5206\u914d\u591a\u5c11\u5185\u5b58\u57fa\u672c\u4e0a\u5728\u7c7b\u7ed3\u6784\u786e\u5b9a\u540e\u4fbf\u5df2\u77e5\uff0c\u56e0\u6b64\u8fd9\u51e0\u4e2a\u533a\u57df\u7684\u5185\u5b58\u5206\u914d\u548c\u56de\u6536\u90fd\u5177\u5907\u786e\u5b9a\u6027\uff0c\u5728\u8fd9\u51e0\u4e2a\u533a\u57df\u5185\u5c31\u4e0d\u9700\u8981\u8fc7\u591a\u8003\u8651\u56de\u6536\u7684\u95ee\u9898\uff0c\u56e0\u4e3a\u65b9\u6cd5\u7ed3\u675f\u6216\u8005\u7ebf\u7a0b\u7ed3\u675f\u65f6\uff0c\u5185\u5b58\u81ea\u7136\u5c31\u8ddf\u968f\u7740\u56de\u6536\u4e86\u3002</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#_3","title":"\u5bf9\u8c61\u5df2\u6b7b\u5417","text":"<ul> <li>\u5806\u91cc\u5b58\u653e\u7740java\u4e16\u754c\u4e2d\u51e0\u4e4e\u6240\u6709\u7684\u5bf9\u8c61\u5b9e\u4f8b\uff0c\u5783\u573e\u6536\u96c6\u5668\u5728\u5bf9\u5806\u8fdb\u884c\u56de\u6536\u524d\uff0c\u7b2c\u4e00\u4ef6\u4e8b\u8981\u786e\u5b9a\u7684\u5c31\u662f\u54ea\u4e9b\u5bf9\u8c61\u662f\u53ef\u4ee5\u88ab\u56de\u6536\u7684\uff08\u4e0d\u53ef\u80fd\u518d\u88ab\u4efb\u4f55\u9014\u5f84\u4f7f\u7528\u7684\u5bf9\u8c61\uff09\u3002</li> <li>\u5224\u65ad\u5bf9\u8c61\u662f\u5426\u5b58\u6d3b\u7684\u7b97\u6cd5\uff1a<ol> <li>\u5f15\u7528\u8ba1\u6570\u7b97\u6cd5</li> <li>\u53ef\u8fbe\u6027\u5206\u6790\u7b97\u6cd5</li> </ol> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#_4","title":"\u5f15\u7528\u8ba1\u6570\u7b97\u6cd5","text":"<ul> <li>\u7b97\u6cd5\u5b9e\u73b0\uff1a\u7ed9\u5bf9\u8c61\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u5f15\u7528\u8ba1\u6570\u5668\uff0c\u6bcf\u5f53\u7531\u4e00\u4e2a\u5730\u65b9\u5f15\u7528\u7684\u65f6\u5019\uff0c\u8ba1\u6570\u5668\u503c\u5c31\u52a01\uff1b\u5f53\u5f15\u7528\u5931\u6548\u65f6\uff0c\u8ba1\u6570\u5668\u503c\u51cf1\uff1b\u4efb\u4f55\u65f6\u523b\u8ba1\u6570\u5668\u503c\u4e3a0\u7684\u5bf9\u8c61\u5c31\u662f\u4e0d\u53ef\u80fd\u518d\u88ab\u4f7f\u7528\u7684\u3002</li> <li>java\u4e0d\u7528\u6b64\u7b97\u6cd5\u539f\u56e0\uff1a\u5f88\u96be\u89e3\u51b3\u5bf9\u8c61\u4e4b\u95f4\u76f8\u4e92\u5faa\u73af\u5f15\u7528\u7684\u95ee\u9898</li> <li>\u5982\u4e0b\u4f8b\u5b50\uff0c<code>testGC()</code>   \u65b9\u6cd5\uff0c\u5bf9\u8c61objA\u548cobjB\u90fd\u6709\u5b57\u6bb5instance\uff0c\u8d4b\u503c\u4ee4objA.instance=objB\u53caobjB.instance=objA\uff0c\u9664\u6b64\u4e4b\u5916\uff0c\u8fd9\u4e24\u4e2a\u5bf9\u8c61\u518d\u65e0\u4efb\u4f55\u5f15\u7528\uff0c\u5b9e\u9645\u4e0a\u8fd9\u4e24\u4e2a\u5bf9\u8c61\u5df2\u7ecf\u4e0d\u53ef\u80fd\u518d\u88ab\u8bbf\u95ee\uff0c\u4f46\u662f\u5b83\u4eec\u56e0\u4e3a\u4e92\u76f8\u5f15\u7528\u7740\u5bf9\u65b9\uff0c\u5bfc\u81f4\u5b83\u4eec\u7684\u5f15\u7528\u8ba1\u6570\u90fd\u4e0d\u4e3a0\uff0c\u4e8e\u662f\u5f15\u7528\u8ba1\u6570\u7b97\u6cd5\u65e0\u6cd5\u901a\u77e5GC\u6536\u96c6\u5668\u56de\u6536\u5b83\u4eec</li> </ul> <pre><code>-XX:+PrintGCDetails\n</code></pre> <pre><code>public class ReferenceCountingGC {\n    public Object instance = null;\n    private static final int _1MB = 1024 * 1024;\n    /**\n     * \u8fd9\u4e2a\u6210\u5458\u5c5e\u6027\u7684\u552f\u4e00\u610f\u4e49\u5c31\u662f\u5360\u70b9\u5185\u5b58\uff0c\u4ee5\u4fbf\u80fd\u5728GC\u65e5\u5fd7\u4e2d\u770b\u6e05\u695a\u662f\u5426\u88ab\u56de\u6536\u8fc7\n     */\n    private byte[] bigSize = new byte[2 * _1MB];\n\n    public static void testGC() {\n        ReferenceCountingGC objA = new ReferenceCountingGC();\n        ReferenceCountingGC objB = new ReferenceCountingGC();\n        objA.instance = objB;\n        objB.instance = objA;\n        objA = null;\n        objB = null;\n//\u5047\u8bbe\u5728\u8fd9\u884c\u53d1\u751fGC,objA\u548cobjB\u662f\u5426\u80fd\u88ab\u56de\u6536\uff1f\n        System.gc();\n    }\n\n    public static void main(String[] args) {\n        testGC();\n    }\n}\n</code></pre> <p>\u8fd0\u884c\u7ed3\u679c</p> <pre><code>[GC (System.gc()) [PSYoungGen: 7966K-&gt;824K(75264K)] 7966K-&gt;832K(247296K), 0.0009400 secs] [Times: user=0.00 sys=0.00, real=0.00 secs] \n[Full GC (System.gc()) [PSYoungGen: 824K-&gt;0K(75264K)] [ParOldGen: 8K-&gt;688K(172032K)] 832K-&gt;688K(247296K), [Metaspace: 3111K-&gt;3111K(1056768K)], 0.0047815 secs] [Times: user=0.09 sys=0.00, real=0.01 secs] \nHeap\n PSYoungGen      total 75264K, used 1935K [0x000000076ca00000, 0x0000000771e00000, 0x00000007c0000000)\n  eden space 64512K, 3% used [0x000000076ca00000,0x000000076cbe3fb8,0x0000000770900000)\n  from space 10752K, 0% used [0x0000000770900000,0x0000000770900000,0x0000000771380000)\n  to   space 10752K, 0% used [0x0000000771380000,0x0000000771380000,0x0000000771e00000)\n ParOldGen       total 172032K, used 688K [0x00000006c5e00000, 0x00000006d0600000, 0x000000076ca00000)\n  object space 172032K, 0% used [0x00000006c5e00000,0x00000006c5eac260,0x00000006d0600000)\n Metaspace       used 3138K, capacity 4496K, committed 4864K, reserved 1056768K\n  class space    used 342K, capacity 388K, committed 512K, reserved 1048576K\n\nProcess finished with exit code 0\n</code></pre> <p>\u8fd0\u884c\u7ed3\u679c\u4e2d\u53ef\u4ee5\u6e05\u695a\u770b\u5230\uff0cGC\u65e5\u5fd7\u4e2d\u5305\u542b\u201c7966K-&gt;824K(75264K)\u201d\uff0c\u610f\u5473\u7740\u865a\u62df\u673a\u5e76\u6ca1\u6709\u56e0\u4e3a\u8fd9\u4e24\u4e2a\u5bf9\u8c61\u4e92\u76f8\u5f15\u7528\u5c31\u4e0d\u56de\u6536\u5b83\u4eec\uff0c\u8fd9\u4e5f\u4ece\u4fa7\u9762\u8bf4\u660e\u865a\u62df\u673a\u5e76\u4e0d\u662f\u901a\u8fc7\u5f15\u7528\u8ba1\u6570\u7b97\u6cd5\u6765\u5224\u65ad\u5bf9\u8c61\u662f\u5426\u5b58\u6d3b\u7684</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#_5","title":"\u53ef\u8fbe\u6027\u5206\u6790\u7b97\u6cd5","text":"<ul> <li>\u5728\u4e3b\u6d41\u7684\u5546\u7528\u7a0b\u5e8f\u8bed\u8a00\uff08Java\u3001C#\uff0c\u751a\u81f3\u5305\u62ec\u524d\u9762\u63d0\u5230\u7684\u53e4\u8001\u7684Lisp\uff09\u7684\u4e3b\u6d41\u5b9e\u73b0\u4e2d\uff0c\u90fd\u662f\u79f0\u901a\u8fc7\u53ef\u8fbe\u6027\u5206\u6790\uff08Reachability Analysis\uff09\u6765\u5224\u5b9a\u5bf9\u8c61\u662f\u5426\u5b58\u6d3b\u7684</li> <li>\u7b97\u6cd5\u601d\u8def\uff1a\u901a\u8fc7\u4e00\u7cfb\u5217\u7684\u79f0\u4e3a\u201cGC Roots\u201d\u7684\u5bf9\u8c61\u4f5c\u4e3a\u8d77\u59cb\u70b9\uff0c\u4ece\u8fd9\u4e9b\u8282\u70b9\u5f00\u59cb\u5411\u4e0b\u641c\u7d22\uff0c\u641c\u7d22\u6240\u8d70\u8fc7\u7684\u8def\u5f84\u79f0\u4e3a\u5f15\u7528\u94fe\uff08Reference Chain\uff09\uff0c\u5f53\u4e00\u4e2a\u5bf9\u8c61\u5230GC Roots\u6ca1\u6709\u4efb\u4f55\u5f15\u7528\u94fe\u76f8\u8fde\uff08\u7528\u56fe\u8bba\u7684\u8bdd\u6765\u8bf4\uff0c\u5c31\u662f\u4eceGC   Roots\u5230\u8fd9\u4e2a\u5bf9\u8c61\u4e0d\u53ef\u8fbe\uff09\u65f6\uff0c\u5219\u8bc1\u660e\u6b64\u5bf9\u8c61\u662f\u4e0d\u53ef\u7528\u7684\u3002      \u5982\u56fe\uff0cobject5\u3001object6\u3001object7\u867d\u6709\u5173\u8054\uff0c\u4f46\u662f\u5b83\u4eec\u5230GC roots\u65f6\u4e0d\u53ef\u8fbe\u7684\uff0c\u6240\u4ee5\u88ab\u5224\u5b9a\u662f\u53ef\u56de\u6536\u7684\u5bf9\u8c61</li> <li>Java\u8bed\u8a00\u4e2d\uff0c\u53ef\u4f5c\u4e3aGC Roots\u7684\u5bf9\u8c61\u5305\u62ec\uff1a<ul> <li>\u865a\u62df\u673a\u6808\uff08\u6808\u5e27\u4e2d\u7684\u672c\u5730\u53d8\u91cf\u8868\uff09\u4e2d\u5f15\u7528\u7684\u5bf9\u8c61</li> <li>\u65b9\u6cd5\u533a\u4e2d\u7c7b\u9759\u6001\u5c5e\u6027\u5f15\u7528\u7684\u5bf9\u8c61</li> <li>\u65b9\u6cd5\u533a\u4e2d\u5e38\u91cf\u5f15\u7528\u7684\u5bf9\u8c61</li> <li>\u672c\u5730\u65b9\u6cd5\u6808\u4e2dJNI(Native\u65b9\u6cd5)\u5f15\u7528\u7684\u5bf9\u8c61</li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#_6","title":"\u518d\u8c08\u5f15\u7528","text":"<p>Java\u5bf9\u5f15\u7528\u7684\u6982\u5ff5\u5206\u4e3a\u5f3a\u5f15\u7528\uff08Strong Reference\uff09\uff0c\u8f6f\u5f15\u7528\uff08Soft Reference\uff09\uff0c\u5f31\u5f15\u7528\uff08Weak Reference\uff09\uff0c\u865a\u5f15\u7528\uff08Phantom Reference\uff094\u79cd\u3002 SoftReference\uff0cWeakReference\uff0cPhantomReference</p> <ul> <li>\u5f3a\u5f15\u7528\u5728\u7a0b\u5e8f\u4ee3\u7801\u4e2d\u666e\u904d\u5b58\u5728\u7684\uff0c\u7c7b\u4f3c\u201cObject obj=new Object()\u201d\u8fd9\u7c7b\u7684\u5f15\u7528\uff0c\u53ea\u8981\u5f3a\u5f15\u7528\u8fd8\u5728\uff0c\u5783\u573e\u6536\u96c6\u5668\u6c38\u8fdc\u4e0d\u4f1a\u56de\u6536\u6389\u88ab\u5f15\u7528\u7684\u5bf9\u8c61</li> <li>\u8f6f\u5f15\u7528\u63cf\u8ff0\u4e00\u4e9b\u6709\u7528\u4f46\u662f\u975e\u5fc5\u9700\u7684\u5bf9\u8c61\uff0c\u8f6f\u5f15\u7528\u5173\u8054\u7684\u5bf9\u8c61\uff0c\u5728\u7cfb\u7edf\u5c06\u8981\u53d1\u751f\u5185\u5b58\u6ea2\u51fa\u5f02\u5e38\u4e4b\u524d\uff0c\u5c06\u4f1a\u628a\u8fd9\u4e9b\u5bf9\u8c61\u5217\u8fdb\u56de\u6536\u8303\u56f4\u8fdb\u884c\u7b2c\u4e8c\u6b21\u56de\u6536\u3002\u5982\u679c\u8fd9\u6b21\u56de\u6536\u8fd8\u6ca1\u6709\u8db3\u591f\u7684\u5185\u5b58\uff0c\u624d\u4f1a\u629b\u51fa\u5185\u5b58\u6ea2\u51fa\u5f02\u5e38\u3002</li> <li>\u5f31\u5f15\u7528\u4e5f\u662f\u7528\u6765\u63cf\u8ff0\u975e\u5fc5\u987b\u5bf9\u8c61\uff0c\u4f46\u662f\u5b83\u7684\u5f3a\u5ea6\u6bd4\u8f6f\u5f15\u7528\u66f4\u5f31\u4e00\u4e9b\uff0c\u88ab\u5f31\u5f15\u7528\u5173\u8054\u7684\u5bf9\u8c61\u53ea\u80fd\u751f\u5b58\u5230\u4e0b\u4e00\u6b21\u5783\u573e\u6536\u96c6\u53d1\u751f\u4e4b\u524d\u3002\u5f53\u5783\u573e\u6536\u96c6\u5668\u5de5\u4f5c\u65f6\uff0c\u65e0\u8bba\u5f53\u524d\u5185\u5b58\u662f\u5426\u8db3\u591f\uff0c\u90fd\u4f1a\u56de\u6536\u6389\u53ea\u88ab\u5f31\u5f15\u7528\u5173\u8054\u7684\u5bf9\u8c61\u3002</li> <li>\u865a\u5f15\u7528\u4e5f\u79f0\u4e3a\u5e7d\u7075\u5f15\u7528\u6216\u8005\u5e7b\u5f71\u5f15\u7528\uff0c\u5b83\u662f\u6700\u5f31\u7684\u4e00\u79cd\u5f15\u7528\u5173\u7cfb\u3002\u4e00\u4e2a\u5bf9\u8c61\u662f\u5426\u6709\u865a\u5f15\u7528\u7684\u5b58\u5728\uff0c\u5b8c\u5168\u4e0d\u4f1a\u5bf9\u5176\u751f\u5b58\u65f6\u95f4\u6784\u6210\u5f71\u54cd\uff0c\u4e5f\u65e0\u6cd5\u901a\u8fc7\u865a\u5f15\u7528\u6765\u53d6\u5f97\u4e00\u4e2a\u5bf9\u8c61\u5b9e\u4f8b\u3002\u4e3a\u4e00\u4e2a\u5bf9\u8c61\u8bbe\u7f6e\u865a\u5f15\u7528\u5173\u8054\u7684\u552f\u4e00\u76ee\u7684\u5c31\u662f\u80fd\u5728\u8fd9\u4e2a\u5bf9\u8c61\u88ab\u6536\u96c6\u5668\u56de\u6536\u65f6\u6536\u5230\u4e00\u4e2a\u7cfb\u7edf\u901a\u77e5</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#_7","title":"\u751f\u5b58\u8fd8\u662f\u6b7b\u4ea1","text":"<p>\u5373\u4f7f\u5728\u53ef\u8fbe\u6027\u5206\u6790\u7b97\u6cd5\u4e2d\u4e0d\u53ef\u8fbe\u7684\u5bf9\u8c61\uff0c\u8981\u771f\u6b63\u5ba3\u544a\u4e00\u4e2a\u5bf9\u8c61\u6b7b\u4ea1\uff0c\u81f3\u5c11\u8981\u7ecf\u5386\u4e24\u6b21\u6807\u8bb0\u8fc7\u7a0b\uff1a\u5982\u679c\u5bf9\u8c61\u5728\u8fdb\u884c\u53ef\u8fbe\u6027\u5206\u6790\u540e\u53d1\u73b0\u6ca1\u6709\u4e0eGC Roots\u76f8\u8fde\u63a5\u7684\u5f15\u7528\u94fe\uff0c\u90a3\u5b83\u5c06\u4f1a\u88ab\u7b2c\u4e00\u6b21\u6807\u8bb0\u5e76\u4e14\u8fdb\u884c\u4e00\u6b21\u7b5b\u9009\uff0c\u7b5b\u9009\u7684\u6761\u4ef6\u662f\u6b64\u5bf9\u8c61\u662f\u5426\u6709\u5fc5\u8981\u6267\u884cfinalize\uff08\uff09\u65b9\u6cd5\uff0c\u5f53\u5bf9\u8c61\u6ca1\u6709\u8986\u76d6finalize\uff08\uff09\u65b9\u6cd5\uff0c\u6216\u8005finalize\uff08\uff09\u65b9\u6cd5\u5df2\u7ecf\u88ab\u865a\u62df\u673a\u8c03\u7528\u8fc7\uff0c\u865a\u62df\u673a\u5c06\u8fd9\u4e24\u79cd\u60c5\u51b5\u90fd\u89c6\u4e3a\u201c\u6ca1\u6709\u5fc5\u8981\u6267\u884c\u201d\u3002</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#-finalizef-queuefinalizer","title":"- \u5982\u679c\u8fd9\u4e2a\u5bf9\u8c61\u88ab\u5224\u5b9a\u6709\u5fc5\u8981\u6267\u884cfinalize()\u65b9\u6cd5\uff0c\u90a3\u8fd9\u4e2a\u5bf9\u8c61\u5c06\u4f1a\u653e\u7f6e\u5728\u4e00\u4e2aF-Queue\u7684\u961f\u5217\u4e2d\uff0c\u5e76\u5728\u7a0d\u540e\u7531\u4e00\u4e2a\u7531\u865a\u62df\u673a\u81ea\u52a8\u5efa\u7acb\u7684\u3001\u4f4e\u4f18\u5148\u7ea7\u7684Finalizer\u7ebf\u7a0b\u53bb\u6267\u884c\u5b83\u3002","text":"<p>finalize\uff08\uff09\u65b9\u6cd5\u662f\u5bf9\u8c61\u9003\u8131\u6b7b\u4ea1\u547d\u8fd0\u7684\u6700\u540e\u4e00\u6b21\u673a\u4f1a\uff0c\u7a0d\u540eGC\u5c06\u5bf9F-Queue\u4e2d\u7684\u5bf9\u8c61\u8fdb\u884c\u7b2c\u4e8c\u6b21\u5c0f\u89c4\u6a21\u7684\u6807\u8bb0\uff0c\u5982\u679c\u5bf9\u8c61\u8981\u5728finalize\uff08\uff09\u4e2d\u6210\u529f\u62ef\u6551\u81ea\u5df1\u2014\u2014\u53ea\u8981\u91cd\u65b0\u4e0e\u5f15\u7528\u94fe\u4e0a\u7684\u4efb\u4f55\u4e00\u4e2a\u5bf9\u8c61\u5efa\u7acb\u5173\u8054\u5373\u53ef\uff0c\u8b6c\u5982\u628a\u81ea\u5df1\uff08this\u5173\u952e\u5b57\uff09\u8d4b\u503c\u7ed9\u67d0\u4e2a\u7c7b\u53d8\u91cf\u6216\u8005\u5bf9\u8c61\u7684\u6210\u5458\u53d8\u91cf\uff0c\u90a3\u5728\u7b2c\u4e8c\u6b21\u6807\u8bb0\u65f6\u5b83\u5c06\u88ab\u79fb\u9664\u51fa\u201c\u5373\u5c06\u56de\u6536\u201d\u7684\u96c6\u5408\uff1b\u5982\u679c\u5bf9\u8c61\u8fd9\u65f6\u5019\u8fd8\u6ca1\u6709\u9003\u8131\uff0c\u90a3\u57fa\u672c\u4e0a\u5b83\u5c31\u771f\u7684\u88ab\u56de\u6536\u4e86\u3002 - \u4e00\u6b21\u5bf9\u8c61\u81ea\u6211\u62ef\u6551\u6f14\u793a</p> <pre><code>public class FinalizeEscapeGC {\n    public static FinalizeEscapeGC SAVE_HOOK = null;\n\n    public void isAlive() {\n        System.out.println(\"yes,i am still alive\uff1a)\");\n    }\n\n    @Override\n    protected void finalize() throws Throwable {\n        super.finalize();\n        System.out.println(\"finalize mehtod executed!\");\n        FinalizeEscapeGC.SAVE_HOOK = this;\n    }\n\n    public static void main(String[] args) throws Throwable {\n        SAVE_HOOK = new FinalizeEscapeGC();\n//\u5bf9\u8c61\u7b2c\u4e00\u6b21\u6210\u529f\u62ef\u6551\u81ea\u5df1\n        SAVE_HOOK = null;\n        System.gc();\n//\u56e0\u4e3afinalize\u65b9\u6cd5\u4f18\u5148\u7ea7\u5f88\u4f4e\uff0c\u6240\u4ee5\u6682\u505c0.5\u79d2\u4ee5\u7b49\u5f85\u5b83\n        Thread.sleep(500);\n        if (SAVE_HOOK != null) {\n            SAVE_HOOK.isAlive();\n        } else {\n            System.out.println(\"no,i am dead\uff1a(\");\n        }\n        //\u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801\u4e0e\u4e0a\u9762\u7684\u5b8c\u5168\u76f8\u540c\uff0c\u4f46\u662f\u8fd9\u6b21\u81ea\u6551\u5374\u5931\u8d25\u4e86\n        SAVE_HOOK = null;\n        System.gc();\n//\u56e0\u4e3afinalize\u65b9\u6cd5\u4f18\u5148\u7ea7\u5f88\u4f4e\uff0c\u6240\u4ee5\u6682\u505c0.5\u79d2\u4ee5\u7b49\u5f85\u5b83\n        Thread.sleep(500);\n        if (SAVE_HOOK != null) {\n            SAVE_HOOK.isAlive();\n        } else {\n            System.out.println(\"no,i am dead\uff1a(\");\n        }\n    }\n}\n</code></pre> <p>\u8fd0\u884c\u7ed3\u679c\uff1a</p> <pre><code>\"C:\\Program Files\\Java\\jdk1.8.0_261\\bin\\java.exe\" \"-javaagent:E:\\IntelliJ IDEA 2020.1.3\\lib\\idea_rt.jar=52343:E:\\IntelliJ IDEA 2020.1.3\\bin\" -Dfile.encoding=UTF-8 -classpath \"C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\charsets.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\deploy.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\ext\\access-bridge-64.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\ext\\cldrdata.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\ext\\dnsns.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\ext\\jaccess.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\ext\\jfxrt.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\ext\\localedata.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\ext\\nashorn.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\ext\\sunec.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\ext\\sunjce_provider.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\ext\\sunmscapi.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\ext\\sunpkcs11.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\ext\\zipfs.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\javaws.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\jce.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\jfr.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\jfxswt.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\jsse.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\management-agent.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\plugin.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\resources.jar;C:\\Program Files\\Java\\jdk1.8.0_261\\jre\\lib\\rt.jar;F:\\data\\play-jdk\\target\\classes;C:\\Users\\Administrator\\.m2\\repository\\org\\springframework\\boot\\spring-boot-starter\\2.4.0\\spring-boot-starter-2.4.0.jar;C:\\Users\\Administrator\\.m2\\repository\\org\\springframework\\boot\\spring-boot\\2.4.0\\spring-boot-2.4.0.jar;C:\\Users\\Administrator\\.m2\\repository\\org\\springframework\\spring-context\\5.3.1\\spring-context-5.3.1.jar;C:\\Users\\Administrator\\.m2\\repository\\org\\springframework\\spring-aop\\5.3.1\\spring-aop-5.3.1.jar;C:\\Users\\Administrator\\.m2\\repository\\org\\springframework\\spring-beans\\5.3.1\\spring-beans-5.3.1.jar;C:\\Users\\Administrator\\.m2\\repository\\org\\springframework\\spring-expression\\5.3.1\\spring-expression-5.3.1.jar;C:\\Users\\Administrator\\.m2\\repository\\org\\springframework\\boot\\spring-boot-autoconfigure\\2.4.0\\spring-boot-autoconfigure-2.4.0.jar;C:\\Users\\Administrator\\.m2\\repository\\org\\springframework\\boot\\spring-boot-starter-logging\\2.4.0\\spring-boot-starter-logging-2.4.0.jar;C:\\Users\\Administrator\\.m2\\repository\\ch\\qos\\logback\\logback-classic\\1.2.3\\logback-classic-1.2.3.jar;C:\\Users\\Administrator\\.m2\\repository\\ch\\qos\\logback\\logback-core\\1.2.3\\logback-core-1.2.3.jar;C:\\Users\\Administrator\\.m2\\repository\\org\\apache\\logging\\log4j\\log4j-to-slf4j\\2.13.3\\log4j-to-slf4j-2.13.3.jar;C:\\Users\\Administrator\\.m2\\repository\\org\\apache\\logging\\log4j\\log4j-api\\2.13.3\\log4j-api-2.13.3.jar;C:\\Users\\Administrator\\.m2\\repository\\org\\slf4j\\jul-to-slf4j\\1.7.30\\jul-to-slf4j-1.7.30.jar;C:\\Users\\Administrator\\.m2\\repository\\jakarta\\annotation\\jakarta.annotation-api\\1.3.5\\jakarta.annotation-api-1.3.5.jar;C:\\Users\\Administrator\\.m2\\repository\\org\\springframework\\spring-core\\5.3.1\\spring-core-5.3.1.jar;C:\\Users\\Administrator\\.m2\\repository\\org\\springframework\\spring-jcl\\5.3.1\\spring-jcl-5.3.1.jar;C:\\Users\\Administrator\\.m2\\repository\\org\\yaml\\snakeyaml\\1.27\\snakeyaml-1.27.jar;C:\\Users\\Administrator\\.m2\\repository\\org\\slf4j\\slf4j-api\\1.7.30\\slf4j-api-1.7.30.jar\" com.llh.jdk.map.FinalizeEscapeGC\nfinalize mehtod executed!\nyes,i am still alive\uff1a)\nno,i am dead\uff1a(\nProcess finished with exit code 0\n</code></pre> <p>\u4ee3\u7801\u7406\u89e3\uff1a\u5c06\u5bf9\u8c61\u8d4b\u503c\u4e3a\u7a7a\u5e76\u4e14\u8c03\u7528gc\u7684\u65f6\u5019\uff0c\u7ebf\u7a0b\u7b49\u5f85\u7531\u865a\u62df\u673a\u81ea\u52a8\u5efa\u7acb\u7684\u3001\u4f4e\u4f18\u5148\u7ea7\u7684finalizer\u7ebf\u7a0b\u53bb\u6267\u884c\uff0c\u6267\u884c\u65f6\u627e\u5230finalize() \u65b9\u6cd5\uff0c\u5bf9\u8c61\u6210\u529f\u62ef\u6551\u81ea\u5df1\uff0c\u6240\u4ee5\u5bf9\u8c61\u4e0d\u4e3a\u7a7a\uff1b\u518d\u6b21gc\u56de\u6536\uff0cfinalize\uff08\uff09\u65b9\u6cd5\u5df2\u7ecf\u88ab\u865a\u62df\u673a\u8c03\u7528\u8fc7\uff0c\u6240\u4ee5\u5224\u5b9a\u4e3a\u65b9\u6cd5\u4e0d\u4f1a\u518d\u6b21\u6267\u884c\uff0c\u5df2\u88ab\u5f7b\u5e95\u56de\u6536\u3002</p> <p>- \u4ee3\u7801\u4e2d\u6709\u4e24\u6bb5\u5b8c\u5168\u4e00\u6837\u7684\u4ee3\u7801\u7247\u6bb5\uff0c\u6267\u884c\u7ed3\u679c\u5374\u662f\u4e00\u6b21\u9003\u8131\u6210\u529f\uff0c\u4e00\u6b21\u5931\u8d25\uff0c\u8fd9\u662f\u56e0\u4e3a\u4efb\u4f55\u4e00\u4e2a\u5bf9\u8c61\u7684finalize\uff08\uff09\u65b9\u6cd5\u90fd\u53ea\u4f1a\u88ab\u7cfb\u7edf\u81ea\u52a8\u8c03\u7528\u4e00\u6b21\uff0c\u5982\u679c\u5bf9\u8c61\u9762\u4e34\u4e0b\u4e00\u6b21\u56de\u6536\uff0c\u5b83\u7684finalize\uff08\uff09\u65b9\u6cd5\u4e0d\u4f1a\u88ab\u518d\u6b21\u6267\u884c\uff0c\u56e0\u6b64\u7b2c\u4e8c\u6bb5\u4ee3\u7801\u7684\u81ea\u6551\u884c\u52a8\u5931\u8d25\u4e86\u3002</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#_8","title":"\u56de\u6536\u65b9\u6cd5\u533a","text":"<ul> <li>Java\u865a\u62df\u673a\u89c4\u8303\u4e2d\u53ef\u4ee5\u4e0d\u8981\u6c42\u865a\u62df\u673a\u5728\u65b9\u6cd5\u533a\u5b9e\u73b0\u5783\u573e\u6536\u96c6\uff0c\u800c\u4e14\u5728\u65b9\u6cd5\u533a\u5185\u8fdb\u884c\u5783\u573e\u6536\u96c6\u7684\u201c\u6027\u4ef7\u6bd4\u201d\u4e00\u822c\u6bd4\u8f83\u4f4e\uff1a\u5728\u5806\u4e2d\uff0c\u5c24\u5176\u662f\u5728\u65b0\u751f\u4ee3\u4e2d\uff0c\u5e38\u89c4\u5e94\u7528\u8fdb\u884c\u4e00\u6b21\u5783\u573e\u6536\u96c6\u4e00\u822c\u53ef\u4ee5\u56de\u653670%\uff5e95%\u7684\u7a7a\u95f4\uff0c\u800c\u6c38\u4e45\u4ee3\u7684\u5783\u573e\u6536\u96c6\u6548\u7387\u8fdc\u4f4e\u4e8e\u6b64</li> <li>\u6c38\u4e45\u4ee3\u7684\u5783\u573e\u6536\u96c6\u4e3b\u8981\u56de\u6536\u4e24\u90e8\u5206\u5185\u5bb9\uff1a     -     \u5e9f\u5f03\u5e38\u91cf\uff1a\u4ee5\u5e38\u91cf\u6c60\u4e2d\u5b57\u9762\u91cf\u7684\u56de\u6536\u4e3a\u4f8b\uff0c\u5047\u5982\u4e00\u4e2a\u5b57\u7b26\u4e32\u201cabc\u201d\u5df2\u7ecf\u8fdb\u5165\u4e86\u5e38\u91cf\u6c60\u4e2d\uff0c\u4f46\u662f\u5f53\u524d\u7cfb\u7edf\u6ca1\u6709\u4efb\u4f55\u4e00\u4e2aString\u5bf9\u8c61\u662f\u53eb\u505a\u201cabc\u201d\u7684\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u5c31\u662f\u6ca1\u6709\u4efb\u4f55String\u5bf9\u8c61\u5f15\u7528\u5e38\u91cf\u6c60\u4e2d\u7684\u201cabc\u201d\u5e38\u91cf\uff0c\u4e5f\u6ca1\u6709\u5176\u4ed6\u5730\u65b9\u5f15\u7528\u4e86\u8fd9\u4e2a\u5b57\u9762\u91cf\uff0c\u5982\u679c\u8fd9\u65f6\u53d1\u751f\u5185\u5b58\u56de\u6536\uff0c\u800c\u4e14\u5fc5\u8981\u7684\u8bdd\uff0c\u8fd9\u4e2a\u201cabc\u201d\u5e38\u91cf\u5c31\u4f1a\u88ab\u7cfb\u7edf\u6e05\u7406\u51fa\u5e38\u91cf\u6c60<ul> <li>\u65e0\u7528\u7684\u7c7b\uff1a<ol> <li>\u8be5\u7c7b\u6240\u6709\u7684\u5b9e\u4f8b\u90fd\u5df2\u7ecf\u88ab\u56de\u6536\uff0c\u4e5f\u5c31\u662fJava\u5806\u4e2d\u4e0d\u5b58\u5728\u8be5\u7c7b\u7684\u4efb\u4f55\u5b9e\u4f8b</li> <li>\u52a0\u8f7d\u8be5\u7c7b\u7684ClassLoader\u5df2\u7ecf\u88ab\u56de\u6536</li> <li> </li> </ol> </li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#javalangclass","title":"\u8be5\u7c7b\u5bf9\u5e94\u7684java.lang.Class\u5bf9\u8c61\u6ca1\u6709\u5728\u4efb\u4f55\u5730\u65b9\u88ab\u5f15\u7528\uff0c\u65e0\u6cd5\u5728\u4efb\u4f55\u5730\u65b9\u901a\u8fc7\u53cd\u5c04\u8bbf\u95ee\u8be5\u7c7b\u7684\u65b9\u6cd5","text":"\u865a\u62df\u673a\u53ef\u4ee5\u5bf9\u6ee1\u8db3\u4e0a\u8ff03\u4e2a\u6761\u4ef6\u7684\u65e0\u7528\u7c7b\u8fdb\u884c\u56de\u6536\uff0c\u8fd9\u91cc\u8bf4\u7684\u4ec5\u4ec5\u662f\u201c\u53ef\u4ee5\u201d\uff0c\u800c\u5e76\u4e0d\u662f\u548c\u5bf9\u8c61\u4e00\u6837\uff0c\u4e0d\u4f7f\u7528\u4e86\u5c31\u5fc5\u7136\u4f1a\u56de\u6536\u3002\u662f\u5426\u5bf9\u7c7b\u8fdb\u884c\u56de\u6536\uff0cHotSpot\u865a\u62df\u673a\u63d0\u4f9b\u4e86-Xnoclassgc\u53c2\u6570\u8fdb\u884c\u63a7\u5236\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528-verbose\uff1aclass\u4ee5\u53ca-XX\uff1a+TraceClassLoading\u3001-XX\uff1a+TraceClassUnLoading\u67e5\u770b\u7c7b\u52a0\u8f7d\u548c\u5378\u8f7d\u4fe1\u606f\uff0c\u5176\u4e2d-verbose\uff1aclass\u548c-XX\uff1a+TraceClassLoading\u53ef\u4ee5\u5728Product\u7248\u7684\u865a\u62df\u673a\u4e2d\u4f7f\u7528\uff0c-XX\uff1a+TraceClassUnLoading\u53c2\u6570\u9700\u8981FastDebug\u7248\u7684\u865a\u62df\u673a\u652f\u6301\u3002"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#_9","title":"\u5783\u573e\u6536\u96c6\u7b97\u6cd5","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#-_1","title":"\u6807\u8bb0-\u6e05\u9664\u7b97\u6cd5","text":"<p>\u6700\u57fa\u7840\u7684\u6536\u96c6\u7b97\u6cd5\u662f\u201c\u6807\u8bb0-\u6e05\u9664\u201d\uff08Mark-Sweep\uff09\u7b97\u6cd5\u3002</p> <ul> <li>\u9996\u5148\u6807\u8bb0\u51fa\u6240\u6709\u9700\u8981\u56de\u6536\u7684\u5bf9\u8c61\uff0c\u6807\u8bb0\u5b8c\u6210\u540e\u7edf\u4e00\u56de\u6536\u6240\u6709\u88ab\u6807\u8bb0\u7684\u5bf9\u8c61\u3002<ul> <li>\u6807\u8bb0-\u6e05\u9664\u7b97\u6cd5\u4e3b\u8981\u7531\u4e24\u4e2a\u4e0d\u8db3\uff1a<ul> <li>\u4e00\u4e2a\u662f\u6548\u7387\u95ee\u9898\uff0c\u6807\u8bb0\u548c\u6e05\u9664\u4e24\u4e2a\u8fc7\u7a0b\u7684\u6548\u7387\u90fd\u4e0d\u9ad8\uff1b</li> <li>\u53e6\u4e00\u4e2a\u662f\u7a7a\u95f4\u95ee\u9898\uff0c\u6807\u8bb0\u6e05\u9664\u540e\u4f1a\u4ea7\u751f\u5927\u91cf\u4e0d\u8fde\u7eed\u7684\u5185\u5b58\u788e\u7247\uff0c\u7a7a\u95f4\u788e\u7247\u592a\u591a\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4ee5\u540e\u5728\u7a0b\u5e8f\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u9700\u8981\u5206\u914d\u8f83\u5927\u5bf9\u8c61\u65f6\uff0c\u65e0\u6cd5\u627e\u5230\u8db3\u591f\u7684\u8fde\u7eed\u5185\u5b58\u800c\u4e0d\u5f97\u4e0d\u63d0\u524d\u51fa\u53d1\u4e00\u6b21\u5783\u573e\u6536\u96c6\u7684\u52a8\u4f5c\u3002   </li> </ul> </li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#_10","title":"\u590d\u5236\u7b97\u6cd5","text":"<p>\u4e3a\u4e86\u89e3\u51b3\u6548\u7387\u95ee\u9898\uff0c\u4e00\u79cd\u79f0\u4e3a\u201c\u590d\u5236\u201d\uff08Copying\uff09\u7684\u6536\u96c6\u7b97\u6cd5\u51fa\u73b0\u4e86\uff0c\u5b83\u5c06\u53ef\u7528\u5185\u5b58\u6309\u5bb9\u91cf\u5212\u5206\u4e3a\u5927\u5c0f\u76f8\u7b49\u7684\u4e24\u5757\uff0c\u6bcf\u6b21\u53ea\u4f7f\u7528\u5176\u4e2d\u7684\u4e00\u5757\u3002\u5f53\u8fd9\u4e00\u5757\u7684\u5185\u5b58\u7528\u5b8c\u4e86\uff0c\u5c31\u5c06\u8fd8\u5b58\u6d3b\u7740\u7684\u5bf9\u8c61\u590d\u5236\u5230\u53e6\u5916\u4e00\u5757\u4e0a\u9762\uff0c\u7136\u540e\u518d\u628a\u5df2\u4f7f\u7528\u8fc7\u7684\u5185\u5b58\u7a7a\u95f4\u4e00\u6b21\u6e05\u7406\u6389\u3002\u8fd9\u6837\u4f7f\u5f97\u6bcf\u6b21\u90fd\u662f\u5bf9\u6574\u4e2a\u534a\u533a\u8fdb\u884c\u5185\u5b58\u56de\u6536\uff0c\u5185\u5b58\u5206\u914d\u65f6\u4e5f\u5c31\u4e0d\u7528\u8003\u8651\u5185\u5b58\u788e\u7247\u7b49\u590d\u6742\u60c5\u51b5\uff0c\u53ea\u8981\u79fb\u52a8\u5806\u9876\u6307\u9488\uff0c\u6309\u987a\u5e8f\u5206\u914d\u5185\u5b58\u5373\u53ef\uff0c\u5b9e\u73b0\u7b80\u5355\uff0c\u8fd0\u884c\u9ad8\u6548\u3002\u53ea\u662f\u8fd9\u79cd\u7b97\u6cd5\u7684\u4ee3\u4ef7\u662f\u5c06\u5185\u5b58\u7f29\u5c0f\u4e3a\u4e86\u539f\u6765\u7684\u4e00\u534a\uff0c\u672a\u514d\u592a\u9ad8\u4e86\u4e00\u70b9\u3002 </p> <ul> <li>\u65b0\u751f\u4ee3\u4e2d\u7684\u5bf9\u8c6198%\u662f\u201c\u671d\u751f\u5915\u6b7b\u201d\u7684\uff0c\u6240\u4ee5\u5e76\u4e0d\u9700\u8981\u6309\u71671\uff1a1\u7684\u6bd4\u4f8b\u6765\u5212\u5206\u5185\u5b58\u7a7a\u95f4\uff0c\u800c\u662f\u5c06\u5185\u5b58\u5206\u4e3a\u4e00\u5757\u6bd4\u8f83\u5927\u7684Eden\u7a7a\u95f4\u548c\u4e24\u5757\u8f83\u5c0f\u7684Survivor\u7a7a\u95f4,\u6bcf\u6b21\u4f7f\u7528Eden\u548c\u5176\u4e2d\u4e00\u5757Survivor\u3002\u5f53\u53d1\u751f\u56de\u6536\u65f6\uff0c\u5c06Eden\u548cSurvivor\u4e2d\u8fd8\u5b58\u6d3b\u7740\u7684\u5bf9\u8c61\u4e00\u6b21\u6027\u590d\u5236\u5230\u53e6\u4e00\u5757Survivor\u7a7a\u95f4\u4e0a\uff0c\u6700\u540e\u6e05\u7406\u6389Eden\u548c\u521a\u624d\u7528\u8fc7\u7684Survivor\u7a7a\u95f4\u3002</li> <li>HotSpot\u865a\u62df\u673a\u9ed8\u8ba4Eden\u548cSurvivor\u7684\u5927\u5c0f\u6bd4\u4f8b\u662f8\uff1a1\uff0c\u4e5f\u5c31\u662f\u6bcf\u6b21\u65b0\u751f\u4ee3\u4e2d\u53ef\u7528\u5185\u5b58\u7a7a\u95f4\u4e3a\u6574\u4e2a\u65b0\u751f\u4ee3\u5bb9\u91cf\u768490%\uff0880%+10%\uff09\u3002\u5f53\u7136\uff0c98%\u7684\u5bf9\u8c61\u53ef\u56de\u6536\u53ea\u662f\u4e00\u822c\u573a\u666f\u4e0b\u7684\u6570\u636e\uff0c\u6211\u4eec\u6ca1\u6709\u529e\u6cd5\u4fdd\u8bc1\u6bcf\u6b21\u56de\u6536\u90fd\u53ea\u6709\u4e0d\u591a\u4e8e10%\u7684\u5bf9\u8c61\u5b58\u6d3b\uff0c\u5f53Survivor\u7a7a\u95f4\u4e0d\u591f\u7528\u65f6\uff0c\u9700\u8981\u4f9d\u8d56\u5176\u4ed6\u5185\u5b58\uff08\u8fd9\u91cc\u6307\u8001\u5e74\u4ee3\uff09\u8fdb\u884c\u5206\u914d\u62c5\u4fdd\uff08Handle Promotion\uff09\u3002</li> <li>\u5185\u5b58\u7684\u5206\u914d\u62c5\u4fdd\u5c31\u597d\u6bd4\u6211\u4eec\u53bb\u94f6\u884c\u501f\u6b3e\uff0c\u5982\u679c\u6211\u4eec\u4fe1\u8a89\u5f88\u597d\uff0c\u572898%\u7684\u60c5\u51b5\u4e0b\u90fd\u80fd\u6309\u65f6\u507f\u8fd8\uff0c\u4e8e\u662f\u94f6\u884c\u53ef\u80fd\u4f1a\u9ed8\u8ba4\u6211\u4eec\u4e0b\u4e00\u6b21\u4e5f\u80fd\u6309\u65f6\u6309\u91cf\u5730\u507f\u8fd8\u8d37\u6b3e\uff0c\u53ea\u9700\u8981\u6709\u4e00\u4e2a\u62c5\u4fdd\u4eba\u80fd\u4fdd\u8bc1\u5982\u679c\u6211\u4e0d\u80fd\u8fd8\u6b3e\u65f6\uff0c\u53ef\u4ee5\u4ece\u4ed6\u7684\u8d26\u6237\u6263\u94b1\uff0c\u90a3\u94f6\u884c\u5c31\u8ba4\u4e3a\u6ca1\u6709\u98ce\u9669\u4e86\u3002\u5185\u5b58\u7684\u5206\u914d\u62c5\u4fdd\u4e5f\u4e00\u6837\uff0c\u5982\u679c\u53e6\u5916\u4e00\u5757Survivor\u7a7a\u95f4\u6ca1\u6709\u8db3\u591f\u7a7a\u95f4\u5b58\u653e\u4e0a\u4e00\u6b21\u65b0\u751f\u4ee3\u6536\u96c6\u4e0b\u6765\u7684\u5b58\u6d3b\u5bf9\u8c61\u65f6\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u5c06\u76f4\u63a5\u901a\u8fc7\u5206\u914d\u62c5\u4fdd\u673a\u5236\u8fdb\u5165\u8001\u5e74\u4ee3\u3002</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#-_2","title":"\u6807\u8bb0-\u6574\u7406\u7b97\u6cd5","text":"<ul> <li>\u590d\u5236\u6536\u96c6\u7b97\u6cd5\u5728\u5bf9\u8c61\u5b58\u6d3b\u7387\u8f83\u9ad8\u65f6\u5c31\u8981\u8fdb\u884c\u8f83\u591a\u7684\u590d\u5236\u64cd\u4f5c\uff0c\u6548\u7387\u5c31\u4f1a\u53d8\u4f4e\u3002\u66f4\u5173\u952e\u7684\u662f\uff0c\u5982\u679c\u4e0d\u60f3\u6d6a\u8d3950%\u7684\u7a7a\u95f4\uff0c\u5c31\u9700\u8981\u6709\u989d\u5916\u7684\u7a7a\u95f4\u8fdb\u884c\u5206\u914d\u62c5\u4fdd\uff0c\u4ee5\u5e94\u5bf9\u88ab\u4f7f\u7528\u7684\u5185\u5b58\u4e2d\u6240\u6709\u5bf9\u8c61\u90fd100%\u5b58\u6d3b\u7684\u6781\u7aef\u60c5\u51b5\uff0c\u6240\u4ee5\u5728\u8001\u5e74\u4ee3\u4e00\u822c\u4e0d\u80fd\u76f4\u63a5\u9009\u7528\u8fd9\u79cd\u7b97\u6cd5\u3002</li> <li>\u6839\u636e\u8001\u5e74\u4ee3\u7684\u7279\u70b9\uff0c\u6709\u4eba\u63d0\u51fa\u4e86\u53e6\u5916\u4e00\u79cd\u201c\u6807\u8bb0-\u6574\u7406\u201d\uff08Mark-Compact\uff09\u7b97\u6cd5\uff0c\u6807\u8bb0\u8fc7\u7a0b\u4ecd\u7136\u4e0e\u201c\u6807\u8bb0-\u6e05\u9664\u201d\u7b97\u6cd5\u4e00\u6837\uff0c\u4f46\u540e\u7eed\u6b65\u9aa4\u4e0d\u662f\u76f4\u63a5\u5bf9\u53ef\u56de\u6536\u5bf9\u8c61\u8fdb\u884c\u6e05\u7406\uff0c\u800c\u662f\u8ba9\u6240\u6709\u5b58\u6d3b\u7684\u5bf9\u8c61\u90fd\u5411\u4e00\u7aef\u79fb\u52a8\uff0c\u7136\u540e\u76f4\u63a5\u6e05\u7406\u6389\u7aef\u8fb9\u754c\u4ee5\u5916\u7684\u5185\u5b58\u3002   </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#_11","title":"\u5206\u4ee3\u6536\u96c6\u7b97\u6cd5","text":"<ul> <li>\u5f53\u524d\u5546\u4e1a\u865a\u62df\u673a\u7684\u5783\u573e\u6536\u96c6\u90fd\u91c7\u7528\u2018\u5206\u4ee3\u6536\u96c6\u2019\uff08Generational Collection\uff09\u7b97\u6cd5\u3002</li> <li>\u5206\u4ee3\u6536\u96c6\u7b97\u6cd5\u6839\u636e\u5bf9\u8c61\u5b58\u6d3b\u5468\u671f\u7684\u4e0d\u540c\u5c06\u5185\u5b58\u5212\u5206\u4e3a\u51e0\u5757\u3002</li> <li>\u628aJava\u5806\u5206\u4e3a\u65b0\u751f\u4ee3\u548c\u8001\u5e74\u4ee3<ul> <li>\u65b0\u751f\u4ee3\u4e2d\uff0c\u6bcf\u6b21\u5783\u573e\u6536\u96c6\u65f6\u90fd\u6709\u5927\u6279\u5bf9\u8c61\u6b7b\u53bb\uff0c\u53ea\u6709\u5c11\u91cf\u5b58\u6d3b\uff0c\u90a3\u5c31\u9009\u7528\u590d\u5236\u7b97\u6cd5\uff0c\u53ea\u9700\u8981\u4ed8\u51fa\u5c11\u91cf\u5b58\u6d3b\u5bf9\u8c61\u7684\u590d\u5236\u6210\u672c\u5c31\u53ef\u4ee5\u5b8c\u6210\u6536\u96c6\u3002</li> <li>\u8001\u5e74\u4ee3\u4e2d\uff0c\u56e0\u4e3a\u5bf9\u8c61\u5b58\u6d3b\u7387\u9ad8\u3001\u6ca1\u6709\u989d\u5916\u7a7a\u95f4\u5bf9\u5b83\u8fdb\u884c\u5206\u914d\u62c5\u4fdd\uff0c\u5c31\u5fc5\u987b\u4f7f\u7528\u201c\u6807\u8bb0-\u6e05\u7406\u201d\u6216\u8005\u201c\u6807\u8bb0-\u6574\u7406\u201d\u7b97\u6cd5\u6765\u8fdb\u884c\u56de\u6536\u3002</li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#hotspot","title":"HotSpot\u7684\u7b97\u6cd5\u5b9e\u73b0","text":"<p>\u4e0a\u9762\u4ecb\u7ecd\u4e86\u5bf9\u8c61\u5b58\u6d3b\u5224\u5b9a\u7b97\u6cd5\u548c\u5783\u573e\u6536\u96c6\u7b97\u6cd5\uff0c\u800c\u5728HotSpot\u865a\u62df\u673a\u4e0a\u5b9e\u73b0\u8fd9\u4e9b\u7b97\u6cd5\u65f6\uff0c\u5fc5\u987b\u5bf9\u7b97\u6cd5\u7684\u6267\u884c\u6548\u7387\u6709\u4e25\u683c\u7684\u8003\u91cf\uff0c\u624d\u80fd\u4fdd\u8bc1\u865a\u62df\u673a\u9ad8\u6548\u8fd0\u884c\u3002</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#_12","title":"\u679a\u4e3e\u6839\u8282\u70b9","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#-gc-rootsgc-roots","title":"- \u53ef\u8fbe\u6027\u5206\u6790\u4e2d\u4eceGC Roots\u8282\u70b9\u627e\u5f15\u7528\u94fe\u8fd9\u4e2a\u64cd\u4f5c\u4e3a\u4f8b\uff0c\u53ef\u4ee5\u4f5c\u4e3aGC Roots\u7684\u8282\u70b9\u4e3b\u8981\u5728\u5168\u5c40\u6027\u7684\u5f15\u7528\uff08\u5e38\u91cf\u6216\u9759\u6001\u5c5e\u6027\uff09\u4e0e\u6267\u884c\u4e0a\u4e0b\u6587\uff08\u6808\u5e27\u4e2d\u7684\u672c\u5730\u53d8\u91cf\u8868\uff09\u4e2d\uff0c\u5f88\u591a\u5e94\u7528\u5728\u65b9\u6cd5\u533a\u5c31\u6709\u6570\u767e\u5146\uff0c\u9010\u4e2a\u68c0\u67e5\u8fd9\u4e2a\u91cc\u9762\u7684\u5f15\u7528\uff0c\u4f1a\u6d88\u8017\u5f88\u591a\u65f6\u95f4","text":"<p>\u53ef\u8fbe\u6027\u5206\u6790\u5bf9\u6267\u884c\u65f6\u95f4\u7684\u654f\u611f\u8fd8\u4f53\u73b0\u5728GC\u505c\u987f\u4e0a\uff0c\u56e0\u4e3a\u8fd9\u9879\u5206\u6790\u5de5\u4f5c\u5fc5\u987b\u5728\u4e00\u4e2a\u80fd\u786e\u4fdd\u4e00\u81f4\u6027\u7684\u5feb\u7167\u4e2d\u8fdb\u884c----\u8fd9\u91cc\u201c\u4e00\u81f4\u6027\u201d\u7684\u610f\u601d\u662f\u6307\u5728\u6574\u4e2a\u5206\u6790\u671f\u95f4\u6574\u4e2a\u6267\u884c\u7cfb\u7edf\u770b\u8d77\u6765\u5c31\u50cf\u88ab\u51bb\u7ed3\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\u4e0a\uff0c\u4e0d\u53ef\u4ee5\u51fa\u73b0\u5206\u6790\u8fc7\u7a0b\u4e2d\u5bf9\u8c61\u5f15\u7528\u5173\u7cfb\u8fd8\u5728\u4e0d\u65ad\u53d8\u5316\u7684\u60c5\u51b5\uff0c\u8be5\u70b9\u4e0d\u6ee1\u8db3\u7684\u8bdd\u5206\u6790\u7ed3\u679c\u51c6\u786e\u6027\u5c31\u65e0\u6cd5\u5f97\u5230\u4fdd\u8bc1\u3002\u8fd9\u70b9\u662f\u5bfc\u81f4GC\u8fdb\u884c\u65f6\u5fc5\u987b\u505c\u987f\u6240\u6709Java\u6267\u884c\u7ebf\u7a0b\uff08Sun\u5c06\u8fd9\u4ef6\u4e8b\u60c5\u79f0\u4e3a\u201cStop The World\u201d\uff09\u7684\u5176\u4e2d\u4e00\u4e2a\u91cd\u8981\u539f\u56e0\uff0c\u5373\u4f7f\u662f\u5728\u53f7\u79f0\uff08\u51e0\u4e4e\uff09\u4e0d\u4f1a\u53d1\u751f\u505c\u987f\u7684CMS\u6536\u96c6\u5668\u4e2d\uff0c\u679a\u4e3e\u6839\u8282\u70b9\u65f6\u4e5f\u662f\u5fc5\u987b\u8981\u505c\u987f\u7684\u3002 - \u76ee\u524d\u4e3b\u6d41\u7684Java\u865a\u62df\u673a\u90fd\u662f\u51c6\u786e\u5f0fGC,\u6240\u4ee5\u5f53\u6267\u884c\u7cfb\u7edf\u505c\u987f\u4e0b\u6765\u540e\uff0c\u5e76\u4e0d\u9700\u8981\u4e00\u4e2a\u4e0d\u6f0f\u5730\u68c0\u67e5\u5b8c\u6240\u6709\u6267\u884c\u4e0a\u4e0b\u6587\u548c\u5168\u5c40\u7684\u5f15\u7528\u4f4d\u7f6e\uff0c\u865a\u62df\u673a\u5e94\u5f53\u662f\u6709\u529e\u6cd5\u76f4\u63a5\u5f97\u77e5\u54ea\u4e9b\u5730\u65b9\u5b58\u653e\u7740\u5bf9\u8c61\u5f15\u7528 - HotSpot\u7684\u5b9e\u73b0\u4e2d\uff0c\u662f\u4f7f\u7528\u4e00\u7ec4OopMap\u7684\u6570\u636e\u7ed3\u6784\u6765\u8fbe\u5230\u8fd9\u4e2a\u76ee\u7684\u7684,\u5728\u7c7b\u52a0\u8f7d\u5b8c\u6210\u7684\u65f6\u5019\uff0cHotSpot\u5c31\u628a\u5bf9\u8c61\u5185\u4ec0\u4e48\u504f\u79fb\u91cf\u4e0a\u662f\u4ec0\u4e48\u7c7b\u578b\u7684\u6570\u636e\u8ba1\u7b97\u51fa\u6765\uff0c\u5728JIT\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\uff0c\u4e5f\u4f1a\u5728\u7279\u5b9a\u7684\u4f4d\u7f6e\u8bb0\u5f55\u4e0b\u6808\u548c\u5bc4\u5b58\u5668\u4e2d\u54ea\u4e9b\u4f4d\u7f6e\u662f\u5f15\u7528\u3002\u8fd9\u6837\uff0cGC\u5728\u626b\u63cf\u65f6\u5c31\u53ef\u4ee5\u76f4\u63a5\u5f97\u77e5\u8fd9\u4e9b\u4fe1\u606f\u4e86\u3002</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#safepoint","title":"\u5b89\u5168\u70b9\uff08Safepoint\uff09","text":"<ul> <li>HotSpot\u6ca1\u6709\u4e3a\u6bcf\u6761\u6307\u4ee4\u90fd\u751f\u6210OopMap,\u53ea\u662f\u5728\u7279\u5b9a\u7684\u4f4d\u7f6e\u8bb0\u5f55\u4e86\u8fd9\u4e9b\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4f4d\u7f6e\u79f0\u4e3a\u201c\u5b89\u5168\u70b9\u201d\uff0c\u5373\u7a0b\u5e8f\u6267\u884c\u65f6\u5e76\u975e\u5728\u6240\u6709\u5730\u65b9\u90fd\u80fd\u505c\u987f\u4e0b\u6765\u5f00\u59cbGC\uff0c\u53ea\u6709\u5728\u5230\u8fbe\u5b89\u5168\u70b9\u65f6\u624d\u80fd\u6682\u505c\u3002</li> <li>safepoint\u7684\u9009\u5b9a\u65e2\u4e0d\u80fd\u592a\u5c11\u4ee5\u81f4\u4e8e\u8ba9GC\u7b49\u5f85\u65f6\u95f4\u592a\u957f\uff0c\u4e5f\u4e0d\u80fd\u8fc7\u4e8e\u9891\u7e41\u4ee5\u81f4\u4e8e\u8fc7\u5206\u589e\u5927\u8fd0\u884c\u65f6\u7684\u8d1f\u8377\u3002\u5982\u65b9\u6cd5\u8c03\u7528\u3001\u5faa\u73af\u8df3\u8f6c\u3001\u5f02\u5e38\u8df3\u8f6c\uff0c\u6240\u4ee5\u5177\u6709\u8fd9\u4e9b\u529f\u80fd\u7684\u6307\u4ee4\u624d\u4f1a\u4ea7\u751fSafePoint</li> <li>\u5982\u4f55\u5728GC\u53d1\u751f\u65f6\u8ba9\u6240\u6709\u7ebf\u7a0b\uff08\u8fd9\u91cc\u4e0d\u5305\u62ec\u6267\u884cJNI\u8c03\u7528\u7684\u7ebf\u7a0b\uff09\u90fd\u201c\u8dd1\u201d\u5230\u6700\u8fd1\u7684\u5b89\u5168\u70b9\u4e0a\u518d\u505c\u987f\u4e0b\u6765\u3002<ul> <li>\u62a2\u5148\u5f0f\u4e2d\u65ad\uff08Preemptive   Suspension\uff09\uff0c\u4e0d\u9700\u8981\u7ebf\u7a0b\u7684\u6267\u884c\u4ee3\u7801\u4e3b\u52a8\u53bb\u914d\u5408\uff0cGC\u53d1\u751f\u65f6\uff0c\u9996\u5148\u628a\u6240\u6709\u7684\u7ebf\u7a0b\u5168\u90e8\u4e2d\u65ad\uff0c\u5982\u679c\u53d1\u73b0\u6709\u4e2d\u65ad\u7684\u5730\u65b9\u4e0d\u5728\u5b89\u5168\u70b9\u4e0a\uff0c\u5c31\u6062\u590d\u7ebf\u7a0b\uff0c\u8ba9\u5b83\u201c\u8dd1\u201d\u5230\u5b89\u5168\u70b9\u4e0a\u3002\u73b0\u5728\u51e0\u4e4e\u6ca1\u6709\u865a\u62df\u673a\u5b9e\u73b0\u91c7\u7528\u62a2\u5148\u5f0f\u4e2d\u65ad\u6765\u6682\u505c\u7ebf\u7a0b\u4ece\u800c\u54cd\u5e94GC\u4e8b\u4ef6</li> <li>\u4e3b\u52a8\u5f0f\u4e2d\u65ad\uff08Voluntary   Suspension\uff09\u5f53GC\u9700\u8981\u4e2d\u65ad\u7ebf\u7a0b\u7684\u65f6\u5019\uff0c\u4e0d\u76f4\u63a5\u5bf9\u7ebf\u7a0b\u64cd\u4f5c\uff0c\u4ec5\u4ec5\u7b80\u5355\u5730\u8bbe\u7f6e\u4e00\u4e2a\u6807\u5fd7\uff0c\u5404\u4e2a\u7ebf\u7a0b\u6267\u884c\u65f6\u4e3b\u52a8\u53bb\u8f6e\u8be2\u8fd9\u4e2a\u6807\u5fd7\uff0c\u53d1\u73b0\u4e2d\u65ad\u6807\u5fd7\u4e3a\u771f\u65f6\u5c31\u81ea\u5df1\u4e2d\u65ad\u6302\u8d77\uff0c\u8f6e\u8be2\u6807\u5fd7\u7684\u5730\u65b9\u548c\u5b89\u5168\u70b9\u662f\u91cd\u5408\u7684\uff0c\u53e6\u5916\u518d\u52a0\u4e0a\u521b\u5efa\u5bf9\u8c61\u9700\u8981\u5206\u914d\u5185\u5b58\u7684\u5730\u65b9</li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5/#safe-region","title":"\u5b89\u5168\u533a\u57df\uff08Safe Region\uff09","text":"<ul> <li>Safepoint\u673a\u5236\u4fdd\u8bc1\u4e86\u7a0b\u5e8f\u6267\u884c\u65f6\uff0c\u5728\u4e0d\u592a\u957f\u7684\u65f6\u95f4\u5185\u5c31\u4f1a\u9047\u5230\u53ef\u8fdb\u5165GC\u7684Safepoint\uff0c</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E8%87%AA%E5%8A%A8%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%9C%BA%E5%88%B6/","title":"\u81ea\u52a8\u5185\u5b58\u7ba1\u7406\u673a\u5236","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E8%87%AA%E5%8A%A8%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%9C%BA%E5%88%B6/#java","title":"Java\u5185\u5b58\u533a\u57df\u4e0e\u5185\u5b58\u6ea2\u51fa","text":"<p>Java\u4e0eC++\u4e4b\u95f4\u6709\u4e00\u5835\u7531\u5185\u5b58\u52a8\u6001\u5206\u914d\u548c\u5783\u573e\u6536\u96c6\u6280\u672f\u6240\u56f4\u6210\u7684\u201c\u9ad8\u5899\u201d\uff0c\u5899\u5916\u9762\u7684\u4eba\u60f3 \u8fdb\u53bb\uff0c\u5899\u91cc\u9762\u7684\u4eba\u5374\u60f3\u51fa\u6765</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E8%87%AA%E5%8A%A8%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%9C%BA%E5%88%B6/#_1","title":"\u8fd0\u884c\u65f6\u6570\u636e\u533a","text":"<ul> <li>\u6240\u6709\u7ebf\u7a0b\u5171\u4eab\u7684\u6570\u636e\u533a\uff1a\u65b9\u6cd5\u533a\u3001\u5806</li> <li>\u7ebf\u7a0b\u9694\u79bb\u7684\u6570\u636e\u533a\uff1a\u865a\u62df\u673a\u6808\u3001\u672c\u5730\u65b9\u6cd5\u6808\u3001\u7a0b\u5e8f\u8ba1\u6570\u5668</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E8%87%AA%E5%8A%A8%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%9C%BA%E5%88%B6/#program-counter-register","title":"\u7a0b\u5e8f\u8ba1\u6570\u5668(Program Counter Register)","text":"<ul> <li>\u7ebf\u7a0b\u79c1\u6709</li> <li>\u4e00\u5757\u5185\u5b58\u8f83\u5c0f\u7684\u5185\u5b58\u7a7a\u95f4</li> <li> </li> <li>\u6b64\u5185\u5b58\u533a\u57df\u662f\u552f\u4e00\u4e00\u4e2a\u5728Java\u865a\u62df\u673a\u89c4\u8303\u4e2d\u6ca1\u6709\u89c4\u5b9a\u4efb\u4f55OutOfMemoryError\u60c5\u51b5\u7684\u533a\u57df</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E8%87%AA%E5%8A%A8%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%9C%BA%E5%88%B6/#etc","title":"\u5b57\u8282\u7801\u89e3\u91ca\u5668\u5de5\u4f5c\u65f6\u901a\u8fc7\u6539\u53d8\u8fd9\u4e2a\u8ba1\u6570\u5668\u7684\u503c\u6765\u9009\u53d6\u4e0b\u4e00\u6761\u9700\u8981\u6267\u884c\u7684\u5b57\u8282\u7801\u6307\u4ee4\uff0c\u5206\u652f\u3001\u5faa\u73af\u3001\u8df3\u8f6c\u3001\u5f02\u5e38\u5904\u7406\u3001\u7ebf\u7a0b\u6062\u590detc\u57fa\u7840\u529f\u80fd\u90fd\u9700\u8981\u4f9d\u8d56\u8fd9\u4e2a\u8ba1\u6570\u5668","text":"Java\u865a\u62df\u673a\u7684\u591a\u7ebf\u7a0b\uff1a\u901a\u8fc7\u7ebf\u7a0b\u8f6e\u6d41\u5207\u6362\u5e76\u5206\u914d\u5904\u7406\u5668\u6267\u884c\u65f6\u95f4\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\uff0c\u4efb\u4f55\u4e00\u4e2a\u786e\u5b9a\u65f6\u523b\uff0c\u4e00\u4e2a\u5904\u7406\u5668\u90fd\u53ea\u4f1a\u6267\u884c\u4e00\u6761\u7ebf\u7a0b\u4e2d\u7684\u6307\u4ee4\u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u7ebf\u7a0b\u5207\u6362\u540e\u80fd\u6062\u590d\u5230\u6b63\u786e\u7684\u6267\u884c\u4f4d\u7f6e\uff0c\u6bcf\u6761\u7ebf\u7a0b\u90fd\u9700\u8981\u6709\u4e00\u4e2a\u72ec\u7acb\u7684\u7a0b\u5e8f\u8ba1\u6570\u5668\uff0c\u5404\u6761\u7ebf\u7a0b\u4e4b\u95f4\u8ba1\u6570\u5668\u4e92\u4e0d\u5f71\u54cd\uff0c\u72ec\u7acb\u5b58\u50a8\u3002"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E8%87%AA%E5%8A%A8%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%9C%BA%E5%88%B6/#java_1","title":"Java\u865a\u62df\u673a\u6808","text":"<ul> <li>\u7ebf\u7a0b\u79c1\u6709</li> <li>\u6bcf\u4e2a\u65b9\u6cd5\u5728\u6267\u884c\u7684\u540c\u65f6\u90fd\u4f1a\u521b\u5efa\u4e00\u4e2a\u6808\u5e27\uff08stack frame\uff09\u7528\u4e8e\u5b58\u50a8\u5c40\u90e8\u53d8\u91cf\u8868\uff08\u6808\u5185\u5b58\uff09\u3001\u64cd\u4f5c\u6570\u6808\u3001\u52a8\u6001\u94fe\u63a5\uff0c\u65b9\u6cd5\u51fa\u53e3\u7b49\u4fe1\u606f\u3002</li> <li>\u6bcf\u4e2a\u65b9\u6cd5\u4ece\u8c03\u7528\u76f4\u81f3\u6267\u884c\u5b8c\u6210\u7684\u8fc7\u7a0b\uff0c\u5bf9\u5e94\u7740\u4e00\u4e2a\u6808\u5e27\u5728\u865a\u62df\u673a\u6808\u4e2d\u5165\u6808\u5230\u51fa\u6808\u7684\u8fc7\u7a0b</li> <li>\u5c40\u90e8\u53d8\u91cf\u8868\u5b58\u653e\u4e86\u7f16\u8bd1\u671f\u53ef\u77e5\u7684\u5404\u79cd\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff08boolean\u3001byte\u3001char\u3001short\u3001int\u3001float\u3001long\u3001double\uff09\u3001\u5bf9\u8c61\u5f15\u7528\uff08reference\u7c7b\u578b\uff0c\u53ef\u80fd\u662f\u4e00\u4e2a\u6307\u5411\u5bf9\u8c61\u8d77\u59cb\u5730\u5740\u7684\u6307\u9488\uff0c\u4e5f\u53ef\u80fd\u662f\u6307\u5411\u4e00\u4e2a\u4ee3\u8868\u5bf9\u8c61\u7684\u53e5\u67c4\uff09\u548creturnAddress\u7c7b\u578b\uff08\u6307\u5411\u4e86\u4e00\u6761\u5b57\u8282\u7801\u6307\u4ee4\u7684\u5730\u5740\uff09</li> <li>64\u4f4d\u7684long\u548cdouble\u5360\u75282\u5404\u5c40\u90e8\u53d8\u91cf\u7a7a\u95f4\u3002\u65b9\u6cd5\u8fd0\u884c\u671f\u95f4\u4e0d\u4f1a\u6539\u53d8\u5c40\u90e8\u53d8\u91cf\u8868\u7684\u5927\u5c0f</li> <li>\u8fd9\u4e2a\u533a\u57df\u6709\u4e24\u79cd\u5f02\u5e38\u72b6\u51b5\uff1a\u7ebf\u7a0b\u8bf7\u6c42\u6808\u6df1\u5ea6\u5927\u4e8e\u865a\u62df\u673a\u6240\u5141\u8bb8\u7684\u6df1\u5ea6\uff0c\u629b\u51faStackOverflowError\u5f02\u5e38\uff1b\u5982\u679c\u865a\u62df\u673a\u6808\u53ef\u4ee5\u52a8\u6001\u6269\u5c55\uff0c\u6269\u5c55\u65f6\u65e0\u6cd5\u7533\u8bf7\u5230\u8db3\u591f\u7684\u5185\u5b58\uff0c\u5219\u4f1a\u629b\u51faOutOfMemoryError\u5f02\u5e38</li> <li>\u603b\u7ed3\uff1a\u6808\u5e27\uff1a<ul> <li>\u5c40\u90e8\u53d8\u91cf\u8868<ul> <li>\u5404\u79cd\u57fa\u672c\u6570\u636e\u7c7b\u578b</li> <li>\u5bf9\u8c61\u5f15\u7528</li> <li>returnAddress\u7c7b\u578b</li> </ul> </li> <li>\u64cd\u4f5c\u6570\u6808</li> <li>\u52a8\u6001\u94fe\u63a5</li> <li>\u65b9\u6cd5\u51fa\u53e3etc</li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E8%87%AA%E5%8A%A8%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%9C%BA%E5%88%B6/#native-method-stack","title":"\u672c\u5730\u65b9\u6cd5\u6808\uff08Native Method Stack\uff09","text":"<ul> <li>\u7ebf\u7a0b\u79c1\u6709</li> <li>\u4e0e\u865a\u62df\u673a\u6808\u7684\u533a\u522b\uff1a\u865a\u62df\u673a\u6808\u4e3a\u865a\u62df\u673a\u6267\u884cJava\u65b9\u6cd5\uff08\u4e5f\u5c31\u662f\u5b57\u8282\u7801\uff09\u670d\u52a1\uff0c\u800c\u672c\u5730\u65b9\u6cd5\u6808\u5219\u4e3a\u865a\u62df\u673a\u4f7f\u7528\u5230\u7684Native\u65b9\u6cd5\u670d\u52a1</li> <li>Sun HotSpot\u865a\u62df\u673a\u5c06\u672c\u5730\u65b9\u6cd5\u6808\u4e0e\u865a\u62df\u673a\u6808\u5408\u4e8c\u4e3a\u4e00</li> <li>\u4e0e\u865a\u62df\u673a\u6808\u76f8\u540c\uff0c\u4e5f\u4f1a\u629b\u51fa\u4e24\u79cd\u5f02\u5e38</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E8%87%AA%E5%8A%A8%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%9C%BA%E5%88%B6/#javajava-heap","title":"Java\u5806\uff08Java Heap\uff09","text":"<ul> <li>\u5927\u90e8\u5206\u5e94\u7528\uff0c\u5806\u662fjava\u865a\u62df\u673a\u6240\u7ba1\u7406\u7684\u5185\u5b58\u4e2d\u6700\u5927\u7684\u4e00\u5757\u3002</li> <li>\u88ab\u6240\u6709\u7ebf\u7a0b\u5171\u4eab\u7684\u4e00\u5757\u5185\u5b58\u533a\u57df</li> <li>\u865a\u62df\u673a\u542f\u52a8\u65f6\u521b\u5efa</li> <li>\u5b58\u653e\u5bf9\u8c61\u5b9e\u4f8b\uff0c\u51e0\u4e4e\u6240\u6709\u7684\u5bf9\u8c61\u5b9e\u4f8b\u90fd\u5728\u8fd9\u91cc\u5206\u914d\u5185\u5b58\u3002Java\u865a\u62df\u673a\u89c4\u8303\u4e2d\u63cf\u8ff0\uff1a\u6240\u6709\u7684\u5bf9\u8c61\u5b9e\u4f8b\u4ee5\u53ca\u6570\u7ec4\u90fd\u8981\u5728\u5806\u4e0a\u5206\u914d\uff0c\u4f46\u662f\u968f\u7740JIT\u7f16\u8bd1\u5668\u7684\u53d1\u5c55\u4e0e\u9003\u9038\u5206\u6790\u6280\u672f\u9010\u6e10\u6210\u719f\uff0c\u6808\u4e0a\u5206\u914d\u3001\u6807\u91cf\u66ff\u6362[2]   \u4f18\u5316\u6280\u672f\u5c06\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u5fae\u5999\u7684\u53d8\u5316\u53d1\u751f\uff0c\u6240\u6709\u7684\u5bf9\u8c61\u90fd\u5206\u914d\u5728\u5806\u4e0a\u4e5f\u6e10\u6e10\u53d8\u5f97\u4e0d\u662f\u90a3\u4e48\u201c\u7edd\u5bf9\u201d\u3002</li> <li>\u5783\u573e\u6536\u96c6\u5668\u7ba1\u7406\u7684\u4e3b\u8981\u533a\u57df\uff0c\u4e5f\u88ab\u79f0\u4e3aGC\u5806\uff08Garbage Collected Heap\uff09</li> <li>\u4ece\u5185\u5b58\u56de\u6536\u89d2\u5ea6\u770b\uff0c\u73b0\u5728\u6536\u96c6\u5668\u57fa\u672c\u90fd\u91c7\u7528\u5206\u4ee3\u6536\u96c6\u7b97\u6cd5\uff0c\u6240\u4ee5Java\u5806\u8fd8\u53ef\u4ee5\u7ec6\u5206\uff1a\u65b0\u751f\u4ee3\u3001\u8001\u5e74\u4ee3\uff1b\u518d\u7ec6\u81f4\u7684\u6709Eden\u7a7a\u95f4\u3001From Survivor\u7a7a\u95f4\u3001To Survivor\u7a7a\u95f4\u3002</li> <li>\u4ece\u5185\u5b58\u5206\u914d\u7684\u89d2\u5ea6\u770b\uff0c\u7ebf\u7a0b\u5171\u4eab\u7684\u5806\u4e2d\u80fd\u5212\u5206\u591a\u4e2a\u7ebf\u7a0b\u79c1\u6709\u7684\u5206\u914d\u7f13\u51b2\u533a\uff08Thread Local Allocation Buffer,TLAB\uff09\uff0c\u5212\u5206\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u66f4\u597d\u7684\u56de\u6536\u5185\u5b58\uff0c\u6216\u8005\u66f4\u5feb\u7684\u5206\u914d\u5185\u5b58\u3002</li> <li>\u5806\u53ef\u4ee5\u5904\u4e8e\u7269\u7406\u4e0a\u4e0d\u8fde\u7eed\u7684\u5185\u5b58\u7a7a\u95f4\u4e2d\u3002\u65e2\u53ef\u4ee5\u5b9e\u73b0\u57ce\u56fa\u5b9a\u5927\u5c0f\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u53ef\u6269\u5c55\u7684\uff08\u901a\u8fc7-Xmx\u548c-Xms\u63a7\u5236\uff09\u3002</li> <li>\u5806\u4e2d\u6ca1\u6709\u5185\u5b58\u5b8c\u6210\u5b9e\u4f8b\u5206\u914d\uff0c\u5e76\u4e14\u5806\u4e5f\u65e0\u6cd5\u518d\u6269\u5c55\u65f6\uff0c\u5c06\u4f1a\u629b\u51faOutOfMemoryError\u5f02\u5e38</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E8%87%AA%E5%8A%A8%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%9C%BA%E5%88%B6/#method-area","title":"\u65b9\u6cd5\u533a\uff08Method Area\uff09","text":"<ul> <li>\u6240\u6709\u7ebf\u7a0b\u5171\u4eab\u7684\u4e00\u5757\u533a\u57df</li> <li>\u5b58\u50a8\u88ab\u865a\u62df\u673a\u52a0\u8f7d\u7684\u7c7b\u4fe1\u606f\u3001\u5e38\u91cf\u3001\u9759\u6001b\u53d8\u91cf\u3001\u5373\u65f6\u7f16\u8bd1\u5668\u7f16\u8bd1\u540e\u7684\u4ee3\u7801\u7b49</li> <li>1.7\u7684\u865a\u62df\u673a\u89c4\u8303\u5c06\u65b9\u6cd5\u533a\u63cf\u8ff0\u4e3a\u5806\u7684\u4e00\u4e2a\u903b\u8f91\u90e8\u5206\uff0c\u4f46\u5b83\u5374\u662f\u975e\u5806\uff08non-heap\uff09</li> <li>\u5728hotspot\u865a\u62df\u673a\u4e0a\u5f00\u53d1\u8005\u6765\u8bf4\uff0c\u65b9\u6cd5\u533a\u4e5f\u88ab\u79f0\u4e3a\u6c38\u4e45\u4ee3\uff0c\u4f46\u662f\u4e24\u8005\u5e76\u4e0d\u7b49\u4ef7\uff0c\u662f\u56e0\u4e3ahotspot\u7684\u8bbe\u8ba1\u56e2\u961f\u628aGC\u7684\u5206\u4ee3\u6536\u96c6\u6269\u5c55\u5230\u4e86\u65b9\u6cd5\u533a\u3002\u5176\u4ed6\u865a\u62df\u673a\uff08\u5982BEA JRockit\u3001IBM J9\u7b49\uff09\u4e0d\u5b58\u5728\u6c38\u4e45\u4ee3\u7684\u6982\u5ff5</li> <li>\u65b9\u6cd5\u533a\u7684GC\u56de\u6536\u4e5f\u53ef\u4ee5\u4e0d\u5b9e\u73b0</li> <li>\u65b9\u6cd5\u533a\uff08\u6c38\u4e45\u4ee3\u7684\u6982\u5ff5\u57281.8\u88ab\u53d6\u6d88\uff0c\u5143\u7a7a\u95f4\u6765\u4ee3\u66ff\uff09</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E8%87%AA%E5%8A%A8%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%9C%BA%E5%88%B6/#runtime-constant-pool","title":"\u8fd0\u884c\u65f6\u5e38\u91cf\u6c60\uff08Runtime Constant Pool\uff09","text":"<ul> <li>\u662f\u65b9\u6cd5\u533a\u7684\u4e00\u90e8\u5206</li> <li>\u5b58\u653e\u7f16\u8bd1\u5668\u751f\u6210\u7684\u5404\u79cd\u5b57\u9762\u91cf\u548c\u7b26\u53f7\u5f15\u7528\uff0c\u8fd9\u90e8\u5206\u5185\u5bb9\u5728\u7c7b\u52a0\u8f7d\u540e\u8fdb\u5165\u65b9\u6cd5\u533a\u7684\u8fd0\u884c\u65f6\u5e38\u91cf\u6c60</li> <li>\u8fd0\u884c\u65f6\u5e38\u91cf\u6c60\u76f8\u5bf9\u4e8eclass\u6587\u4ef6\u5e38\u91cf\u6c60\u7684\u4e00\u4e2a\u91cd\u8981\u7279\u5f81\u5c31\u662f\u5177\u5907\u52a8\u6001\u6027\uff0c\u5e38\u91cf\u5e76\u975e\u4e00\u5b9a\u53ea\u6709\u7f16\u8bd1\u671f\u624d\u80fd\u4ea7\u751f\uff0c\u8fd0\u884c\u671f\u95f4\u4e5f\u53ef\u80fd\u5c06\u65b0\u7684\u5e38\u91cf\u653e\u5165\u6c60\u4e2d\uff0c\u6bd4\u5982string\u7684intern()\u65b9\u6cd5</li> <li>\u5e38\u91cf\u6c60\u65e0\u6cd5\u7533\u8bf7\u5230\u5185\u5b58\u7684\u65f6\u5019\u4f1a\u629b\u51faOutOfMemoryError\u5f02\u5e38</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/JVM/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-jdk1.7/%E8%87%AA%E5%8A%A8%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%9C%BA%E5%88%B6/#direct-memory","title":"\u76f4\u63a5\u5185\u5b58\uff08Direct Memory\uff09","text":"<ul> <li>\u4e0d\u662f\u865a\u62df\u673a\u8fd0\u884c\u65f6\u6570\u636e\u533a\u7684\u4e00\u90e8\u5206</li> <li>1.4\u65f6\u5019\u65b0\u52a0\u5165NIO\uff08New   input/output\uff09\u7c7b\uff0c\u5f15\u5165\u57fa\u4e8e\u901a\u9053channel\u4e0e\u7f13\u51b2\u533abuffer\u7684I/O\u65b9\u5f0f\uff0c\u53ef\u4ee5\u4f7f\u7528Native\u51fd\u6570\u5e93\u76f4\u63a5\u5206\u914d\u5806\u5916\u5185\u5b58\uff0c\u7136\u540e\u901a\u8fc7\u4e00\u4e2a\u5b58\u50a8\u5728Java\u5806\u4e2d\u7684DirectByteBuffer\u5bf9\u8c61\u4f5c\u4e3a\u8fd9\u5757\u5185\u5b58\u7684\u5f15\u7528\u8fdb\u884c\u64cd\u4f5c - \u672c\u673a\u76f4\u63a5\u5185\u5b58\u5206\u914d\u4e0d\u4f1a\u53d7\u5230\u5806\u5927\u5c0f\u7684\u9650\u5236\uff0c\u4f46\u662f\u4f1a\u53d7\u5230\u672c\u673a\u5185\u5b58\u5927\u5c0f\u4ee5\u53ca\u5904\u7406\u5668\u5bfb\u5740\u7a7a\u95f4\u7684\u9650\u5236\u3002\u5728\u914d\u7f6e\u865a\u62df\u673a\u53c2\u6570\u65f6\uff0c\u4f1a\u6839\u636e\u5b9e\u9645\u5185\u5b58\u8bbe\u7f6e-Xmx\u7b49\u53c2\u6570\u4fe1\u606f\uff0c\u5f53\u5ffd\u7565\u76f4\u63a5\u5185\u5b58\u65f6\uff0c\u4f7f\u5f97\u5404\u4e2a\u533a\u57df\u603b\u548c\u5927\u4e8e\u7269\u7406\u5185\u5b58\u9650\u5236\uff0c\u5bfc\u81f4\u52a8\u6001\u6269\u5c55\u65f6\u51fa\u73b0OutOfMemoryError\u5f02\u5e38</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/AQS/","title":"AQS","text":"<p>AbstractQueuedSynchronizer:\u62bd\u8c61\u961f\u5217\u540c\u6b65\u5668\uff0c\u5b9a\u4e49\u4e86\u591a\u7ebf\u7a0b\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u7684\u540c\u6b65\u5668\u6846\u67b6</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/AQS/#_1","title":"\u57fa\u7840\u6982\u89c8","text":"<p>\u5305\u540d\uff1ajava.util.concurrent.locks\uff0c\u53ef\u89c1\u5c5e\u4e8ejuc\u591a\u7ebf\u7a0b\u5e76\u53d1\u5305\uff0c\u9501\u4e0b</p> <p>\u7528\u5230AQS\u5b9e\u73b0\u7684\uff1aReentrantLock/Semaphore/CountDownLatch</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/AQS/#_2","title":"\u57fa\u7840\u5c5e\u6027","text":"<p>\u5c5e\u6027\u4ee3\u7801\u5757\uff1a</p> <pre><code>/**\n * Head of the wait queue, lazily initialized.  Except for\n * initialization, it is modified only via method setHead.  Note:\n * If head exists, its waitStatus is guaranteed not to be\n * CANCELLED.\n */\nprivate transient volatile Node head;\n\n/**\n * Tail of the wait queue, lazily initialized.  Modified only via\n * method enq to add new wait node.\n */\nprivate transient volatile Node tail;\n\n/**\n * The synchronization state.\n */\nprivate volatile int state;\n</code></pre> <p>\u5b83\u7ef4\u62a4\u4e86\u4e00\u4e2avolatile int state\uff08\u4ee3\u8868\u5171\u4eab\u8d44\u6e90\uff09\u548c\u4e00\u4e2aFIFO\uff08\u5148\u8fdb\u5148\u51fa\uff09\u7ebf\u7a0b\u7b49\u5f85\u961f\u5217\uff08\u591a\u7ebf\u7a0b\u4e89\u7528\u8d44\u6e90\u88ab\u963b\u585e\u65f6\u4f1a\u8fdb\u5165\u6b64\u961f\u5217\uff09</p> <p>\u5f15\u7528 - \u4eceReentrantLock\u7684\u5b9e\u73b0\u770bAQS\u7684\u539f\u7406\u53ca\u5e94\u7528  - Java\u5e76\u53d1\u4e4bAQS\u8be6\u89e3  - Java\u5e76\u53d1\u7f16\u7a0bAQS\u8be6\u89e3 </p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/CAS%E8%87%AA%E6%97%8B%E9%94%81/","title":"CAS\u81ea\u65cb\u9501","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/CAS%E8%87%AA%E6%97%8B%E9%94%81/#cas","title":"CAS\u81ea\u65cb\u9501","text":"<p>unsafe\u7c7b\u7684compareAndSwap()\u65b9\u6cd5,\u5b9e\u73b0\u6bd4\u8f83\u5e76\u4ea4\u6362</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/CAS%E8%87%AA%E6%97%8B%E9%94%81/#cas_1","title":"CAS\u53ef\u80fd\u9020\u6210\u7684\u95ee\u9898","text":"<ul> <li>\u8fdb\u5165\u6b7b\u5faa\u73af\uff0c\u5bfc\u81f4cpu\u5360\u7528\u8fc7\u9ad8</li> <li>\u5f15\u53d1ABA\u95ee\u9898</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/CAS%E8%87%AA%E6%97%8B%E9%94%81/#_1","title":"\u81ea\u5df1\u5b9e\u73b0\u81ea\u65cb\u9501","text":"<p>\u5c1d\u8bd5\u83b7\u53d6\u9501\u7684\u7ebf\u7a0b\u4e0d\u4f1a\u7acb\u5373\u963b\u585e\uff0c\u800c\u662f\u91c7\u7528\u5faa\u73af\u7684\u65b9\u5f0f\u53bb\u5c1d\u8bd5\u83b7\u53d6\u9501\u3002\u597d\u5904\uff1a\u51cf\u5c11\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\u7684\u6d88\u8017\uff0c\u7f3a\u70b9\uff1a\u4f1a\u8017CPU</p> <pre><code>public class SpinLockDemo {\n\n    /**\n     * \u539f\u5b50\u5f15\u7528\u7ebf\u7a0b\n     */\n    AtomicReference&lt;Thread&gt; atomicReference = new AtomicReference();\n\n    public void myLock() {\n        Thread thread = Thread.currentThread();\n        System.out.println(Thread.currentThread().getName() + \"come in\");\n        while (!atomicReference.compareAndSet(null, thread)) {\n            System.out.println(\"\u5c1d\u8bd5\");\n        }\n    }\n\n    public void myUnlock() {\n        Thread thread = Thread.currentThread();\n        atomicReference.compareAndSet(thread, null);\n        System.out.println(Thread.currentThread().getName() + \"invoked my unlock\");\n    }\n\n    public static void main(String[] args) {\n        SpinLockDemo spinLockDemo = new SpinLockDemo();\n        new Thread(() -&gt; {\n            spinLockDemo.myLock();\n            try {\n                TimeUnit.SECONDS.sleep(5);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            spinLockDemo.myUnlock();\n        }, \"AA\").start();\n        try {\n            TimeUnit.SECONDS.sleep(1);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n\n        new Thread(() -&gt; {\n            spinLockDemo.myLock();\n            try {\n                TimeUnit.SECONDS.sleep(1);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            spinLockDemo.myUnlock();\n        }, \"BB\").start();\n    }\n}\n</code></pre>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/CAS%E8%87%AA%E6%97%8B%E9%94%81/#casaba","title":"CAS\u5f15\u53d1\u7684ABA\u95ee\u9898","text":"<pre><code>/**\n * \u89e3\u51b3ABA\u95ee\u9898\uff08\u539f\u5b50\u5f15\u7528\uff1f\u7248\u672c\u53f7\uff1f\uff09\n */\npublic class ABADemo {\n\n    /**\n     * \u539f\u5b50\u5f15\u7528\n     */\n    static AtomicReference&lt;Integer&gt; atomicReference = new AtomicReference&lt;&gt;(100);\n\n\n    static AtomicStampedReference atomicStampedReference = new AtomicStampedReference(100, 1);\n\n    public static void main(String[] args) {\n        System.out.println(\"=========================\u4ea7\u751fABA\u95ee\u9898===========================\");\n        new Thread(() -&gt; {\n            atomicReference.compareAndSet(100, 101);\n            atomicReference.compareAndSet(101, 100);\n        }, \"t1\").start();\n\n        new Thread(() -&gt; {\n            //\u4fdd\u8bc1t1\u7ebf\u7a0b\u5b8c\u6210\u4e00\u6b21ABA\u64cd\u4f5c\n            try {\n                Thread.sleep(1);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            System.out.println(atomicReference.compareAndSet(100, 2019) + \":\" + atomicReference.get());\n        }, \"t2\").start();\n\n        System.out.println(\"=========================\u89e3\u51b3ABA\u95ee\u9898===========================\");\n\n        new Thread(() -&gt; {\n            int stamp = atomicStampedReference.getStamp();\n            System.out.println(Thread.currentThread().getName() + \"\u521d\u59cb\u7248\u672c\u53f7\" + stamp);\n\n            try {\n                Thread.sleep(1);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n\n            atomicStampedReference.compareAndSet(100, 101, atomicStampedReference.getStamp(), atomicStampedReference.getStamp() + 1);\n            System.out.println(Thread.currentThread().getName() + \"2\u6b21\u7248\u672c\u53f7\" + atomicStampedReference.getStamp());\n\n            atomicStampedReference.compareAndSet(101, 100, atomicStampedReference.getStamp(), atomicStampedReference.getStamp() + 1);\n            System.out.println(Thread.currentThread().getName() + \"3\u6b21\u7248\u672c\u53f7\" + atomicStampedReference.getStamp());\n        }, \"t3\").start();\n\n        new Thread(() -&gt; {\n            //\u7b49\u5f85t3\u62ff\u5230\u76f8\u540c\u7684\u7248\u672c\u53f7\n            int stamp = atomicStampedReference.getStamp();\n            System.out.println(Thread.currentThread().getName() + \"\u521d\u59cb\u7248\u672c\u53f7\" + stamp);\n            try {\n                Thread.sleep(3);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            boolean result = atomicStampedReference.compareAndSet(100, 2019, stamp, stamp + 1);\n            System.out.println(Thread.currentThread().getName() + \":\" + result + \":\" + atomicStampedReference.getStamp());\n            System.out.println(\"\u6700\u65b0\u503c\uff1a\" + atomicStampedReference.getReference());\n        }, \"t4\").start();\n    }\n}\n</code></pre>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/JMM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8BVolatile%E5%85%B3%E9%94%AE%E5%AD%97/","title":"JMM\u5185\u5b58\u6a21\u578bVolatile\u5173\u952e\u5b57","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/JMM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8BVolatile%E5%85%B3%E9%94%AE%E5%AD%97/#_1","title":"\u5e76\u53d1\u7f16\u7a0b","text":"<p>\u5728\u5e76\u53d1\u7f16\u7a0b\u7684\u64cd\u4f5c\u4e2d\uff0c\u7a0b\u5e8f\u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u5c06\u9700\u8981\u8fd0\u7b97\u4fee\u6539\u7684\u6570\u636e\u4ece\u4e3b\u5185\u5b58\u590d\u5236\u4e00\u4efd\u5230\u7ebf\u7a0b\u4e2d\uff0c\u5728\u7ebf\u7a0b\u8ba1\u7b97\u7ed3\u675f\u4f1a\u5c06\u6b64\u6570\u636e\u91cd\u65b0\u5237\u5165\u4e3b\u5185\u5b58\uff0c\u5728\u5e76\u53d1\u4e2d\uff0c\u5c31\u6709\u53ef\u80fd\u9020\u6210\u4e00\u4e9b\u95ee\u9898\uff0c\u6bd4\u5982\uff1a</p> <pre><code>i=i+1;\n</code></pre> <p>\u7ebf\u7a0b\u6267\u884c\u65f6\uff0c\u4f1a\u4ece\u4e3b\u5185\u5b58\u4e2d\u8bfb\u53d6i\u7684\u503c\uff0c\u7136\u540e\u590d\u5236\u4e00\u4efd\u5230\u9ad8\u901f\u7f13\u5b58\u4e2d\uff0c\u7136\u540eCPU\u6307\u4ee4\u8fdb\u884c+1\u64cd\u4f5c\uff0c\u7136\u540e\u5c06\u6570\u636e\u5199\u5165\u5230\u9ad8\u901f\u7f13\u5b58\uff0c\u518d\u5c06\u9ad8\u901f\u7f13\u5b58\u4e2di\u6700\u65b0\u7684\u503c\u5237\u5230\u4e3b\u5185\u5b58\u3002 \u5355\u7ebf\u7a0b\u4e0d\u4f1a\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u4f46\u662f\u591a\u7ebf\u7a0b\u573a\u666f\u4e0b\u5c31\u4f1a\u6709\u95ee\u9898\u4e86\u3002\u5982\uff1a</p> <ul> <li>\uff08\u7f13\u5b58\u4e00\u81f4\u6027\u95ee\u9898\uff09\u5047\u8bbe   \u521d\u59cb\u503c\u4e3a0\uff0c\u90a3\u4e48\u5728\u4e24\u4e2a\u7ebf\u7a0b\u6267\u884c\u5b8c\u6210\u4e4b\u540e\u6211\u4eec\u671f\u671b\u7684\u7ed3\u679c\u5e94\u8be5\u662f2\uff0c\u4f46\u662f\uff0c\u5f53\u591a\u7ebf\u7a0b\u5e76\u53d1\u65f6\uff0c\u7ebf\u7a0bA\u548cb\u62ff\u5230\u521d\u59cb\u503c\u90fd\u4e3a0\uff0cA\u8fdb\u884c+1\u64cd\u4f5c\uff0c\u5199\u56de\u9ad8\u901f\u7f13\u5b58\uff0c\u5199\u56de\u4e3b\u5185\u5b58\uff1b\u6b64\u65f6\u7ebf\u7a0bB\u4e2d\u521d\u59cb\u503c\u4f9d\u7136\u4e3a0\uff0c\u4e5f\u8fdb\u884c+1\u64cd\u4f5c\uff0c\u5199\u56de\u9ad8\u901f\u7f13\u5b58\uff0c\u5199\u56de\u4e3b\u5185\u5b58\uff0c\u8fd9\u662f\u5f97\u5230\u7684\u6700\u7ec8\u7ed3\u679c\u662f1\uff0c\u800c\u4e0d\u662f2</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/JMM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8BVolatile%E5%85%B3%E9%94%AE%E5%AD%97/#_2","title":"\u5e76\u53d1\u7f16\u7a0b\u7684\u4e09\u4e2a\u6982\u5ff5","text":"<p>\u5728\u5e76\u53d1\u7f16\u7a0b\u4e2d\uff0c\u901a\u5e38\u4f1a\u9047\u5230\u4e09\u4e2a\u95ee\u9898\uff1a\u539f\u5b50\u6027\u3001\u53ef\u89c1\u6027\u3001\u6709\u5e8f\u6027</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/JMM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8BVolatile%E5%85%B3%E9%94%AE%E5%AD%97/#_3","title":"\u539f\u5b50\u6027","text":"<p>\u4e00\u4e2a\u64cd\u4f5c\u6216\u8005\u591a\u4e2a\u64cd\u4f5c\uff0c\u8981\u4e48\u5168\u90e8\u6267\u884c\u5e76\u4e14\u6267\u884c\u7684\u8fc7\u7a0b\u4e0d\u4f1a\u88ab\u4efb\u4f55\u56e0\u7d20\u6253\u65ad\uff0c\u8981\u4e48\u90fd\u4e0d\u6267\u884c</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/JMM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8BVolatile%E5%85%B3%E9%94%AE%E5%AD%97/#_4","title":"\u53ef\u89c1\u6027","text":"<p>\u53ef\u89c1\u6027\u662f\u6307\u5f53\u591a\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u540c\u4e00\u4e2a\u53d8\u91cf\u65f6\uff0c\u4e00\u4e2a\u7ebf\u7a0b\u4fee\u6539\u4e86\u8fd9\u4e2a\u53d8\u91cf\u7684\u503c\uff0c\u5176\u4ed6\u7ebf\u7a0b\u80fd\u591f\u7acb\u5373\u770b\u5230\u4fee\u6539\u7684\u503c \u4f8b\u5b50\uff1a</p> <pre><code>//\u7ebf\u7a0b1\u6267\u884c\u7684\u4ee3\u7801\nint i=0;\n        i=10;\n\n//\u7ebf\u7a0b2\u6267\u884c\u7684\u4ee3\u7801\n        j=i;\n</code></pre> <p>\u5047\u8bbe\u6709A.B\u4e24\u4e2a\u7ebf\u7a0b\u5e76\u53d1\u64cd\u4f5c\uff0cA\u64cd\u4f5c\u6267\u884c\u5230i=10\u8fd9\u53e5\u8bdd\u65f6\uff0c\u4f1a\u5c06\u521d\u59cb\u503ci=0\u52a0\u8f7d\u5230\u7ebf\u7a0bA\u7684\u9ad8\u901f\u7f13\u5b58\u4e2d\u53bb\u505a\u4fee\u6539\u8d4b\u503c10\uff0c\u90a3\u4e48\u7ebf\u7a0bA\u7684\u9ad8\u901f\u7f13\u5b58\u4e2d\u7684\u503c\u53d8\u4e3a\u4e8610\uff0c\u4f46\u662f\u5374\u6ca1\u6709\u7acb\u5373\u5199\u56de\u5230\u4e3b\u5185\u5b58\u3002\u8fd9\u65f6\u5019\u7ebf\u7a0bB\u6267\u884cj=i\u64cd\u4f5c\uff0c\u5b83\u4f1a\u5148\u53bb\u4e3b\u5185\u5b58\u8bfb\u53d6\u503c\u52a0\u8f7d\u5230B\u7684\u9ad8\u901f\u7f13\u5b58\u4e2d\uff0c\u8fd9\u65f6\u4e3b\u5185\u5b58\u4e2di\u7684\u503c\u8fd8\u662f0\uff0c\u90a3\u4e48\u5c31\u4f1a\u9020\u6210j\u7684\u503c\u4e3a0\uff0c\u800c\u4e0d\u662f10</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/JMM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8BVolatile%E5%85%B3%E9%94%AE%E5%AD%97/#_5","title":"\u6709\u5e8f\u6027","text":"<p>\u5373\u7a0b\u5e8f\u6267\u884c\u7684\u987a\u5e8f\u6309\u7167\u4ee3\u7801\u7684\u5148\u540e\u987a\u5e8f\u6267\u884c\u3002 JMM\u4f18\u5316\u4f1a\u5728\u7f16\u8bd1\u540e\u7684\u4ee3\u7801\u8fdb\u884c\u6307\u4ee4\u91cd\u6392\u5e8f\uff0c\u6307\u4ee4\u91cd\u6392\u5e8f\u7684\u610f\u4e49\uff1a\u4f7f\u6307\u4ee4\u66f4\u52a0\u7b26\u5408CPU\u7684\u6267\u884c\u7279\u6027\uff0c\u6700\u5927\u9650\u5ea6\u7684\u53d1\u6325\u673a\u5668\u7684\u6027\u80fd\uff0c\u63d0\u9ad8\u7a0b\u5e8f\u7684\u6267\u884c\u6548\u7387\u3002\u5728\u591a\u7ebf\u7a0b\u64cd\u4f5c\u4e0b\uff0c\u6307\u4ee4\u91cd\u6392\u5e8f\u53ef\u80fd\u5bfc\u81f4\u7a0b\u5e8f\u4e0d\u80fd\u4fdd\u8bc1\u6709\u5e8f\u6027\u3002</p> <ul> <li>\u4ec0\u4e48\u53eb\u6307\u4ee4\u91cd\u6392\uff1f\u5904\u7406\u5668\u4e3a\u4e86\u63d0\u9ad8\u7a0b\u5e8f\u8fd0\u884c\u6548\u7387\uff0c\u53ef\u80fd\u4f1a\u5bf9\u8f93\u5165\u4ee3\u7801\u8fdb\u884c\u4f18\u5316\uff0c\u5b83\u4e0d\u4fdd\u8bc1\u7a0b\u5e8f\u4e2d\u5404\u4e2a\u8bed\u53e5\u7684\u6267\u884c\u5148\u540e\u987a\u5e8f\u540c\u4ee3\u7801\u4e2d\u7684\u987a\u5e8f\u4e00\u81f4\uff0c\u4f46\u662f\u5b83\u4f1a\u4fdd\u8bc1\u7a0b\u5e8f\u6700\u7ec8\u6267\u884c\u7ed3\u679c\u548c\u4ee3\u7801\u987a\u5e8f\u6267\u884c\u7684\u7ed3\u679c\u662f\u4e00\u81f4\u7684\u3002\u5904\u7406\u5668\u5728\u8fdb\u884c\u91cd\u6392\u5e8f\u65f6\u662f\u4f1a\u8003\u8651\u6307\u4ee4\u4e4b\u95f4\u7684\u6570\u636e\u4f9d\u8d56\u6027   \u3002</li> <li>\u591a\u7ebf\u7a0b\u6267\u884c\u6307\u4ee4\u91cd\u6392\u5bfc\u81f4\u5f02\u5e38\u7684\u4f8b\u5b50\u5982\u4e0b\uff1a</li> </ul> <pre><code>//\u7ebf\u7a0b1:\ncontext=loadContext();   //\u8bed\u53e51\n        inited=true;             //\u8bed\u53e52\n\n//\u7ebf\u7a0b2:\n        while(!inited){\n        sleep()\n        }\n        doSomethingwithconfig(context);\n</code></pre> <p>\u5982\u4e0a\u6d41\u7a0b\uff0c\u6709\u7ebf\u7a0b1\uff0c2\u5e76\u53d1\u6267\u884c\uff0c\u5728\u7f16\u8bd1\u540e\u53ef\u80fd\u4f1a\u5bf9\u4ee3\u7801\u8fdb\u884c\u6307\u4ee4\u91cd\u6392\uff0c\u56e0\u4e3a\u7ebf\u7a0b1\u5185\u7684\u4e24\u884c\u4ee3\u7801\u5e76\u6ca1\u6709\u6570\u636e\u4f9d\u8d56\u6027\uff0c\u6240\u4ee5\u53ef\u80fd\u5148\u6267\u884c\u8bed\u53e52\uff0c\u8fd9\u65f6\u5019\u7ebf\u7a0b2\u5728\u5224\u65ad\u65f6\uff0c\u8df3\u8fc7\u5faa\u73af\uff0c\u76f4\u63a5\u6267\u884cdoSomethingwithconfig(context) \u65b9\u6cd5\uff0c\u7136\u800c\uff0c\u6b64\u65f6\u7ebf\u7a0b1\u8fd8\u672a\u521d\u59cb\u5316context\uff0c\u6240\u4ee5\u5bfc\u81f4\u7a0b\u5e8f\u51fa\u9519</p> <ul> <li>\u6307\u4ee4\u91cd\u6392\u5e8f\u4e0d\u4f1a\u5f71\u54cd\u5355\u4e2a\u7ebf\u7a0b\u7684\u6267\u884c\uff0c\u4f46\u662f\u4f1a\u5f71\u54cd\u5230\u7ebf\u7a0b\u5e76\u53d1\u6267\u884c\u7684\u6b63\u786e\u6027</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/JMM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8BVolatile%E5%85%B3%E9%94%AE%E5%AD%97/#java","title":"Java\u5185\u5b58\u6a21\u578b","text":"<p>Java\u5185\u5b58\u6a21\u578b\u89c4\u5b9a\u6240\u6709\u7684\u53d8\u91cf\u90fd\u662f\u5b58\u5728\u4e3b\u5b58\u5f53\u4e2d\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u6709\u81ea\u5df1\u7684\u5de5\u4f5c\u5185\u5b58\u3002\u7ebf\u7a0b\u5bf9\u53d8\u91cf\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u5fc5\u987b\u5728\u5de5\u4f5c\u5185\u5b58\u4e2d\u8fdb\u884c\uff0c\u800c\u4e0d\u80fd\u76f4\u63a5\u5bf9\u4e3b\u5b58\u8fdb\u884c\u64cd\u4f5c\u3002\u5e76\u4e14\u6bcf\u4e2a\u7ebf\u7a0b\u4e0d\u80fd\u8bbf\u95ee\u5176\u4ed6\u7ebf\u7a0b\u7684\u5de5\u4f5c\u5185\u5b58\u3002  \u5982\u56fe\uff0c\u5982\u679c\u8981\u4fee\u6539\u4e3b\u5185\u5b58\u768410\u8fd9\u4e2a\u503c\uff0c\u90a3\u4e48T1,T2\u7ebf\u7a0b\u90fd\u4f1a\u5148\u4ece\u4e3b\u5185\u5b58\u4e2d\u5c0610\u8fd9\u4e2a\u503c\u62f7\u8d1d\u56de\u81ea\u5df1\u7684\u5de5\u4f5c\u5185\u5b58\u4e2d\u53bb\uff0c\u4fee\u6539\u5b8c\u4e4b\u540e\u518d\u5237\u65b0\u56de\u4e3b\u5185\u5b58</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/JMM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8BVolatile%E5%85%B3%E9%94%AE%E5%AD%97/#valatile","title":"valatile","text":"<p>\u4e86\u89e3\u4e86java\u7684\u5185\u5b58\u6a21\u578b\uff0c\u90a3\u4e48\u53ef\u4ee5\u6b63\u5f0f\u6765\u770b\u4e00\u4e0bvolatile\u662f\u600e\u4e48\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u7684\u5427</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/JMM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8BVolatile%E5%85%B3%E9%94%AE%E5%AD%97/#volatile","title":"volatile\u5173\u952e\u5b57\u7684\u4e24\u5c42\u8bed\u4e49","text":"<p>\u4e00\u65e6\u4e00\u4e2a\u5171\u4eab\u53d8\u91cf\uff08\u7c7b\u7684\u6210\u5458\u53d8\u91cf\u3001\u9759\u6001\u6210\u5458\u53d8\u91cf\uff09\u88abvolatile\u4fee\u9970\u4e4b\u540e\uff0c\u90a3\u5c31\u5177\u5907\u4e86\u4e24\u5c42\u8bed\u4e49\uff1a</p> <ol> <li>\u4fdd\u8bc1\u4e86\u4e0d\u540c\u7ebf\u7a0b\u5bf9\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u64cd\u4f5c\u65f6\u7684\u53ef\u89c1\u6027</li> <li>\u7981\u6b62\u8fdb\u884c\u6307\u4ee4\u91cd\u6392\u5e8f</li> </ol>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/JMM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8BVolatile%E5%85%B3%E9%94%AE%E5%AD%97/#volatile_1","title":"volatile\u4e0d\u80fd\u4fdd\u8bc1\u539f\u5b50\u6027","text":"<ul> <li>\u539f\u5b50\u6027\u53ef\u4ee5\u4f7f\u7528synchronized\u6765\u4fdd\u8bc1\uff0c\u4f46\u662f\u4f1a\u9020\u6210\u6267\u884c\u6548\u7387\u6162\u7684\u95ee\u9898</li> <li>\u53ef\u4ee5\u4f7f\u7528atomic\u539f\u5b50\u7c7b\u4fdd\u8bc1\uff0catomic\u539f\u5b50\u7c7b\u539f\u7406\u662f\u4f7f\u7528CAS\u81ea\u65cb\u9501\uff08compare and swap\uff09,\u6bd4\u8f83\u5e76\u4ea4\u6362</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Java%E9%94%81/","title":"Java\u9501","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Java%E9%94%81/#_1","title":"\u9501","text":"<p>\u516c\u5e73\u9501/\u975e\u516c\u5e73\u9501/\u53ef\u91cd\u5165\u9501(\u53c8\u540d\u9012\u5f52\u9501)/\u81ea\u65cb\u9501/\u72ec\u5360\u9501\uff08\u5199\u9501\uff09/\u5171\u4eab\u9501\uff08\u8bfb\u9501\uff09/\u4e92\u65a5\u9501</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Java%E9%94%81/#_2","title":"\u516c\u5e73\u9501","text":"<p>\u591a\u4e2a\u7ebf\u7a0b\u6309\u7167\u7533\u8bf7\u9501\u7684\u987a\u5e8f\u6765\u83b7\u53d6\u9501\uff0c\u961f\u5217\u5148\u6765\u540e\u5230</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Java%E9%94%81/#_3","title":"\u975e\u516c\u5e73\u9501","text":"<ul> <li>\u591a\u4e2a\u7ebf\u7a0b\u83b7\u53d6\u9501\u7684\u987a\u5e8f\u5e76\u4e0d\u662f\u6309\u7167\u7533\u8bf7\u9501\u7684\u987a\u5e8f\uff0c\u6709\u53ef\u80fd\u540e\u7533\u8bf7\u7684\u7ebf\u7a0b\u6bd4\u5148\u7533\u8bf7\u7684\u7ebf\u7a0b\u4f18\u5148\u83b7\u53d6\u9501\u3002</li> <li>\u5982\u679c\u5c1d\u8bd5\u5931\u8d25\uff0c\u518d\u91c7\u7528\u7c7b\u4f3c\u516c\u5e73\u9501\u7684\u65b9\u5f0f</li> <li>\u9ad8\u5e76\u53d1\u573a\u666f\uff0c\u6709\u53ef\u80fd\u4f1a\u9020\u6210\u4f18\u5148\u7ea7\u53cd\u8f6c\u6216\u8005\u9965\u997f\u73b0\u8c61</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Java%E9%94%81/#_4","title":"\u53ef\u91cd\u5165\u9501","text":"<p>\u53ef\u91cd\u5165\u9501\u53c8\u88ab\u79f0\u4e3a\u9012\u5f52\u9501</p> <ul> <li>\u540c\u4e00\u7ebf\u7a0b\u5916\u5c42\u51fd\u6570\u83b7\u5f97\u9501\u4e4b\u540e\uff0c\u5185\u5c42\u9012\u5f52\u51fd\u6570\u4ecd\u7136\u80fd\u83b7\u53d6\u8be5\u9501\u7684\u4ee3\u7801\uff0c\u5728\u540c\u4e00\u4e2a\u7ebf\u7a0b\u5728\u5916\u5c42\u65b9\u6cd5\u83b7\u53d6\u9501\u7684\u65f6\u5019\uff0c\u5728\u8fdb\u5165\u5185\u5c42\u65b9\u6cd5\u4f1a\u81ea\u52a8\u83b7\u53d6\u9501\uff08\u5373\uff1a\u7ebf\u7a0b\u53ef\u4ee5\u8fdb\u5165\u4efb\u4f55\u4e00\u4e2a\u5b83\u5df2\u7ecf\u62e5\u6709\u7684\u9501\u6240\u540c\u6b65\u7740\u7684\u4ee3\u7801\u5757\uff09</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Java%E9%94%81/#_5","title":"\u5178\u578b","text":"<p>ReentrantLock/Synchronized\u5178\u578b\u7684\u53ef\u91cd\u5165\u9501</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Java%E9%94%81/#_6","title":"\u4f5c\u7528","text":"<p>\u907f\u514d\u6b7b\u9501</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Java%E9%94%81/#_7","title":"\u4ee3\u7801","text":"<pre><code>public class ReentrantLockTest {\n    public static void main(String[] args) {\n        ReentrantLockTest reentrantLockTest = new ReentrantLockTest();\n        new Thread(() -&gt; {\n            reentrantLockTest.b();\n        }, \"b1\").start();\n\n        Thread thread = new Thread(() -&gt; {\n            reentrantLockTest.a();\n        }, \"a1\");\n        thread.start();\n        try {\n            TimeUnit.SECONDS.sleep(2);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(thread.getState());\n\n\n    }\n\n    synchronized void a() {\n        System.out.println(Thread.currentThread().getName() + \"\u8fdb\u5165A\u65b9\u6cd5\");\n        try {\n            Thread.sleep(5000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        b();\n    }\n\n    synchronized void b() {\n        System.out.println(Thread.currentThread().getName() + \"\u8fdb\u5165B\u65b9\u6cd5\");\n        try {\n            Thread.sleep(10000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(Thread.currentThread().getName() + \"\u9000\u51fab\u65b9\u6cd5\");\n    }\n}\n</code></pre>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Java%E9%94%81/#reentrantlock","title":"ReentrantLock\u53ef\u91cd\u5165\u9501","text":"<ul> <li>\u521d\u59cb\u5316ReentrantLock\u9ed8\u8ba4\u975e\u516c\u5e73\u9501</li> </ul> <pre><code>   /**\n * Creates an instance of {@code ReentrantLock}.\n * This is equivalent to using {@code ReentrantLock(false)}.\n */\npublic ReentrantLock(){\n        sync=new NonfairSync();\n        }\n</code></pre> <ul> <li>\u516c\u5e73\u9501\uff08\u6709\u53c2\u6784\u9020\u65b9\u6cd5\uff0c\u53ef\u4ee5\u6307\u5b9a\u662f\u5426\u4e3a\u516c\u5e73\u9501\uff09:\u591a\u4e2a\u7ebf\u7a0b\u6309\u7167\u7533\u8bf7\u9501\u7684\u987a\u5e8f\u6765\u83b7\u53d6\u9501\uff0c\u961f\u5217\u5148\u6765\u540e\u5230\uff1b\u975e\u516c\u5e73\u9501\uff1a\u62a2\u9501\u7684\u7ebf\u7a0b\u9ed8\u8ba4\u975e\u516c\u5e73</li> </ul> <pre><code>    /**\n * Creates an instance of {@code ReentrantLock} with the\n * given fairness policy.\n *\n * @param fair {@code true} if this lock should use a fair ordering policy\n */\npublic ReentrantLock(boolean fair){\n        sync=fair?new FairSync():new NonfairSync();\n        }\n</code></pre> <p>java\u9664\u4e86\u4f7f\u7528\u5173\u952e\u5b57synchronized\u5916\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528ReentrantLock\u5b9e\u73b0\u72ec\u5360\u9501\u7684\u529f\u80fd\u3002\u800c\u4e14ReentrantLock\u76f8\u6bd4synchronized\u800c\u8a00\u529f\u80fd\u66f4\u52a0\u4e30\u5bcc\uff0c\u4f7f\u7528\u8d77\u6765\u66f4\u4e3a\u7075\u6d3b\uff0c\u4e5f\u66f4\u9002\u5408\u590d\u6742\u7684\u5e76\u53d1\u573a\u666f\u3002\u8fd9\u7bc7\u6587\u7ae0\u4e3b\u8981\u662f\u4ece\u4f7f\u7528\u7684\u89d2\u5ea6\u6765\u5206\u6790\u4e00\u4e0bReentrantLock</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Java%E9%94%81/#_8","title":"\u81ea\u65cb\u9501","text":"<p>\u5c1d\u8bd5\u83b7\u53d6\u9501\u7684\u7ebf\u7a0b\u4e0d\u4f1a\u7acb\u5373\u963b\u585e\uff0c\u800c\u662f\u91c7\u7528\u5faa\u73af\u7684\u65b9\u5f0f\u53bb\u5c1d\u8bd5\u83b7\u53d6\u9501\u3002\u597d\u5904\uff1a\u51cf\u5c11\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\u7684\u6d88\u8017\uff0c\u7f3a\u70b9\uff1a\u4f1a\u8017CPU</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Java%E9%94%81/#_9","title":"\u72ec\u5360\u9501","text":"<p>\u6307\u8be5\u9501\u4e00\u6b21\u53ea\u80fd\u88ab\u4e00\u4e2a\u7ebf\u7a0b\u6301\u6709\uff0c\u5bf9synchronized/reentrantLock\u800c\u8a00\u90fd\u662f\u72ec\u5360\u9501</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Java%E9%94%81/#_10","title":"\u5171\u4eab\u9501","text":"<p>\u53ef\u4ee5\u88ab\u591a\u4e2a\u7ebf\u7a0b\u6240\u6301\u6709</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Java%E9%94%81/#readwritelockdemo","title":"\u8bfb\u5199\u9501ReadWriteLockDemo","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Synchronized%E9%94%81%E8%AF%A6%E8%A7%A3/","title":"Synchronized\u9501\u8be6\u89e3","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Synchronized%E9%94%81%E8%AF%A6%E8%A7%A3/#synchronized","title":"synchronized\u9501","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Synchronized%E9%94%81%E8%AF%A6%E8%A7%A3/#synchronized_1","title":"synchronized\u6ce8\u610f\u70b9","text":"<ul> <li>\u4e00\u628a\u9501\u53ea\u80fd\u540c\u65f6\u88ab\u4e00\u4e2a\u7ebf\u7a0b\u83b7\u53d6\uff0c\u6ca1\u6709\u83b7\u5f97\u9501\u7684\u7ebf\u7a0b\u53ea\u80fd\u7b49\u5f85</li> <li>\u6bcf\u4e2a\u5b9e\u4f8b\u5bf9\u5e94\u81ea\u5df1\u7684\u4e00\u628a\u9501(this)\uff0c\u4e0d\u540c\u5b9e\u4f8b\u4e4b\u95f4\u4e92\u4e0d\u5f71\u54cd</li> <li>synchronized\u4fee\u9970\u7684\u65b9\u6cd5\uff0c\u6b63\u5e38\u6267\u884c\u5b8c\u53ca\u629b\u51fa\u5f02\u5e38\uff0c\u90fd\u4f1a\u91ca\u653e\u9501</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Synchronized%E9%94%81%E8%AF%A6%E8%A7%A3/#_1","title":"\u9501\u7c7b\u578b","text":"<p>\u9501\u81a8\u80c0\u65b9\u5411\uff1a\u65e0\u9501--&gt;\u504f\u5411\u9501--&gt;\u8f7b\u91cf\u7ea7\u9501--&gt;\u91cd\u91cf\u7ea7\u9501(\u8fc7\u7a0b\u4e0d\u53ef\u9006\uff0c\u4f46\u504f\u5411\u9501\u53ef\u88ab\u91cd\u7f6e\u4e3a\u65e0\u9501)</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Synchronized%E9%94%81%E8%AF%A6%E8%A7%A3/#synchronized_2","title":"synchronized\u9501\u5347\u7ea7\u8fc7\u7a0b","text":"<ul> <li>\u65e0\u9501--&gt;\u504f\u5411\u9501<ul> <li>\u7ebf\u7a0b\u8bbf\u95ee\u9501\u5bf9\u8c61\u65f6\uff0c\u4f1a\u5c06\u5f53\u524d\u7ebf\u7a0bid\u5199\u5165\u9501\u5bf9\u8c61\u7684\u5bf9\u8c61\u5934\u5185\uff0c\u5347\u7ea7\u4e3a\u504f\u5411\u9501\uff0c\u4e0d\u4f1a\u4e3b\u52a8\u91ca\u653e\u9501\uff0c\u6b64\u540e\uff0c\u518d\u6709\u7ebf\u7a0b\u83b7\u53d6\u9501\u4f1a\u5224\u65ad\u4e0e\u5bf9\u8c61\u5934   \u5185\u7684\u7ebf\u7a0bid\u662f\u5426\u76f8\u540c\uff0c\u4e00\u6837\u5219\u7ee7\u7eed\u83b7\u5f97\u9501</li> <li>\u5982\u679c\u4e0d\u4e00\u81f4\uff0c\u9700\u8981\u5224\u65ad\u5bf9\u8c61\u5934\u5185\u8bb0\u5f55\u7684\u7ebf\u7a0b\u662f\u5426\u5b58\u6d3b\uff0c\u5982\u679c\u6ca1\u5b58\u6d3b\uff0c\u9501\u5bf9\u8c61\u91cd\u7f6e\u4e3a\u65e0\u9501\u72b6\u6001</li> <li>\u5982\u679c\u5b58\u6d3b\uff0c\u7acb\u5373\u67e5\u627e\u8be5\u7ebf\u7a0b\u7684\u6808\u5e27\u4fe1\u606f\uff0c\u5982\u679c\u8fd8\u662f\u9700\u8981\u6301\u6709\uff0c\u90a3\u4e48\u6682\u505c\u5f53\u524d\u7ebf\u7a0b\uff0c\u64a4\u9500\u504f\u5411\u9501\uff0c\u5347\u7ea7\u4e3a\u8f7b\u91cf\u7ea7\u9501</li> </ul> </li> <li>\u8f7b\u91cf\u7ea7\u9501\u539f\u7406</li> <li>\u5347\u7ea7\u91cd\u91cf\u9501     -     \u5982\u679c\u81ea\u65cb\u7684\u65f6\u95f4\u592a\u957f\u4e5f\u4e0d\u884c\uff0c\u56e0\u4e3a\u81ea\u65cb\u662f\u8981\u8017CPU\u7684\uff0c\u56e0\u6b64\u81ea\u65cb\u7684\u6b21\u6570\u662f\u6709\u9650\u5236\u7684\uff0c\u6bd4\u598210\u6b21\u6216\u8005100\u6b21\uff0c\u5982\u679c\u81ea\u65cb\u6b21\u6570\u8fbe\u5230\u4e86\u7ebf\u7a0b1\u8fd8\u6ca1\u6709\u91ca\u653e\u9501\uff0c\u6216\u8005\u7ebf\u7a0b1\u8fd8\u5728\u6267\u884c\uff0c\u7ebf\u7a0b2\u8fd8\u5728\u81ea\u65cb\u7b49\u5f85\uff0c\u8fd9\u65f6\u53c8\u6709\u4e00\u4e2a\u7ebf\u7a0b3\u8fc7\u6765\u7ade\u4e89\u8fd9\u4e2a\u9501\u5bf9\u8c61\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u8f7b\u91cf\u7ea7\u9501\u5c31\u4f1a\u81a8\u80c0\u4e3a\u91cd\u91cf\u7ea7\u9501\u3002\u91cd\u91cf\u7ea7\u9501\u628a\u9664\u4e86\u62e5\u6709\u9501\u7684\u7ebf\u7a0b\u90fd\u963b\u585e\uff0c\u9632\u6b62CPU\u7a7a\u8f6c</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/Synchronized%E9%94%81%E8%AF%A6%E8%A7%A3/#-1markword1displacedmarkwordcas1","title":"- \u7ebf\u7a0b1\u83b7\u53d6\u8f7b\u91cf\u7ea7\u9501\u65f6\u4f1a\u628a\u9501\u5bf9\u8c61\u7684\u5bf9\u8c61\u5934MarkWord\u590d\u5236\u4e00\u4efd\u5230\u7ebf\u7a0b1\u7684\u6808\u5e27\u4e2d\u521b\u5efa\u7684\u7528\u4e8e\u5b58\u50a8\u9501\u8bb0\u5f55\u7684\u7a7a\u95f4\uff08DisplacedMarkWord\uff09,\u7136\u540e\u4f7f\u7528CAS\u628a\u5bf9\u8c61\u5934\u4e2d\u7684\u5185\u5bb9\u66ff\u6362\u4e3a\u7ebf\u7a0b1\u5b58\u50a8\u7684\u9501\u8bb0\u5f55\u7684\u5730\u5740\uff1b","text":"<p>\u5982\u679c\u5728\u590d\u5236\u5bf9\u8c61\u5934\u7684\u540c\u65f6\uff0c\u7ebf\u7a0b2\u4e5f\u51c6\u5907\u83b7\u53d6\u9501\uff0c\u590d\u5236\u4e86\u5bf9\u8c61\u5934\u5230\u7ebf\u7a0b2\u7684\u9501\u8bb0\u5f55\u7a7a\u95f4\u4e2d\uff0c\u4f46\u662f\u5728\u7ebf\u7a0b2CAS\u7684\u65f6\u5019\uff0c\u53d1\u73b0\u7ebf\u7a0b1\u5df2\u7ecf\u628a\u5bf9\u8c61\u5934\u6362\u4e86\uff0c\u7ebf\u7a0b2\u7684CAS\u5931\u8d25\uff0c\u90a3\u4e48\u7ebf\u7a0b2\u5c31\u5c1d\u8bd5\u4f7f\u7528\u81ea\u65cb\u9501\u6765\u7b49\u5f85\u7ebf\u7a0b1\u91ca\u653e\u9501\u3002\u81ea\u65cb\u9501\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u8ba9\u7ebf\u7a0b2\u5728\u5faa\u73af\u4e2d\u4e0d\u65adCAS</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/ThreadLocal%E8%AF%A6%E8%A7%A3/","title":"ThreadLocal\u8be6\u89e3","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/ThreadLocal%E8%AF%A6%E8%A7%A3/#threadlocal","title":"ThreadLocal","text":"<p>\u6982\u5ff5\uff1a\u7ebf\u7a0b\u5c40\u90e8\u53d8\u91cf\uff0c\u4e00\u4e2aThreadLocal\u5728\u4e00\u4e2a\u7ebf\u7a0b\u4e2d\u662f\u5171\u4eab\u7684\uff0c\u5728\u4e0d\u540c\u7ebf\u7a0b\u4e4b\u95f4\u53c8\u662f\u9694\u79bb\u7684\uff08\u6bcf\u4e2a\u7ebf\u7a0b\u667a\u80fd\u770b\u5230\u81ea\u5df1\u7ebf\u7a0b\u7684\u503c\uff09</p> <ul> <li>\u6e90\u7801\u89e3\u6790\uff1a<ul> <li>set\u65b9\u6cd5\uff1a\u901a\u8fc7Thread.currentThread()\u65b9\u6cd5\u83b7\u53d6\u4e86\u5f53\u524d\u7684\u7ebf\u7a0b\u5f15\u7528\uff0c\u5e76\u4f20\u7ed9\u4e86getMap(Thread)   \u65b9\u6cd5\u83b7\u53d6\u4e00\u4e2aThreadLocalMap\u7684\u5b9e\u4f8b</li> <li>\u6bcf\u4e2aThread\u5bf9\u8c61\u90fd\u6709\u4e00\u4e2aThreadLocalMap\uff0c\u5f53\u521b\u5efa\u4e00\u4e2aThreadLocal\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u5c06\u8be5ThreadLocal\u5bf9\u8c61\u6dfb\u52a0\u5230\u8be5Map\u4e2d\uff0c\u5176\u4e2d\u952e\u5c31\u662fThreadLocal\uff0c\u503c\u53ef\u4ee5\u662f\u4efb\u610f\u7c7b\u578b</li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/ThreadLocal%E8%AF%A6%E8%A7%A3/#threadlocal_1","title":"ThreadLocal\u5185\u5b58\u6cc4\u9732\u95ee\u9898","text":"<ul> <li>\u4e3a\u4ec0\u4e48ThreadLocal\u4f1a\u5bfc\u81f4\u5185\u5b58\u6cc4\u9732</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/ThreadLocal%E8%AF%A6%E8%A7%A3/#_1","title":"\u524d\u63d0\u9700\u8981\u4e86\u89e3","text":"<ul> <li>\u5f3a\u5f15\u7528\uff1a\u5f53JVM\u5185\u5b58\u7a7a\u95f4\u4e0d\u8db3\u65f6\uff0c\u5b81\u613f\u7a0b\u5e8f\u629b\u51faOOM\u4f7f\u7a0b\u5e8f\u5f02\u5e38\u7ec8\u6b62\u4e5f\u4e0d\u613f\u56de\u6536\u5177\u6709\u5f3a\u5f15\u7528\u7684\u5b58\u6d3b\u8005\u7684\u5bf9\u8c61</li> <li>\u5f31\u5f15\u7528\uff1a\u5728GC\u7684\u65f6\u5019\uff0c\u4e0d\u7ba1\u5185\u5b58\u7a7a\u95f4\u8db3\u4e0d\u8db3\u90fd\u4f1a\u56de\u6536\u8fd9\u4e2a\u5bf9\u8c61</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/ThreadLocal%E8%AF%A6%E8%A7%A3/#_2","title":"\u4e3a\u4f55\u4f1a\u5bfc\u81f4\u5185\u5b58\u6cc4\u9732\uff1f","text":"<p>- ThreadLocalMap\u4e2d\u7684key\u4e3aThreadLocal\u7684\u5f31\u5f15\u7528\uff1aThreadLocalMap\u4e2d\u7684Entry\u5bf9\u8c61\u7ee7\u627f\u4e86WeakReference\u5f31\u5f15\u7528\u7c7b\uff0c\u5728Entry\u7684\u6784\u9020\u65b9\u6cd5\u4e2d\uff0c\u4f1a\u4ee5key\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\u5230\u7236\u7c7b\u7684\u6784\u9020\u65b9\u6cd5\u4e2d - key\u4e3a\u5f31\u5f15\u7528\uff0c\u6bcf\u6b21GC\u5219\u4f1a\u56de\u6536\u5bfc\u81f4key\u4e3anull\uff0c\u4f46\u662fvalue\u662f\u5f3a\u5f15\u7528\uff0c\u5783\u573e\u56de\u6536\u4e0d\u5230\u4e5f\u65e0\u6cd5\u8bbf\u95ee\u5230\uff0c\u5219\u4f1a\u5bfc\u81f4OOM\u5185\u5b58\u6ea2\u51fa - \u907f\u514d\uff1f\u4e0d\u4f7f\u7528\u7684\u65f6\u5019\uff0c\u4e3b\u52a8remove()\u79fb\u9664</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/","title":"\u4e00\u90e8\u5206\u5e76\u53d1\u7406\u8bba\u57fa\u7840","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#_1","title":"\u5e76\u53d1\u7406\u8bba\u57fa\u7840","text":"<ul> <li>\u4e3a\u4ec0\u4e48\u8981\u4f7f\u7528\u591a\u7ebf\u7a0b\uff1a\u964d\u4f4e\u5ef6\u8fdf\uff0c\u63d0\u9ad8\u541e\u5410\u91cf</li> <li>\u591a\u7ebf\u7a0b\u5e94\u7528\u573a\u666f\uff1a\u5e76\u53d1\u7f16\u7a0b\u9886\u57df\uff0c\u63d0\u5347\u6027\u80fd\u672c\u8d28\u5c31\u662f\u63d0\u5347\u786c\u4ef6\u4f7f\u7528\u7387\uff0c\u5c31\u662f\u63d0\u5347I/O\u5229\u7528\u7387\u548cCPU\u5229\u7528\u7387</li> <li>\u521b\u5efa\u591a\u5c11\u7ebf\u7a0b\u5408\u9002\uff1a<ul> <li>\u5bf9\u4e8eCPU\u5bc6\u96c6\u578b\u7684\u8ba1\u7b97\u573a\u666f\uff0c\u7ebf\u7a0b\u6570=CPU\u6838\u6570+1\u5c31\u662f\u5408\u9002\u7684</li> <li>\u5bf9\u4e8eI/O\u5bc6\u96c6\u578b\u7684\u8ba1\u7b97\u573a\u666f\uff0c\u6700\u4f73\u7ebf\u7a0b\u6570=CPU\u6838\u6570*(1+I/O\u8017\u65f6/CPU\u8017\u65f6)</li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#bug","title":"\u5e76\u53d1\u7f16\u7a0bbug\u6e90\u5934","text":"<p>\u53ef\u89c1\u6027\u3001\u6709\u5e8f\u6027\u3001\u539f\u5b50\u6027\u95ee\u9898</p> <ul> <li>\u7f13\u5b58\u5bfc\u81f4\u7684\u53ef\u89c1\u6027\u95ee\u9898\uff1a\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u5171\u4eab\u53d8\u91cf\u7684\u4fee\u6539\uff0c\u53e6\u5916\u4e00\u4e2a\u7ebf\u7a0b\u80fd\u591f\u7acb\u523b\u770b\u5230\uff0c\u79f0\u4e3a\u53ef\u89c1\u6027</li> <li>\u7ebf\u7a0b\u5207\u6362\u5e26\u6765\u7684\u539f\u5b50\u6027\u95ee\u9898\uff1a\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u64cd\u4f5c\u5728CPU\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\u4e0d\u88ab\u4e2d\u65ad\u7684\u7279\u6027\u79f0\u4e3a\u539f\u5b50\u6027</li> <li>\u7f16\u8bd1\u4f18\u5316\u5e26\u6765\u7684\u6709\u5e8f\u6027\u95ee\u9898<ul> <li>\u5982\uff1a\u53cc\u7aef\u68c0\u9501\u673a\u5236\u5b9e\u4f8b\u5316\u5355\u4f8bbean\u7684\u65f6\u5019\uff0c\u5728getInstance()   \u65b9\u6cd5\u4e2d\uff0c\u5148\u5224\u65adinstance\u662f\u5426\u4e3a\u7a7a\uff0c\u518d\u52a0\u9501\uff0c\u518d\u5224\u65ad\u4e00\u6b21\u662f\u5426\u4e3a\u7a7a\uff0c\u518d\u53bb\u5b9e\u4f8b\u5316</li> <li>\u6709\u5e8f\u6027\u95ee\u9898\u63cf\u8ff0\uff1a\u5f53\u6709A,B\u4e24\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8bbf\u95ee\uff0c\u540c\u65f6\u5224\u65ad\u5b9e\u4f8b\u4e3a\u7a7a\uff0c\u5176\u4e2d\u4e00\u4e2a\u7ebf\u7a0b\u83b7\u5f97\u9501\uff0c\u8fdb\u5165\u65b9\u6cd5\u5185\u5b9e\u4f8b\u5316\uff1b\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u7b49\u5f85A\u7ebf\u7a0b\u6267\u884c\u5b8c\uff0c\u6267\u884c\u5b8c\u540e\u83b7\u5f97\u9501\u5bf9\u8c61\uff0c\u518d\u6b21\u5224\u65ad\u4e0d\u4e3a\u7a7a\uff0c\u4e0d\u4f1a\u518d\u53bb\u5b9e\u4f8b\u5316<ul> <li>\u6211\u4eec\u4ee5\u4e3a\u7684\u6d41\u7a0b\uff1a<ol> <li>\u5206\u914d\u4e00\u5757\u5185\u5b58M</li> <li>\u5728\u5185\u5b58M\u4e0a\u521d\u59cb\u5316instance</li> <li>\u7136\u540e\u628aM\u7684\u5730\u5740\u8d4b\u503c\u7ed9instance</li> </ol> </li> <li>\u7136\u800cJMM\u5185\u5b58\u4f18\u5316\u540e\u7684\u662f\uff1a<ol> <li>\u5206\u914d\u4e00\u5757\u5185\u5b58M</li> <li>\u628aM\u7684\u5730\u5740\u8d4b\u503c\u7ed9instance</li> <li>\u5728\u5185\u5b58M\u4e0a\u521d\u59cb\u5316instance</li> </ol> </li> <li>\u89e3\u51b3\uff1a\u589e\u52a0volatile\u7981\u6b62\u6307\u4ee4\u91cd\u6392\u5e8f</li> </ul> </li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#java","title":"Java\u5185\u5b58\u6a21\u578b\uff0c\u5982\u4f55\u89e3\u51b3\u53ef\u89c1\u6027\u3001\u6709\u5e8f\u6027","text":"<ul> <li>\u5bfc\u81f4\u53ef\u89c1\u6027\u539f\u56e0\u662f\u7f13\u5b58\u4f18\u5316\uff0c\u5bfc\u81f4\u6709\u5e8f\u6027\u662f\u7f16\u8bd1\u5668\u4f18\u5316\uff0c\u90a3\u6700\u76f4\u63a5\u7684\u89e3\u51b3\u65b9\u6848\u5c31\u662f\u7981\u7528\u7f13\u5b58\u4f18\u5316\uff0c\u7981\u7528\u7f16\u8bd1\u5668\u4f18\u5316\uff1b\u4f46\u662f\uff0c\u4f1a\u6709\u6027\u80fd\u95ee\u9898</li> <li>\u6309\u9700\u7981\u7528\u7f13\u5b58\u4f18\u5316\u7f16\u8bd1\u5668\u4f18\u5316</li> <li>Java\u5185\u5b58\u6a21\u578b\u89c4\u8303\u4e86JVM\u5982\u4f55\u63d0\u4f9b\u6309\u9700\u7981\u7528\u7f13\u5b58\u4ee5\u53ca\u7f16\u8bd1\u4f18\u5316\u7684\u65b9\u6cd5<ul> <li>volatile</li> <li>synchronized</li> <li>final</li> <li>\u516d\u9879Happens-before\u89c4\u5219\uff1a\u524d\u9762\u4e00\u4e2a\u64cd\u4f5c\u7684\u7ed3\u679c\u5bf9\u540e\u7eed\u662f\u53ef\u89c1\u7684<ol> <li>\u5bf9\u4e00\u4e2avolatile\u53d8\u91cf\u7684\u5199\u64cd\u4f5c\u76f8\u5bf9\u4e8e\u540e\u7eed\u5bf9\u8fd9\u4e2avolatile\u53d8\u91cf\u7684\u8bfb\u64cd\u4f5c\u53ef\u89c1</li> <li>\u4f20\u9012\u6027\uff1a\u5982\u679cA happens-before B\uff0cB happens-before C,\u90a3\u4e48A happens-before C</li> <li>\u7ba1\u7a0b\u4e2d\u9501\u7684\u89c4\u5219\uff1a\u5bf9\u4e00\u4e2a\u9501\u7684\u89e3\u9501Happens-before\u4e8e\u540e\u7eed\u5bf9\u8fd9\u4e2a\u9501\u7684\u52a0\u9501\uff08\u7ba1\u7a0b\uff1a\u901a\u7528\u7684\u540c\u6b65\u539f\u8bed\uff0cJava\u4e2dsynchronized\u662f\u5bf9\u7ba1\u7a0b\u7684\u5b9e\u73b0\uff09</li> </ol> </li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#_2","title":"\u539f\u5b50\u6027\u95ee\u9898\u89e3\u51b3\uff0c\u4e92\u65a5\u9501","text":"<p>\u4e92\u65a5\uff1a\u540c\u4e00\u4e2a\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u6267\u884c</p> <ul> <li>synchronized\u5173\u952e\u5b57\uff1a\u4fee\u9970\u9759\u6001\u65b9\u6cd5\uff0c\u9501\u4f4f\u7684\u662f\u5f53\u524dClass\u5bf9\u8c61\uff1b\u4fee\u9970\u975e\u9759\u6001\u65b9\u6cd5\uff0c\u9501\u5b9a\u7684\u662f\u5f53\u524d\u5b9e\u4f8b\u5bf9\u8c61this</li> <li>\u53ef\u4ee5\u4f7f\u7528\u4e00\u628a\u9501\u4fdd\u62a4\u591a\u4e2a\u8d44\u6e90\uff0c\u4f46\u662f\u4e0d\u53ef\u4ee5\u4f7f\u7528\u591a\u628a\u9501\u4fdd\u62a4\u540c\u4e00\u4e2a\u8d44\u6e90</li> <li>\u4fdd\u62a4\u6ca1\u6709\u5173\u8054\u5173\u7cfb\u7684\u591a\u4e2a\u8d44\u6e90<ul> <li>\u5982\u7535\u5f71\u7968\u548c\u7403\u573a\u95e8\u7968</li> <li>\u7528\u540c\u4e00\u628a\u9501\u4fdd\u62a4\u591a\u4e2a\u8d44\u6e90\u4f1a\u7f16\u7a0b\u591a\u4e2a\u8d44\u6e90\u4e32\u884c\u5316</li> <li>\u4f18\u5316\uff1a\u7ec6\u7c92\u5ea6\u9501\uff0c\u7528\u4e0d\u540c\u7684\u9501\u4fdd\u62a4\u8d44\u6e90\u8fdb\u884c\u7cbe\u7ec6\u5316\u7ba1\u7406\uff0c\u4ee5\u4f18\u5316\u6027\u80fd</li> </ul> </li> <li>\u4fdd\u62a4\u6709\u5173\u8054\u5173\u7cfb\u7684\u591a\u4e2a\u8d44\u6e90\uff1a\u9009\u62e9\u7c92\u5ea6\u66f4\u5927\u7684\u9501\uff0c\u8fd9\u4e2a\u9501\u80fd\u8986\u76d6\u6240\u6709\u76f8\u5173\u7684\u8d44\u6e90</li> <li>\u539f\u5b50\u6027\u672c\u8d28\uff1a\u591a\u4e2a\u8d44\u6e90\u95f4\u6709\u4e00\u81f4\u6027\u7684\u8981\u6c42\uff0c\u64cd\u4f5c\u7684\u4e2d\u95f4\u72b6\u6001\u5bf9\u5916\u4e0d\u53ef\u89c1</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#_3","title":"\u6b7b\u9501\uff0c\u600e\u4e48\u529e","text":"<p>\u7ec6\u7c92\u5ea6\u9501\u867d\u7136\u53ef\u4ee5\u4f18\u5316\u6027\u80fd\uff0c\u4f46\u662f\u4ee3\u4ef7\u5c31\u662f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6b7b\u9501\u3002\u4e00\u7ec4\u4e92\u76f8\u7ade\u4e89\u8d44\u6e90\u7684\u7ebf\u7a0b\u56e0\u4e92\u76f8\u7b49\u5f85\uff0c\u5bfc\u81f4\"\u6c38\u4e45\"\u963b\u585e\u7684\u73b0\u8c61</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#_4","title":"\u6b7b\u9501\u53d1\u751f\u6761\u4ef6","text":"<ol> <li>\u4e92\u65a5\uff0c\u5171\u4eab\u8d44\u6e90x\u548cy\u53ea\u80fd\u88ab\u4e00\u4e2a\u7ebf\u7a0b\u5360\u7528</li> <li>\u5360\u6709\u4e14\u7b49\u5f85\uff0c\u7ebf\u7a0bT1\u5df2\u7ecf\u53d6\u5f97\u5171\u4eab\u8d44\u6e90x\uff0c\u5728\u7b49\u5f85\u5171\u4eab\u8d44\u6e90y\u7684\u65f6\u5019\uff0c\u4e0d\u91ca\u653e\u5171\u4eab\u8d44\u6e90x\u3002<ul> <li>\u7834\u574f\uff1a\u4e00\u6b21\u6027\u7533\u8bf7\u6240\u6709\u8d44\u6e90\uff0c\u5c31\u4e0d\u5b58\u5728\u7b49\u5f85\u4e86\uff0c\u5982\u589e\u52a0\u7ba1\u7406\u5458</li> </ul> </li> <li>\u4e0d\u53ef\u62a2\u5360\uff1a\u5176\u4ed6\u7ebf\u7a0b\u4e0d\u80fd\u5f3a\u884c\u62a2\u5360\u7ebf\u7a0bT1\u5360\u6709\u7684\u8d44\u6e90\u3002<ul> <li>\u7834\u574f\uff1a\u80fd\u591f\u4e3b\u52a8\u91ca\u653e\u5b83\u5360\u6709\u7684\u8d44\u6e90\uff0csynchronized\u505a\u4e0d\u5230\uff0c\u56e0\u4e3a\u5982\u679c\u7533\u8bf7\u4e0d\u5230\u4f1a\u963b\u585e\uff0c\u53ef\u4ee5\u4f7f\u7528juc\u4e0b\u7684Lock</li> </ul> </li> <li>\u5faa\u73af\u7b49\u5f85\uff1a\u7ebf\u7a0bT1\u7b49\u5f85\u7ebf\u7a0bT2\u5360\u6709\u7684\u8d44\u6e90\uff0c\u7ebf\u7a0bT2\u5728\u7b49\u5f85\u7ebf\u7a0bT1\u5360\u6709\u7684\u8d44\u6e90\uff0c\u5c31\u662f\u5faa\u73af\u7b49\u5f85<ul> <li>\u7834\u574f\uff1a\u9700\u8981\u5bf9\u8d44\u6e90\u8fdb\u884c\u6392\u5e8f\uff0c\u7136\u540e\u6309\u987a\u5e8f\u7533\u8bf7\u8d44\u6e90</li> </ul> </li> </ol>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#-","title":"\u7528\u7b49\u5f85-\u901a\u77e5\u673a\u5236\u4f18\u5316\u5faa\u73af\u7b49\u5f85(\u7ebf\u7a0b\u95f4\u534f\u4f5c\u65b9\u5f0f)","text":"<p>\u7b49\u5f85-\u901a\u77e5\u673a\u5236\uff1a\u7ebf\u7a0b\u9996\u5148\u83b7\u53d6\u4e92\u65a5\u9501\uff0c\u5f53\u7ebf\u7a0b\u8981\u6c42\u7684\u6761\u4ef6\u4e0d\u6ee1\u8db3\u65f6\uff0c\u5c31\u91ca\u653e\u4e92\u65a5\u9501\uff0c\u8fdb\u5165\u7b49\u5f85\u72b6\u6001\uff1b\u5f53\u8981\u6c42\u7684\u6761\u4ef6\u6ee1\u8db3\u65f6\uff0c\u901a\u77e5\u7b49\u5f85\u7684\u7ebf\u7a0b\uff0c\u91cd\u65b0\u83b7\u53d6\u4e92\u65a5\u9501</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#synchronizedwaitnotifynotifyall","title":"\u7528synchronized\u5b9e\u73b0\u7b49\u5f85\u901a\u77e5\u673a\u5236\uff1await()\u3001notify()\u3001notifyAll()","text":"<p> \u5c3d\u91cf\u4f7f\u7528notifyAll()\u800c\u4e0d\u662fnotify()\uff0c\u56e0\u4e3anotify()\u662f\u968f\u673a\u901a\u77e5\u7b49\u5f85\u961f\u5217\u4e2d\u7684\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u800cnotifyAll()\u662f\u901a\u77e5\u7b49\u5f85\u961f\u5217\u4e2d\u7684\u6240\u6709\u7ebf\u7a0b\u3002(notify()\u98ce\u9669\u5728\u4e8e\u7b49\u5f85\u961f\u5217\u4e2d\u7684\u67d0\u4e2a\u7ebf\u7a0b\u53ef\u80fd\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u901a\u77e5\u5230)</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#waitsleep","title":"wait()\u65b9\u6cd5\u548csleep()\u533a\u522b","text":"<ul> <li>wait()\u65b9\u6cd5\u4f1a\u91ca\u653e\"\u9501\u6807\u8bc6\"\uff0c\u5728synchronized\u4ee3\u7801\u5757\u5185\u522b\u7684\u7ebf\u7a0b\u53ef\u4ee5\u8bbf\u95ee\u5230\u5171\u4eab\u8d44\u6e90</li> <li>sleep()\u65b9\u6cd5\u9700\u8981\u6307\u5b9a\u7b49\u5f85\u4e8b\u4ef6\uff0c\u5b83\u53ef\u4ee5\u8ba9\u5f53\u524d\u6b63\u5728\u6267\u884c\u7684\u7ebf\u7a0b\u5728\u6307\u5b9a\u7684\u65f6\u95f4\u5185\u6682\u505c\u6267\u884c\uff0c\u8fdb\u5165\u963b\u585e\u72b6\u6001\uff0c\u4e0d\u4f1a\u91ca\u653e\"\u9501\u6807\u8bc6\"\uff0c\u8be5\u65b9\u6cd5\u53ef\u4ee5\u8ba9\u5176\u4ed6\u540c\u4f18\u5148\u7ea7\u6216\u8005\u9ad8\u4f18\u5148\u7ea7\u7684\u7ebf\u7a0b\u5f97\u5230\u6267\u884c\u7684\u673a\u4f1a</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#_5","title":"\u5b89\u5168\u6027\u3001\u6d3b\u8dc3\u6027\u4ee5\u53ca\u6027\u80fd\u95ee\u9898","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#_6","title":"\u5b89\u5168\u6027\u95ee\u9898","text":"<ol> <li>\u672c\u8d28\uff1a\u6b63\u786e\u6027\uff0c\u7a0b\u5e8f\u6309\u7167\u6211\u4eec\u7684\u671f\u671b\u6267\u884c\uff0c\u7ebf\u7a0b\u5b89\u5168</li> <li> <p>\u5982\u4f55\u89e3\u51b3\uff1f</p> </li> <li> <p>\u907f\u514d\u539f\u5b50\u6027\u95ee\u9898\uff0c\u53ef\u89c1\u6027\u95ee\u9898\uff0c\u6709\u5e8f\u6027\u95ee\u9898</p> </li> <li> <p>\u4e92\u65a5</p> </li> <li> <p>\u4ec0\u4e48\u60c5\u51b5\u4e0b\u624d\u9700\u8981\u8003\u8651\uff1f</p> </li> <li> <p>\u5b58\u5728\u5171\u4eab\u6570\u636e\u5e76\u4e14\u6570\u636e\u4f1a\u53d1\u751f\u53d8\u5316\uff0c\u901a\u4fd7\u8bb2\u5c31\u662f\u591a\u4e2a\u7ebf\u7a0b\u4f1a\u540c\u65f6\u8bfb\u5199\u540c\u4e00\u6570\u636e</p> </li> </ol>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#_7","title":"\u6d3b\u8dc3\u6027\u95ee\u9898","text":"<p>\u64cd\u4f5c\u65e0\u6cd5\u6267\u884c\u4e0b\u53bb\uff0c\u5982\u6b7b\u9501\u3001\u6d3b\u9501\u3001\u9965\u997f</p> <ul> <li>\u6b7b\u9501\uff1a\u7ebf\u7a0b\u4e92\u76f8\u7b49\u5f85\uff0c\u4e00\u76f4\u7b49\u4e0b\u53bb\uff0c\u5c31\u6c38\u4e45\u963b\u585e\u4e86</li> <li>\u6d3b\u9501\uff1a\u4e24\u4eba\u4e92\u76f8\u8c26\u8ba9\uff0c\u5148\u8d70\uff0ca\u4ee5\u4e3ab\u4e0d\u8d70\u521a\u51c6\u5907\u8d70\uff0cb\u4e5f\u4ee5\u4e3aa\u4e0d\u8d70\u521a\u51c6\u5907\u8d70\uff0c\u5c31\u53c8\u4f1a\u76f8\u649e<ul> <li>\u89e3\u51b3\uff1a\u6bcf\u4e2a\u4eba\u589e\u52a0\u4e00\u4e2a\u968f\u673a\u7b49\u5f85\u65f6\u95f4\uff0c\u76f8\u5f53\u4e8e\u6bcf\u4e2a\u7ebf\u7a0b\u7b49\u5f85\u65f6\u95f4\u4e0d\u540c\uff0c\u76f8\u649e\u7684\u6982\u7387\u5c31\u4f1a\u964d\u4f4e\u3002Raft\u77e5\u540d\u7684\u5206\u5e03\u5f0f\u4e00\u81f4\u6027\u7b97\u6cd5</li> </ul> </li> <li>\u9965\u997f\uff1a\u67d0\u7ebf\u7a0b\u56e0\u65e0\u6cd5\u8bbf\u95ee\u6240\u9700\u8d44\u6e90\u800c\u65e0\u6cd5\u6267\u884c\u4e0b\u53bb\uff0c\u7ebf\u7a0b\u4f18\u5148\u7ea7\u4e0d\u5747\uff0c\u5219\u6709\u53ef\u80fd\u67d0\u4e2a\u7ebf\u7a0b\u4e00\u76f4\u65e0\u6cd5\u83b7\u5f97\u8c03\u5ea6\uff1b\u6301\u6709\u9501\u7684\u7ebf\u7a0b\uff0c\u5982\u679c\u6267\u884c\u65f6\u95f4\u8f83\u957f\uff0c\u4e5f\u6709\u53ef\u80fd\u5bfc\u81f4\u9965\u997f<ul> <li>\u89e3\u51b3\uff1a\u5524\u9192\u7ebf\u7a0b\u91c7\u53d6\u7c7b\u4f3cnotifyAll()\u7684\u65b9\u5f0f</li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#_8","title":"\u6027\u80fd\u95ee\u9898","text":"<p>\u8fc7\u5ea6\u4f7f\u7528\u9501\uff0c\u5bfc\u81f4\u4e32\u884c\u5316\u8303\u56f4\u8fc7\u5927</p> <ul> <li>\u65b9\u6848\u5c42\u89e3\u51b3<ul> <li>\u4f7f\u7528\u65e0\u9501\u7684\u7b97\u6cd5\u6216\u8005\u6570\u636e\u7ed3\u6784<ul> <li>\u5982\u7ebf\u7a0b\u672c\u5730\u5b58\u50a8ThreadLocal</li> <li>\u5199\u65f6\u590d\u5236copy-on-write</li> <li>\u4e50\u89c2\u9501</li> <li>Java\u5e76\u53d1\u5305\u5185\u7684\u539f\u5b50\u7c7b\u4e5f\u662f\u65e0\u9501\u7684\u6570\u636e\u7ed3\u6784</li> </ul> </li> <li>\u51cf\u5c11\u9501\u6301\u6709\u7684\u65f6\u95f4<ul> <li>\u4e92\u65a5\u9501\u672c\u8d28\u5c06\u5e76\u884c\u7684\u7a0b\u5e8f\u4e32\u884c\u5316\uff0c\u6240\u4ee5\u589e\u52a0\u5e76\u884c\u7684\u89e3\u51b3\u65b9\u6848\u5373\u662f\u51cf\u5c11\u6301\u6709\u9501\u7684\u65f6\u95f4</li> <li>\u7ec6\u7c92\u5ea6\u9501</li> <li>java\u5e76\u53d1\u5305\u5185\u7684ConcurrentHashMap\uff0c\u5206\u6bb5\u9501\u6280\u672f</li> <li>\u8bfb\u5199\u9501\uff0c\u8bfb\u65e0\u9501\uff0c\u5199\u4e92\u65a5</li> </ul> </li> </ul> </li> <li>\u6307\u6807<ul> <li>\u541e\u5410\u91cf\uff1a\u5355\u4f4d\u65f6\u95f4\u5185\u80fd\u5904\u7406\u7684\u8bf7\u6c42\u6570\u91cf\u3002\u541e\u5410\u91cf\u8d8a\u9ad8\u3001\u6027\u80fd\u8d8a\u597d</li> <li>\u5ef6\u8fdf\uff1a\u53d1\u51fa\u8bf7\u6c42\u6536\u5230\u54cd\u5e94\u7684\u65f6\u95f4\u3002\u5ef6\u8fdf\u8d8a\u5c0f\u3001\u6027\u80fd\u8d8a\u597d</li> <li>\u5e76\u53d1\u91cf\uff1a\u80fd\u540c\u65f6\u5904\u7406\u7684\u8bf7\u6c42\u6570\u91cf\uff0c\u5e76\u53d1\u91cf\u589e\u52a0\uff0c\u5ef6\u8fdf\u4e5f\u4f1a\u589e\u52a0</li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#_9","title":"\u7ba1\u7a0b\uff0c\u5e76\u53d1\u7f16\u7a0b\u7684\u4e07\u80fd\u94a5\u5319","text":"<p>\u7ba1\u7a0b\u548c\u4fe1\u53f7\u91cf\u662f\u7b49\u4ef7\u7684\uff0c\u7528\u7ba1\u7a0b\u80fd\u5b9e\u73b0\u4fe1\u53f7\u91cf\uff0c\u80fd\u7528\u4fe1\u53f7\u91cf\u5b9e\u73b0\u7ba1\u7a0b\uff0c\u7ba1\u7a0b\u5c31\u662f\u7ba1\u7406\u5171\u4eab\u53d8\u91cf\u4ee5\u53ca\u5bf9\u5171\u4eab\u53d8\u91cf\u7684\u64cd\u4f5c\u8fc7\u7a0b\uff0c\u8ba9\u4ed6\u4eec\u652f\u6301\u5e76\u53d1</p> <ul> <li>MESA\u6a21\u578b\u89e3\u51b3\u4e92\u65a5\u95ee\u9898\uff1a\u5c06\u5171\u4eab\u53d8\u91cf\u53ca\u5bf9\u5171\u4eab\u53d8\u91cf\u7684\u64cd\u4f5c\u7edf\u4e00\u5c01\u88c5\u8d77\u6765</li> <li>MESA\u6a21\u578b\u89e3\u51b3\u540c\u6b65\u95ee\u9898   </li> <li>\u7ba1\u7a0b\u5c31\u662f\u4e00\u4e2a\u5bf9\u8c61\u76d1\u89c6\u5668\uff0c\u4efb\u4f55\u7ebf\u7a0b\u60f3\u8981\u8bbf\u95ee\u8be5\u8d44\u6e90\uff0c\u90fd\u9700\u8981\u5148\u8fdb\u5165\u76d1\u63a7\u8303\u56f4\u3002\u8fdb\u5165\u4e4b\u540e\uff0c\u63a5\u53d7\u68c0\u67e5\uff0c\u4e0d\u7b26\u5408\u6761\u4ef6\uff0c\u7ee7\u7eed\u7b49\u5f85\uff0c\u76f4\u5230\u88ab\u901a\u77e5\uff0c\u7136\u540e\u7ee7\u7eed\u8fdb\u5165\u76d1\u89c6\u5668</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#java_1","title":"Java\u7ebf\u7a0b\u7684\u751f\u547d\u5468\u671f","text":"<p>\u4e94\u6001\u6a21\u578b/\u516d\u79cd\u72b6\u6001</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#_10","title":"\u901a\u7528\u7684\u7ebf\u7a0b\u751f\u547d\u5468\u671f","text":"<ul> <li>\u4e94\u6001\u6a21\u578b<ul> <li>\u521d\u59cb\u72b6\u6001\uff1a\u7ebf\u7a0b\u5df2\u88ab\u521b\u5efa\uff0c\u4f46\u662f\u8fd8\u4e0d\u5141\u8bb8\u5206\u914dCPU\u6267\u884c\u3002\u7f16\u7a0b\u8bed\u8a00\u7279\u6709\uff0c\u5728\u7f16\u7a0b\u9884\u8a00\u5c42\u9762\u88ab\u521b\u5efa\uff0c\u800c\u5728\u64cd\u4f5c\u7cfb\u7edf\u5185\u8fd8\u6ca1\u6709\u521b\u5efa</li> <li>\u53ef\u8fd0\u884c\u72b6\u6001\uff1a\u7ebf\u7a0b\u53ef\u4ee5\u5206\u914dCPU\u6267\u884c\uff0c\u64cd\u4f5c\u7cfb\u7edf\u7ebf\u7a0b\u5df2\u88ab\u521b\u5efa</li> <li>\u8fd0\u884c\u72b6\u6001\uff1a\u6709\u7a7a\u95f2CPU\u7684\u65f6\u5019\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u5c06\u5176\u5206\u914d\u7ed9\u4e00\u4e2a\u53ef\u8fd0\u884c\u72b6\u6001\u7684\u7ebf\u7a0b\uff0c\u6b64\u65f6\u6b64\u7ebf\u7a0b\u5904\u4e8e\u8fd0\u884c\u72b6\u6001</li> <li>\u4f11\u7720\u72b6\u6001\uff1a\u5982\u679c\u8fd0\u884c\u72b6\u6001\u7684\u7ebf\u7a0b\u8c03\u7528\u963b\u585eAPI\u6216\u8005\u67d0\u4e2a\u7b49\u5f85\u67d0\u4e2a\u4e8b\u4ef6\uff0c\u90a3\u7ebf\u7a0b\u72b6\u6001\u5c31\u4f1a\u53d8\u4e3a\u4f11\u7720\u72b6\u6001\u3002\u4f11\u7720\u72b6\u6001\u7684\u7ebf\u7a0b\u4f1a\u91ca\u653eCPU\u4f7f\u7528\u6743</li> <li>\u7ec8\u6b62\u72b6\u6001\uff1a\u7ebf\u7a0b\u6267\u884c\u5b8c\uff0c\u6216\u8005\u6267\u884c\u5f02\u5e38\u5c31\u4f1a\u8fdb\u5165\u7ec8\u6b62\u72b6\u6001\uff0c\u4e5f\u610f\u5473\u7740\u7ebf\u7a0b\u751f\u547d\u5468\u671f\u7684\u7ed3\u675f</li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#java_2","title":"Java\u7ebf\u7a0b\u7684\u751f\u547d\u5468\u671f","text":"<p>\u516d\u79cd\u72b6\u6001\uff0c\u7b80\u5316\u4e3a\u4e09\u79cd </p> <ul> <li>New\u521d\u59cb\u5316</li> <li>Runable\u53ef\u8fd0\u884c/\u8fd0\u884c\u72b6\u6001</li> <li>Blocked\u963b\u585e\u72b6\u6001</li> <li>Waiting\u65e0\u65f6\u9650\u7b49\u5f85\u72b6\u6001</li> <li>TIMED_WAITING\u6709\u65f6\u9650\u7b49\u5f85\u72b6\u6001</li> <li>Terminated\u7ec8\u6b62\u72b6\u6001</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%B8%80%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/#java_3","title":"Java\u7ebf\u7a0b\u72b6\u6001\u8f6c\u6362","text":"<ul> <li>RUNABLE\u8f6cBLOCKED<ul> <li>\u4e00\u79cd\u573a\u666f\uff0csynchronized\u9690\u5f0f\u9501</li> </ul> </li> <li>RUNABLE\u8f6cWAITING<ul> <li>\u573a\u666f\u4e00\uff1a\u83b7\u5f97synchronized\u9690\u5f0f\u9501\u7684\u7ebf\u7a0b\uff0c\u8c03\u7528wait()\u65b9\u6cd5</li> <li>\u573a\u666f\u4e8c\uff1a\u8c03\u7528\u65e0\u53c2\u65b9\u6cd5Thread.join()\uff0c\u5982\u5728b\u7ebf\u7a0b\u4e2dA.join()A\u7ebf\u7a0bjoin\uff0c\u5219\u4f1aB\u7ebf\u7a0b\u8f6c\u5230WAITING\u72b6\u6001\uff0c\u540c\u6b65\u7b49\u5f85A\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\uff0c\u518d\u7531WAITING\u8f6c\u4e3aRUNABLE</li> <li>\u573a\u666f\u4e09\uff1a\u8c03\u7528LockSupport.park()\u65b9\u6cd5\u7ebf\u7a0b\u8fdb\u5165WAITING\u72b6\u6001\uff0c\u518d\u8c03\u7528LockSupport.unpark()\u65b9\u6cd5\u53ef\u4ee5\u5524\u9192\u7ebf\u7a0b\u8fdb\u5165RUNABLE\u72b6\u6001</li> </ul> </li> <li>RUNABLE\u4e0eTIMED_WAITING\u72b6\u6001\u8f6c\u6362<ul> <li>\u8c03\u7528\u5e26\u8d85\u65f6\u53c2\u6570\u7684Thread.sleep(long millis)\u65b9\u6cd5</li> <li>\u8c03\u7528\u5e26\u8d85\u65f6\u53c2\u6570\u7684Thread.join(long millis)</li> <li>\u83b7\u5f97synchronized\u9690\u5f0f\u9501\u7684\u7ebf\u7a0b\uff0c\u8c03\u7528wait(long timeout)\u65b9\u6cd5</li> <li>\u8c03\u7528\u5e26\u8d85\u65f6\u53c2\u6570\u7684LockSupport.parkNanos(Object blocker,long deadline)</li> <li>\u8c03\u7528\u5e26\u8d85\u65f6\u53c2\u6570\u7684LockSupport.parkUntil(long deadline)</li> </ul> </li> <li>NEW\u5230RUNABLE<ul> <li>\u7ee7\u627fThread\u5bf9\u8c61\uff0c\u91cd\u5199run()\u65b9\u6cd5\uff1a\u8c03\u7528\u7ebf\u7a0b\u5bf9\u8c61\u7684start()\u65b9\u6cd5</li> <li>\u5b9e\u73b0Runable\u63a5\u53e3\uff0c\u91cd\u5199run()\u65b9\u6cd5\uff1a\u8c03\u7528\u7ebf\u7a0b\u5bf9\u8c61\u7684start()\u65b9\u6cd5</li> </ul> </li> <li>RUNABLE\u5230TERMINATED<ul> <li>run()\u65b9\u6cd5\u540e\u4f1a\u81ea\u52a8\u8fdb\u5165TERMINTED</li> </ul> </li> </ul> <p>\u4e2a\u4eba\u94fe\u63a5\uff1ahttps://www.mubucm.com/doc/547p4gdcUMl</p> <p></p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/","title":"\u5e76\u53d1\u5de5\u5177\u7c7b","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#lockcondition","title":"Lock\u548cCondition","text":"<p>condition,\u89e3\u51b3\u540c\u6b65\u95ee\u9898</p> <p>\u5171\u540c\u70b9\uff1aLock\u548cCondition\u5b9e\u73b0\u7684\u7ba1\u7a0b\uff0c\u7ebf\u7a0b\u7b49\u5f85\u548c\u901a\u77e5\u53ef\u4ee5\u8c03\u7528await(),signal(),signalAll()\u65b9\u6cd5</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#lock","title":"Lock","text":"<p>\u89e3\u51b3\u4e92\u65a5\u95ee\u9898</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#synchorinzed","title":"\u5f25\u8865synchorinzed\u4e0d\u80fd\u7834\u574f\u4e0d\u53ef\u62a2\u5360\u6761\u4ef6","text":"<ol> <li>void lockInterruptibly()\uff08throws InterruptedException\uff09\u65b9\u6cd5\uff0c\u80fd\u591f\u54cd\u5e94\u4e2d\u65ad\uff0c\u5373\u5728\u6211\u4eec\u7ed9\u963b\u585e\u7684\u7ebf\u7a0b\u53d1\u9001\u4e2d\u65ad\u4fe1\u53f7\u65f6\uff0c\u80fd\u591f\u5524\u9192\u5b83\uff0c\u90a3\u963b\u585e\u7684\u7ebf\u7a0b\u5c31\u6709\u673a\u4f1a\u91ca\u653e\u6301\u6709\u7684\u9501\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u7834\u574f\u4e0d\u53ef\u62a2\u5360\u6761\u4ef6</li> <li>boolean tryLock(long time,TimeUnit unit)(throws InterruptedException)    \u652f\u6301\u8d85\u65f6\uff0c\u5982\u679c\u7ebf\u7a0b\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u6ca1\u6709\u83b7\u53d6\u5230\u9501\uff0c\u4e0d\u662f\u8fdb\u5165\u963b\u585e\u72b6\u6001\uff0c\u800c\u662f\u8fd4\u56de\u5f02\u5e38\uff0c\u90a3\u8fd9\u4e2a\u7ebf\u7a0b\u4e5f\u6709\u673a\u4f1a\u91ca\u653e\u6301\u6709\u7684\u9501</li> <li>boolean tryLock()\u975e\u963b\u585e\u7684\u83b7\u53d6\u9501,\u5982\u679c\u5c1d\u8bd5\u83b7\u53d6\u9501\u5931\u8d25\uff0c\u5e76\u4e0d\u8fdb\u5165\u963b\u585e\u72b6\u6001\uff0c\u800c\u662f\u76f4\u63a5\u8fd4\u56de\uff0c\u8fd9\u4e2a\u7ebf\u7a0b\u4e5f\u4f1a\u91ca\u653e\u6301\u6709\u7684\u9501</li> </ol>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#reentrantlock","title":"ReentrantLock","text":"<p>\u53ef\u91cd\u5165\u9501\uff08\u7ebf\u7a0b\u53ef\u4ee5\u91cd\u590d\u83b7\u53d6\u540c\u4e00\u628a\u9501\uff09\uff0c \u5185\u90e8\u6709\u4e00\u4e2avolatile\u4fee\u9970\u7684state\u6210\u5458\u53d8\u91cf\u4fdd\u8bc1\u53ef\u89c1\u6027</p> <p>ReentrantLock\u6709\u4e24\u4e2a\u6784\u9020\u65b9\u6cd5</p> <ul> <li>\u65e0\u53c2\u6784\u9020\u65b9\u6cd5\u9ed8\u8ba4\u975e\u516c\u5e73\u9501</li> <li>\u6709\u4e00\u4e2afair\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\uff0c\u4f20\u5165true\u5c31\u6784\u9020\u4e00\u4e2a\u516c\u5e73\u9501</li> </ul> <p>\u9501\u90fd\u5bf9\u5e94\u4e00\u4e2a\u7ebf\u7a0b\u7b49\u5f85\u961f\u5217\uff0c\u5982\u679c\u4e00\u4e2a\u7ebf\u7a0b\u6ca1\u6709\u83b7\u5f97\u9501\uff0c\u5c31\u4f1a\u653e\u5165\u7b49\u5f85\u961f\u5217\uff0c\u5f53\u6709\u7ebf\u7a0b\u91ca\u653e\u9501\u65f6\uff0c\u4f1a\u4ece\u7b49\u5f85\u961f\u5217\u4e2d\u5524\u9192\u4e00\u4e2a\u7b49\u5f85\u7684\u7ebf\u7a0b</p> <ul> <li>\u516c\u5e73\u9501\u7684\u5524\u9192\u7b56\u7565\u5c31\u662f\u8c01\u7b49\u5f85\u7684\u65f6\u95f4\u957f\uff0c\u5c31\u5524\u9192\u8c01</li> <li>\u975e\u516c\u5e73\u9501\u7684\u5524\u9192\u7b56\u7565\u591a\u7ebf\u7a0b\u6a21\u5f0f\u4e0d\u4f1a\u6309\u7167\u7ebf\u7a0b\u987a\u5e8f\u83b7\u53d6\u9501\uff0c\u6709\u53ef\u80fd\u7b49\u5f85\u65f6\u95f4\u77ed\u7684\u7ebf\u7a0b\u5148\u88ab\u5524\u9192</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#_2","title":"\u4e09\u4e2a\u7528\u9501\u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u6c38\u8fdc\u53ea\u5728\u66f4\u65b0\u5bf9\u8c61\u7684\u6210\u5458\u53d8\u91cf\u65f6\u52a0\u9501</li> <li>\u6c38\u8fdc\u53ea\u5728\u8bbf\u95ee\u53ef\u53d8\u7684\u6210\u5458\u53d8\u91cf\u65f6\u52a0\u9501</li> <li>\u6c38\u8fdc\u4e0d\u5728\u8c03\u7528\u5176\u5b83\u5bf9\u8c61\u7684\u65b9\u6cd5\u65f6\u52a0\u9501</li> </ol>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#semaphore","title":"Semaphore\uff1a\u5982\u4f55\u5feb\u901f\u5b9e\u73b0\u4e00\u4e2a\u9650\u6d41\u5668","text":"<p>\u4fe1\u53f7\u91cf\u6a21\u578b\uff1a\u4e00\u4e2a\u8ba1\u6570\u5668\u3001\u4e00\u4e2a\u7b49\u5f85\u961f\u5217\u3001\u4e09\u4e2a\u65b9\u6cd5</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#_3","title":"\u6a21\u578b","text":"<p>\u8ba1\u6570\u5668\u548c\u7b49\u5f85\u961f\u5217\u5bf9\u5916\u900f\u660e\uff0c\u6240\u4ee5\u4f7f\u7528\u4e09\u4e2a\u65b9\u6cd5\u5bf9\u5916\u8bbf\u95ee</p> <ol> <li>init()\u8bbe\u7f6e\u8ba1\u6570\u5668\u7684\u521d\u59cb\u503c</li> <li>up()\u8ba1\u6570\u5668\u7684\u503c\u52a01\uff1b\u5982\u679c\u6b64\u65f6\u8ba1\u6570\u5668\u7684\u503c\u5c0f\u4e8e\u6216\u8005\u7b49\u4e8e0\uff0c\u5219\u5524\u9192\u4e00\u4e2a\u7b49\u5f85\u961f\u5217\u4e2d\u7684\u7ebf\u7a0b\uff0c\u5e76\u5c06\u5176\u4ece\u7b49\u5f85\u961f\u5217\u4e2d\u79fb\u9664</li> <li>down()\u8ba1\u6570\u5668\u7684\u503c\u51cf1\uff0c\u5982\u679c\u8ba1\u6570\u5668\u7684\u503c\u5c0f\u4e8e0\uff0c\u5219\u5f53\u524d\u7ebf\u7a0b\u88ab\u963b\u585e</li> </ol> <p>\u4fe1\u53f7\u91cf\u7684down(),up()\u64cd\u4f5c\u4e5f\u88ab\u79f0\u4e3aP\u64cd\u4f5cV\u64cd\u4f5c\uff0cPV\u539f\u8bed</p> <p>\u5728Java\u91cc\uff0cdown()\u5bf9\u5e94acquire(),up()\u5bf9\u5e94release()</p> <p>\u4f7f\u7528\u573a\u666f\uff1a</p> <p>\u8fde\u63a5\u6c60\u3001\u5bf9\u8c61\u6c60\u3001\u7ebf\u7a0b\u6c60</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#readwritelock","title":"ReadWriteLock","text":"<p>\u8bfb\u591a\u5199\u5c11\u573a\u666f\uff0c\u7f13\u5b58\u5143\u6570\u636e\uff0c\u7f13\u5b58\u57fa\u7840\u6570\u636e\u7b49</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#_4","title":"\u4e09\u5927\u57fa\u672c\u539f\u5219","text":"<ol> <li>\u5141\u8bb8\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8bfb\u5171\u4eab\u53d8\u91cf</li> <li>\u53ea\u5141\u8bb8\u4e00\u4e2a\u7ebf\u7a0b\u5199\u5171\u4eab\u53d8\u91cf</li> <li>\u5f53\u4e00\u4e2a\u5199\u7ebf\u7a0b\u5728\u6267\u884c\u5199\u64cd\u4f5c\uff0c\u6b64\u65f6\u7981\u6b62\u8bfb\u7ebf\u7a0b\u8bfb\u5171\u4eab\u53d8\u91cf</li> </ol>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#_5","title":"\u5feb\u901f\u5b9e\u73b0\u4e00\u4e2a\u7f13\u5b58","text":"<p>Cache\u5de5\u5177\u7c7b\uff0c\u4e00\u4e2a\u8bfb\u7f13\u5b58\u65b9\u6cd5get()\uff0c\u53e6\u4e00\u4e2a\u662f\u5199\u7f13\u5b58\u65b9\u6cd5put()\u3002</p> <pre><code>class Cache&lt;K, V&gt; {\n    final Map&lt;K, V&gt; m =\n            new HashMap&lt;&gt;();\n    final ReadWriteLock rwl =\n            new ReentrantReadWriteLock();\n    // \u8bfb\u9501\n    final Lock r = rwl.readLock();\n    // \u5199\u9501\n    final Lock w = rwl.writeLock();\n\n    // \u8bfb\u7f13\u5b58\n    V get(K key) {\n        r.lock();\n        try {\n            return m.get(key);\n        } finally {\n            r.unlock();\n        }\n    }\n\n    // \u5199\u7f13\u5b58\n    V put(K key, V value) {\n        w.lock();\n        try {\n            return m.put(key, v);\n        } finally {\n            w.unlock();\n        }\n    }\n}\n</code></pre> <p>\u7f13\u5b58\u6570\u636e\u521d\u59cb\u5316</p> <ol> <li>\u4e00\u6b21\u6027\u52a0\u8f7d\uff1a\u5982\u5728\u7a0b\u5e8f\u542f\u52a8\u65f6\uff0c\u5c06\u6570\u636e\u67e5\u8be2\u51fa\u6765\uff0c\u8c03\u7528\u793a\u4f8b\u65b9\u6cd5\u4e2d\u7684put()\u65b9\u6cd5</li> <li>\u61d2\u52a0\u8f7d\uff1a\u5728\u9700\u8981\u7528\u5230\u6570\u636e\uff0c\u7f13\u5b58\u5185\u4e0d\u5b58\u5728\u65f6\uff0c\u518d\u53bb\u67e5\u8be2\u6570\u636e\u5e93\u653e\u5165\u7f13\u5b58\u4e2d</li> </ol>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#stampedlock","title":"StampedLock","text":"<p>\u6027\u80fd\u6bd4\u8bfb\u5199\u9501\u66f4\u5feb\u7684\u9501\u3002\u652f\u6301\u4e09\u79cd\u6a21\u5f0f\uff1a\u5199\u9501\u3001\u60b2\u89c2\u8bfb\u9501\u3001\u4e50\u89c2\u8bfb\uff08\u65e0\u9501\uff09</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#readwritelock_1","title":"\u4e0eReadWriteLock\u533a\u522b","text":"<ul> <li>StampedLock\u7684\u5199\u9501\u3001\u60b2\u89c2\u8bfb\u9501\u7684\u8bed\u4e49\u548cReadWriteLock\u7684\u5199\u9501\u3001\u8bfb\u9501\u7684\u8bed\u4e49\u975e\u5e38\u7c7b\u4f3c\uff0c\u5141\u8bb8\u591a\u7ebf\u7a0b\u540c\u65f6\u83b7\u53d6\u60b2\u89c2\u8bfb\u9501\uff0c\u53ea\u5141\u8bb8\u4e00\u4e2a\u7ebf\u7a0b\u83b7\u53d6\u5199\u9501\uff0c\u5199\u9501\u548c\u60b2\u89c2\u8bfb\u9501\u4e92\u65a5</li> <li>\u4e0d\u540c\uff1aStampedLock\u91cc\u5199\u9501\u548c\u60b2\u89c2\u8bfb\u9501\u52a0\u9501\u6210\u529f\u540e\uff0c\u4f1a\u8fd4\u56destamp\uff1b\u89e3\u9501\u65f6\uff0c\u9700\u8981\u4f20\u5165stamp</li> <li>StampedLock\u6027\u80fd\u4e4b\u6240\u4ee5\u6bd4ReadWriteLock\u8981\u597d\uff0c   \u5173\u952e\u662fStampedLock\u652f\u6301\u4e50\u89c2\u8bfb\u65b9\u5f0f\u3002ReadWriteLock\u652f\u6301\u591a\u7ebf\u7a0b\u540c\u65f6\u8bfb\uff0c\u4f46\u662f\u4e0e\u5199\u64cd\u4f5c\u65f6\u5019\u4e92\u65a5\u7684\uff0c\u5199\u64cd\u4f5c\u4f1a\u88ab\u963b\u585e\uff1b\u800cStampedLock\u63d0\u4f9b\u7684\u4e50\u89c2\u8bfb\uff0c\u662f\u5141\u8bb8\u4e00\u4e2a\u7ebf\u7a0b\u83b7\u53d6\u5199\u9501\u7684\uff0c\u5c31\u662f\u4e0d\u662f\u6240\u6709\u7684\u5199\u64cd\u4f5c\u90fd\u88ab\u963b\u585e</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#_6","title":"\u6ce8\u610f\u4e8b\u9879","text":"<ul> <li>\u4e0d\u652f\u6301\u91cd\u5165</li> <li>\u60b2\u89c2\u8bfb\u9501\u3001\u5199\u9501\u90fd\u4e0d\u652f\u6301\u6761\u4ef6\u53d8\u91cf</li> <li>\u4f7f\u7528StampedLock\u4e00\u5b9a\u4e0d\u8981\u8c03\u7528\u4e2d\u65adinterrupt()\u64cd\u4f5c\uff0c\u5982\u679c\u9700\u8981\u652f\u6301\u4e2d\u65ad\uff0c\u4f7f\u7528\u53ef\u4e2d\u65ad\u7684\u60b2\u89c2\u8bfb\u9501readLockInterruptibly()\u548c\u5199\u9501writeLockInterruptibly()</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#_7","title":"\u6a21\u677f\u4ee3\u7801","text":"<p>\u8bfb\u6a21\u677f</p> <pre><code>final StampedLock sl=\n        new StampedLock();\n// \u4e50\u89c2\u8bfb\n        long stamp=\n        sl.tryOptimisticRead();\n// \u8bfb\u5165\u65b9\u6cd5\u5c40\u90e8\u53d8\u91cf\n        ......\n// \u6821\u9a8cstamp\n        if(!sl.validate(stamp)){\n        // \u5347\u7ea7\u4e3a\u60b2\u89c2\u8bfb\u9501\n        stamp=sl.readLock();\n        try{\n        // \u8bfb\u5165\u65b9\u6cd5\u5c40\u90e8\u53d8\u91cf\n        .....\n        }finally{\n        //\u91ca\u653e\u60b2\u89c2\u8bfb\u9501\n        sl.unlockRead(stamp);\n        }\n        }\n//\u4f7f\u7528\u65b9\u6cd5\u5c40\u90e8\u53d8\u91cf\u6267\u884c\u4e1a\u52a1\u64cd\u4f5c\n        ......\n</code></pre> <p>\u5199 \u4ee3\u7801</p> <pre><code>long stamp=sl.writeLock();\n        try{\n        // \u5199\u5171\u4eab\u53d8\u91cf\n        ......\n        }finally{\n        sl.unlockWrite(stamp);\n        }\n</code></pre>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#countdownlatchcyclicbarrier","title":"CountDownLatch\u548cCyclicBarrier\uff1a\u8ba9\u591a\u7ebf\u7a0b\u6b65\u8c03\u4e00\u81f4","text":"<p>CountDownLatch\u8ba1\u6570\u5668\u64cd\u4f5c</p> <p>\u58f0\u660e\u521b\u5efaCountDownLatch,\u5728\u7ebf\u7a0b\u8c03\u7528\u65f6\u5b9e\u73b0countDown()\u51cf\u51cf\u64cd\u4f5c\uff0c\u4e3b\u7ebf\u7a0b\u4e2d\u4f7f\u7528await()\u65b9\u6cd5\u7b49\u5f85CountDownLatch\u5185\u7684\u521d\u59cb\u5316\u5927\u5c0f\u4e3a0\uff0c\u518d\u7ee7\u7eed\u6267\u884c\u4e3b\u7ebf\u57ce\u64cd\u4f5c</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#cyclicbarrier","title":"CyclicBarrier","text":"<ol> <li>\u521b\u5efa\u4e00\u4e2a\u8ba1\u6570\u5668\u521d\u59cb\u503c\u4e3aN\u7684CyclicBarieer,\u4f20\u5165\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\uff0c\u5f53\u8ba1\u6570\u5668\u51cf\u52300\u7684\u65f6\u5019\uff0c\u4f1a\u8c03\u7528\u8fd9\u4e2a\u56de\u8c03\u51fd\u6570\u3002\u8c03\u7528await()\u5c06\u8ba1\u6570\u5668\u51cf1\uff0c\u5f53\u8ba1\u6570\u5668\u53d8\u62100\u65f6\uff0c\u4f1a\u8c03\u7528barrier\u7684\u56de\u8c03\u51fd\u6570</li> <li>\u8ba1\u6570\u5668\u6709\u81ea\u52a8\u91cd\u7f6e\u7684\u529f\u80fd\uff0c\u51cf\u52300\u65f6\uff0c\u4f1a\u81ea\u52a8\u91cd\u7f6e\u8bbe\u7f6e\u7684N\u521d\u59cb\u503c</li> </ol>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#_8","title":"\u533a\u522b","text":"<ol> <li>CountDownLatch\u4e3b\u8981\u7528\u4e8e\u89e3\u51b3\u4e00\u4e2a\u7ebf\u7a0b\u7b49\u5f85\u591a\u4e2a\u7ebf\u7a0b\u7684\u573a\u666f</li> <li>CyclicBarrier\u662f\u4e00\u7ec4\u7ebf\u7a0b\u4e4b\u95f4\u4e92\u76f8\u7b49\u5f85</li> </ol>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#_9","title":"\u5e76\u53d1\u5bb9\u5668","text":"<p>\u56db\u5927\u7c7b\u5bb9\u5668\uff1aList\uff0cMap\uff0cSet\uff0cQueue</p> <p>\u540c\u6b65\u5bb9\u5668\uff1asunchronized</p> <ul> <li>\u7528\u8fed\u4ee3\u5668\u904d\u5386\u5bb9\u5668\u5b58\u5728\u5b89\u5168\u6027\u95ee\u9898</li> </ul> <p>\u7ebf\u7a0b\u4e0d\u5b89\u5168\u4ee3\u7801</p> <pre><code>List list=Collections.synchronizedList(new ArrayList());\n        Iterator i=list.iterator();\n        while(i.hasNext())\n        foo(i.next());\n</code></pre> <p>\u7ebf\u7a0b\u5b89\u5168\u4ee3\u7801</p> <pre><code>List list=Collections.synchronizedList(new ArrayList());\nsynchronized (list){\n        Iterator i=list.iterator();\n        while(i.hasNext())\n        foo(i.next());\n        }\n</code></pre> <ul> <li>\u6027\u80fd\u5dee\uff0c\u4e32\u884c\u5ea6\u592a\u9ad8</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#_10","title":"\u539f\u5b50\u7c7b\uff1a\u65e0\u9501\u5de5\u5177\u7c7b","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#executor","title":"Executor\u4e0e\u7ebf\u7a0b\u6c60","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#future","title":"Future","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E4%BA%8C%E9%83%A8%E5%88%86%E5%B9%B6%E5%8F%91%E5%B7%A5%E5%85%B7%E7%B1%BB%E8%AF%A6%E8%A7%A3/#completionstage","title":"CompletionStage\u63a5\u53e3","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/","title":"\u591a\u7ebf\u7a0b\u9762\u8bd5\u9898\u603b\u7ed3","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#_1","title":"\u4e3a\u4ec0\u4e48\u7a0b\u5e8f\u8ba1\u6570\u5668\u3001\u865a\u62df\u673a\u6808\u548c\u672c\u5730\u65b9\u6cd5\u6808\u662f\u7ebf\u7a0b\u79c1\u6709\u7684\uff1f\u4e3a\u4ec0\u4e48\u5806\u548c\u65b9\u6cd5\u533a\u662f\u7ebf\u7a0b\u5171\u4eab\u7684\u5462\uff1f","text":"<ul> <li>\u7a0b\u5e8f\u8ba1\u6570\u5668\u4e3a\u4ec0\u4e48\u662f\u79c1\u6709\u7684\uff1f<ul> <li>\u7a0b\u5e8f\u8ba1\u6570\u5668\u6709\u4ee5\u4e0b\u4f5c\u7528\uff1a<ul> <li>\u5b57\u8282\u7801\u89e3\u91ca\u5668\u901a\u8fc7\u6539\u53d8\u7a0b\u5e8f\u8ba1\u6570\u5668\u6765\u4f9d\u6b21\u8bfb\u53d6\u6307\u4ee4\uff0c\u4ece\u800c\u5b9e\u73b0\u4ee3\u7801\u7684\u6d41\u7a0b\u63a7\u5236\uff0c\u5982\uff1a\u987a\u5e8f\u6267\u884c\u3001\u9009\u62e9\u3001\u5faa\u73af\u3001\u5f02\u5e38\u5904\u7406\u3002</li> <li>\u5728\u591a\u7ebf\u7a0b\u7684\u60c5\u51b5\u4e0b\uff0c\u7a0b\u5e8f\u8ba1\u6570\u5668\u7528\u4e8e\u8bb0\u5f55\u5f53\u524d\u7ebf\u7a0b\u6267\u884c\u7684\u4f4d\u7f6e\uff0c\u4ece\u800c\u5f53\u7ebf\u7a0b\u88ab\u5207\u6362\u56de\u6765\u7684\u65f6\u5019\u80fd\u591f\u77e5\u9053\u8be5\u7ebf\u7a0b\u4e0a\u6b21\u8fd0\u884c\u5230\u54ea\u513f\u4e86\u3002   \uff08\u6240\u4ee5\uff0c\u7a0b\u5e8f\u8ba1\u6570\u5668\u79c1\u6709\u4e3b\u8981\u662f\u4e3a\u4e86\u7ebf\u7a0b\u5207\u6362\u540e\u80fd\u6062\u590d\u5230\u6b63\u786e\u7684\u6267\u884c\u4f4d\u7f6e\uff09\u3002</li> </ul> </li> </ul> </li> <li>\u865a\u62df\u673a\u6808\u548c\u672c\u5730\u65b9\u6cd5\u6808\u4e3a\u4ec0\u4e48\u662f\u79c1\u6709\u7684\uff1f<ul> <li>\u865a\u62df\u673a\u6808\uff1a\u6bcf\u4e2a Java \u65b9\u6cd5\u5728\u6267\u884c\u7684\u540c\u65f6\u4f1a\u521b\u5efa\u4e00\u4e2a\u6808\u5e27\u7528\u4e8e\u5b58\u50a8\u5c40\u90e8\u53d8\u91cf\u8868\u3001\u64cd\u4f5c\u6570\u6808\u3001\u5e38\u91cf\u6c60\u5f15\u7528\u7b49\u4fe1\u606f\u3002\u4ece\u65b9\u6cd5\u8c03\u7528\u76f4\u81f3\u6267\u884c\u5b8c\u6210\u7684\u8fc7\u7a0b\uff0c\u5c31\u5bf9\u5e94\u7740\u4e00\u4e2a\u6808\u5e27\u5728Java\u865a\u62df\u673a\u6808\u4e2d\u5165\u6808\u548c\u51fa\u6808\u7684\u8fc7\u7a0b\u3002</li> <li>\u672c\u5730\u65b9\u6cd5\u6808\uff1a\u548c\u865a\u62df\u673a\u6808\u6240\u53d1\u6325\u7684\u4f5c\u7528\u975e\u5e38\u76f8\u4f3c\uff0c\u533a\u522b\u662f\uff1a \u865a\u62df\u673a\u6808\u4e3a\u865a\u62df\u673a\u6267\u884c Java \u65b9\u6cd5 \uff08\u4e5f\u5c31\u662f\u5b57\u8282\u7801\uff09\u670d\u52a1\uff0c\u800c\u672c\u5730\u65b9\u6cd5\u6808\u5219\u4e3a\u865a\u62df\u673a\u4f7f\u7528\u5230\u7684 Native \u65b9\u6cd5\u670d\u52a1\u3002 \u5728 HotSpot \u865a\u62df\u673a\u4e2d\u548c Java   \u865a\u62df\u673a\u6808\u5408\u4e8c\u4e3a\u4e00\u3002   \uff08\u6240\u4ee5\uff09\u4e3a\u4e86\u4fdd\u8bc1\u7ebf\u7a0b\u4e2d\u7684\u5c40\u90e8\u53d8\u91cf\u4e0d\u88ab\u522b\u7684\u7ebf\u7a0b\u8bbf\u95ee\u5230\uff0c\u865a\u62df\u673a\u6808\u548c\u672c\u5730\u65b9\u6cd5\u6808\u662f\u7ebf\u7a0b\u79c1\u6709\u7684</li> </ul> </li> <li>\u5806\u548c\u65b9\u6cd5\u533a\u662f\u6240\u6709\u7ebf\u7a0b\u5171\u4eab\u7684\u8d44\u6e90<ul> <li>\u5806\u662f\u8fdb\u7a0b\u4e2d\u6700\u5927\u7684\u4e00\u5757\u5185\u5b58\uff0c\u4e3b\u8981\u7528\u4e8e\u5b58\u653e\u65b0\u521b\u5efa\u7684\u5bf9\u8c61\uff08\u6240\u6709\u5bf9\u8c61\u90fd\u5728\u8fd9\u5206\u914d\u5185\u5b58\uff09</li> <li>\u65b9\u6cd5\u533a\u4e3b\u8981\u7528\u4e8e\u5b58\u653e\u5df2\u88ab\u52a0\u8f7d\u7684\u7c7b\u4fe1\u606f\u3001\u5e38\u91cf\u3001\u9759\u6001\u53d8\u91cf\u3001\u5373\u65f6\u7f16\u8bd1\u540e\u7684\u4ee3\u7801\u6570\u636e</li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E5%A4%9A%E7%BA%BF%E7%A8%8B/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/#java","title":"Java\u7ebf\u7a0b\u7684\u72b6\u6001","text":"<p>\u521d\u59cb\u72b6\u6001\u3001\u8fd0\u884c\u72b6\u6001\u3001\u963b\u585e\u72b6\u6001\u3001\u7b49\u5f85\u72b6\u6001\u3001\u8d85\u65f6\u7b49\u5f85\u72b6\u6001\u3001\u7ec8\u6b62\u72b6\u6001\u3002  \u7ebf\u7a0b\u5728\u751f\u547d\u5468\u671f\u4e2d\u5e76\u4e0d\u662f\u56fa\u5b9a\u5904\u4e8e\u67d0\u4e00\u4e2a\u72b6\u6001\u800c\u662f\u968f\u7740\u4ee3\u7801\u7684\u6267\u884c\u5728\u4e0d\u540c\u72b6\u6001\u4e4b\u95f4\u5207\u6362 </p> <ul> <li>\u7ebf\u7a0b\u521b\u5efa\u540e\u5904\u4e8e\u521d\u59cb\u72b6\u6001\uff08New\uff09,\u8c03\u7528start()\u65b9\u6cd5\u540e\u5f00\u59cb\u8fd0\u884c\uff0c\u7ebf\u7a0b\u8fd9\u65f6\u5019\u5904\u4e8e\u53ef\u8fd0\u884c\u72b6\u6001\uff08READY\uff09</li> <li>\u53ef\u8fd0\u884c\u72b6\u6001\u7684\u7ebf\u7a0b\u83b7\u5f97\u4e86CPU\u65f6\u95f4\u7247\u540e\u5c31\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\uff08RUNNING\uff09</li> <li>\u5f53\u7ebf\u7a0b\u6267\u884cwait()\u65b9\u6cd5\u4e4b\u540e\uff0c\u7ebf\u7a0b\u8fdb\u5165\u7b49\u5f85\u72b6\u6001(WAITING),\u8fdb\u5165\u7b49\u5f85\u72b6\u6001\u7684\u7ebf\u7a0b\u9700\u8981\u4f9d\u9760\u5176\u4ed6\u7ebf\u7a0b\u7684\u901a\u77e5\u624d\u80fd\u8fd4\u56de\u5230\u8fd0\u884c\u72b6\u6001\uff08notify()   \uff09\u3002\u800c\u8d85\u65f6\u7b49\u5f85\u72b6\u6001\uff08TIME_WAITING\uff09\u76f8\u5f53\u4e8e\u5728\u7b49\u5f85\u7684\u57fa\u7840\u4e0a\u589e\u52a0\u4e86\u8d85\u65f6\u9650\u5236\uff0c\u3010sleep(long millis)/wait(long millis)\u3011,\u5f53\u8d85\u65f6\u65f6\u95f4\u5230\u8fbe\u540ejava\u7ebf\u7a0b\u5c06\u4f1a\u8fd4\u56de\u5230\u8fd0\u884c\u72b6\u6001\u3002</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/json/","title":"\u4e3a\u4ec0\u4e48\u7528json\u4f20\u8f93\u6570\u636e","text":"<p>JavaScript Object Notation</p> <ol> <li>json\u53ef\u8bfb\u6027\u9ad8\uff0c\u66f4\u7b80\u6d01\uff0c\u66f4\u5bb9\u6613\u7406\u89e3</li> <li>JSON \u7684\u89e3\u6790\u901f\u5ea6\u6bd4 XML \u66f4\u5feb\uff08\u56e0\u4e3a XML \u4e0e HTML \u5f88\u50cf\uff0c\u5728\u89e3\u6790\u5927\u578b XML \u6587\u4ef6\u65f6\u9700\u8981\u6d88\u8017\u989d\u5916\u7684\u5185\u5b58\uff09\uff0c\u5b58\u50a8\u540c\u6837\u7684\u6570\u636e\uff0cJSON \u683c\u5f0f\u6240\u5360\u7684\u5b58\u50a8\u7a7a\u95f4\u66f4\u5c0f</li> <li>\u4f20\u9001\u901f\u5ea6\u5feb\uff0c\u5360\u7528\u5185\u5b58\u5c0f</li> </ol>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E7%BD%91%E7%BB%9C/TCP%E5%8D%8F%E8%AE%AE/","title":"TCP\u534f\u8bae","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E7%BD%91%E7%BB%9C/TCP%E5%8D%8F%E8%AE%AE/#tcp","title":"TCP\u4e09\u6b21\u63e1\u624b\u3001\u56db\u6b21\u6325\u624b","text":"<p>TCP\u62a5\u6587\u683c\u5f0f\u6bd4\u8f83\u91cd\u8981\u7684\u5b57\u6bb5\u6709\uff1a</p> <ol> <li>\u5e8f\u53f7\uff08sequence number\uff09\uff1aSeq\u5e8f\u53f7\uff0c\u536032\u4f4d\uff0c\u7528\u6765\u6807\u8bc6\u4eceTCP\u6e90\u7aef\u5411\u76ee\u7684\u7aef\u53d1\u9001\u7684\u5b57\u8282\u6d41\uff0c\u53d1\u8d77\u65b9\u53d1\u9001\u6570\u636e\u65f6\u5bf9\u6b64\u8fdb\u884c\u6807\u8bb0</li> <li>\u786e\u8ba4\u53f7\uff08acknowledgement number\uff09\uff1aAck\u5e8f\u53f7\uff0c\u536032\u4f4d\uff0c\u53ea\u6709ACK\u6807\u5fd7\u4f4d\u4e3a1\u65f6\uff0c\u786e\u8ba4\u5e8f\u53f7\u5b57\u6bb5\u624d\u6709\u6548\uff0cAck=Seq+1</li> <li>\u6807\u5fd7\u4f4d\uff08Flags\uff09\uff1a\u51716\u4e2a\uff0c\u5373URG\u3001ACK\u3001PSH\u3001RST\u3001SYN\u3001FIN\u7b49\u3002\u5177\u4f53\u542b\u4e49\u5982\u4e0b\uff1a<ul> <li>URG\uff1a\u7d27\u6025\u6307\u9488\uff08urgent pointer\uff09\u6709\u6548</li> <li>ACK\uff1a\u786e\u8ba4\u5e8f\u53f7\u6709\u6548</li> <li>PSH\uff1a\u63a5\u6536\u65b9\u5e94\u8be5\u5c3d\u5feb\u5c06\u8fd9\u4e2a\u62a5\u6587\u4ea4\u7ed9\u5e94\u7528\u5c42</li> <li>RST\uff1a\u91cd\u7f6e\u8fde\u63a5</li> <li>SYN\uff1a\u53d1\u8d77\u4e00\u4e2a\u65b0\u8fde\u63a5</li> <li>FIN\uff1a\u91ca\u653e\u4e00\u4e2a\u8fde\u63a5</li> </ul> </li> </ol>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E7%BD%91%E7%BB%9C/TCP%E5%8D%8F%E8%AE%AE/#tcpthree-way-handshake","title":"TCP\u4e09\u6b21\u63e1\u624b\uff08Three-Way Handshake\uff09","text":"<p>\u4e09\u6b21\u63e1\u624b==TCP\u5efa\u7acb\u8fde\u63a5\uff0c\u8fd9\u4e2a\u8fde\u63a5\u5fc5\u987b\u662f\u4e00\u65b9\u4e3b\u52a8\u6253\u5f00\uff0c\u53e6\u4e00\u65b9\u88ab\u52a8\u6253\u5f00\uff0c\u5982\u56fe\uff08\u6765\u6e90\u4e8e\u7f51\u7edc\uff09 </p> <ol> <li>\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u5668\u7aef\u53d1\u9001\u4e00\u6bb5TCP\u62a5\u6587:SYN=1,seq=x<ul> <li>\u6807\u8bb0\u4f4d\u4e3aSYN\uff0c\u8868\u793a\u201c\u8bf7\u6c42\u5efa\u7acb\u65b0\u8fde\u63a5\u201d;</li> <li>\u5e8f\u53f7\u4e3aSeq=X\uff08X\u4e00\u822c\u4e3a1\uff09</li> <li>\u968f\u540e\u5ba2\u6237\u7aef\u8fdb\u5165SYN-SENT\u9636\u6bb5</li> </ul> </li> <li>\u670d\u52a1\u5668\u7aef\u63a5\u6536\u5230\u6765\u81ea\u5ba2\u6237\u7aef\u7684TCP\u62a5\u6587\u4e4b\u540e\uff0c\u7ed3\u675fLISTEN\u9636\u6bb5\u3002\u5e76\u8fd4\u56de\u4e00\u6bb5TCP\u62a5\u6587\uff0c\u5176\u4e2d\uff1aSYN=1,ACK=1,seq=y,ack=x+1<ul> <li>\u6807\u5fd7\u4f4d\u4e3aSYN\u548cACK\uff0c\u8868\u793a\u201c\u786e\u8ba4\u5ba2\u6237\u7aef\u7684\u62a5\u6587Seq\u5e8f\u53f7\u6709\u6548\uff0c\u670d\u52a1\u5668\u80fd\u6b63\u5e38\u63a5\u6536\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u6570\u636e\uff0c\u5e76\u540c\u610f\u521b\u5efa\u65b0\u8fde\u63a5\u201d</li> <li>\u5e8f\u53f7\u4e3aseq=y</li> <li>\u786e\u8ba4\u53f7\u4e3aAck=x+1\uff0c\u8868\u793a\u6536\u5230\u5ba2\u6237\u7aef\u7684\u5e8f\u53f7Seq\u5e76\u5c06\u5176\u503c\u52a01\u4f5c\u4e3a\u81ea\u5df1\u786e\u8ba4\u53f7Ack\u7684\u503c\uff1b\u968f\u540e\u670d\u52a1\u5668\u7aef\u8fdb\u5165SYN-RCVD\u9636\u6bb5</li> </ul> </li> <li>\u5ba2\u6237\u7aef\u63a5\u6536\u5230\u6765\u81ea\u670d\u52a1\u5668\u7aef\u7684\u786e\u8ba4\u6536\u5230\u6570\u636e\u7684TCP\u62a5\u6587\u4e4b\u540e\uff0c\u660e\u786e\u4e86\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u5668\u7684\u6570\u636e\u4f20\u8f93\u662f\u6b63\u5e38\u7684\uff0c\u7ed3\u675fSYN-SENT\u9636\u6bb5\u3002\u5e76\u8fd4\u56de\u6700\u540e\u4e00\u6bb5TCP\u62a5\u6587\u3002\u5176\u4e2d\uff1aACK=1,seq=x+1,ack=y+1<ul> <li>\u6807\u5fd7\u4f4d\u4e3aACK\uff0c\u8868\u793a\u201c\u786e\u8ba4\u6536\u5230\u670d\u52a1\u5668\u7aef\u540c\u610f\u8fde\u63a5\u7684\u4fe1\u53f7\u201d</li> <li>\u5e8f\u53f7\u4e3aSeq=x+1\uff0c\u8868\u793a\u6536\u5230\u670d\u52a1\u5668\u7aef\u7684\u786e\u8ba4\u53f7Ack\uff0c\u5e76\u5c06\u5176\u503c\u4f5c\u4e3a\u81ea\u5df1\u7684\u5e8f\u53f7\u503c</li> <li>\u786e\u8ba4\u53f7\u4e3aAck=y+1\uff0c\u8868\u793a\u6536\u5230\u670d\u52a1\u5668\u7aef\u5e8f\u53f7Seq\uff0c\u5e76\u5c06\u5176\u503c\u52a01\u4f5c\u4e3a\u81ea\u5df1\u7684\u786e\u8ba4\u53f7Ack\u7684\u503c</li> <li>\u968f\u540e\u5ba2\u6237\u7aef\u8fdb\u5165ESTABLISHED\u9636\u6bb5</li> </ul> </li> <li>\u670d\u52a1\u5668\u6536\u5230\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u201c\u786e\u8ba4\u6536\u5230\u670d\u52a1\u5668\u6570\u636e\u201d\u7684TCP\u62a5\u6587\u4e4b\u540e\uff0c\u660e\u786e\u4e86\u4ece\u670d\u52a1\u5668\u5230\u5ba2\u6237\u7aef\u7684\u6570\u636e\u4f20\u8f93\u662f\u6b63\u5e38\u7684\u3002\u7ed3\u675fSYN-SENT\u9636\u6bb5\uff0c\u8fdb\u5165ESTABLISHED\u9636\u6bb5</li> </ol>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E7%BD%91%E7%BB%9C/TCP%E5%8D%8F%E8%AE%AE/#_1","title":"\u4e3a\u4ec0\u4e48\u8981\u4e09\u6b21\u63e1\u624b","text":"<p>\u76ee\u7684\uff1a\u53cc\u65b9\u786e\u8ba4\u81ea\u5df1\u4e0e\u5bf9\u65b9\u7684\u53d1\u9001\u4e0e\u63a5\u6536\u662f\u6b63\u5e38\u7684\uff0c\u5efa\u7acb\u53ef\u9760\u7684\u901a\u4fe1\u4fe1\u9053</p> <ul> <li>\u7b2c\u4e00\u6b21\u63e1\u624b\uff1aClient\u4ec0\u4e48\u90fd\u4e0d\u80fd\u786e\u8ba4;Server\u7aef\u63a5\u6536\u6b63\u5e38\uff0c\u5bf9\u65b9\u53d1\u9001\u6b63\u5e38</li> <li>\u7b2c\u4e8c\u6b21\u63e1\u624b\uff1aClient\u786e\u5b9a\u81ea\u5df1\u53d1\u9001\u6b63\u5e38\uff0c\u63a5\u6536\u6b63\u5e38\uff0c\u5bf9\u65b9\u53d1\u9001\u6b63\u5e38\uff0c\u63a5\u6536\u6b63\u5e38;Server\u786e\u8ba4\u5bf9\u65b9\u53d1\u9001\u6b63\u5e38\uff0c\u81ea\u5df1\u63a5\u6536\u6b63\u5e38</li> <li>\u7b2c\u4e09\u6b21\u63e1\u624b\uff1aClient\u786e\u5b9a\u81ea\u5df1\u53d1\u9001\u6b63\u5e38\uff0c\u63a5\u6536\u6b63\u5e38\uff0c\u5bf9\u65b9\u53d1\u9001\u6b63\u5e38\uff0c\u63a5\u6536\u6b63\u5e38;Server\u786e\u8ba4\u5bf9\u65b9\u53d1\u9001\u6b63\u5e38\uff0c\u81ea\u5df1\u63a5\u6536\u6b63\u5e38\uff0c\u81ea\u5df1\u53d1\u9001\u6b63\u5e38\uff0c\u5bf9\u65b9\u63a5\u6536\u6b63\u5e38</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E7%BD%91%E7%BB%9C/TCP%E5%8D%8F%E8%AE%AE/#_2","title":"\u4e09\u6b21\u63e1\u624b\u53ef\u4ee5\u643a\u5e26\u6570\u636e\u5417","text":"<ul> <li>\u7b2c\u4e09\u6b21\u53ef\u4ee5\uff0c\u524d\u4e24\u6b21\u4e0d\u53ef\u4ee5\uff0c\u5982\u679c\u6709\u4eba\u8981\u6076\u610f\u653b\u51fb\u670d\u52a1\u5668\uff0c\u90a3\u4ed6\u6bcf\u6b21\u90fd\u5728\u7b2c\u4e00\u6b21\u63e1\u624b\u4e2d\u7684 SYN \u62a5\u6587\u4e2d\u653e\u5165\u5927\u91cf\u7684\u6570\u636e\uff0c\u75af\u72c2\u7740\u91cd\u590d\u53d1 SYN \u62a5\u6587\uff0c\u8fd9\u4f1a\u8ba9\u670d\u52a1\u5668\u82b1\u8d39\u5927\u91cf\u7684\u5185\u5b58\u7a7a\u95f4\u6765\u7f13\u5b58\u8fd9\u4e9b\u62a5\u6587\uff0c\u8fd9\u6837\u670d\u52a1\u5668\u5c31\u66f4\u5bb9\u6613\u88ab\u653b\u51fb</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E7%BD%91%E7%BB%9C/TCP%E5%8D%8F%E8%AE%AE/#tcpfour-way-wavehand","title":"TCP\u56db\u6b21\u6325\u624b\uff08Four-Way Wavehand\uff09","text":"<p>\u56db\u6b21\u6325\u624b\u5373TCP\u8fde\u63a5\u7684\u91ca\u653e(\u89e3\u9664)\u3002\u8fde\u63a5\u7684\u91ca\u653e\u5fc5\u987b\u662f\u4e00\u65b9\u4e3b\u52a8\u91ca\u653e\uff0c\u53e6\u4e00\u65b9\u88ab\u52a8\u91ca\u653e </p> <ol> <li>\u9996\u5148\u5ba2\u6237\u7aef\u60f3\u8981\u91ca\u653e\u8fde\u63a5\uff0c\u5411\u670d\u52a1\u5668\u7aef\u53d1\u9001\u4e00\u6bb5TCP\u62a5\u6587\uff0c\u5176\u4e2d\uff1aFIN=1,seq=u<ul> <li>\u6807\u8bb0\u4f4d\u4e3aFIN\uff0c\u8868\u793a\u201c\u8bf7\u6c42\u91ca\u653e\u8fde\u63a5\u201c</li> <li>\u5e8f\u53f7\u4e3aSeq=U</li> <li>\u968f\u540e\u5ba2\u6237\u7aef\u8fdb\u5165FIN-WAIT-1\u9636\u6bb5\uff0c\u5373\u534a\u5173\u95ed\u9636\u6bb5\u3002\u5e76\u4e14\u505c\u6b62\u5728\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u5668\u7aef\u65b9\u5411\u4e0a\u53d1\u9001\u6570\u636e\uff0c\u4f46\u662f\u5ba2\u6237\u7aef\u4ecd\u7136\u80fd\u63a5\u6536\u4ece\u670d\u52a1\u5668\u7aef\u4f20\u8f93\u8fc7\u6765\u7684\u6570\u636e\u3002</li> </ul> </li> <li>\u670d\u52a1\u5668\u7aef\u63a5\u6536\u5230\u4ece\u5ba2\u6237\u7aef\u53d1\u51fa\u7684TCP\u62a5\u6587\u4e4b\u540e\uff0c\u786e\u8ba4\u4e86\u5ba2\u6237\u7aef\u60f3\u8981\u91ca\u653e\u8fde\u63a5\uff0c\u968f\u540e\u670d\u52a1\u5668\u7aef\u7ed3\u675fESTABLISHED\u9636\u6bb5\uff0c\u8fdb\u5165CLOSE-WAIT\u9636\u6bb5\uff08\u534a\u5173\u95ed\u72b6\u6001\uff09\u5e76\u8fd4\u56de\u4e00\u6bb5TCP\u62a5\u6587,\u5176\u4e2d\uff1aACK=1,seq=v,ack=u+1<ul> <li>\u6807\u8bb0\u4f4d\u4e3aACK\uff0c\u8868\u793a\u201c\u63a5\u6536\u5230\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u91ca\u653e\u8fde\u63a5\u7684\u8bf7\u6c42\u201d</li> <li>\u5e8f\u53f7\u4e3aSeq=v</li> <li>\u786e\u8ba4\u53f7\u4e3aAck=U+1\uff0c\u8868\u793a\u662f\u5728\u6536\u5230\u5ba2\u6237\u7aef\u62a5\u6587\u7684\u57fa\u7840\u4e0a\uff0c\u5c06\u5176\u5e8f\u53f7Seq\u503c\u52a01\u4f5c\u4e3a\u672c\u6bb5\u62a5\u6587\u786e\u8ba4\u53f7Ack\u7684\u503c</li> <li>\u968f\u540e\u670d\u52a1\u5668\u7aef\u5f00\u59cb\u51c6\u5907\u91ca\u653e\u670d\u52a1\u5668\u7aef\u5230\u5ba2\u6237\u7aef\u65b9\u5411\u4e0a\u7684\u8fde\u63a5</li> <li>\u5ba2\u6237\u7aef\u6536\u5230\u4ece\u670d\u52a1\u5668\u7aef\u53d1\u51fa\u7684TCP\u62a5\u6587\u4e4b\u540e\uff0c\u786e\u8ba4\u4e86\u670d\u52a1\u5668\u6536\u5230\u4e86\u5ba2\u6237\u7aef\u53d1\u51fa\u7684\u91ca\u653e\u8fde\u63a5\u8bf7\u6c42\uff0c\u968f\u540e\u5ba2\u6237\u7aef\u7ed3\u675fFIN-WAIT-1\u9636\u6bb5\uff0c\u8fdb\u5165FIN-WAIT-2\u9636\u6bb5</li> </ul> </li> <li>\u670d\u52a1\u5668\u7aef\u81ea\u4ece\u53d1\u51faACK\u786e\u8ba4\u62a5\u6587\u4e4b\u540e\uff0c\u7ecf\u8fc7CLOSED-WAIT\u9636\u6bb5\uff0c\u505a\u597d\u4e86\u91ca\u653e\u670d\u52a1\u5668\u7aef\u5230\u5ba2\u6237\u7aef\u65b9\u5411\u4e0a\u7684\u8fde\u63a5\u51c6\u5907\uff0c\u518d\u6b21\u5411\u5ba2\u6237\u7aef\u53d1\u51fa\u4e00\u6bb5TCP\u62a5\u6587\uff0c\u5176\u4e2d\uff1aFIN=1,ACK=1,seq=w,ack=u+1<ul> <li>\u6807\u8bb0\u4f4d\u4e3aFIN\uff0cACK\uff0c\u8868\u793a\u201c\u5df2\u7ecf\u51c6\u5907\u597d\u91ca\u653e\u8fde\u63a5\u4e86\u201d</li> <li>\u5e8f\u53f7\u4e3aSeq=W</li> <li>\u786e\u8ba4\u53f7\u4e3aAck=U+1\uff1b\u8868\u793a\u662f\u5728\u6536\u5230\u5ba2\u6237\u7aef\u62a5\u6587\u7684\u57fa\u7840\u4e0a\uff0c\u5c06\u5176\u5e8f\u53f7Seq\u503c\u52a01\u4f5c\u4e3a\u672c\u6bb5\u62a5\u6587\u786e\u8ba4\u53f7Ack\u7684\u503c</li> <li>\u968f\u540e\u670d\u52a1\u5668\u7aef\u7ed3\u675fCLOSE-WAIT\u9636\u6bb5\uff0c\u8fdb\u5165LAST-ACK\u9636\u6bb5\u3002\u5e76\u4e14\u505c\u6b62\u5728\u670d\u52a1\u5668\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u65b9\u5411\u4e0a\u53d1\u9001\u6570\u636e\uff0c\u4f46\u662f\u670d\u52a1\u5668\u7aef\u4ecd\u7136\u80fd\u591f\u63a5\u6536\u4ece\u5ba2\u6237\u7aef\u4f20\u8f93\u8fc7\u6765\u7684\u6570\u636e\u3002</li> </ul> </li> <li>\u5ba2\u6237\u7aef\u6536\u5230\u4ece\u670d\u52a1\u5668\u7aef\u53d1\u51fa\u7684TCP\u62a5\u6587\uff0c\u786e\u8ba4\u4e86\u670d\u52a1\u5668\u7aef\u5df2\u505a\u597d\u91ca\u653e\u8fde\u63a5\u7684\u51c6\u5907\uff0c\u7ed3\u675fFIN-WAIT-2\u9636\u6bb5\uff0c\u8fdb\u5165TIME-WAIT\u9636\u6bb5\uff0c\u5e76\u5411\u670d\u52a1\u5668\u7aef\u53d1\u9001\u4e00\u6bb5\u62a5\u6587\uff0c\u5176\u4e2d\uff1aACK=1,seq=u+1,ack=w+1<ul> <li>\u6807\u8bb0\u4f4d\u4e3aACK\uff0c\u8868\u793a\u201c\u63a5\u6536\u5230\u670d\u52a1\u5668\u51c6\u5907\u597d\u91ca\u653e\u8fde\u63a5\u7684\u4fe1\u53f7\u201d</li> <li>\u5e8f\u53f7\u4e3aSeq=U+1\uff1b\u8868\u793a\u662f\u5728\u6536\u5230\u4e86\u670d\u52a1\u5668\u7aef\u62a5\u6587\u7684\u57fa\u7840\u4e0a\uff0c\u5c06\u5176\u786e\u8ba4\u53f7Ack\u503c\u4f5c\u4e3a\u672c\u6bb5\u62a5\u6587\u5e8f\u53f7\u7684\u503c</li> <li>\u786e\u8ba4\u53f7\u4e3aAck=W+1\uff1b\u8868\u793a\u662f\u5728\u6536\u5230\u4e86\u670d\u52a1\u5668\u7aef\u62a5\u6587\u7684\u57fa\u7840\u4e0a\uff0c\u5c06\u5176\u5e8f\u53f7Seq\u503c\u4f5c\u4e3a\u672c\u6bb5\u62a5\u6587\u786e\u8ba4\u53f7\u7684\u503c</li> <li>\u968f\u540e\u5ba2\u6237\u7aef\u5f00\u59cb\u5728TIME-WAIT\u9636\u6bb5\u7b49\u5f852MSL</li> <li>\u670d\u52a1\u5668\u7aef\u6536\u5230\u4ece\u5ba2\u6237\u7aef\u53d1\u51fa\u7684TCP\u62a5\u6587\u4e4b\u540e\u7ed3\u675fLAST-ACK\u9636\u6bb5\uff0c\u8fdb\u5165CLOSED\u9636\u6bb5\u3002\u7531\u6b64\u6b63\u5f0f\u786e\u8ba4\u5173\u95ed\u670d\u52a1\u5668\u7aef\u5230\u5ba2\u6237\u7aef\u65b9\u5411\u4e0a\u7684\u8fde\u63a5;\u5ba2\u6237\u7aef\u7b49\u5f85\u5b8c2MSL\u4e4b\u540e\uff0c\u7ed3\u675fTIME-WAIT\u9636\u6bb5\uff0c\u8fdb\u5165CLOSED\u9636\u6bb5\uff0c\u7531\u6b64\u5b8c\u6210\"   \u56db\u6b21\u6325\u624b\"</li> </ul> </li> </ol>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E7%BD%91%E7%BB%9C/TCP%E5%8D%8F%E8%AE%AE/#2msl","title":"\u4e3a\u4ec0\u4e48\u8981\u7b49\u5f852MSL","text":"<p>MSL\uff08Maximum Segment Lifetime\uff09\uff0cTCP\u5141\u8bb8\u4e0d\u540c\u7684\u5b9e\u73b0\u53ef\u4ee5\u8bbe\u7f6e\u4e0d\u540c\u7684MSL\u503c\u3002</p> <ul> <li>\u4fdd\u8bc1\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u6700\u540e\u4e00\u4e2aACK\u62a5\u6587\u80fd\u591f\u5230\u8fbe\u670d\u52a1\u5668\uff0c\u56e0\u4e3a\u8fd9\u4e2aACK\u62a5\u6587\u53ef\u80fd\u4e22\u5931\uff0c\u7ad9\u5728\u670d\u52a1\u5668\u7684\u89d2\u5ea6\u770b\u6765\uff0c\u6211\u5df2\u7ecf\u53d1\u9001\u4e86FIN+ACK\u62a5\u6587\u8bf7\u6c42\u65ad\u5f00\u4e86\uff0c\u5ba2\u6237\u7aef\u8fd8\u6ca1\u6709\u7ed9\u6211\u56de\u5e94\uff0c\u5e94\u8be5\u662f\u6211\u53d1\u9001\u7684\u8bf7\u6c42\u65ad\u5f00\u62a5\u6587\u5b83\u6ca1\u6709\u6536\u5230\uff0c\u4e8e\u662f\u670d\u52a1\u5668\u53c8\u4f1a\u91cd\u65b0\u53d1\u9001\u4e00\u6b21\uff0c\u800c\u5ba2\u6237\u7aef\u5c31\u80fd\u5728\u8fd9\u4e2a2MSL\u65f6\u95f4\u6bb5\u5185\u6536\u5230\u8fd9\u4e2a\u91cd\u4f20\u7684\u62a5\u6587\uff0c\u63a5\u7740\u7ed9\u51fa\u56de\u5e94\u62a5\u6587\uff0c\u5e76\u4e14\u4f1a\u91cd\u542f2MSL\u8ba1\u65f6\u5668\u3002</li> <li>\u9632\u6b62\u7c7b\u4f3c\u4e0e\u201c\u4e09\u6b21\u63e1\u624b\u201d\u4e2d\u63d0\u5230\u4e86\u7684\u201c\u5df2\u7ecf\u5931\u6548\u7684\u8fde\u63a5\u8bf7\u6c42\u62a5\u6587\u6bb5\u201d\u51fa\u73b0\u5728\u672c\u8fde\u63a5\u4e2d</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E7%BD%91%E7%BB%9C/TCP%E5%8D%8F%E8%AE%AE/#_3","title":"\u5982\u679c\u5df2\u5efa\u7acb\u4e86\u8fde\u63a5\uff0c\u5ba2\u6237\u7aef\u6545\u969c\u4e86\u5982\u4f55\u5904\u7406","text":"<p>TCP\u8fd8\u8bbe\u6709\u4e00\u4e2a\u4fdd\u6d3b\u8ba1\u65f6\u5668\uff0c\u663e\u7136\uff0c\u5ba2\u6237\u7aef\u5982\u679c\u51fa\u73b0\u6545\u969c\uff0c\u670d\u52a1\u5668\u4e0d\u80fd\u4e00\u76f4\u7b49\u4e0b\u53bb\uff0c\u767d\u767d\u6d6a\u8d39\u8d44\u6e90\u3002\u670d\u52a1\u5668\u6bcf\u6536\u5230\u4e00\u6b21\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u540e\u90fd\u4f1a\u91cd\u65b0\u590d\u4f4d\u8fd9\u4e2a\u8ba1\u65f6\u5668\uff0c\u65f6\u95f4\u901a\u5e38\u662f\u8bbe\u7f6e\u4e3a2\u5c0f\u65f6\uff0c\u82e5\u4e24\u5c0f\u65f6\u8fd8\u6ca1\u6709\u6536\u5230\u5ba2\u6237\u7aef\u7684\u4efb\u4f55\u6570\u636e\uff0c\u670d\u52a1\u5668\u5c31\u4f1a\u53d1\u9001\u4e00\u4e2a\u63a2\u6d4b\u62a5\u6587\u6bb5\uff0c\u4ee5\u540e\u6bcf\u969475\u79d2\u53d1\u9001\u4e00\u6b21\u3002\u82e5\u4e00\u8fde\u53d1\u900110\u4e2a\u63a2\u6d4b\u62a5\u6587\u4ecd\u7136\u6ca1\u53cd\u5e94\uff0c\u670d\u52a1\u5668\u5c31\u8ba4\u4e3a\u5ba2\u6237\u7aef\u51fa\u4e86\u6545\u969c\uff0c\u63a5\u7740\u5c31\u5173\u95ed\u8fde\u63a5</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E7%BD%91%E7%BB%9C/TCP%E5%8D%8F%E8%AE%AE/#tcpudp","title":"TCP,UDP\u534f\u8bae\u7684\u533a\u522b","text":"<ul> <li>TCP<ul> <li>\u4f18\u70b9\uff1a \u53ef\u9760\uff0c\u7a33\u5b9a TCP\u7684\u53ef\u9760\u4f53\u73b0\u5728TCP\u5728\u4f20\u9012\u6570\u636e\u4e4b\u524d\uff0c\u4f1a\u6709\u4e09\u6b21\u63e1\u624b\u6765\u5efa\u7acb\u8fde\u63a5\uff0c\u800c\u4e14\u5728\u6570\u636e\u4f20\u9012\u65f6\uff0c\u6709\u786e\u8ba4\u3001\u7a97\u53e3\u3001\u91cd\u4f20\u3001\u62e5\u585e\u63a7\u5236\u673a\u5236\uff0c\u5728\u6570\u636e\u4f20\u5b8c\u540e\uff0c\u8fd8\u4f1a\u65ad\u5f00\u8fde\u63a5\u7528\u6765\u8282\u7ea6\u7cfb\u7edf\u8d44\u6e90\u3002</li> <li>\u7f3a\u70b9\uff1a\u6162\uff0c\u6548\u7387\u4f4e\uff0c\u5360\u7528\u7cfb\u7edf\u8d44\u6e90\u9ad8\uff0c\u6613\u88ab\u653b\u51fb\uff0c\u56e0\u4e3aTCP\u6709\u786e\u8ba4\u673a\u5236\u3001\u4e09\u6b21\u63e1\u624b\u673a\u5236\uff0c\u8fd9\u4e9b\u4e5f\u5bfc\u81f4TCP\u5bb9\u6613\u88ab\u4eba\u5229\u7528\uff0c\u5b9e\u73b0DOS\u3001DDOS\u3001CC\u7b49\u653b\u51fb</li> <li>\u5e94\u7528\uff1a\u6d4f\u89c8\u5668\uff0c\u7528\u7684HTTP FlashFXP\uff0c\u7528\u7684FTP Outlook\uff0c\u7528\u7684POP\u3001SMTP Putty\uff0c\u7528\u7684Telnet\u3001SSH QQ\u6587\u4ef6\u4f20\u8f93</li> </ul> </li> <li>UDP:<ul> <li>\u4f18\u70b9\uff1a UDP\u662f\u4e00\u4e2a\u65e0\u72b6\u6001\u7684\u4f20\u8f93\u534f\u8bae\uff0c\u6240\u4ee5\u5b83\u5728\u4f20\u9012\u6570\u636e\u65f6\u975e\u5e38\u5feb</li> <li>\u7f3a\u70b9\uff1a\u7f51\u7edc\u8d28\u91cf\u4e0d\u597d\uff0c\u5c31\u4f1a\u5f88\u5bb9\u6613\u4e22\u5305\uff0c\u4e0d\u53ef\u9760\uff0c\u4e0d\u7a33\u5b9a</li> <li>\u5e94\u7528\uff1aQQ\u8bed\u97f3 QQ\u89c6\u9891 TFTP \u76f4\u64ad</li> </ul> </li> <li>\u603b\u7ed3\uff1a<ol> <li>TCP\u9762\u5411\u8fde\u63a5\uff08\u5982\u6253\u7535\u8bdd\u8981\u5148\u62e8\u53f7\u5efa\u7acb\u8fde\u63a5\uff09;UDP\u662f\u65e0\u8fde\u63a5\u7684\uff0c\u5373\u53d1\u9001\u6570\u636e\u4e4b\u524d\u4e0d\u9700\u8981\u5efa\u7acb\u8fde\u63a5</li> <li>\u6bcf\u4e00\u6761TCP\u8fde\u63a5\u53ea\u80fd\u662f\u70b9\u5230\u70b9\u7684;UDP\u652f\u6301\u4e00\u5bf9\u4e00\uff0c\u4e00\u5bf9\u591a\uff0c\u591a\u5bf9\u4e00\u548c\u591a\u5bf9\u591a\u7684\u4ea4\u4e92\u901a\u4fe1</li> <li>TCP\u9996\u90e8\u5f00\u950020\u5b57\u8282;UDP\u7684\u9996\u90e8\u5f00\u9500\u5c0f\uff0c\u53ea\u67098\u4e2a\u5b57\u8282</li> <li>TCP\u7684\u903b\u8f91\u901a\u4fe1\u4fe1\u9053\u662f\u5168\u53cc\u5de5\u7684\u53ef\u9760\u4fe1\u9053\uff0cUDP\u5219\u662f\u4e0d\u53ef\u9760\u4fe1\u9053</li> </ol> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/","title":"\u8ba1\u7b97\u673a\u7f51\u7edc","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#osi","title":"OSI\u4e03\u5c42\u6a21\u578b","text":"<ol> <li>\u6765\u6e90    OSI\uff08Open System Interconnect\uff09\uff0c\u5373\u5f00\u653e\u5f0f\u7cfb\u7edf\u4e92\u8054\u3002 \u4e00\u822c\u90fd\u53ebOSI\u53c2\u8003\u6a21\u578b\uff0c\u662fISO\uff08\u56fd\u9645\u6807\u51c6\u5316\u7ec4\u7ec7\uff09\u7ec4\u7ec7\u57281985\u5e74\u7814\u7a76\u7684\u7f51\u7edc\u4e92\u8fde\u6a21\u578b\u3002</li> <li> <p>\u4e03\u5c42\u6a21\u578b\u5212\u5206    ISO\u5f00\u653e\u4e92\u8054\u7cfb\u7edf\u53c2\u8003\u6a21\u578b\uff1a\uff08\u4e0b3\u5c42\u4e3b\u8981\u4efb\u52a1\u6570\u636e\u901a\u4fe1\uff0c\u4e0a3\u5c42\u4e3b\u8981\u4efb\u52a1\u6570\u636e\u5904\u7406\uff09</p> </li> <li> <p>\u7269\u7406\u5c42\uff1a</p> <ul> <li>\u53c2\u8003\u6a21\u578b\u7684\u6700\u4f4e\u5c42</li> <li>\u5229\u7528\u4f20\u8f93\u4ecb\u8d28\u4e3a\u6570\u636e\u94fe\u8def\u5c42\u63d0\u4f9b\u7269\u7406\u8fde\u63a5\uff0c\u5b9e\u73b0\u6bd4\u7279\u6d41\u7684\u4f20\u8f93</li> <li>\u7269\u7406\u5c42\u5e38\u7528\u7684\u4f20\u8f93\u4ecb\u8d28\uff1a\u96c6\u7ebf\u5668\u3001\u4e2d\u7ee7\u5668\u3001\u8c03\u5236\u89e3\u8c03\u5668\u3001\u7f51\u7ebf\u3001\u53cc\u7ede\u7ebf\u3001\u540c\u8f74\u7535\u7f06</li> </ul> </li> <li>\u6570\u636e\u94fe\u8def\u5c42\uff1a<ul> <li>\u4ecb\u8d28\u8bbf\u95ee\u63a7\u5236\uff08MAC\uff09\u548c\u903b\u8f91\u94fe\u8def\u63a7\u5236\uff08LLC\uff09</li> <li>\u901a\u8fc7\u5404\u79cd\u63a7\u5236\u534f\u8bae\uff0c\u5c06\u6709\u5dee\u9519\u7684\u7269\u7406\u4fe1\u9053\u53d8\u4e3a\u65e0\u5dee\u9519\u7684\u3001\u80fd\u53ef\u9760\u4f20\u8f93\u6570\u636e\u5e27\u7684\u6570\u636e\u94fe\u8def</li> <li>\u901a\u8fc7\u5dee\u9519\u63a7\u5236\uff0c\u6d41\u91cf\u63a7\u5236\uff0c\u4f7f\u6709\u5dee\u9519\u7684\u7269\u7406\u7ebf\u8def\u53d8\u4e3a\u65e0\u5dee\u9519\u7684\u6570\u636e\u94fe\u8def\uff0c\u5373\u63d0\u4f9b\u53ef\u9760\u7684\u901a\u8fc7\u7269\u7406\u4ecb\u8d28\u4f20\u8f93\u6570\u636e\u7684\u65b9\u6cd5</li> </ul> </li> <li>\u7f51\u7edc\u5c42<ul> <li>\u901a\u4fe1\u5b50\u7f51\u7684\u6700\u9ad8\u4e00\u5c42\uff0c\u5728\u4e0b\u4e24\u5c42\u7684\u57fa\u7840\u4e0a\u5411\u8d44\u6e90\u5b50\u7f51\u63d0\u4f9b\u670d\u52a1</li> <li>IP\u9009\u5740\uff0c\u8def\u7531\u9009\u62e9</li> <li>\u901a\u8fc7\u8def\u7531\u9009\u62e9\u7b97\u6cd5\uff0c\u4e3a\u62a5\u6587\u6216\u5206\u7ec4\u901a\u8fc7\u901a\u4fe1\u5b50\u7f51\u9009\u62e9\u6700\u9002\u5f53\u7684\u8def\u5f84<ul> <li>\u8def\u7531\u7b97\u6cd5\uff1a\u5f53\u6e90\u8282\u70b9\u548c\u76ee\u7684\u8282\u70b9\u4e4b\u95f4\u5b58\u5728\u591a\u6761\u8def\u5f84\u65f6\uff0c\u672c\u5c42\u53ef\u4ee5\u6839\u636e\u8def\u7531\u7b97\u6cd5\uff0c\u901a\u8fc7\u7f51\u7edc\u4e3a\u6570\u636e\u5206\u7ec4\u9009\u62e9\u6700\u4f73\u8def\u5f84\uff0c\u5e76\u5c06\u4fe1\u606f\u4ece\u6700\u5408\u9002\u7684\u8def\u5f84\u7531\u53d1\u9001\u7aef\u4f20\u9001\u5230\u63a5\u6536\u7aef</li> </ul> </li> <li>\u6570\u636e\u94fe\u8def\u5c42\u662f\u89e3\u51b3\u540c\u4e00\u7f51\u7edc\u5185\u8282\u70b9\u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u800c\u7f51\u7edc\u5c42\u4e3b\u8981\u89e3\u51b3\u4e0d\u540c\u5b50\u7f51\u95f4\u7684\u901a\u4fe1</li> <li>IP\u534f\u8bae\u5c42</li> </ul> </li> <li>\u4f20\u8f93\u5c42<ul> <li>\u5efa\u7acb\uff0c\u7ba1\u7406\uff0c\u7ef4\u62a4\u7aef\u5230\u7aef\u7684\u8fde\u63a5</li> <li>\u8be5\u5c42\u662f\u901a\u4fe1\u5b50\u7f51\u548c\u8d44\u6e90\u5b50\u7f51\u63a5\u53e3\u548c\u6865\u6881\uff0c\u8d77\u5230\u627f\u4e0a\u542f\u4e0b\u7684\u4f5c\u7528</li> <li>\u8be5\u5c42\u5e38\u89c1\u7684\u534f\u8bae\u6709TCP/IP\u4e2d\u7684TCP\u534f\u8bae\u3001Novell\u7f51\u7edc\u4e2d\u7684SPX\u534f\u8bae\u548c\u5fae\u8f6f\u7684NetBIOS/NetBEUI\u534f\u8bae</li> <li>\u63d0\u4f9b\u5efa\u7acb\u3001\u7ef4\u62a4\u548c\u62c6\u9664\u4f20\u8f93\u8fde\u63a5\u7684\u529f\u80fd\u3002\u4f20\u8f93\u5c42\u5728\u7f51\u7edc\u5c42\u7684\u57fa\u7840\u4e0a\u4e3a\u9ad8\u5c42\u63d0\u4f9b\u201c\u9762\u5411\u8fde\u63a5\u201d\u548c\u201c\u9762\u5411\u65e0\u8fde\u63a5\u201d\u7684\u4e24\u79cd\u670d\u52a1</li> <li>\u7528\u6237\u6570\u636e\u534f\u8bae UDP\uff08User Datagram Protocol\uff09--\u63d0\u4f9b\u65e0\u8fde\u63a5\u7684\uff0c\u5c3d\u6700\u5927\u52aa\u529b\u7684\u6570\u636e\u4f20\u8f93\u670d\u52a1\uff08\u4e0d\u4fdd\u8bc1\u6570\u636e\u4f20\u8f93\u7684\u53ef\u9760\u6027\uff09</li> </ul> </li> <li>\u4f1a\u8bdd\u5c42<ul> <li>\u7ec4\u7ec7\u548c\u534f\u8c03\u4e24\u4e2a\u4f1a\u8bdd\u8fdb\u7a0b\u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u5e76\u5bf9\u6570\u636e\u4ea4\u6362\u8fdb\u884c\u7ba1\u7406\u548c\u7ef4\u62a4\u3002</li> <li>\u5f53\u5efa\u7acb\u4f1a\u8bdd\u65f6\uff0c\u7528\u6237\u5fc5\u987b\u63d0\u4f9b\u4ed6\u4eec\u60f3\u8981\u8fde\u63a5\u7684\u8fdc\u7a0b\u5730\u5740\u3002\u800c\u8fd9\u4e9b\u5730\u5740\u4e0eMAC\uff08\u4ecb\u8d28\u8bbf\u95ee\u63a7\u5236\u5b50\u5c42\uff09\u5730\u5740\u6216\u7f51\u7edc\u5c42\u7684\u903b\u8f91\u5730\u5740\u4e0d\u540c\uff0c\u5b83\u4eec\u662f\u4e3a\u7528\u6237\u4e13\u95e8\u8bbe\u8ba1\u7684\uff0c\u66f4\u4fbf\u4e8e\u7528\u6237\u8bb0\u5fc6\u3002\u57df\u540d\uff08DN\uff09\u5c31\u662f\u4e00\u79cd\u7f51\u7edc\u4e0a\u4f7f\u7528\u7684\u8fdc\u7a0b\u5730\u5740</li> </ul> </li> <li>\u8868\u793a\u5c42<ul> <li>\u6570\u636e\u683c\u5f0f\u8f6c\u6362\uff0c\u6570\u636e\u52a0\u5bc6</li> <li>\u5bf9\u6765\u81ea\u5e94\u7528\u5c42\u7684\u547d\u4ee4\u548c\u6570\u636e\u8fdb\u884c\u89e3\u91ca\uff0c\u5bf9\u5404\u79cd\u8bed\u6cd5\u8d4b\u4e88\u76f8\u5e94\u7684\u542b\u4e49\uff0c\u5e76\u6309\u7167\u4e00\u5b9a\u7684\u683c\u5f0f\u4f20\u9001\u7ed9\u4f1a\u8bdd\u5c42\u3002</li> <li>\u538b\u7f29\u548c\u89e3\u538b\u7f29\uff1a\u4e3a\u4e86\u51cf\u5c11\u6570\u636e\u7684\u4f20\u8f93\u91cf\uff0c\u8fd9\u4e00\u5c42\u8fd8\u8d1f\u8d23\u6570\u636e\u7684\u538b\u7f29\u4e0e\u6062\u590d</li> </ul> </li> <li>\u5e94\u7528\u5c42<ul> <li>\u53c2\u8003\u6a21\u578b\u7684\u6700\u9ad8\u5c42</li> <li> </li> </ul> </li> </ol> <p>\u5982\u56fe\uff0c\u603b\u7ed3 </p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_1","title":"\u76f4\u63a5\u5411\u7528\u6237\u63d0\u4f9b\u670d\u52a1\uff0c\u5b8c\u6210\u7528\u6237\u5e0c\u671b\u5728\u7f51\u7edc\u4e0a\u5b8c\u6210\u7684\u5404\u79cd\u5de5\u4f5c","text":"\u5bf9\u4e8e\u4e0d\u540c\u7684\u7f51\u7edc\u5e94\u7528\u9700\u8981\u4e0d\u540c\u7684\u5e94\u7528\u5c42\u534f\u8bae\uff0c\uff08HTTP\uff0cHTTPS\uff0cFTP\uff0cPOP3\u3001SMTP\uff09\u6587\u4ef6\u670d\u52a1\u3001\u76ee\u5f55\u670d\u52a1\u3001\u6587\u4ef6\u4f20\u8f93\u670d\u52a1\uff08FTP\uff09\u3001\u8fdc\u7a0b\u767b\u5f55\u670d\u52a1\uff08Telnet\uff09\u3001\u7535\u5b50\u90ae\u4ef6\u670d\u52a1\uff08E-mail\uff09\u3001\u6253\u5370\u670d\u52a1\u3001\u5b89\u5168\u670d\u52a1\u3001\u7f51\u7edc\u7ba1\u7406\u670d\u52a1\u3001\u6570\u636e\u5e93\u670d\u52a1"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E7%BD%91%E7%BB%9C/http/HTTP%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF%E7%A0%81/","title":"HTTP\u5e38\u89c1\u9519\u8bef\u7801","text":"<ul> <li>200\uff1a\u6b63\u786e\u7684\u8bf7\u6c42\u8fd4\u56de\u6b63\u786e\u7684\u7ed3\u679c\uff0c\u5982\u679c\u4e0d\u60f3\u7ec6\u5206\u6b63\u786e\u7684\u8bf7\u6c42\u7ed3\u679c\u90fd\u53ef\u4ee5\u76f4\u63a5\u8fd4\u56de200\u3002</li> <li>201\uff1a\u8868\u793a\u8d44\u6e90\u88ab\u6b63\u786e\u7684\u521b\u5efa\u3002\u6bd4\u5982\u8bf4\uff0c\u6211\u4eec POST \u7528\u6237\u540d\u3001\u5bc6\u7801\u6b63\u786e\u521b\u5efa\u4e86\u4e00\u4e2a\u7528\u6237\u5c31\u53ef\u4ee5\u8fd4\u56de 201\u3002</li> <li>202\uff1a\u8bf7\u6c42\u662f\u6b63\u786e\u7684\uff0c\u4f46\u662f\u7ed3\u679c\u6b63\u5728\u5904\u7406\u4e2d\uff0c\u8fd9\u65f6\u5019\u5ba2\u6237\u7aef\u53ef\u4ee5\u901a\u8fc7\u8f6e\u8be2\u7b49\u673a\u5236\u7ee7\u7eed\u8bf7\u6c42\u3002</li> <li>203\uff1a\u8bf7\u6c42\u7684\u4ee3\u7406\u670d\u52a1\u5668\u4fee\u6539\u4e86\u6e90\u670d\u52a1\u5668\u8fd4\u56de\u7684 200 \u4e2d\u7684\u5185\u5bb9\uff0c\u6211\u4eec\u901a\u8fc7\u4ee3\u7406\u670d\u52a1\u5668\u5411\u670d\u52a1\u5668 A \u8bf7\u6c42\u7528\u6237\u4fe1\u606f\uff0c\u670d\u52a1\u5668 A \u6b63\u5e38\u54cd\u5e94\uff0c\u4f46\u4ee3\u7406\u670d\u52a1\u5668\u547d\u4e2d\u4e86\u7f13\u5b58\u5e76\u8fd4\u56de\u4e86\u81ea\u5df1\u7684\u7f13\u5b58\u5185\u5bb9\uff0c\u8fd9\u65f6\u5019\u5b83\u8fd4\u56de 203 \u544a\u8bc9\u6211\u4eec\u8fd9\u90e8\u5206\u4fe1\u606f\u4e0d\u4e00\u5b9a\u662f\u6700\u65b0\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u884c\u5224\u65ad\u5e76\u5904\u7406\u3002</li> <li>300\uff1a\u8bf7\u6c42\u6210\u529f\uff0c\u4f46\u7ed3\u679c\u6709\u591a\u79cd\u9009\u62e9\u3002</li> <li>301\uff1a\u8bf7\u6c42\u6210\u529f\uff0c\u4f46\u662f\u8d44\u6e90\u88ab\u6c38\u4e45\u8f6c\u79fb\u3002\u6bd4\u5982\u8bf4\uff0c\u6211\u4eec\u4e0b\u8f7d\u7684\u4e1c\u897f\u4e0d\u5728\u8fd9\u4e2a\u5730\u5740\u9700\u8981\u53bb\u5230\u65b0\u7684\u5730\u5740\u3002</li> <li>303\uff1a\u4f7f\u7528 GET \u6765\u8bbf\u95ee\u65b0\u7684\u5730\u5740\u6765\u83b7\u53d6\u8d44\u6e90\u3002</li> <li>304\uff1a\u8bf7\u6c42\u7684\u8d44\u6e90\u5e76\u6ca1\u6709\u88ab\u4fee\u6539\u8fc7\u3002</li> <li>308\uff1a\u4f7f\u7528\u539f\u6709\u7684\u5730\u5740\u8bf7\u6c42\u65b9\u5f0f\u6765\u901a\u8fc7\u65b0\u5730\u5740\u83b7\u53d6\u8d44\u6e90\u3002</li> <li>400\uff1a\u8bf7\u6c42\u51fa\u73b0\u9519\u8bef\uff0c\u6bd4\u5982\u8bf7\u6c42\u5934\u4e0d\u5bf9\u7b49\u3002</li> <li>401\uff1a\u6ca1\u6709\u63d0\u4f9b\u8ba4\u8bc1\u4fe1\u606f\u3002\u8bf7\u6c42\u7684\u65f6\u5019\u6ca1\u6709\u5e26\u4e0a Token \u7b49\u3002</li> <li>402\uff1a\u4e3a\u4ee5\u540e\u9700\u8981\u6240\u4fdd\u7559\u7684\u72b6\u6001\u7801\u3002</li> <li>403\uff1a\u8bf7\u6c42\u7684\u8d44\u6e90\u4e0d\u5141\u8bb8\u8bbf\u95ee\u3002\u5c31\u662f\u8bf4\u6ca1\u6709\u6743\u9650\u3002</li> <li>404\uff1a\u8bf7\u6c42\u7684\u5185\u5bb9\u4e0d\u5b58\u5728\u3002</li> <li>406\uff1a\u8bf7\u6c42\u7684\u8d44\u6e90\u5e76\u4e0d\u7b26\u5408\u8981\u6c42\u3002</li> <li>408\uff1a\u5ba2\u6237\u7aef\u8bf7\u6c42\u8d85\u65f6\u3002</li> <li>413\uff1a\u8bf7\u6c42\u4f53\u8fc7\u5927\u3002</li> <li>415\uff1a\u7c7b\u578b\u4e0d\u6b63\u786e\u3002</li> <li>416\uff1a\u8bf7\u6c42\u7684\u533a\u95f4\u65e0\u6548\u3002</li> <li>500\uff1a\u670d\u52a1\u5668\u9519\u8bef\u3002</li> <li>501\uff1a\u8bf7\u6c42\u8fd8\u6ca1\u6709\u88ab\u5b9e\u73b0\u3002</li> <li>502\uff1a\u7f51\u5173\u9519\u8bef\u3002</li> <li>503\uff1a\u670d\u52a1\u6682\u65f6\u4e0d\u53ef\u7528\u3002\u670d\u52a1\u5668\u6b63\u597d\u5728\u66f4\u65b0\u4ee3\u7801\u91cd\u542f\u3002</li> <li>505\uff1a\u8bf7\u6c42\u7684 HTTP \u7248\u672c\u4e0d\u652f\u6301\u3002</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/","title":"Index","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#_1","title":"\u8bbe\u8ba1\u6a21\u5f0f","text":"<ul> <li>\u521b\u5efa\u578b\u6a21\u578b<ul> <li>\u5355\u4f8b\u6a21\u5f0f</li> <li>\u7b80\u5355\u5de5\u5382\u6a21\u5f0f</li> </ul> </li> <li>\u884c\u4e3a\u6a21\u578b<ul> <li>\u6a21\u677f\u65b9\u6cd5\u6a21\u5f0f</li> <li>\u7b56\u7565\u6a21\u5f0f</li> <li>\u547d\u4ee4\u6a21\u5f0f</li> <li>\u8d23\u4efb\u94fe\u6a21\u5f0f</li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/","title":"\u8bbe\u8ba1\u6a21\u5f0f","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/#_2","title":"\u5982\u4f55\u6b63\u786e\u4f7f\u7528","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/#_3","title":"\u8bbe\u8ba1\u539f\u5219","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%9E%8B/","title":"Index","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%9E%8B/#_1","title":"\u521b\u5efa\u578b\u6a21\u578b","text":"<ul> <li>\u5355\u4f8b\u6a21\u5f0f</li> <li>\u7b80\u5355\u5de5\u5382\u6a21\u5f0f</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%9E%8B/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/","title":"\u5355\u4f8b\u6a21\u5f0f","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%9E%8B/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/#_1","title":"\u5355\u4f8b\u6a21\u5f0f","text":"<p>\u5728\u6709\u4e9b\u7cfb\u7edf\u4e2d\uff0c\u4e3a\u4e86\u8282\u7701\u5185\u5b58\u8d44\u6e90\u3001\u4fdd\u8bc1\u6570\u636e\u5185\u5bb9\u7684\u4e00\u81f4\u6027\uff0c\u5bf9\u67d0\u4e9b\u7c7b\u8981\u6c42\u53ea\u80fd\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u8fd9\u5c31\u662f\u6240\u8c13\u7684\u5355\u4f8b\u6a21\u5f0f\u3002</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%9E%8B/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/#_2","title":"\u5355\u4f8b\u6a21\u5f0f\u4f18\u70b9\u548c\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a - \u5355\u4f8b\u6a21\u5f0f\u53ef\u4ee5\u4fdd\u8bc1\u5185\u5b58\u91cc\u53ea\u6709\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u51cf\u5c11\u4e86\u5185\u5b58\u7684\u5f00\u9500\u3002 - \u53ef\u4ee5\u907f\u514d\u5bf9\u8d44\u6e90\u7684\u591a\u91cd\u5360\u7528\u3002 - \u5355\u4f8b\u6a21\u5f0f\u8bbe\u7f6e\u5168\u5c40\u8bbf\u95ee\u70b9\uff0c\u53ef\u4ee5\u4f18\u5316\u548c\u5171\u4eab\u8d44\u6e90\u7684\u8bbf\u95ee\u3002 \u7f3a\u70b9\uff1a - \u5355\u4f8b\u6a21\u5f0f\u4e00\u822c\u6ca1\u6709\u63a5\u53e3\uff0c\u6269\u5c55\u56f0\u96be\u3002\u5982\u679c\u8981\u6269\u5c55\uff0c\u5219\u9664\u4e86\u4fee\u6539\u539f\u6765\u7684\u4ee3\u7801\uff0c\u6ca1\u6709\u7b2c\u4e8c\u79cd\u9014\u5f84\uff0c\u8fdd\u80cc\u5f00\u95ed\u539f\u5219\u3002 - \u5728\u5e76\u53d1\u6d4b\u8bd5\u4e2d\uff0c\u5355\u4f8b\u6a21\u5f0f\u4e0d\u5229\u4e8e\u4ee3\u7801\u8c03\u8bd5\u3002\u5728\u8c03\u8bd5\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u5355\u4f8b\u4e2d\u7684\u4ee3\u7801\u6ca1\u6709\u6267\u884c\u5b8c\uff0c\u4e5f\u4e0d\u80fd\u6a21\u62df\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u5bf9\u8c61\u3002 - \u5355\u4f8b\u6a21\u5f0f\u7684\u529f\u80fd\u4ee3\u7801\u901a\u5e38\u5199\u5728\u4e00\u4e2a\u7c7b\u4e2d\uff0c\u5982\u679c\u529f\u80fd\u8bbe\u8ba1\u4e0d\u5408\u7406\uff0c\u5219\u5f88\u5bb9\u6613\u8fdd\u80cc\u5355\u4e00\u804c\u8d23\u539f\u5219\u3002</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%9E%8B/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/#_3","title":"\u5355\u4f8b\u6a21\u5f0f\u7684\u5e94\u7528\u573a\u666f","text":"<ul> <li>\u9700\u8981\u9891\u7e41\u521b\u5efa\u7684\u4e00\u4e9b\u7c7b\uff0c\u4f7f\u7528\u5355\u4f8b\u53ef\u4ee5\u964d\u4f4e\u7cfb\u7edf\u7684\u5185\u5b58\u538b\u529b\uff0c\u51cf\u5c11 GC\u3002</li> <li>\u67d0\u7c7b\u9700\u8981\u9891\u7e41\u5b9e\u4f8b\u5316\uff0c\u800c\u521b\u5efa\u7684\u5bf9\u8c61\u53c8\u9891\u7e41\u88ab\u9500\u6bc1\u7684\u65f6\u5019\uff0c\u5982\u591a\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u6c60\u3001\u7f51\u7edc\u8fde\u63a5\u6c60\u7b49\u3002</li> <li>\u9891\u7e41\u8bbf\u95ee\u6570\u636e\u5e93\u6216\u6587\u4ef6\u7684\u5bf9\u8c61\u3002</li> <li>\u5f53\u5bf9\u8c61\u9700\u8981\u88ab\u5171\u4eab\u7684\u573a\u5408\u3002\u7531\u4e8e\u5355\u4f8b\u6a21\u5f0f\u53ea\u5141\u8bb8\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5171\u4eab\u8be5\u5bf9\u8c61\u53ef\u4ee5\u8282\u7701\u5185\u5b58\uff0c\u5e76\u52a0\u5feb\u5bf9\u8c61\u8bbf\u95ee\u901f\u5ea6\u3002\u5982 Web \u4e2d\u7684\u914d\u7f6e\u5bf9\u8c61\u3001\u6570\u636e\u5e93\u7684\u8fde\u63a5\u6c60\u7b49\u3002</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%9E%8B/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/#_4","title":"\u5b9e\u73b0\u5355\u4f8b\u7684\u6a21\u5f0f\u7684\u51e0\u79cd\u65b9\u5f0f","text":"<ol> <li>\u997f\u6c49\u6a21\u5f0f</li> <li>\u61d2\u6c49\u6a21\u5f0f</li> <li>DCL\u53cc\u7aef\u68c0\u9501\u673a\u5236</li> <li>\u679a\u4e3e\u6a21\u5f0f</li> <li>\u9759\u6001\u5185\u90e8\u7c7b\u6a21\u5f0f</li> </ol>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%9E%8B/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/#_5","title":"\u5b9e\u4f8b\u4ee3\u7801","text":"<pre><code>/**\n * @author lviter\n * \u5355\u4f8b\u6a21\u5f0f\u7684\u56db\u79cd\u5b9e\u73b0\uff1a\n * 1. \u997f\u6c49\n * 2. \u61d2\u6c49\n * 3. DCL\u53cc\u7aef\u68c0\u9501\u673a\u5236\n * 4. \u9759\u6001\u5185\u90e8\u7c7b\n * 5. \u679a\u4e3e\u6a21\u5f0f\n */\npublic class Singleton {\n    public static void main(String[] args) {\n        SingletonEnum s1 = SingletonEnum.INSTANCE.getInstance();\n        SingletonEnum s2 = SingletonEnum.INSTANCE.getInstance();\n        System.out.println(s1 == s2);\n    }\n}\n\n/**\n * \u61d2\u6c49\u5f0f--\u7ebf\u7a0b\u4e0d\u5b89\u5168\n */\nclass SingletonLazy {\n    private static SingletonLazy singletonLazy = null;\n\n    private SingletonLazy() {\n        System.out.println(\"\u61d2\u6c49\u5f0f---\u7ebf\u7a0b\u4e0d\u5b89\u5168\u7684\u6784\u9020\u65b9\u6cd5\");\n    }\n\n    public static SingletonLazy getSingletonLazy() {\n        if (singletonLazy == null) {\n            return new SingletonLazy();\n        }\n        return singletonLazy;\n    }\n}\n\n/**\n * \u997f\u6c49\u5f0f\n * \u6ca1\u6709\u52a0\u9501\uff0c\u6267\u884c\u6548\u7387\u4f1a\u63d0\u9ad8\u3002\u7f3a\u70b9\u662f\u7c7b\u52a0\u8f7d\u65f6\u5c31\u521d\u59cb\u5316\uff0c\u6d6a\u8d39\u5185\u5b58\n * \u57fa\u4e8eclassloder\u673a\u5236\u907f\u514d\u4e86\u591a\u7ebf\u7a0b\u7684\u540c\u6b65\u95ee\u9898\n */\nclass SingletonHungry {\n    private static final SingletonHungry singletonHungry = new SingletonHungry();\n\n    private SingletonHungry() {\n        System.out.println(\"\u997f\u6c49\u5f0f\");\n    }\n\n    public static SingletonHungry getSingletonHungry() {\n        return singletonHungry;\n    }\n}\n\n/**\n * DCL:double check lock,\u53cc\u7aef\u68c0\u9501\u673a\u5236--\u5728\u540c\u6b65\u9501\u524d\u540e\u90fd\u589e\u52a0\u68c0\u67e5\u64cd\u4f5c\n * \u591a\u7ebf\u7a0b\u5b89\u5168\uff0c\u91c7\u7528\u53cc\u9501\u673a\u5236\uff0c\u5b89\u5168\u4e14\u5728\u591a\u7ebf\u7a0b\u4e0b\u4fdd\u6301\u9ad8\u6027\u80fd\u3002\n */\nclass SingletonDcl {\n\n    private volatile static SingletonDcl singletonDcl;\n\n    private SingletonDcl() {\n        System.out.println(\"DCL\u53cc\u7aef\u68c0\u9501--\u7ebf\u7a0b\u5b89\u5168\uff0c\u652f\u6301\u9ad8\u6027\u80fd\");\n    }\n\n    /**\n     * \u540c\u6b65\u9501\u524d\u540e\u90fd\u589e\u52a0\u68c0\u67e5\n     *\n     * @return\n     */\n    public static SingletonDcl getSingletonDcl() {\n        if (singletonDcl == null) {\n            synchronized (SingletonDcl.class) {\n                if (singletonDcl == null) {\n                    singletonDcl = new SingletonDcl();\n                }\n            }\n        }\n        return singletonDcl;\n    }\n}\n\n/**\n * \u9759\u6001\u5185\u90e8\u7c7b\u7684\u6784\u9020\u65b9\u6cd5\u53ea\u4f1a\u5728\u8c03\u7528\u4ed6\u7684\u65f6\u5019\u89e6\u53d1\uff0c\u6240\u4ee5\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\n */\nclass SingletonStaticInternal {\n\n    private SingletonStaticInternal() {\n        System.out.println(\"\u8fd9\u91cc\u662f\u9759\u6001\u5185\u90e8\u7c7b\u7684\u65b9\u5f0f\");\n    }\n\n    private static class holder {\n        private static final SingletonStaticInternal instance = new SingletonStaticInternal();\n    }\n\n    public static SingletonStaticInternal getInstance() {\n        return holder.instance;\n    }\n}\n\n/**\n * \u679a\u4e3e\u5355\u4f8b(\u5355\u4f8b\u6a21\u5f0f\u7684\u6700\u4f73\u5b9e\u73b0\u65b9\u6cd5)\n * \u65e2\u53ef\u4ee5\u907f\u514d\u591a\u7ebf\u7a0b\u540c\u6b65\u95ee\u9898\uff1b\u8fd8\u53ef\u4ee5\u9632\u6b62\u901a\u8fc7\u53cd\u5c04\u548c\u53cd\u5e8f\u5217\u5316\u6765\u91cd\u65b0\u521b\u5efa\u65b0\u7684\u5bf9\u8c61\n */\nenum SingletonEnum {\n    /**\n     * \u5355\u4f8b\n     */\n    INSTANCE;\n\n    public SingletonEnum getInstance() {\n        return INSTANCE;\n    }\n\n    public void m() {\n        System.out.println(\"\u679a\u4e3e\u7c7b\");\n    }\n}\n</code></pre>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%9E%8B/%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/","title":"\u7b80\u5355\u5de5\u5382\u6a21\u5f0f","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%9E%8B/%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/#simplefactory","title":"\u7b80\u5355\u5de5\u5382\u6a21\u5f0f\uff08SimpleFactory\uff09","text":"<p>\u5b9a\u4e49\u4e00\u4e2a\u521b\u5efa\u4ea7\u54c1\u5bf9\u8c61\u7684\u5de5\u5382\u63a5\u53e3\uff0c\u5c06\u4ea7\u54c1\u5bf9\u8c61\u7684\u5b9e\u9645\u521b\u5efa\u5de5\u4f5c\u63a8\u8fdf\u5230\u5177\u4f53\u5b50\u5de5\u5382\u7c7b\u5f53\u4e2d\u3002\u8fd9\u6ee1\u8db3\u521b\u5efa\u578b\u6a21\u5f0f\u4e2d\u6240\u8981\u6c42\u7684\u201c\u521b\u5efa\u4e0e\u4f7f\u7528\u76f8\u5206\u79bb\u201d\u7684\u7279\u70b9\u3002</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/","title":"Index","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/#_1","title":"\u884c\u4e3a\u6a21\u578b","text":"<ul> <li>\u6a21\u677f\u65b9\u6cd5\u6a21\u5f0f</li> <li>\u7b56\u7565\u6a21\u5f0f</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/","title":"\u547d\u4ee4\u6a21\u5f0f","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/#_1","title":"\u884c\u4e3a\u6a21\u578b\uff1a\u547d\u4ee4\u6a21\u5f0f","text":"<p>\u5982\u770b\u7535\u89c6\u65f6\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8f7b\u8f7b\u4e00\u6309\u9065\u63a7\u5668\u5c31\u80fd\u5b8c\u6210\u9891\u9053\u7684\u5207\u6362\uff0c\u8fd9\u5c31\u662f\u547d\u4ee4\u6a21\u5f0f\uff0c\u5c06\u6362\u53f0\u8bf7\u6c42\u548c\u6362\u53f0\u5904\u7406\u5b8c\u5168\u89e3\u8026\u4e86\u3002\u7535\u89c6\u673a\u9065\u63a7\u5668\uff08\u547d\u4ee4\u53d1\u9001\u8005\uff09\u901a\u8fc7\u6309\u94ae\uff08\u5177\u4f53\u547d\u4ee4\uff09\u6765\u9065\u63a7\u7535\u89c6\u673a\uff08\u547d\u4ee4\u63a5\u6536\u8005\uff09\u3002</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/#_2","title":"\u5b9a\u4e49\u4e0e\u7279\u70b9","text":"<ul> <li>\u5b9a\u4e49\uff1a\u5c06\u4e00\u4e2a\u8bf7\u6c42\u5c01\u88c5\u4e3a\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4f7f\u53d1\u51fa\u8bf7\u6c42\u7684\u8d23\u4efb\u548c\u6267\u884c\u8bf7\u6c42\u7684\u8d23\u4efb\u5206\u5272\u5f00\u3002\u8fd9\u6837\u4e24\u8005\u4e4b\u95f4\u901a\u8fc7\u547d\u4ee4\u5bf9\u8c61\u8fdb\u884c\u6c9f\u901a\uff0c\u8fd9\u6837\u65b9\u4fbf\u5c06\u547d\u4ee4\u5bf9\u8c61\u8fdb\u884c\u50a8\u5b58\u3001\u4f20\u9012\u3001\u8c03\u7528\u3001\u589e\u52a0\u4e0e\u7ba1\u7406\u3002</li> <li>\u4f18\u70b9\uff1a<ul> <li>\u5f15\u5165\u62bd\u8c61\u63a5\u53e3\u964d\u4f4e\u7cfb\u7edf\u8026\u5408\u5ea6</li> <li>\u6269\u5c55\u6027\u597d\uff0c\u589e\u52a0\u6216\u5220\u9664\u547d\u4ee4\u975e\u5e38\u65b9\u4fbf\u3002\u91c7\u7528\u547d\u4ee4\u6a21\u5f0f\u589e\u52a0\u4e0e\u5220\u9664\u547d\u4ee4\u4e0d\u4f1a\u5f71\u54cd\u5176\u4ed6\u7c7b\uff0c\u4e14\u6ee1\u8db3\u201c\u5f00\u95ed\u539f\u5219\u201d\u3002</li> <li>\u53ef\u4e0e\u591a\u79cd\u8bbe\u8ba1\u6a21\u5f0f\u7ec4\u5408\uff0c\u5982\u7ed3\u5408\u5907\u5fd8\u5f55\u6a21\u5f0f\uff0c\u5b9e\u73b0\u547d\u4ee4\u7684\u64a4\u9500\u4e0e\u6062\u590d\uff1b\u7ed3\u5408\u88c5\u9970\u5668\u6a21\u5f0f\uff0c\u66f4\u52a0\u7075\u6d3b\u589e\u52a0\u65e5\u5fd7\u8bb0\u5f55</li> </ul> </li> <li>\u7f3a\u70b9\uff1a<ul> <li>\u589e\u52a0\u7cfb\u7edf\u7684\u590d\u6742\u6027</li> </ul> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/#_3","title":"\u6a21\u5f0f\u7ed3\u6784\u4e0e\u5b9e\u73b0","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/#_4","title":"\u6a21\u5f0f\u7ed3\u6784","text":"<p>\u5305\u542b\u4ee5\u4e0b\u4e3b\u8981\u89d2\u8272\uff1a 1. \u62bd\u8c61\u547d\u4ee4\u7c7b\uff08command\uff09:\u58f0\u660e\u6267\u884c\u547d\u4ee4\u7684\u63a5\u53e3\uff0c\u62e5\u6709\u62bd\u8c61\u65b9\u6cd5execute() 2. \u5177\u4f53\u547d\u4ee4\u7c7b\uff08concrete command\uff09:\u62bd\u8c61\u547d\u4ee4\u7c7b\u7684\u5177\u4f53\u5b9e\u73b0\u7c7b\uff0c\u5b83\u62e5\u6709\u63a5\u6536\u8005\u5bf9\u8c61\uff0c\u5e76\u901a\u8fc7\u8c03\u7528\u63a5\u6536\u8005\u7684\u529f\u80fd\u6765\u5b8c\u6210\u547d\u4ee4\u8981\u6267\u884c\u7684\u64cd\u4f5c 3. \u5b9e\u73b0\u8005/\u63a5\u6536\u8005\uff08Receiver\uff09:\u6267\u884c\u547d\u4ee4\u529f\u80fd\u7684\u76f8\u5173\u64cd\u4f5c\uff0c\u662f\u5177\u4f53\u547d\u4ee4\u5bf9\u8c61\u4e1a\u52a1\u7684\u771f\u6b63\u5b9e\u73b0\u8005\u3002 4. \u8c03\u7528\u8005/\u8bf7\u6c42\u8005\uff08Invoker\uff09:\u8bf7\u6c42\u7684\u53d1\u9001\u8005\uff0c\u5b83\u901a\u5e38\u62e5\u6709\u5f88\u591a\u7684\u547d\u4ee4\u5bf9\u8c61\uff0c\u5e76\u901a\u8fc7\u8bbf\u95ee\u547d\u4ee4\u5bf9\u8c61\u6765\u6267\u884c\u76f8\u5173\u8bf7\u6c42\uff0c\u5b83\u4e0d\u76f4\u63a5\u8bbf\u95ee\u63a5\u6536\u8005</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/#_5","title":"\u6a21\u5f0f\u7684\u4ee3\u7801\u5b9e\u73b0","text":"<p>\u4ee3\u7801 \u793a\u4f8b\uff1a\u589e\u52a0\u65e5\u5fd7\u64cd\u4f5c - \u5bf9\u5916\u6a21\u677f\u8c03\u7528\u65b9\u6cd5\uff1a<code>RecordLogTemplate.class</code> <pre><code>import org.springframework.stereotype.Component;\n/**\n * @author lvite\n */\n@Component\npublic class RecordLogTemplate {\n    /**\n     * \u6dfb\u52a0\u65e5\u5fd7\n     */\n    public void addLog() {\n        AbstractLogCommand cmd = new ConcreteLogCommand();\n        LogInvoker logInvoker = new LogInvoker(cmd);\n        logInvoker.call();\n    }\n}\n</code></pre> - \u62bd\u8c61\u547d\u4ee4\u7c7b<code>AbstractLogCommand.class</code> <pre><code>/**\n * @author lviter \u65e5\u5fd7\u62bd\u8c61\u547d\u4ee4\u6a21\u5f0f\n */\npublic abstract class AbstractLogCommand {\n\n    /**\n     * \u8bb0\u5f55\u65e5\u5fd7\n     */\n    public abstract void recordLog();\n\n}\n</code></pre> - \u62bd\u8c61\u547d\u4ee4\u7684\u5177\u4f53\u5b9e\u73b0<code>ConcreteLogCommand.class</code> <pre><code>import org.springframework.stereotype.Component;\n/**\n * @author lviter \u547d\u4ee4\u6a21\u5f0f\u5b9e\u9645\u5b9e\u73b0\n */\n@Component\npublic class ConcreteLogCommand extends AbstractLogCommand {\n\n    @Override\n    public void recordLog() {\n        LogReceiver logReceiver = new LogReceiver();\n        logReceiver.addLog();\n    }\n}\n</code></pre> - \u65e5\u5fd7\u5b9e\u9645\u8c03\u7528\u8005<code>LogInvoker.class</code> <pre><code>/**\n * @author lviter \u8bb0\u5f55\u65e5\u5fd7\u8c03\u7528\u8005\n */\npublic class LogInvoker {\n\n    private AbstractLogCommand abstractLogCommand;\n\n    public LogInvoker(AbstractLogCommand abstractLogCommand) {\n        this.abstractLogCommand = abstractLogCommand;\n    }\n\n    public void call() {\n        abstractLogCommand.recordLog();\n    }\n}\n</code></pre> - \u65e5\u5fd7\u5b9e\u73b0<code>LogReceiver.class</code> <pre><code>import org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Component;\n\n/**\n * @author lviter \u5199\u65e5\u5fd7\u5b9e\u73b0\n */\n@Component\npublic class LogReceiver {\n\n    private static Logger log = LoggerFactory.getLogger(LogReceiver.class);\n\n    public void addLog() {\n        log.info(\"============================\u5199\u65e5\u5fd7\u64cd\u4f5c========================\");\n    }\n\n}\n</code></pre></p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/","title":"\u6a21\u677f\u65b9\u6cd5\u8bbe\u8ba1\u6a21\u5f0f","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#_1","title":"\u884c\u4e3a\u6a21\u578b\uff1a\u6a21\u677f\u65b9\u6cd5","text":"<p>\u8bbe\u8ba1\u4e00\u4e2a\u7cfb\u7edf\u65f6\u77e5\u9053\u4e86\u7b97\u6cd5\u6240\u9700\u7684\u5173\u952e\u6b65\u9aa4\uff0c\u800c\u4e14\u786e\u5b9a\u4e86\u8fd9\u4e9b\u6b65\u9aa4\u7684\u6267\u884c\u987a\u5e8f\uff0c\u4f46\u67d0\u4e9b\u6b65\u9aa4\u7684\u5177\u4f53\u5b9e\u73b0\u8fd8\u672a\u77e5\uff0c\u6216\u8005\u8bf4\u67d0\u4e9b\u6b65\u9aa4\u7684\u5b9e\u73b0\u4e0e\u5177\u4f53\u7684\u73af\u5883\u76f8\u5173 \u5982\uff1a\u53bb\u94f6\u884c\u529e\u7406\u4e1a\u52a1\u4e00\u822c\u8981\u7ecf\u8fc7\u4ee5\u4e0b4\u4e2a\u6d41\u7a0b\uff1a\u53d6\u53f7\u3001\u6392\u961f\u3001\u529e\u7406\u5177\u4f53\u4e1a\u52a1\u3001\u5bf9\u94f6\u884c\u5de5\u4f5c\u4eba\u5458\u8fdb\u884c\u8bc4\u5206\u7b49\uff0c\u5176\u4e2d\u53d6\u53f7\u3001\u6392\u961f\u548c\u5bf9\u94f6\u884c\u5de5\u4f5c\u4eba\u5458\u8fdb\u884c\u8bc4\u5206\u7684\u4e1a\u52a1\u5bf9\u6bcf\u4e2a\u5ba2\u6237\u662f\u4e00\u6837\u7684\uff0c\u53ef\u4ee5\u5728\u7236\u7c7b\u4e2d\u5b9e\u73b0\uff0c\u4f46\u662f\u529e\u7406\u5177\u4f53\u4e1a\u52a1\u5374\u56e0\u4eba\u800c\u5f02\uff0c\u5b83\u53ef\u80fd\u662f\u5b58\u6b3e\u3001\u53d6\u6b3e\u6216\u8005\u8f6c\u8d26\u7b49\uff0c\u53ef\u4ee5\u5ef6\u8fdf\u5230\u5b50\u7c7b\u4e2d\u5b9e\u73b0</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#_2","title":"\u6a21\u5f0f\u5b9a\u4e49\u4e0e\u7279\u70b9","text":"<ul> <li>\u8be5\u6a21\u5f0f\u7684\u4e3b\u8981\u4f18\u70b9<ol> <li>\u5b83\u5c01\u88c5\u4e86\u4e0d\u53d8\u90e8\u5206\uff0c\u6269\u5c55\u53ef\u53d8\u90e8\u5206\u3002\u5b83\u628a\u8ba4\u4e3a\u662f\u4e0d\u53d8\u90e8\u5206\u7684\u7b97\u6cd5\u5c01\u88c5\u5230\u7236\u7c7b\u4e2d\u5b9e\u73b0\uff0c\u800c\u628a\u53ef\u53d8\u90e8\u5206\u7b97\u6cd5\u7531\u5b50\u7c7b\u7ee7\u627f\u5b9e\u73b0\uff0c\u4fbf\u4e8e\u5b50\u7c7b\u7ee7\u7eed\u6269\u5c55\u3002</li> <li>\u5b83\u5728\u7236\u7c7b\u4e2d\u63d0\u53d6\u4e86\u516c\u5171\u7684\u90e8\u5206\u4ee3\u7801\uff0c\u4fbf\u4e8e\u4ee3\u7801\u590d\u7528\u3002</li> <li>\u90e8\u5206\u65b9\u6cd5\u662f\u7531\u5b50\u7c7b\u5b9e\u73b0\u7684\uff0c\u56e0\u6b64\u5b50\u7c7b\u53ef\u4ee5\u901a\u8fc7\u6269\u5c55\u65b9\u5f0f\u589e\u52a0\u76f8\u5e94\u7684\u529f\u80fd\uff0c\u7b26\u5408\u5f00\u95ed\u539f\u5219\u3002</li> </ol> </li> <li>\u8be5\u6a21\u5f0f\u4e3b\u8981\u7f3a\u70b9<ol> <li>\u5bf9\u6bcf\u4e2a\u4e0d\u540c\u7684\u5b9e\u73b0\u90fd\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a\u5b50\u7c7b\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u7c7b\u7684\u4e2a\u6570\u589e\u52a0\uff0c\u7cfb\u7edf\u66f4\u52a0\u5e9e\u5927\uff0c\u8bbe\u8ba1\u4e5f\u66f4\u52a0\u62bd\u8c61\uff0c\u95f4\u63a5\u5730\u589e\u52a0\u4e86\u7cfb\u7edf\u5b9e\u73b0\u7684\u590d\u6742\u5ea6\u3002</li> <li>\u7236\u7c7b\u4e2d\u7684\u62bd\u8c61\u65b9\u6cd5\u7531\u5b50\u7c7b\u5b9e\u73b0\uff0c\u5b50\u7c7b\u6267\u884c\u7684\u7ed3\u679c\u4f1a\u5f71\u54cd\u7236\u7c7b\u7684\u7ed3\u679c\uff0c\u8fd9\u5bfc\u81f4\u4e00\u79cd\u53cd\u5411\u7684\u63a7\u5236\u7ed3\u6784\uff0c\u5b83\u63d0\u9ad8\u4e86\u4ee3\u7801\u9605\u8bfb\u7684\u96be\u5ea6</li> <li>\u7531\u4e8e\u7ee7\u627f\u5173\u7cfb\u81ea\u8eab\u7684\u7f3a\u70b9\uff0c\u5982\u679c\u7236\u7c7b\u6dfb\u52a0\u65b0\u7684\u62bd\u8c61\u65b9\u6cd5\uff0c\u5219\u6240\u6709\u5b50\u7c7b\u90fd\u8981\u6539\u4e00\u904d\u3002</li> </ol> </li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#_3","title":"\u6a21\u5f0f\u7684\u5e94\u7528\u5b9e\u4f8b","text":"<ul> <li>\u5982\u4e0b\u4ee3\u7801\uff0c\u6839\u636e\u4e1a\u52a1\u9700\u6c42\uff0c\u624b\u673a\u53f7\u6ce8\u518c\u4ee5\u53ca\u8d26\u5bc6\u6ce8\u518c\u4e24\u79cd\u65b9\u5f0f\uff0c\u6ce8\u518c\u6d41\u7a0b\u90fd\u76f8\u540c\uff0c\u73b0\u4e1a\u52a1\u7684\u533a\u522b\u4e4b\u5904\u5728\u4e8e\u5b58\u50a8redis\u7684namespace\u4e0d\u540c\uff0c\u56e0\u6b64\u5c01\u88c5\u4e86\u4e0d\u53d8\u90e8\u5206\uff0c\u6269\u5c55\u53ef\u53d8\u90e8\u5206\uff0c\u5b9e\u73b0\u6a21\u677f\u65b9\u6cd5\u6a21\u5f0f <pre><code>import com.dadi01.scrm.foundation.model.error.ErrorEnum;\nimport com.dadi01.scrm.foundation.model.exception.ScrmException;\nimport com.dadi01.scrm.foundation.utils.date.DateRelatedUtils;\nimport com.dadi01.scrm.service.member.api.dto.request.AbstractRegisterRq;\nimport com.dadi01.scrm.service.member.provider.domain.MemberDomain;\nimport com.dadi01.scrm.service.member.provider.factory.AuthenticatorFactory;\nimport com.dadi01.scrm.service.member.provider.service.base.IBaseMemberService;\nimport com.dadi01.scrm.service.member.provider.util.CheckModelUtils;\nimport com.dadi01.scrm.service.member.provider.util.KeyGenerateUtil;\nimport org.apache.commons.lang3.StringUtils;\nimport org.springframework.beans.BeanUtils;\nimport org.springframework.stereotype.Component;\n\nimport java.text.DateFormat;\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.HashMap;\nimport java.util.Map;\n\n/**\n * @author lviter\n */\n@Component\npublic abstract class RegisterTemplate {\n\n    private final AuthenticatorFactory authenticatorFactory;\n    private final IBaseMemberService baseMemberService;\n    private final KeyGenerateUtil keyGenerateUtil;\n\n    public RegisterTemplate(AuthenticatorFactory authenticatorFactory, IBaseMemberService baseMemberService, KeyGenerateUtil keyGenerateUtil) {\n        this.authenticatorFactory = authenticatorFactory;\n        this.baseMemberService = baseMemberService;\n        this.keyGenerateUtil = keyGenerateUtil;\n    }\n\n    /**\n     * \u6ce8\u518c\u7edf\u4e00\u6a21\u677f\u65b9\u6cd5\n     *\n     * @param tenantId\n     * @param account\n     * @param abstractRegisterRq\n     */\n    public void registerTemplate(Integer tenantId, String account, AbstractRegisterRq abstractRegisterRq) {\n        Long cacheSize = getCache(tenantId, account);\n        if (null == cacheSize || cacheSize &lt;= 0) {\n            //\u521b\u5efa\u8d26\u53f7\n            Long id = generateKey();\n            saveMember(id, abstractRegisterRq);\n            //\u653e\u5165\u7f13\u5b58\n            saveCache(abstractRegisterRq.getTenantId(), account, id);\n        } else {\n            registerMemberDomainValidate(cacheSize, tenantId);\n        }\n\n    }\n\n\n    /**\n     * \u751f\u6210\u5206\u5e03\u5f0f\u4e3b\u952e\n     *\n     * @return\n     */\n    public Long generateKey() {\n        return keyGenerateUtil.generate();\n    }\n\n\n    /**\n     * \u83b7\u53d6\u7f13\u5b58\u5185\u624b\u673a\u53f7/\u8d26\u53f7\u5bf9\u5e94\u7684id\n     *\n     * @param tenantId\n     */\n    public Long getCache(Integer tenantId, String account) {\n        return (Long) getLoginUserFromCache(tenantId).get(account);\n    }\n\n    /**\n     * \u7ed3\u679c\u5b58\u5165\u7f13\u5b58\n     *\n     * @param tenantId\n     * @param account\n     * @param id\n     */\n    public void saveCache(Integer tenantId, String account, Long id) {\n        Map&lt;String, Object&gt; cache = new HashMap&lt;&gt;(2);\n        cache.put(account, id);\n        saveLoginUserToCache(tenantId, cache);\n    }\n\n\n    /**\n     * \u4ece\u7f13\u5b58\u5185\u83b7\u53d6hash\u96c6\u5408\n     *\n     * @param tenantId\n     * @return\n     */\n    public abstract Map&lt;Object, Object&gt; getLoginUserFromCache(Integer tenantId);\n\n    /**\n     * \u5b58\u50a8\u7f13\u5b58\n     *\n     * @param tenantId\n     * @param cache\n     */\n    public abstract void saveLoginUserToCache(Integer tenantId, Map&lt;String, Object&gt; cache);\n\n    /**\n     * \u4fdd\u5b58\u4f1a\u5458\u4fe1\u606f\n     *\n     * @param id\n     * @param abstractRegisterRq\n     */\n    public void saveMember(Long id, AbstractRegisterRq abstractRegisterRq) {\n        MemberDomain memberDomain = new MemberDomain(id);\n        BeanUtils.copyProperties(abstractRegisterRq, memberDomain);\n        CheckModelUtils.checkField(memberDomain);\n        if (StringUtils.isNotBlank(abstractRegisterRq.getBirth())) {\n            DateFormat fmt = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");\n            DateRelatedUtils.convertStringToLongDateString(abstractRegisterRq.getBirth());\n            try {\n                memberDomain.setBirth(fmt.parse(abstractRegisterRq.getBirth()));\n            } catch (ParseException e) {\n                throw new ScrmException(ErrorEnum.MEMBER_DATE_FORMAT_ERROR.build());\n            }\n        }\n        baseMemberService.save(memberDomain);\n    }\n\n\n    /**\n     * \u6821\u9a8c\u8d26\u6237\n     *\n     * @param id\n     * @param tenantId\n     */\n    public void registerMemberDomainValidate(Long id, Integer tenantId) {\n        authenticatorFactory.registerMemberDomainValidate(id, tenantId);\n    }\n}\n</code></pre> \u4e0a\u9762\u4ee3\u7801\u4e3a\u62bd\u8c61\u7c7b\uff0c\u5c01\u88c5\u4e86\u4e0d\u53d8\u7684\u65b9\u6cd5\u5b9e\u73b0 <pre><code>import com.dadi01.scrm.foundation.model.constant.RedisConstant;\nimport com.dadi01.scrm.service.member.provider.factory.AuthenticatorFactory;\nimport com.dadi01.scrm.service.member.provider.service.base.IBaseMemberService;\nimport com.dadi01.scrm.service.member.provider.util.KeyGenerateUtil;\nimport com.dadi01.scrm.service.member.provider.util.RedisUtil;\nimport org.springframework.stereotype.Component;\n\nimport java.util.Map;\n\n/**\n * @author lviter\n */\n@Component\npublic class PasswordRegister extends RegisterTemplate {\n\n    private final RedisUtil redisUtils;\n\n    public PasswordRegister(AuthenticatorFactory authenticatorFactory, IBaseMemberService baseMemberService, KeyGenerateUtil keyGenerateUtil, RedisUtil redisUtils) {\n        super(authenticatorFactory, baseMemberService, keyGenerateUtil);\n        this.redisUtils = redisUtils;\n    }\n\n    /**\n     * \u83b7\u53d6\u767b\u5f55\u8d26\u6237\u4ece\u7f13\u5b58\u4e2d\u662f\u5426\u5b58\u5728\n     *\n     * @param tenantId\n     * @return\n     */\n    @Override\n    public Map&lt;Object, Object&gt; getLoginUserFromCache(Integer tenantId) {\n        return redisUtils.hmget(RedisConstant.REDIS_PASSWORD_NAMESPACE.concat(String.valueOf(tenantId)));\n    }\n\n\n    /**\n     * \u4fdd\u5b58\u8d26\u6237\u5230\u7f13\u5b58\u5185\n     *\n     * @param tenantId\n     * @param memberPhoneCache\n     */\n    @Override\n    public void saveLoginUserToCache(Integer tenantId, Map&lt;String, Object&gt; memberPhoneCache) {\n        redisUtils.hmset(RedisConstant.REDIS_PASSWORD_NAMESPACE.concat(String.valueOf(tenantId)), memberPhoneCache);\n    }\n}\n</code></pre> \u4e0a\u9762\u4e3a\u8d26\u5bc6\u65b9\u5f0f\u6ce8\u518c\uff0c\u91cd\u5199\u4e86\u53ef\u53d8\u7684\u65b9\u6cd5 <pre><code>import com.dadi01.scrm.foundation.model.constant.RedisConstant;\nimport com.dadi01.scrm.service.member.provider.factory.AuthenticatorFactory;\nimport com.dadi01.scrm.service.member.provider.service.base.IBaseMemberService;\nimport com.dadi01.scrm.service.member.provider.util.KeyGenerateUtil;\nimport com.dadi01.scrm.service.member.provider.util.RedisUtil;\nimport org.springframework.stereotype.Component;\n\nimport java.util.Map;\n\n/**\n * @author lviter\n */\n@Component\npublic class SmsRegister extends RegisterTemplate {\n    private final RedisUtil redisUtils;\n\n    public SmsRegister(AuthenticatorFactory authenticatorFactory, IBaseMemberService baseMemberService, KeyGenerateUtil keyGenerateUtil, RedisUtil redisUtils) {\n        super(authenticatorFactory, baseMemberService, keyGenerateUtil);\n        this.redisUtils = redisUtils;\n    }\n\n    @Override\n    public Map&lt;Object, Object&gt; getLoginUserFromCache(Integer tenantId) {\n        return redisUtils.hmget(RedisConstant.REDIS_PHONE_NAMESPACE.concat(String.valueOf(tenantId)));\n    }\n\n    @Override\n    public void saveLoginUserToCache(Integer tenantId, Map&lt;String, Object&gt; cache) {\n        redisUtils.hmset(RedisConstant.REDIS_PHONE_NAMESPACE.concat(String.valueOf(tenantId)), cache);\n    }\n\n}\n</code></pre> \u4e0a\u9762\u4e3a\u624b\u673a\u53f7\u65b9\u5f0f\u6ce8\u518c\uff0c\u91cd\u5199\u4e86\u53ef\u53d8\u7684\u65b9\u6cd5</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/","title":"\u7b56\u7565\u6a21\u5f0f","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/#strategy-pattern","title":"\u7b56\u7565\u6a21\u5f0f(Strategy Pattern)","text":"<ul> <li>\u4ee3\u7801\u53c2\u8003</li> <li>\u4e00\u4e2a\u7c7b\u7684\u884c\u4e3a\u6216\u5176\u7b97\u6cd5\u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u66f4\u6539\u3002\u8fd9\u79cd\u7c7b\u578b\u7684\u8bbe\u8ba1\u6a21\u5f0f\u5c5e\u4e8e\u884c\u4e3a\u578b\u6a21\u5f0f</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/#_1","title":"\u4ecb\u7ecd","text":"<ul> <li>\u5e94\u7528\u80cc\u666f\uff1a1.\u805a\u5408\u767b\u5f55\u7684\u8ba4\u8bc1\u4e2d\u5fc3\uff0c\u6709\u591a\u79cd\u767b\u5f55\u65b9\u5f0f\uff0c\u8fd4\u56de\u9700\u8981\u540c\u6837\u7684token\u7ed3\u6784\uff0c\u5165\u53c2\u7ed3\u6784\u56fa\u5b9a\uff0c\u767b\u9646\u65b9\u5f0f\u4e0d\u540c\uff0c\u6240\u4ee5\u8ba4\u8bc1\u4e2d\u5fc3\u7684\u8bbe\u8ba1\uff0c\u5728\u5b9e\u73b0\u4fbf\u6377\u6269\u5c55\u4e0d\u540c\u767b\u5f55\u65b9\u5f0f\u65f6\u53ef\u4ee5\u53ea\u589e\u52a0\u4e0d\u540c\u767b\u5f55\u65b9\u5f0f\u7684\u5b9e\u73b0\u30022.\u8c03\u5ea6\u4efb\u52a1\u7684\u5f02\u5e38\u901a\u77e5\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5fae\u4fe1/\u9489\u9489/\u98de\u4e66\u7b49\u4e0d\u540c\u65b9\u5f0f\u7684\u901a\u77e5\u5b9e\u73b0</li> <li>\u4f18\u70b9\uff1a1\u3001\u5e94\u7528\u53ef\u4ee5\u81ea\u7531\u5207\u63622\u3001\u907f\u514d\u4f7f\u7528\u591a\u91cd\u6761\u4ef6\u5224\u65ad3\u3001\u6269\u5c55\u6027\u826f\u597d</li> <li>\u7f3a\u70b9\uff1a\u7b56\u7565\u7c7b\u4f1a\u589e\u591a\uff0c\u6240\u6709\u7b56\u7565\u7c7b\u90fd\u4f1a\u5806\u5916\u66b4\u6f0f</li> <li>\u5b9e\u73b0\uff1a\u5b9e\u73b0\u540c\u4e00\u4e2a\u63a5\u53e3</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/#_2","title":"\u5b9e\u73b0","text":"<p> \u521b\u5efa\u4e00\u4e2a\u5b9a\u4e49\u8ba4\u8bc1\u64cd\u4f5c\u7684\u63a5\u53e3<code>AuthService</code>,\u805a\u5408\u591a\u79cd\u670d\u52a1\u5b9e\u73b0\uff0c\u5982<code>AppleAuthServiceImpl</code>,<code>WechatAuthServiceImpl</code>\u7b49 1. \u521b\u5efa\u4e00\u4e2a\u63a5\u53e3 <pre><code>import com.security.spring.web.rq.GetTokenMessageDTO;\nimport com.security.spring.web.rs.TokenMessageDTO;\n\n/**\n * @author Administrator\n */\npublic interface AuthService {\n\n    TokenMessageDTO doAuth(GetTokenMessageDTO getTokenMessageDTO);\n}\n</code></pre> 2. \u521b\u5efa\u5b9e\u73b0\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b <pre><code>import com.security.spring.auth.AuthService;\nimport com.security.spring.web.rq.GetTokenMessageDTO;\nimport com.security.spring.web.rs.TokenMessageDTO;\nimport org.springframework.stereotype.Service;\n\n/**\n * @author Administrator\n */\n@Service\npublic class AppleAuthServiceImpl implements AuthService {\n    @Override\n    public TokenMessageDTO doAuth(GetTokenMessageDTO getTokenMessageDTO) {\n        return null;\n    }\n}\n</code></pre></p> <p><pre><code>import com.security.spring.auth.AuthService;\nimport com.security.spring.web.rq.GetTokenMessageDTO;\nimport com.security.spring.web.rs.TokenMessageDTO;\nimport org.springframework.stereotype.Service;\n\n/**\n * @author Administrator\n */\n@Service\npublic class WechatAuthServiceImpl implements AuthService {\n    @Override\n    public TokenMessageDTO doAuth(GetTokenMessageDTO getTokenMessageDTO) {\n        return null;\n    }\n}\n</code></pre> 3. \u8c03\u7528\u65b9\u91c7\u7528\u83b7\u53d6\u5230\u6240\u6709\u5b9e\u73b0\u7c7b\u7684\u65b9\u5f0f\uff0c\u88c5\u8f7d\u5165\u96c6\u5408\u5185\u5206\u522b\u8c03\u7528 <pre><code>import com.security.spring.auth.AuthService;\nimport com.security.spring.service.AuthorizationService;\nimport com.security.spring.web.rq.GetTokenMessageDTO;\nimport com.security.spring.web.rs.TokenMessageDTO;\nimport org.springframework.beans.BeansException;\nimport org.springframework.beans.factory.InitializingBean;\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.ApplicationContextAware;\nimport org.springframework.stereotype.Service;\nimport org.springframework.util.CollectionUtils;\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.concurrent.atomic.AtomicReference;\n\n/**\n * @author Administrator\n */\n@Service\npublic class AuthorizationServiceImpl implements AuthorizationService, ApplicationContextAware, InitializingBean {\n\n    private ApplicationContext applicationContext;\n    private List&lt;AuthService&gt; authServices;\n\n    @Override\n    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {\n        this.applicationContext = applicationContext;\n    }\n\n    @Override\n    public void afterPropertiesSet() {\n        Map&lt;String, AuthService&gt; serviceBeanMap = applicationContext.getBeansOfType(AuthService.class);\n        if (serviceBeanMap.size() &gt; 0) {\n            authServices = new ArrayList&lt;&gt;(serviceBeanMap.values());\n        }\n    }\n    @Override\n    public TokenMessageDTO doAuth(GetTokenMessageDTO getTokenMessageDTO) {\n        AtomicReference&lt;TokenMessageDTO&gt; tokenMessageDTO = new AtomicReference&lt;&gt;(new TokenMessageDTO());\n        if (!CollectionUtils.isEmpty(authServices)) {\n            authServices.forEach(authService -&gt; {\n                try {\n                    TokenMessageDTO messageDTO = authService.doAuth(getTokenMessageDTO);\n                    if (null != messageDTO) {\n                        tokenMessageDTO.set(messageDTO);\n                    }\n                } catch (Exception e) {\n                    System.out.println(\"\u5f02\u5e38\");\n                }\n            });\n        }\n        return tokenMessageDTO.get();\n    }\n}\n</code></pre></p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/#_3","title":"\u6ce8\u610f","text":"<p>\u5b9e\u73b0service\u7684\u5b9e\u73b0\u7c7b\u9700\u8981\u5224\u65ad\u7c7b\u578b\uff0c\u8fd4\u56de\u5f02\u5e38\u6216\u8005\u7a7a\u7686\u53ef\u5904\u7406\uff0c\u5e94\u7528\u4e0e\u8ba4\u8bc1\u4e2d\u5fc3\u9700\u8981\u6539\u9020\uff0c\u5e94\u7528\u901a\u77e5\u7c7b\u5219\u53ef\u652f\u6301\u591a\u79cd\u6e20\u9053\u540c\u4e8b\u901a\u77e5</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/","title":"\u8d23\u4efb\u94fe\u6a21\u5f0f","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%9E%8B/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/#_1","title":"\u884c\u4e3a\u6a21\u578b\uff1a\u8d23\u4efb\u94fe\u6a21\u5f0f","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/","title":"\u96c6\u5408\u6846\u67b6","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Fail-Fast/","title":"Fail-fast","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/","title":"Index","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/#interface-collectionjavautil","title":"Interface Collection(java.util)","text":"<p>\u7ecf\u5178\u56fe\u89e3  \u6240\u6709\u5df2\u77e5\u7684\u5b9e\u73b0\u7c7b\uff1a <pre><code>AbstractCollection \uff0c AbstractList \uff0c AbstractQueue \uff0c AbstractSequentialList \uff0c AbstractSet \uff0c ArrayBlockingQueue \uff0c ArrayDeque \uff0c ArrayList \uff0c AttributeList \uff0c BeanContextServicesSupport \uff0c BeanContextSupport \uff0c ConcurrentHashMap.KeySetView \uff0c ConcurrentLinkedDeque \uff0c ConcurrentLinkedQueue \uff0c ConcurrentSkipListSet \uff0c CopyOnWriteArrayList \uff0c CopyOnWriteArraySet \uff0c DelayQueue \uff0c EnumSet \uff0c HashSet \uff0c JobStateReasons \uff0c LinkedBlockingDeque \uff0c LinkedBlockingQueue \uff0c LinkedHashSet \uff0c LinkedList \uff0c LinkedTransferQueue \uff0c PriorityBlockingQueue \uff0c PriorityQueue \uff0c RoleList \uff0c RoleUnresolvedList \uff0c Stack \uff0c SynchronousQueue \uff0c TreeSet \uff0c Vector \n</code></pre></p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/#_1","title":"\u6570\u7ec4\u53ef\u4ee5\u5145\u5f53\u96c6\u5408\uff0c\u4e3a\u4ec0\u4e48\u8fd8\u9700\u8981\u5176\u4ed6\u7684\u96c6\u5408\u7c7b","text":"<ul> <li>\u6570\u7ec4\u521d\u59cb\u5316\u540e\u5927\u5c0f\u4e0d\u53ef\u53d8</li> <li>\u6570\u7ec4\u53ea\u80fd\u6309\u7d22\u5f15\u987a\u5e8f\u5b58\u53d6</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/#collection","title":"Collection","text":"<p>java.util\u5305\u4e2d\u4e3b\u8981\u63d0\u4f9b\u4e86\u4e09\u79cd\u7c7b\u578b\u7684\u96c6\u5408\uff1a - List \u4e00\u79cd\u6709\u5e8f\u5217\u8868\u7684\u96c6\u5408 - Set \u4e00\u79cd\u4fdd\u8bc1\u6ca1\u6709\u91cd\u590d\u5143\u7d20\u7684\u96c6\u5408 - Map \u4e00\u79cd\u952e\u503c\u5bf9\u67e5\u627e\u7684\u6620\u5c04\u8868\u96c6\u5408</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/#_2","title":"\u96c6\u5408\u5185\u9057\u7559\u7c7b","text":"<ul> <li>Hashtable\uff1a\u4e00\u79cd\u65b0\u57ce\u5b89\u5168\u7684Map\u5b9e\u73b0</li> <li>Vector:\u4e00\u79cd\u7ebf\u7a0b\u5b89\u5168\u7684List\u5b9e\u73b0</li> <li>Stack:\u57fa\u4e8eVector\u5b9e\u73b0\u7684LIFO\u6808</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/#_3","title":"\u5e38\u7528\u96c6\u5408\u8be6\u89e3","text":"<ul> <li>ArrayList</li> <li>CopyOnWriteArrayList</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/ArrayList%E8%AF%A6%E8%A7%A3/","title":"ArrayList\u8be6\u89e3","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/ArrayList%E8%AF%A6%E8%A7%A3/#arraylist","title":"ArrayList","text":"<p>ArrayList\u662f\u5b9e\u73b0\u4e86List\u7684\u52a8\u6001\u6570\u7ec4\uff0c\u6bcf\u4e2aArrayList\u5b9e\u4f8b\u90fd\u6709\u4e00\u4e2a\u5bb9\u91cf\uff0c\u5bb9\u91cf\u7528\u6765\u6307\u5b9a\u6570  \u7ec4\u7684\u5927\u5c0f\u3002\u9ed8\u8ba4\u521d\u59cb\u5bb9\u91cf\u662f10\uff0cArrayList\u4e2d\u5143\u7d20\u589e\u52a0\uff0c\u5bb9\u91cf\u4e5f\u4f1a\u4e0d\u65ad\u7684\u81ea\u52a8\u589e\u957f\u3002\u6bcf\u6b21\u6dfb\u52a0\u5143\u7d20\u65f6\uff0cArrayList\u90fd\u4f1a\u68c0\u67e5\u662f\u5426\u9700\u8981\u8fdb\u884c\u6269\u5bb9.</p> <ul> <li>\u968f\u673a\u5143\u7d20\u65f6\u95f4\u590d\u6742\u5ea6O(1),\u63d2\u5165\u5220\u9664\u64cd\u4f5c\u9700\u8981\u5927\u91cf\u79fb\u52a8\u5143\u7d20\uff0c\u6548\u7387\u8f83\u4f4e\uff08\u94fe\u8868\u7279\u6027\uff09</li> <li>\u5bb9\u5668\u5e95\u5c42\u91c7\u7528\u6570\u7ec4\u5b58\u50a8\uff0c\u6bcf\u6b21\u6269\u5bb91.5\u500d</li> <li>ArrayList\u7684\u5b9e\u73b0\u4e2d\u5927\u91cf\u5730\u8c03\u7528\u4e86Arrays.copyof()\u548cSystem.arraycopy()\u65b9\u6cd5\uff0c\u5176\u5b9eArrays.copyof()\u5185\u90e8\u4e5f\u662f\u8c03\u7528System.arraycopy()\u3002System.arraycopy()\u4e3aNative\u65b9\u6cd5</li> <li>\u53ef\u4ee5\u5b58\u50a8null\u503c</li> <li>ArrayList \u6bcf\u6b21\u4fee\u6539\uff08\u589e\u52a0\u3001\u5220\u9664\uff09\u5bb9\u5668\u65f6\uff0c\u90fd\u662f\u4fee\u6539\u81ea\u8eab\u7684 modCount\uff1b\u5728\u751f\u6210\u8fed\u4ee3\u5668\u65f6\uff0c\u8fed\u4ee3\u5668\u4f1a\u4fdd\u5b58\u8be5 modCount \u503c\uff0c\u8fed\u4ee3\u5668\u6bcf\u6b21\u83b7\u53d6\u5143\u7d20\u65f6\uff0c\u4f1a\u6bd4\u8f83\u81ea\u8eab\u7684 modCount \u4e0e ArrayList \u7684   modCount\u662f\u5426\u76f8\u7b49\uff0c\u6765\u5224\u65ad\u5bb9\u5668\u662f\u5426\u5df2\u7ecf\u88ab\u4fee\u6539\uff0c\u5982\u679c\u88ab\u4fee\u6539\u4e86\u5219\u629b\u51fa\u5f02 \u5e38\uff08fast-fail \u673a\u5236\uff09\u3002</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/ArrayList%E8%AF%A6%E8%A7%A3/#arraylist_1","title":"ArrayList\u6e90\u7801\u89e3\u8bfb","text":"<ol> <li>\u5e95\u5c42\u4f7f\u7528\u6570\u7ec4 <pre><code>  /**\n     * The array buffer into which the elements of the ArrayList are stored.\n     * The capacity of the ArrayList is the length of this array buffer. Any\n     * empty ArrayList with elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA\n     * will be expanded to DEFAULT_CAPACITY when the first element is added.\n     */\n    transient Object[] elementData; // non-private to simplify nested class access\n</code></pre> transient\u4e3a\u53d8\u91cf\u4fee\u9970\u7b26\uff0c\u5f53\u6301\u4e45\u5316\u5bf9\u8c61\u65f6\uff0c\u53ef\u80fd\u6709\u4e00\u4e2a\u7279\u6b8a\u7684\u5bf9\u8c61\u6570\u636e\u6210\u5458\uff0c\u6211\u4eec\u4e0d\u60f3\u7528serialization\u673a\u5236\u6765\u4fdd\u5b58\u5b83\u3002\u4e3a\u4e86\u5728\u4e00\u4e2a\u7279\u5b9a\u5bf9\u8c61\u7684\u4e00\u4e2a\u57df\u4e0a\u5173\u95edserialization\uff0c\u53ef\u4ee5\u5728\u8fd9\u4e2a\u57df\u524d\u52a0\u4e0a\u5173\u952e\u5b57transient\u3002\u5f53\u4e00\u4e2a\u5bf9\u8c61\u88ab\u5e8f\u5217\u5316\u7684\u65f6\u5019\uff0ctransient\u578b\u53d8\u91cf\u7684\u503c\u4e0d\u5305\u62ec\u5728\u5e8f\u5217\u5316\u7684\u8868\u793a\u4e2d\uff0c\u7136\u800c\u975etransient\u578b\u7684\u53d8\u91cf\u662f\u88ab\u5305\u62ec\u8fdb\u53bb\u7684\u3002</li> <li>ArrayList\u63d0\u4f9b\u4e86add(E e)\u3001add(int index, E element)\u3001addAll(Collection&lt;? extends E&gt; c)\u3001addAll(int index, Collection&lt;? extends E&gt; c)\u3001set(int index, E element)\u8fd9\u4e2a\u4e94\u4e2a\u65b9\u6cd5\u6765\u5b9e\u73b0ArrayList\u589e\u52a0 <pre><code>   /**\n     * Appends the specified element to the end of this list.\n     *\n     * @param e element to be appended to this list\n     * @return &lt;tt&gt;true&lt;/tt&gt; (as specified by {@link Collection#add})\n     */\n    public boolean add(E e) {\n        ensureCapacityInternal(size + 1);  // Increments modCount!!\n        elementData[size++] = e;\n        return true;\n    }\n</code></pre> add \u65b9\u6cd5\u7b2c\u4e00\u6b65\u64cd\u4f5c\u4f1a\u53bb\u5224\u65ad\u662f\u5426\u6269\u5bb9\uff0csize\u4e3a\u6570\u7ec4\u5185\u5df2\u6709\u5143\u7d20\u7684\u957f\u5ea6\uff1b\u7b2c\u4e8c\u6b65\u64cd\u4f5c\u662f\u5c06\u65b0\u7684\u503ce\u63d2\u5165\u6570\u7ec4\u7684\u5c3e\u90e8 <pre><code>    /**\n     * Inserts the specified element at the specified position in this\n     * list. Shifts the element currently at that position (if any) and\n     * any subsequent elements to the right (adds one to their indices).\n     *\n     * @param index index at which the specified element is to be inserted\n     * @param element element to be inserted\n     * @throws IndexOutOfBoundsException {@inheritDoc}\n     */\n    public void add(int index, E element) {\n        rangeCheckForAdd(index);\n\n        ensureCapacityInternal(size + 1);  // Increments modCount!!\n        System.arraycopy(elementData, index, elementData, index + 1,\n                         size - index);\n        elementData[index] = element;\n        size++;\n    }\n</code></pre> \u5c06element\u63d2\u5165\u6570\u7ec4\u5185\u6307\u5b9aindex\u7684\u4f4d\u7f6e</li> </ol>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/ArrayList%E8%AF%A6%E8%A7%A3/#arraylist_2","title":"\u89e3\u51b3arraylist\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898","text":"<p>\u5728\u591a\u7ebf\u7a0b\u5e76\u53d1\u573a\u666f\u4e0b\uff0caraylist\u7684add\u64cd\u4f5c\u53ef\u80fd\u5bfc\u81f4\uff1a\u63d2\u5165null\u503c\uff1b\u5c11\u63d2\u5165\u503c\uff1b\u63d2\u5165\u503c\u8d85\u8fc7\u6570\u7ec4\u957f\u5ea6\u3002\u89e3\u51b3arraylist\u5e76\u53d1\u5bfc\u81f4\u7684\u95ee\u9898\uff0c\u6709\u4ee5\u4e0b\u51e0\u4e2a\u89e3\u51b3\u65b9\u6848\uff1a 1. \u4f7f\u7528Collections.synchronizedList()\u65b9\u6cd5\uff0c\u76f8\u5f53\u4e8esynchronized\u540c\u6b65\u9501\uff0c\u4e0d\u5efa\u8bae\u4f7f\u7528\uff0c\u5f71\u54cd\u6027\u80fd 2. \u4f7f\u7528CopyOnWriteArrayList\uff0cReentrantLock\u53ef\u91cd\u5165\u9501 <pre><code>public class CopyOnWriteArrayListTest {\n    public static void main(String[] args) {\n\n        CopyOnWriteArrayList&lt;String&gt; copyOnWriteArrayList = new CopyOnWriteArrayList();\n        for (int i = 0; i &lt; 3; i++) {\n            new Thread(() -&gt; {\n                copyOnWriteArrayList.add(UUID.randomUUID().toString().substring(0, 8));\n                try {\n                    Thread.sleep(1000);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                System.out.println(copyOnWriteArrayList);\n            }, \"t1\").start();\n        }\n    }\n}\n\nclass ArrayListDemo {\n\n    public static List&lt;String&gt; addArrayList() {\n        List&lt;String&gt; strings = new ArrayList&lt;&gt;();\n        strings.add(UUID.randomUUID().toString().substring(0, 8));\n        return strings;\n    }\n\n}\n\nclass ArrayListSync {\n    public static List&lt;String&gt; addArrayList() {\n        List&lt;String&gt; strings = Collections.synchronizedList(new ArrayList&lt;&gt;());\n        strings.add(UUID.randomUUID().toString().substring(0, 8));\n        return strings;\n    }\n}\n</code></pre></p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/CopyOnWriteArrayList%E8%AF%A6%E8%A7%A3/","title":"CopyOnWriteArrayList\u8be6\u89e3","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/CopyOnWriteArrayList%E8%AF%A6%E8%A7%A3/#_1","title":"\u5199\u5165\u65f6\u590d\u5236\u601d\u60f3","text":"<p>\u5199\u5165\u65f6\u590d\u5236\uff08CopyOnWrite\uff0c\u7b80\u79f0COW\uff09\u601d\u60f3\u662f\u8ba1\u7b97\u673a\u7a0b\u5e8f\u8bbe\u8ba1\u9886\u57df\u4e2d\u7684\u4e00\u79cd\u4f18\u5316\u7b56\u7565\u3002\u5176\u6838\u5fc3\u601d\u60f3\u662f\uff0c\u5982\u679c\u6709\u591a\u4e2a\u8c03\u7528\u8005\uff08Callers\uff09\u540c\u65f6\u8981\u6c42\u76f8\u540c\u7684\u8d44\u6e90\uff08\u5982\u5185\u5b58\u6216\u8005\u662f\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u5b58\u50a8\uff09\uff0c\u4ed6\u4eec\u4f1a\u5171\u540c\u83b7\u53d6\u76f8\u540c\u7684\u6307\u9488\u6307\u5411\u76f8\u540c\u7684\u8d44\u6e90\uff0c\u76f4\u5230\u67d0\u4e2a\u8c03\u7528\u8005\u89c6\u56fe\u4fee\u6539\u8d44\u6e90\u5185\u5bb9\u65f6\uff0c\u7cfb\u7edf\u624d\u4f1a\u771f\u6b63\u590d\u5236\u4e00\u4efd\u4e13\u7528\u526f\u672c\uff08private copy\uff09\u7ed9\u8be5\u8c03\u7528\u8005\uff0c\u800c\u5176\u4ed6\u8c03\u7528\u8005\u6240\u89c1\u5230\u7684\u6700\u521d\u7684\u8d44\u6e90\u4ecd\u7136\u4fdd\u6301\u4e0d\u53d8\u3002\u8fd9\u8fc7\u7a0b\u5bf9\u5176\u4ed6\u7684\u8c03\u7528\u8005\u90fd\u662f\u900f\u660e\u7684\uff08transparently\uff09\u3002\u6b64\u505a\u6cd5\u4e3b\u8981\u7684\u4f18\u70b9\u662f\u5982\u679c\u8c03\u7528\u8005\u6ca1\u6709\u4fee\u6539\u8d44\u6e90\uff0c\u5c31\u4e0d\u4f1a\u6709\u526f\u672c\uff08private copy\uff09\u88ab\u521b\u5efa\uff0c\u56e0\u6b64\u591a\u4e2a\u8c03\u7528\u8005\u53ea\u662f\u8bfb\u53d6\u64cd\u4f5c\u65f6\u53ef\u4ee5\u5171\u4eab\u540c\u4e00\u4efd\u8d44\u6e90</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/CopyOnWriteArrayList%E8%AF%A6%E8%A7%A3/#_2","title":"\u4f7f\u7528\u573a\u666f","text":"<p>\u8bfb\u591a\u5199\u5c11\u7684\u60c5\u51b5</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/CopyOnWriteArrayList%E8%AF%A6%E8%A7%A3/#copyonwritearraylist","title":"CopyOnWriteArrayList","text":"<p>\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0cadd\u64cd\u4f5c\u4f1a\u5148copy\u4e00\u4efd\u539f\u6570\u7ec4\uff0c\u6570\u7ec4\u957f\u5ea6+1\uff0c\u4fee\u6539\u5b8c\u4e4b\u540e\uff0c\u5c06\u539f\u6765\u7684\u5f15\u7528\u6307\u5411\u65b0copy\u7684\u6570\u7ec4\u3002\u4ee5\u4e0b\u662f\u6e90\u7801\u90e8\u5206\uff1a</p> <pre><code>  /**\n * Appends the specified element to the end of this list.\n *\n * @param e element to be appended to this list\n * @return {@code true} (as specified by {@link Collection#add})\n */\npublic boolean add(E e){\nfinal ReentrantLock lock=this.lock;\n        lock.lock();\n        try{\n        Object[]elements=getArray();\n        int len=elements.length;\n        Object[]newElements=Arrays.copyOf(elements,len+1);\n        newElements[len]=e;\n        // \u7136\u540e\u628a\u526f\u672c\u6570\u7ec4\u8d4b\u503c\u7ed9volatile\u4fee\u9970\u7684\u53d8\u91cf\n        setArray(newElements);\n        return true;\n        }finally{\n        lock.unlock();\n        }\n        }\n</code></pre> <ul> <li>ReetrantLock\u662f\u53ef\u91cd\u5165\u9501   \uff0c\u540c\u4e00\u65f6\u95f4\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u66f4\u65b0,CopyOnWriteArrayList\u4f7f\u7528\u53ef\u91cd\u5165\u9501\u4e0d\u9002\u7528synchronized\u7684\u539f\u56e0\u662f\u6574\u4e2aCopyOnWriteArrayList\u4f7f\u7528\u7684\u662f\u540c\u4e00\u628a\u9501\uff0c\u5728\u64cd\u4f5cadd/set/remove\u8fd9\u4e9b\u65b9\u6cd5\u7684\u65f6\u5019\u540c\u4e00\u65f6\u95f4\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u4fee\u6539\u6210\u529f</li> <li>\u53ef\u4ee5\u770b\u5230<code>Object[] newElements = Arrays.copyOf(elements, len + 1);</code>new\u4e86\u4e00\u4e2a\u65b0\u7684\u6570\u7ec4\uff0c\u7531\u539f\u6765\u7684\u6570\u7ec4copy\u8fc7\u6765\uff0csize\u8bbe\u7f6e\u4e3a\u539f\u6765\u7684\u6570\u7ec4\u957f\u5ea6+1.</li> <li>\u5173\u952e\u95ee\u9898\uff0c\u5199\u7ebf\u7a0b\u73b0\u5728\u628a\u526f\u672c\u6570\u7ec4\u7ed9\u4fee\u6539\u5b8c\u4e86\uff0c\u73b0\u5728\u600e\u4e48\u624d\u80fd\u8ba9\u8bfb\u7ebf\u7a0b\u611f\u77e5\u5230\u8fd9\u4e2a\u53d8\u5316\uff1f===\u52a0\u4e0avolatile\u5173\u952e\u5b57\uff08\u53ef\u89c1\u6027\uff09</li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/HashSet%E8%AF%A6%E8%A7%A3/","title":"HashSet\u8be6\u89e3","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/HashSet%E8%AF%A6%E8%A7%A3/#hashset","title":"HashSet","text":"<ul> <li>HashSet\u662f\u7ebf\u7a0b\u4e0d\u5b89\u5168\u7684</li> <li>\u5e95\u5c42\u4f7f\u7528HashMap,hastSet\u7684add\u503c\u4f7f\u7528\u7684HashMap\u7684key\u505a\u5b58\u50a8\uff0c\u5982\u4e0b\u6e90\u4ee3\u7801\uff1a <pre><code>  /**\n     * Constructs a new, empty set; the backing &lt;tt&gt;HashMap&lt;/tt&gt; instance has\n     * default initial capacity (16) and load factor (0.75).\n     */\n    public HashSet() {\n        map = new HashMap&lt;&gt;();\n    }\n</code></pre> \u4e0a\u9762\u4ee3\u7801\u662f\u521d\u59cb\u5316HashSet\u7684\u65f6\u5019\u5e95\u5c42\u4f7f\u7528HashMap\u521d\u59cb\u5316\u957f\u5ea616\uff0c0.75\u7684\u52a0\u8f7d\u56e0\u5b50 <pre><code>public boolean add(E e) {\n        return map.put(e, PRESENT)==null;\n    }\n</code></pre></li> </ul>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/Map%E8%AF%A6%E8%A7%A3/","title":"Map\u8be6\u89e3","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/Map%E8%AF%A6%E8%A7%A3/#map","title":"Map\u8be6\u89e3","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/Queue/","title":"Queue","text":"<p>//TODO:</p>"},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/Queue/#concurrentlinkedqueue","title":"ConcurrentLinkedQueue","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/Queue/#concurrentlinkeddeque","title":"ConcurrentLinkedDeque","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/Queue/#blockingqueue","title":"BlockingQueue","text":""},{"location":"Java-%E6%A0%B8%E5%BF%83/%E9%9B%86%E5%90%88/Collection/Queue/#_1","title":"Queue","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/","title":"Index","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/#_1","title":"\u4e2d\u95f4\u4ef6","text":"<ul> <li>es</li> <li>redis</li> <li>postgressql</li> <li>RabbitMQ</li> <li>Kafka</li> </ul>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/Es-Nested%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A2/","title":"Es Nested\u5d4c\u5957\u67e5\u8be2","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/Es-Nested%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A2/#es-","title":"ES-\u5d4c\u5957\u67e5\u8be2","text":"<p>ES\u7d22\u5f15\u7ed3\u6784\u672c\u8eab\u5b58\u50a8\u662f\u6241\u5e73\u5316\u5b58\u50a8\uff0c\u5982\u4e0b\u4f8b\u5b50</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/Es-Nested%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A2/#_1","title":"\u80cc\u666f","text":"<ol> <li>\u770b\u5982\u4e0b\u793a\u4f8b,\u4e00\u4e2a\u8ba2\u5355\u4fe1\u606f\uff0c\u5bf9\u5e94\u591a\u4e2a\u8d39\u7528\u9879\u6570\u636e</li> </ol> <p><pre><code>{\n  \"orderNumber\": \"YY2201-12345678\",\n  \"remark\": \"\u8fd9\u91cc\u662f\u5907\u6ce8\",\n  \"waybillNumbers\": [\"YD2201-12345678\", \"YD2201-12345679\"],\n  \"creationDate\": 1663658432000,\n  \"costItemInfos\": [\n    {\n      \"name\": \"\u6263\u6b3e1\",\n      \"amount\": 34,\n      \"fromSource\": 8,\n      \"comment\": \"\u56e0\u4e3a\u5565\u6263\u6b3e\"\n    },\n    {\n      \"name\": \"\u6263\u6b3e2\",\n      \"amount\": 38,\n      \"fromSource\": 9,\n      \"comment\": \"\u56e0\u4e3a\u5565\u6263\u6b3e2\"\n    },\n    {\n      \"name\": \"\u8865\u8d341\",\n      \"amount\": 33,\n      \"fromSource\": 7,\n      \"comment\": \"\u56e0\u4e3a\u5565\u6263\u6b3e3\"\n    }\n  ]\n}\n</code></pre> 2. \u95ee\u9898 \u5982\u679c\u6211\u4eec\u73b0\u5728\u60f3\u67e5\u8be2{\"name\": \"\u6263\u6b3e2\",\"amount\":34}\u7684\u8ba2\u5355\uff0c\u53d1\u73b0\u4f9d\u7136\u53ef\u4ee5\u628a\u4e0a\u9762\u7684\u6570\u636e\u67e5\u8be2\u51fa\u6765\uff0c\u7136\u800c\u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u5e76\u4e0d\u5b58\u5728\u6263\u6b3e2 \u91d1\u989d34\u7684\u8d39\u7528\u9879\u3002</p> <p><pre><code>GET /order/_search?pretty\n{\n  \"query\": {\n    \"bool\": {\n      \"must\": [\n        {\n          \"match\": {\n            \"costItemInfos.name\": \"\u6263\u6b3e2\"\n          }\n        },\n        {\n          \"match\": {\n            \"costItemInfos.amount\": 34\n          }\n        }\n      ]\n    }\n  }\n}\n</code></pre> 3. \u539f\u56e0\u5206\u6790 \u56e0\u4e3aES\uff08lucene\uff09\u5b58\u50a8\u7ed3\u6784\u662f\u6241\u5e73\u5316\u5b58\u50a8\uff0c\u5982\u793a\u4f8b\u7684\u6587\u6863\u5728es\u5185\u5b58\u50a8\u7ed3\u6784\u5b9e\u9645\u4e0a\u662f\u8fd9\u6837\u7684\uff1a</p> <p><pre><code>{\n  \"orderNumber\":                    [ YY2201-12345678, YY2201-12345679 ],\n  \"remark\":                     [ \u8fd9\u91cc\u662f\u5907\u6ce8,\u8fd9\u91cc\u662f\u5907\u6ce82 ],\n  \"waybillNumbers\":                     [ \"YD2201-12345678\", \"YD2201-12345679\" ],\n  \"creationDate\":             [ 1663658432000 ]\n  \"costItemInfos.name\":            [ \u6263\u6b3e1,\u6263\u6b3e2,\u6263\u6b3e3 ],\n  \"costItemInfos.amount\":             [ 33, 34, 38 ],\n  \"costItemInfos.fromSource\":          [ 7, 8, 9 ],\n  \"costItemInfos.comment\":    [ \u56e0\u4e3a\u5565\u6263\u6b3e,\u56e0\u4e3a\u5565\u6263\u6b3e2,\u56e0\u4e3a\u5565\u6263\u6b3e3 ]\n}\n</code></pre> \u6240\u4ee5\u6839\u636e\u91d1\u989d\u4ee5\u53ca\u8d39\u7528\u9879\u540d\u79f0\u6765\u67e5\u8be2\u662f\u53ef\u4ee5\u5339\u914d\u5230\u7684\uff0c\u7136\u800c\u8d39\u7528\u9879\u540d\u79f0\u4e0e\u91d1\u989d\u7684\u5173\u7cfb\u5df2\u7ecf\u4e0d\u5b58\u5728</p> <ol> <li>\u5982\u4f55\u89e3\u51b3\uff1f \u89e3\u51b3\u53ea\u9700\u8981\u5c06costItemInfos\u7684\u7c7b\u578b\u6307\u5b9a\u4e3aNested\u7c7b\u578b\u5373\u53ef</li> </ol> <p><pre><code>PUT /order_new\n{\n  \"mappings\": {\n    \"order\": {\n      \"properties\": {\n        \"orderNumber\": {\n          \"type\": \"keyword\"\n        },\n        \"remark\": {\n          \"fields\": {\n            \"raw\": {\n              \"null_value\": \"\",\n              \"type\": \"keyword\"\n            }\n          },\n          \"type\": \"text\"\n        },\n        \"waybillNumbers\": {\n          \"type\": \"keyword\"\n        },\n        \"creationDate\": {\n          \"type\": \"date\",\n                \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\"\n        },\n        \"costItemInfos\": {\n          \"type\": \"nested\",\n          \"properties\": {\n            \"name\": {\n              \"type\": \"text\"\n            },\n            \"amount\": {\n              \"type\": \"double\"\n            },\n            \"fromSource\": {\n              \"type\": \"keyword\"\n            },\n            \"comment\": {\n              \"type\": \"text\"\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</code></pre> \u90a3\u4e48\u76f8\u5bf9\u5e94\u7684\u67e5\u8be2\u65b9\u5f0f\u505a\u4e00\u4e0b\u6539\u53d8\uff0c\u4f7f\u7528Nested\u67e5\u8be2</p> <pre><code>GET /blog_new/_search?pretty\n{\n  \"query\": {\n    \"bool\": {\n      \"must\": [\n        {\n          \"nested\": {\n            \"path\": \"costItemInfos\",\n            \"query\": {\n              \"bool\": {\n                \"must\": [\n                  {\n                    \"match\": {\n                      \"costItemInfos.name\": \"\u6263\u6b3e1\"\n                    }\n                  },\n                  {\n                    \"match\": {\n                      \"costItemInfos.amount\": 34\n                    }\n                  }\n                ]\n              }\n            }\n          }\n        }\n      ]\n    }\n  }\n}\n</code></pre> <ol> <li>\u6269\u5c55\uff0c\u9ad8\u9636\u67e5\u8be2\uff0cnested\u805a\u5408\u5206\u7ec4\u7edf\u8ba1 <pre><code>{\n  \"query\": {\n    \"bool\": {\n      \"must\": [\n        {\n          \"terms\": {\n            \"userId\": [\n              12312312312312\n            ]\n          }\n        }\n      ]\n    }\n  },\n  \"aggs\": {\n    \"itemNest\": {\n      \"nested\": {\n        \"path\": \"costItemInfos\"\n      },\n      \"aggs\": {\n        \"costItemCodeGroup\": {\n          \"terms\": {\n            \"field\": \"costItemInfos.costCode\"\n          },\n          \"aggs\": {\n            \"amount\": {\n              \"sum\": {\n                \"field\": \"costItemInfos.amount\"\n              }\n            },\n            \"orderCount\": {\n              \"value_count\": {\n                \"field\": \"_id\"\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</code></pre></li> </ol>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/Es7.4.2-RestHighLevelClient%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/","title":"Es7.4.2 RestHighLevelClient\u589e\u5220\u6539\u67e5","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/Es7.4.2-RestHighLevelClient%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/#javaes","title":"java\u64cd\u4f5ces\u65b9\u5f0f","text":"<ul> <li>http</li> <li>\u64cd\u4f5ces\u4f7f\u7528\u7684\u65b9\u5f0f\u4e3ahttp\u65b9\u5f0f\uff0c\u9700\u8981springboot\u7684pom\u4f9d\u8d56\uff0c\u6211\u4f7f\u7528\u7684\u7248\u672c\u4e3a\uff1a7.4.2\uff0ces\u5bf9\u5e94\u7684\u7248\u672c\u4e3a\uff1a7.4.2\uff0cspringboot\u7684\u7248\u672c\u4e3a\uff1a2.2.1.RELEASE</li> </ul>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/Es7.4.2-RestHighLevelClient%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/#java","title":"java\u4f7f\u7528\u65b9\u5f0f","text":"<ul> <li>\u5f15\u5165pom\u4f9d\u8d56</li> </ul> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.elasticsearch&lt;/groupId&gt;\n    &lt;artifactId&gt;elasticsearch&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt;\n    &lt;artifactId&gt;elasticsearch-rest-client&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt;\n    &lt;artifactId&gt;elasticsearch-rest-high-level-client&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <ul> <li>es\u914d\u7f6e</li> </ul> <pre><code>elasticsearch.port=9200\nelasticsearch.username=elastic\nelasticsearch.password=123\nelasticsearch.cluster.address=http://p.es.net\nelasticsearch.shards=1\nelasticsearch.replicas=0\nelasticsearch.connect_timeout=5000\nelasticsearch.socket_timeout=60000\n</code></pre> <ul> <li>ElasticSearchConfig.class</li> </ul> <pre><code>package com.dadi01.scrm.service.mot.provider.config;\n\nimport com.dadi01.scrm.foundation.model.constant.StringPool;\nimport lombok.extern.slf4j.Slf4j;\nimport org.apache.http.Header;\nimport org.apache.http.HttpHost;\nimport org.apache.http.auth.AuthScope;\nimport org.apache.http.auth.UsernamePasswordCredentials;\nimport org.apache.http.client.CredentialsProvider;\nimport org.apache.http.impl.client.BasicCredentialsProvider;\nimport org.apache.http.message.BasicHeader;\nimport org.elasticsearch.client.*;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\n/**\n * @author lviter\n */\n@Slf4j\n@Configuration\npublic class ElasticSearchConfig {\n\n    @Value(\"${elasticsearch.cluster.address}\")\n    private String clusterAddress;\n\n    @Value(\"${elasticsearch.username}\")\n    private String username;\n\n    @Value(\"${elasticsearch.password}\")\n    private String password;\n\n    @Value(\"${elasticsearch.shards}\")\n    private Integer numberOfShards;\n\n    @Value(\"${elasticsearch.replicas}\")\n    private Integer numberOfReplicas;\n\n    @Value(\"${elasticsearch.connect_timeout}\")\n    private Long connectTimeout;\n\n    @Value(\"${elasticsearch.socket_timeout}\")\n    private Long socketTimeout;\n\n    public static RestHighLevelClient client = null;\n\n    public Integer getNumberOfShards() {\n        return numberOfShards;\n    }\n\n    public Integer getNumberOfReplicas() {\n        return numberOfReplicas;\n    }\n\n    /**\n     * @return \u8fde\u63a5es\n     */\n    @Bean\n    public RestHighLevelClient restClient() {\n        final CredentialsProvider credentialsProvider = new BasicCredentialsProvider();\n        credentialsProvider.setCredentials(AuthScope.ANY,\n                new UsernamePasswordCredentials(username, password));\n        Header[] defaultHeaders = {new BasicHeader(\"content-type\", \"application/json\")};\n        RestClientBuilder restClientBuilder = RestClient.builder(HttpHost.create(clusterAddress));\n        restClientBuilder\n                .setHttpClientConfigCallback(httpAsyncClientBuilder -&gt; httpAsyncClientBuilder.setDefaultCredentialsProvider(credentialsProvider))\n                .setDefaultHeaders(defaultHeaders)\n                .setRequestConfigCallback(requestConfigBuilder -&gt; {\n                    // \u8fde\u63a55\u79d2\u8d85\u65f6\uff0c\u5957\u63a5\u5b57\u8fde\u63a560s\u8d85\u65f6\n                    return requestConfigBuilder.setConnectTimeout(connectTimeout.intValue()).setSocketTimeout(socketTimeout.intValue());\n                })\n                .setHttpClientConfigCallback(httpClientBuilder -&gt; {\n                    httpClientBuilder.disableAuthCaching();\n                    return httpClientBuilder.setDefaultCredentialsProvider(credentialsProvider);\n                });\n\n        client = new RestHighLevelClient(restClientBuilder);\n        return client;\n    }\n\n    private List&lt;HttpHost&gt; createHttpHostList() {\n        List&lt;HttpHost&gt; hostList = new ArrayList&lt;&gt;();\n        String[] hostNamesPort;\n        if (!clusterAddress.contains(StringPool.COMMA)) {\n            hostNamesPort = new String[]{clusterAddress};\n        } else {\n            hostNamesPort = clusterAddress.split(\",\");\n        }\n        for (String host : hostNamesPort) {\n            hostList.add(new HttpHost(host.substring(0, host.indexOf(StringPool.COLON)), Integer.parseInt(host.substring(host.indexOf(StringPool.COLON) + 1))));\n        }\n        return hostList;\n    }\n\n}\n</code></pre> <ul> <li>EsSettingsConstant.class</li> </ul> <pre><code>package com.dadi01.scrm.service.mot.provider.constant;\n\n/**\n * @author lviter\n */\npublic class EsSettingsConstant {\n\n    /**\n     * \u6570\u636e\u5206\u7247\u6570\n     */\n    public final static String NUMBER_OF_SHARDS = \"index.number_of_shards\";\n\n    /**\n     * \u6570\u636e\u5907\u4efd\u6570\n     */\n    public final static String NUMBER_OF_REPLICAS = \"index.number_of_replicas\";\n\n    /**\n     * \u5206\u9875\u67e5\u8be2es\u9650\u5236\u6700\u5927\u6761\u6570\n     */\n    public final static String MAX_RESULT_WINDOW = \"index.max_result_window\";\n\n    /**\n     * \u6700\u5927\u4e00\u4ebf\n     */\n    public final static String MAX_RESULT_WINDOW_VALUE = \"100000000\";\n\n}\n</code></pre> <ul> <li>ElasticSearchServiceImpl.class es\u901a\u7528\u589e\u5220\u6539\u67e5\uff0c\u5206\u9875\u7b49</li> </ul> <pre><code>package com.dadi01.scrm.service.mot.provider.impl;\n\nimport com.alibaba.fastjson.JSON;\nimport com.dadi01.scrm.foundation.model.constant.StringPool;\nimport com.dadi01.scrm.foundation.model.dto.PageData;\nimport com.dadi01.scrm.foundation.model.dto.ResultDTO;\nimport com.dadi01.scrm.foundation.model.dto.ResultListDTO;\nimport com.dadi01.scrm.foundation.model.dto.ResultPageDTO;\nimport com.dadi01.scrm.foundation.model.error.ErrorEnum;\nimport com.dadi01.scrm.foundation.model.exception.ScrmException;\nimport com.dadi01.scrm.service.mot.api.IElasticSearchService;\nimport com.dadi01.scrm.service.mot.api.common.EsLogActionEnum;\nimport com.dadi01.scrm.service.mot.api.dto.elasticsearch.CrowdMessageDTO;\nimport com.dadi01.scrm.service.mot.api.dto.elasticsearch.MemberDTO;\nimport com.dadi01.scrm.service.mot.api.dto.elasticsearch.OperatingLogDTO;\nimport com.dadi01.scrm.service.mot.provider.config.ElasticSearchConfig;\nimport com.dadi01.scrm.service.mot.provider.constant.EsIndexConstant;\nimport com.dadi01.scrm.service.mot.provider.constant.EsSettingsConstant;\nimport com.dadi01.scrm.service.mot.provider.util.JsonUtils;\nimport com.google.gson.Gson;\nimport lombok.extern.slf4j.Slf4j;\nimport org.apache.commons.lang3.StringUtils;\nimport org.elasticsearch.action.admin.indices.alias.get.GetAliasesRequest;\nimport org.elasticsearch.action.admin.indices.delete.DeleteIndexRequest;\nimport org.elasticsearch.action.admin.indices.get.GetIndexRequest;\nimport org.elasticsearch.action.bulk.BulkRequest;\nimport org.elasticsearch.action.delete.DeleteRequest;\nimport org.elasticsearch.action.delete.DeleteResponse;\nimport org.elasticsearch.action.get.GetRequest;\nimport org.elasticsearch.action.get.GetResponse;\nimport org.elasticsearch.action.index.IndexRequest;\nimport org.elasticsearch.action.search.MultiSearchRequest;\nimport org.elasticsearch.action.search.MultiSearchResponse;\nimport org.elasticsearch.action.search.SearchRequest;\nimport org.elasticsearch.action.search.SearchResponse;\nimport org.elasticsearch.action.support.master.AcknowledgedResponse;\nimport org.elasticsearch.action.update.UpdateRequest;\nimport org.elasticsearch.action.update.UpdateResponse;\nimport org.elasticsearch.client.GetAliasesResponse;\nimport org.elasticsearch.client.RequestOptions;\nimport org.elasticsearch.client.RestHighLevelClient;\nimport org.elasticsearch.client.indices.CreateIndexRequest;\nimport org.elasticsearch.client.indices.CreateIndexResponse;\nimport org.elasticsearch.cluster.metadata.AliasMetaData;\nimport org.elasticsearch.common.settings.Settings;\nimport org.elasticsearch.common.xcontent.XContentType;\nimport org.elasticsearch.index.query.QueryBuilders;\nimport org.elasticsearch.search.SearchHit;\nimport org.elasticsearch.search.builder.SearchSourceBuilder;\nimport org.elasticsearch.search.sort.SortOrder;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.scheduling.annotation.Async;\nimport org.springframework.stereotype.Service;\n\nimport java.io.IOException;\nimport java.lang.reflect.Field;\nimport java.util.*;\nimport java.util.concurrent.atomic.AtomicLong;\n\n/**\n * @author lviter\n */\n@Slf4j\n@Service\npublic class ElasticSearchServiceImpl implements IElasticSearchService {\n\n    @Autowired\n    private RestHighLevelClient restHighLevelClient;\n    @Autowired\n    private ElasticSearchConfig elasticSearchConfig;\n\n    private static AtomicLong i = new AtomicLong(0);\n\n    @Override\n    public ResultDTO&lt;Object&gt; getElasticSearchInfo() {\n        SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder();\n        // SearchRequest\n        SearchRequest searchRequest = new SearchRequest();\n        searchRequest.source(searchSourceBuilder);\n        // \u67e5\u8be2ES\n        SearchResponse searchResponse = null;\n        try {\n            searchResponse = restHighLevelClient.search(searchRequest, RequestOptions.DEFAULT);\n        } catch (IOException e) {\n            log.error(\"es\u67e5\u8be2\u5f02\u5e38{}\", JsonUtils.objectToJson(e));\n        }\n        return ResultDTO.success(searchResponse);\n    }\n\n    @Override\n    public ResultDTO&lt;Boolean&gt; addCrowdMessage(String index, CrowdMessageDTO crowdMessageDTO) {\n        if (StringUtils.isBlank(index)) {\n            throw new ScrmException(ErrorEnum.MOT_ES_INDEX_NOT_NULL.build());\n        }\n        IndexRequest indexRequest = new IndexRequest(index);\n        Long createTime = System.currentTimeMillis();\n        crowdMessageDTO.setCreateTime(createTime);\n        String source = JSON.toJSONString(crowdMessageDTO);\n        try {\n            indexRequest.source(source, XContentType.JSON);\n            restHighLevelClient.index(indexRequest, RequestOptions.DEFAULT);\n        } catch (IOException e) {\n            log.error(\"es add data filed{}\", JsonUtils.objectToJson(e));\n            throw new ScrmException(ErrorEnum.MOT_ES_ADD_DATA_FAILED.build());\n        }\n        addOperatingLog(EsIndexConstant.ES_OPERATING_LOG.getIndex(), EsLogActionEnum.INSERT, index, new Gson().toJson(source));\n        return ResultDTO.success(true);\n    }\n\n    /**\n     * \u6279\u91cf\u6dfb\u52a0es\u6570\u636e\n     *\n     * @param crowdMessages\n     * @return\n     */\n    @Override\n    public ResultDTO addBatchCrowdMessage(String index, List&lt;CrowdMessageDTO&gt; crowdMessages) {\n        if (crowdMessages.size() &gt; 100000) {\n            log.error(\"es add batch data too large{}\", crowdMessages.size());\n            throw new ScrmException(ErrorEnum.MOT_ES_ADD_DATA_FAILED.build());\n        }\n        BulkRequest request = new BulkRequest();\n        crowdMessages.forEach(crowdMessageDTO -&gt; {\n            crowdMessageDTO.setCreateTime(System.currentTimeMillis());\n            crowdMessageDTO.setSort(i.getAndIncrement());\n            String source = JSON.toJSONString(crowdMessageDTO);\n            request.add(new IndexRequest(index).source(source, XContentType.JSON));\n        });\n        esBatchAdd(request, index);\n        return ResultDTO.success();\n    }\n\n    @Override\n    public ResultDTO&lt;Void&gt; addBatchMember(String index, List&lt;MemberDTO&gt; members) {\n        if (members.size() &gt; 100000) {\n            log.error(\"es add batch data too large{}\", members.size());\n            throw new ScrmException(ErrorEnum.MOT_ES_ADD_DATA_FAILED.build());\n        }\n\n        BulkRequest request = new BulkRequest();\n        members.forEach(member -&gt; {\n            member.setCreateTime(System.currentTimeMillis());\n            String source = JSON.toJSONString(member);\n            request.add(new IndexRequest(index).source(source, XContentType.JSON));\n        });\n        esBatchAdd(request, index);\n        return ResultDTO.success();\n    }\n\n    /**\n     * \u6279\u91cf\u63d2\u5165\u6570\u636e\n     *\n     * @param bulkRequest\n     * @param index\n     */\n    private void esBatchAdd(BulkRequest bulkRequest, String index) {\n        try {\n            restHighLevelClient.bulk(bulkRequest, RequestOptions.DEFAULT);\n        } catch (Exception e) {\n            log.error(\"es add batch data filed{}\", JsonUtils.objectToJson(e));\n            throw new ScrmException(ErrorEnum.MOT_ES_ADD_DATA_FAILED.build());\n        }\n        log.info(\"\u63d2\u5165\u6570\u636e----------------------{}\", bulkRequest.requests().size());\n        addOperatingLog(EsIndexConstant.ES_OPERATING_LOG.getIndex(), EsLogActionEnum.INSERT, index, String.valueOf(bulkRequest.requests().size()));\n    }\n\n    /**\n     * \u521b\u5efa\u7d22\u5f15\n     *\n     * @param index\n     */\n    @Override\n    public ResultDTO&lt;Void&gt; createIndexResponse(String index) {\n        //\u521b\u5efa\u7d22\u5f15,\u5982\u679c\u7d22\u5f15\u5df2\u5b58\u5728\uff0c\u8fd4\u56de\u9519\u8bef\u4fe1\u606f\n        if (checkIndexExists(index)) {\n            log.info(\"\u7d22\u5f15\u5df2\u5b58\u5728{}\", index);\n            throw new ScrmException(ErrorEnum.MOT_ES_INDEX_ALREADY_EXIST.build());\n        }\n        //\u521b\u5efa\u7d22\u5f15\n        CreateIndexRequest createIndexRequest = new CreateIndexRequest(index);\n        //\u8bbe\u7f6e\u5206\u7247\n        createIndexRequest.settings(\n                Settings.builder().put(EsSettingsConstant.NUMBER_OF_SHARDS, elasticSearchConfig.getNumberOfShards())\n                        .put(EsSettingsConstant.NUMBER_OF_REPLICAS, elasticSearchConfig.getNumberOfReplicas())\n                        .put(EsSettingsConstant.MAX_RESULT_WINDOW, EsSettingsConstant.MAX_RESULT_WINDOW_VALUE));\n        CreateIndexResponse createIndexResponse = null;\n        try {\n            createIndexResponse = restHighLevelClient.indices().create(createIndexRequest, RequestOptions.DEFAULT);\n            boolean acknowledged = createIndexResponse.isAcknowledged();\n            boolean shardsAcknowledged = createIndexResponse.isShardsAcknowledged();\n\n            if (acknowledged &amp;&amp; shardsAcknowledged) {\n                addOperatingLog(EsIndexConstant.ES_OPERATING_LOG.getIndex(), EsLogActionEnum.CREATE, index, new Gson().toJson(createIndexResponse));\n                log.info(\"\u7d22\u5f15\u521b\u5efa\u6210\u529f{}\", index);\n            }\n        } catch (IOException e) {\n            log.error(\"index create failed{}\", JsonUtils.objectToJson(e));\n            addOperatingLog(EsIndexConstant.ES_OPERATING_LOG.getIndex(), EsLogActionEnum.CREATE, index, new Gson().toJson(e));\n            throw new ScrmException(ErrorEnum.MOT_ES_INDEX_CREATE_FAILED.build());\n        }\n        return ResultDTO.success();\n    }\n\n    /**\n     * \u5224\u65ad\u7d22\u5f15\u662f\u5426\u5b58\u5728\n     *\n     * @param indexName\n     * @return\n     * @throws IOException\n     */\n    public boolean checkIndexExists(String indexName) {\n        GetIndexRequest request = new GetIndexRequest().indices(indexName);\n        try {\n            return restHighLevelClient.indices().exists(request, RequestOptions.DEFAULT);\n        } catch (IOException e) {\n            log.error(\"\u5224\u65ad\u7d22\u5f15\u662f\u5426\u5b58\u5728\uff0c\u64cd\u4f5c\u5f02\u5e38\uff01\");\n        }\n        return false;\n    }\n\n    @Override\n    public ResultPageDTO&lt;CrowdMessageDTO&gt; pageQuery(Integer page, Integer rows, String index, Integer status) {\n        SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder()\n                .from((page - 1) * rows)\n                .size(rows)\n                .sort(\"sort\", SortOrder.DESC)\n                .trackTotalHits(true);\n        if (status != null) {\n            searchSourceBuilder.query(QueryBuilders.termQuery(\"status\", status));\n        }\n        SearchResponse searchResponse = pageQuerySearchResponse(searchSourceBuilder, index);\n        long total = searchResponse.getHits().getTotalHits().value;\n        // \u904d\u5386\u5c01\u88c5\u5217\u8868\u5bf9\u8c61\n        List&lt;CrowdMessageDTO&gt; crowdMessages = new ArrayList&lt;&gt;();\n        SearchHit[] searchHits = searchResponse.getHits().getHits();\n        for (SearchHit searchHit : searchHits) {\n            crowdMessages.add(JSON.parseObject(searchHit.getSourceAsString(), CrowdMessageDTO.class).setId(searchHit.getId()));\n        }\n        return ResultPageDTO.success(new PageData&lt;CrowdMessageDTO&gt;().setData(crowdMessages).setPageSize(crowdMessages.size()).setTotal((int) total));\n    }\n\n    @Override\n    public ResultPageDTO&lt;Map&lt;String, Object&gt;&gt; pageQueryByIndex(Integer page, Integer rows, String index) {\n        SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder()\n                .from((page - 1) * rows)\n                .size(rows)\n                .trackTotalHits(true);\n        SearchResponse searchResponse = pageQuerySearchResponse(searchSourceBuilder, index);\n        long total = searchResponse.getHits().getTotalHits().value;\n\n        List&lt;Map&lt;String, Object&gt;&gt; resultList = new ArrayList&lt;&gt;();\n        // \u904d\u5386\u5c01\u88c5\u5217\u8868\u5bf9\u8c61\n        SearchHit[] searchHits = searchResponse.getHits().getHits();\n        for (SearchHit searchHit : searchHits) {\n            searchHit.getSourceAsMap().put(\"id\", searchHit.getId());\n            resultList.add(searchHit.getSourceAsMap());\n        }\n        return ResultPageDTO.success(new PageData&lt;Map&lt;String, Object&gt;&gt;().setData(resultList).setPageSize(resultList.size()).setTotal((int) total));\n    }\n\n    /**\n     * \u5206\u9875\u67e5\u8be2\u641c\u7d22es\n     *\n     * @param searchSourceBuilder\n     * @param index\n     * @return\n     */\n    private SearchResponse pageQuerySearchResponse(SearchSourceBuilder searchSourceBuilder, String index) {\n        SearchRequest searchRequest = new SearchRequest()\n                .source(searchSourceBuilder)\n                .indices(index);\n        SearchResponse searchResponse;\n        try {\n            log.info(\"\u67e5\u8be2es\u5165\u53c2\uff1a{}\", new Gson().toJson(searchRequest));\n            searchResponse = restHighLevelClient.search(searchRequest, RequestOptions.DEFAULT);\n        } catch (IOException e) {\n            log.error(\"es page query failed{}\", JsonUtils.objectToJson(e));\n            throw new ScrmException(ErrorEnum.MOT_ES_PAGE_QUERY_FAILED.build());\n        }\n        return searchResponse;\n    }\n\n    @Override\n    public ResultDTO&lt;CrowdMessageDTO&gt; getById(String index, String id) {\n        if (StringUtils.isBlank(index)) {\n            index = EsIndexConstant.ES_TEST.getIndex();\n        }\n        GetRequest getRequest = new GetRequest(index, id);\n        GetResponse getResponse = null;\n        try {\n            log.info(\"\u6839\u636e\u7f16\u53f7\u67e5\u8be2\u6570\u636e\uff0crq:{}\", new Gson().toJson(getRequest));\n            getResponse = restHighLevelClient.get(getRequest, RequestOptions.DEFAULT);\n        } catch (IOException e) {\n            log.error(\"es\u67e5\u8be2\u5f02\u5e38{}\", JsonUtils.objectToJson(e));\n            throw new ScrmException(ErrorEnum.MOT_ES_QUERY_FAILED.build());\n        }\n        CrowdMessageDTO crowdMessageDTO = JSON.parseObject(getResponse.getSourceAsString(), CrowdMessageDTO.class).setId(getResponse.getId());\n        return ResultDTO.success(crowdMessageDTO);\n    }\n\n    @Override\n    public ResultListDTO&lt;MemberDTO&gt; getMemberList(List&lt;String&gt; memberIds) {\n        List&lt;MemberDTO&gt; memberList = new ArrayList&lt;&gt;();\n\n        MultiSearchRequest request = new MultiSearchRequest();\n        memberIds.forEach(memberId -&gt; {\n            SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder().query(QueryBuilders.matchPhraseQuery(\"memberId\", memberId));\n            request.add(new SearchRequest()\n                    .source(searchSourceBuilder)\n                    .indices(EsIndexConstant.ES_MEMBER_INFO.getIndex()));\n        });\n        try {\n            MultiSearchResponse response = restHighLevelClient.msearch(request, RequestOptions.DEFAULT);\n            for (MultiSearchResponse.Item item : response.getResponses()) {\n                log.info(JsonUtils.objectToJson(item));\n                for (SearchHit hit : item.getResponse().getHits().getHits()) {\n                    memberList.add(JsonUtils.jsonToPojo(hit.getSourceAsString(), MemberDTO.class));\n                }\n            }\n        } catch (IOException e) {\n            log.error(\"es\u67e5\u8be2\u5f02\u5e38{}\", JsonUtils.objectToJson(e));\n            throw new ScrmException(ErrorEnum.MOT_ES_QUERY_FAILED.build());\n        }\n        return ResultListDTO.success(memberList);\n    }\n\n    @Override\n    public ResultDTO update(String index, CrowdMessageDTO crowdMessageDTO) {\n        if (StringUtils.isBlank(index)) {\n            throw new ScrmException(ErrorEnum.MOT_ES_INDEX_NOT_NULL.build());\n        }\n        UpdateRequest updateRequest = new UpdateRequest(index, crowdMessageDTO.getId());\n        updateRequest.retryOnConflict(3);\n        updateRequest.doc(JSON.toJSONString(crowdMessageDTO), XContentType.JSON);\n        // \u64cd\u4f5cES\n        UpdateResponse updateResponse = null;\n        try {\n            log.info(\"\u66f4\u65b0\u6570\u636e,rq:{}\", new Gson().toJson(updateRequest));\n            updateResponse = restHighLevelClient.update(updateRequest, RequestOptions.DEFAULT);\n        } catch (IOException e) {\n            log.error(\"es update failed{}\", JsonUtils.objectToJson(e));\n            throw new ScrmException(ErrorEnum.MOT_ES_UPDATE_FAILED.build());\n        }\n        return ResultDTO.success(updateResponse);\n    }\n\n    @Override\n    @Async\n    public ResultDTO&lt;Void&gt; updateBatch(String index, List&lt;CrowdMessageDTO&gt; crowdMessages) {\n        batchUpdate(index, crowdMessages);\n        addOperatingLog(EsIndexConstant.ES_OPERATING_LOG.getIndex(), EsLogActionEnum.UPDATE, index, String.valueOf(crowdMessages.size()));\n        return ResultDTO.success();\n    }\n\n    /**\n     * \u6279\u91cf\u4fee\u6539\n     *\n     * @param index\n     * @param crowdMessages\n     */\n    private void batchUpdate(String index, List&lt;CrowdMessageDTO&gt; crowdMessages) {\n        BulkRequest bulkRequest = new BulkRequest();\n        crowdMessages.forEach(crowdMessageDTO -&gt; bulkRequest.add(new UpdateRequest(index, crowdMessageDTO.getId()).doc(JSON.toJSONString(crowdMessageDTO), XContentType.JSON)));\n        try {\n            restHighLevelClient.bulk(bulkRequest, RequestOptions.DEFAULT);\n        } catch (IOException e) {\n            log.error(\"es add batch data filed{}\", JsonUtils.objectToJson(e));\n            throw new ScrmException(ErrorEnum.MOT_ES_UPDATE_FAILED.build());\n        }\n    }\n\n\n    @Override\n    public ResultDTO deleteById(String index, String id) {\n        if (StringUtils.isBlank(index)) {\n            index = EsIndexConstant.ES_TEST.getIndex();\n        }\n        DeleteRequest deleteRequest = new DeleteRequest(index, id);\n        // \u64cd\u4f5cES\n        DeleteResponse deleteResponse = null;\n        try {\n            log.info(\"\u5220\u9664\u6570\u636e\u6839\u636eID,rq:{}\", new Gson().toJson(deleteRequest));\n            deleteResponse = restHighLevelClient.delete(deleteRequest, RequestOptions.DEFAULT);\n        } catch (IOException e) {\n            log.error(\"es\u67e5\u8be2\u5f02\u5e38{}\", JsonUtils.objectToJson(e));\n            e.printStackTrace();\n        }\n        return ResultDTO.success(deleteResponse);\n    }\n\n    @Override\n    public ResultDTO deleteIndex(String index) {\n        DeleteIndexRequest deleteIndexRequest = new DeleteIndexRequest(index);\n\n        try {\n            AcknowledgedResponse deleteResponse = restHighLevelClient.indices().delete(deleteIndexRequest, RequestOptions.DEFAULT);\n            boolean acknowledged = deleteResponse.isAcknowledged();\n            if (acknowledged) {\n                return ResultDTO.success();\n            }\n            addOperatingLog(EsIndexConstant.ES_OPERATING_LOG.getIndex(), EsLogActionEnum.DELETE, index, new Gson().toJson(deleteResponse));\n        } catch (IOException e) {\n            log.error(\"es delete index failed{}\", JsonUtils.objectToJson(e));\n            addOperatingLog(EsIndexConstant.ES_OPERATING_LOG.getIndex(), EsLogActionEnum.DELETE, index, new Gson().toJson(e));\n            throw new ScrmException(ErrorEnum.MOT_ES_INDEX_DELETE_FAIL.build());\n        }\n        return ResultDTO.success();\n    }\n\n    @Override\n    public ResultDTO&lt;Set&lt;String&gt;&gt; getAlias() {\n        Set&lt;String&gt; indices;\n        GetAliasesRequest request = new GetAliasesRequest();\n        try {\n            GetAliasesResponse getAliasesResponse = restHighLevelClient.indices().getAlias(request, RequestOptions.DEFAULT);\n            Map&lt;String, Set&lt;AliasMetaData&gt;&gt; map = getAliasesResponse.getAliases();\n            indices = map.keySet();\n            indices.removeIf(str -&gt; str.startsWith(StringPool.DOT));\n            return ResultDTO.success(indices);\n        } catch (IOException e) {\n            log.error(\"es get indices failed{}\", JsonUtils.objectToJson(e));\n            throw new ScrmException(ErrorEnum.MOT_ES_QUERY_FAILED.build());\n        }\n    }\n\n    @Override\n    public ResultDTO updateAllByKey(String index, String key, String value) {\n//        UpdateRequest updateRequest = new UpdateRequest(index);\n//        restHighLevelClient.update(updateRequest, RequestOptions.DEFAULT);\n        return null;\n    }\n\n    @Override\n    @Async\n    public ResultDTO&lt;Void&gt; addOperatingLog(String index, EsLogActionEnum esLogActionEnum, String operateIndex, String comment) {\n        //\u521b\u5efa\u7d22\u5f15,\u5982\u679c\u7d22\u5f15\u4e0d\u5b58\u5728\uff0c\u5c31\u521b\u5efa\u7d22\u5f15\n//        String index = EsIndexConstant.ES_OPERATING_LOG.getIndex();\n        if (!checkIndexExists(index)) {\n            createIndexResponse(index);\n        }\n        IndexRequest indexRequest = new IndexRequest(index);\n        OperatingLogDTO operatingLogDTO = new OperatingLogDTO();\n        operatingLogDTO.setCreateTime(System.currentTimeMillis());\n        operatingLogDTO.setLogAction(esLogActionEnum.getKey());\n        operatingLogDTO.setLogModule(operateIndex);\n        operatingLogDTO.setComment(comment);\n        String source = JSON.toJSONString(operatingLogDTO);\n        indexRequest.source(source, XContentType.JSON);\n        try {\n            restHighLevelClient.index(indexRequest, RequestOptions.DEFAULT);\n        } catch (IOException e) {\n            log.error(\"add operating log fail!\");\n        }\n        return ResultDTO.success();\n    }\n}\n</code></pre>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/Es%E5%9F%BA%E7%A1%80%E6%9F%A5%E8%AF%A2/","title":"Es\u57fa\u7840\u67e5\u8be2","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/Es%E5%9F%BA%E7%A1%80%E6%9F%A5%E8%AF%A2/#_1","title":"\u67e5\u8be2\u662f\u5426\u5b58\u5728\u5b57\u6bb5","text":"<p>POST /vts_finance_cost_confirmed_order/_search</p> <pre><code>{\n  \"query\": {\n    \"bool\": {\n      \"must\": {\n        \"exists\": {\n          \"field\": \"rentCarOwnOrgIdRoute\"\n        }\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/Es%E5%9F%BA%E7%A1%80%E6%9F%A5%E8%AF%A2/#_2","title":"Es\u57fa\u7840\u67e5\u8be2","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/Es%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/","title":"Es\u57fa\u7840\u8bed\u6cd5","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/Es%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_1","title":"\u793a\u4f8b","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/Es%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_2","title":"\u57fa\u672c\u6982\u5ff5","text":"<p>Elasticsearch\u662f\u9762\u5411\u6587\u6863\u578b\u6570\u636e\u5e93\uff0c\u4e00\u6761\u6570\u636e\u5728\u8fd9\u91cc\u5c31\u662f\u4e00\u4e2a\u6587\u6863\uff0c\u7528JSON\u4f5c\u4e3a\u6587\u6863\u5e8f\u5217\u5316\u7684\u683c\u5f0f\uff0c\u5982: <pre><code>{\n    \"name\" :     \"John\",\n    \"sex\" :      \"Male\",\n    \"age\" :      25,\n    \"birthDate\": \"1990/05/01\",\n    \"about\" :    \"I love to go rock climbing\",\n    \"interests\": [ \"sports\", \"music\" ]\n}\n</code></pre> es\u4e0e\u5173\u7cfb\u578b\u6570\u636e\u672f\u8bed\u5bf9\u7167\u8868\uff1a <pre><code>\u5173\u7cfb\u6570\u636e\u5e93      \u21d2 \u6570\u636e\u5e93        \u21d2  \u8868         \u21d2 \u884c              \u21d2 \u5217(Columns)\n\nElasticsearch  \u21d2 \u7d22\u5f15(Index)   \u21d2 \u7c7b\u578b(type)  \u21d2 \u6587\u6863(Docments)  \u21d2 \u5b57\u6bb5(Fields)\n</code></pre> \u4e00\u4e2aes\u96c6\u7fa4\u5305\u542b\u591a\u4e2a\u7d22\u5f15\uff0c\u5305\u542b\u5f88\u591a\u7c7b\u578b\u3002\u8fd9\u4e9b\u7c7b\u578b\u4e2d\u5305\u542b\u5f88\u591a\u7684\u6587\u6863\uff0c\u6bcf\u4e2a\u6587\u6863\u5305\u542b\u5f88\u591a\u7684\u5b57\u6bb5\u3002ES\u7684\u4ea4\u4e92\uff0c\u53ef\u4ee5\u4f7f\u7528JAVA API\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528HTTP\u7684restful API\u65b9\u5f0f\u3002</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/Es%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_3","title":"\u64cd\u4f5c","text":"<ol> <li> <p>\u521b\u5efa\u6587\u6863\u7c7b\u578b\u7684\u7d22\u5f15 <pre><code>PUT /website/blog/123\n{\n  \"title\": \"My first blog entry\",\n  \"text\":  \"Just trying this out...\",\n  \"date\":  \"2014/01/01\"\n}\n</code></pre></p> </li> <li> <p>website: \u6587\u6863\u5b58\u653e\u4f4d\u7f6e</p> </li> <li>blog: \u6587\u6863\u8868\u793a\u7684\u5bf9\u8c61\u7c7b\u578b</li> <li> <p>123: \u6587\u6863\u552f\u4e00\u6807\u8bc6</p> </li> <li> <p>\u67e5\u8be2 <pre><code>GET /website/blog/123?_source=title,text\n</code></pre></p> </li> <li>\u5220\u9664 <pre><code>DELETE /website/blog/123\n</code></pre></li> </ol>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/Es%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_4","title":"\u7d22\u5f15","text":"<p>ES\u7d22\u5f15\u7cbe\u9ad3\uff1a <pre><code>\u4e00\u5207\u8bbe\u8ba1\u90fd\u662f\u4e3a\u4e86\u63d0\u9ad8\u641c\u7d22\u7684\u6027\u80fd\n</code></pre></p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/es%E5%A4%8D%E6%9D%82%E7%BB%9F%E8%AE%A1-%E7%BB%9D%E5%AF%B9%E5%80%BC/","title":"Es\u590d\u6742\u7edf\u8ba1 \u7edd\u5bf9\u503c","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/es%E5%A4%8D%E6%9D%82%E7%BB%9F%E8%AE%A1-%E7%BB%9D%E5%AF%B9%E5%80%BC/#_1","title":"\u590d\u6742\u7edf\u8ba1\u793a\u4f8b","text":"<p>POST /vts_finance_insurance_policy/_search</p> <pre><code>{\n  \"query\": {\n    \"bool\": {\n      \"filter\": [\n        {\n          \"bool\": {\n            \"must\": [\n              {\n                \"bool\": {\n                  \"must\": [\n                    {\n                      \"term\": {\n                        \"enabledFlag\": {\n                          \"value\": \"1\",\n                          \"boost\": 1.0\n                        }\n                      }\n                    },\n                    {\n                      \"term\": {\n                        \"tmsBatchNumber\": {\n                          \"value\": \"PC24041600006\",\n                          \"boost\": 1.0\n                        }\n                      }\n                    },\n                    {\n                      \"range\": {\n                        \"bidTime\": {\n                          \"from\": null,\n                          \"to\": \"1715737414000\",\n                          \"include_lower\": true,\n                          \"include_upper\": false,\n                          \"boost\": 1.0\n                        }\n                      }\n                    },\n                    {\n                      \"bool\": {\n                        \"must_not\": [\n                          {\n                            \"term\": {\n                              \"bidTime\": {\n                                \"value\": \"-62167420800000\",\n                                \"boost\": 1.0\n                              }\n                            }\n                          }\n                        ],\n                        \"adjust_pure_negative\": true,\n                        \"boost\": 1.0\n                      }\n                    }\n                  ],\n                  \"adjust_pure_negative\": true,\n                  \"boost\": 1.0\n                }\n              }\n            ],\n            \"adjust_pure_negative\": true,\n            \"boost\": 1.0\n          }\n        }\n      ],\n      \"adjust_pure_negative\": true,\n      \"boost\": 1.0\n    }\n  },\n  \"_source\": {\n    \"includes\": [],\n    \"excludes\": []\n  },\n  \"aggregations\": {\n    \"totalInsureAmount\": {\n      \"sum\": {\n        \"script\": {\n          \"source\": \"Math.abs(doc['premiumAmount'].value)\",\n          \"lang\": \"painless\"\n        }\n      }\n    },\n    \"totalDeductionAmount\": {\n      \"sum\": {\n        \"script\": {\n          \"source\": \"Math.abs(doc['deductionAmount'].value)\",\n          \"lang\": \"painless\"\n        }\n      }\n    },\n    \"unInsuredNum\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"terms\": {\n                \"policyStatus\": [\n                  \"10\"\n                ],\n                \"boost\": 1.0\n              }\n            },\n            {\n              \"terms\": {\n                \"enabledFlag\": [\n                  \"1\"\n                ],\n                \"boost\": 1.0\n              }\n            }\n          ],\n          \"adjust_pure_negative\": true,\n          \"boost\": 1.0\n        }\n      },\n      \"aggregations\": {\n        \"insuranceOrderNumber\": {\n          \"value_count\": {\n            \"field\": \"id\"\n          }\n        }\n      }\n    },\n    \"insuredNum\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"terms\": {\n                \"policyStatus\": [\n                  \"20\"\n                ],\n                \"boost\": 1.0\n              }\n            },\n            {\n              \"terms\": {\n                \"enabledFlag\": [\n                  \"1\"\n                ],\n                \"boost\": 1.0\n              }\n            }\n          ],\n          \"adjust_pure_negative\": true,\n          \"boost\": 1.0\n        }\n      },\n      \"aggregations\": {\n        \"insuranceOrderNumber\": {\n          \"value_count\": {\n            \"field\": \"id\"\n          }\n        }\n      }\n    },\n    \"insureCancelNum\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"terms\": {\n                \"policyStatus\": [\n                  \"30\"\n                ],\n                \"boost\": 1.0\n              }\n            },\n            {\n              \"terms\": {\n                \"enabledFlag\": [\n                  \"1\"\n                ],\n                \"boost\": 1.0\n              }\n            }\n          ],\n          \"adjust_pure_negative\": true,\n          \"boost\": 1.0\n        }\n      },\n      \"aggregations\": {\n        \"insuranceOrderNumber\": {\n          \"value_count\": {\n            \"field\": \"id\"\n          }\n        }\n      }\n    },\n    \"insureFailNum\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"terms\": {\n                \"policyStatus\": [\n                  \"40\"\n                ],\n                \"boost\": 1.0\n              }\n            },\n            {\n              \"terms\": {\n                \"enabledFlag\": [\n                  \"1\"\n                ],\n                \"boost\": 1.0\n              }\n            }\n          ],\n          \"adjust_pure_negative\": true,\n          \"boost\": 1.0\n        }\n      },\n      \"aggregations\": {\n        \"insuranceOrderNumber\": {\n          \"value_count\": {\n            \"field\": \"id\"\n          }\n        }\n      }\n    },\n    \"insureCancelFailNum\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"terms\": {\n                \"policyStatus\": [\n                  \"50\"\n                ],\n                \"boost\": 1.0\n              }\n            },\n            {\n              \"terms\": {\n                \"enabledFlag\": [\n                  \"1\"\n                ],\n                \"boost\": 1.0\n              }\n            }\n          ],\n          \"adjust_pure_negative\": true,\n          \"boost\": 1.0\n        }\n      },\n      \"aggregations\": {\n        \"insuranceOrderNumber\": {\n          \"value_count\": {\n            \"field\": \"id\"\n          }\n        }\n      }\n    },\n    \"pendingPusNum\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"terms\": {\n                \"tmsBillStatus\": [\n                  \"100\"\n                ],\n                \"boost\": 1.0\n              }\n            },\n            {\n              \"terms\": {\n                \"enabledFlag\": [\n                  \"1\"\n                ],\n                \"boost\": 1.0\n              }\n            }\n          ],\n          \"adjust_pure_negative\": true,\n          \"boost\": 1.0\n        }\n      },\n      \"aggregations\": {\n        \"insuranceOrderNumber\": {\n          \"value_count\": {\n            \"field\": \"id\"\n          }\n        }\n      }\n    },\n    \"tmsApproveNum\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"terms\": {\n                \"tmsBillStatus\": [\n                  \"200\"\n                ],\n                \"boost\": 1.0\n              }\n            },\n            {\n              \"terms\": {\n                \"enabledFlag\": [\n                  \"1\"\n                ],\n                \"boost\": 1.0\n              }\n            }\n          ],\n          \"adjust_pure_negative\": true,\n          \"boost\": 1.0\n        }\n      },\n      \"aggregations\": {\n        \"insuranceOrderNumber\": {\n          \"value_count\": {\n            \"field\": \"id\"\n          }\n        }\n      }\n    },\n    \"tmsConfirmNum\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"terms\": {\n                \"tmsBillStatus\": [\n                  \"300\"\n                ],\n                \"boost\": 1.0\n              }\n            },\n            {\n              \"terms\": {\n                \"enabledFlag\": [\n                  \"1\"\n                ],\n                \"boost\": 1.0\n              }\n            }\n          ],\n          \"adjust_pure_negative\": true,\n          \"boost\": 1.0\n        }\n      },\n      \"aggregations\": {\n        \"insuranceOrderNumber\": {\n          \"value_count\": {\n            \"field\": \"id\"\n          }\n        }\n      }\n    },\n    \"tmsPaiNum\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"terms\": {\n                \"tmsBillStatus\": [\n                  \"400\"\n                ],\n                \"boost\": 1.0\n              }\n            },\n            {\n              \"terms\": {\n                \"enabledFlag\": [\n                  \"1\"\n                ],\n                \"boost\": 1.0\n              }\n            }\n          ],\n          \"adjust_pure_negative\": true,\n          \"boost\": 1.0\n        }\n      },\n      \"aggregations\": {\n        \"insuranceOrderNumber\": {\n          \"value_count\": {\n            \"field\": \"id\"\n          }\n        }\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/es%E5%A4%8D%E6%9D%82%E7%BB%9F%E8%AE%A1-%E7%BB%9D%E5%AF%B9%E5%80%BC/#java","title":"java\u4ee3\u7801\u793a\u4f8b","text":"<pre><code>import org.elasticsearch.index.query.QueryBuilder;\nimport org.elasticsearch.index.query.QueryBuilders;\nimport org.elasticsearch.script.Script;\nimport org.elasticsearch.script.ScriptType;\nimport org.elasticsearch.search.aggregations.AggregationBuilder;\nimport org.elasticsearch.search.aggregations.AggregationBuilders;\nimport org.elasticsearch.search.aggregations.metrics.scripted.ScriptedMetricAggregationBuilder;\nimport org.elasticsearch.search.builder.SearchSourceBuilder;\n\nimport java.util.Collections;\n\n/**\n * @Description:\n * @author: 582401\n * @date: 2022/4/1\n */\npublic class InsurancePolicyPreSearch extends BaseGSPreSearch {\n\n    /**\n     * \u5f85\u6295\u4fdd\u6570\u91cf\n     */\n    public static final String UN_INSURED_NUM = \"unInsuredNum\";\n\n\n    /**\n     * \u5df2\u6295\u4fdd\u6570\u91cf\n     */\n    public static final String INSURED_NUM = \"insuredNum\";\n\n    /**\n     * \u53d6\u6d88\u6295\u4fdd\u6570\u91cf\n     */\n    public static final String INSURED_CANCEL_NUM = \"insureCancelNum\";\n\n    /**\n     * \u6295\u4fdd\u5931\u8d25\u6570\u91cf\n     */\n    public static final String INSURE_FAIL_NUM = \"insureFailNum\";\n\n    /**\n     * \u9000\u4fdd\u5931\u8d25\u6570\u91cf\n     */\n    public static final String INSURE_CANCEL_FAIL_NUM = \"insureCancelFailNum\";\n\n    /**\n     * \u5f85\u63a8\u9001TMS\u6570\u91cf\n     */\n    public static final String PENDING_PUS_NUM = \"pendingPusNum\";\n\n    /**\n     * \u5f85\u5bf9\u8d26\u6570\u91cf\n     */\n    public static final String TMS_APPROVE_NUM = \"tmsApproveNum\";\n\n    /**\n     * \u5df2\u5bf9\u8d26\u6570\u91cf\n     */\n    public static final String TMS_CONFIRM_NUM = \"tmsConfirmNum\";\n\n    /**\n     * \u5df2\u652f\u4ed8\u6570\u91cf\n     */\n    public static final String TMS_PAI_NUM = \"tmsPaiNum\";\n\n    /**\n     * \u8ba2\u5355\u6570\u91cf\n     */\n    public static final String ORDER_NUMBER = \"insuranceOrderNumber\";\n\n\n    /**\n     * \u4fdd\u5355\u72b6\u6001\u5206\u7ec4\n     */\n    public static final String POLICY_STATUS_GROUP = \"policyStatusGroup\";\n\n    /**\n     * \u6295\u4fdd\u603b\u91d1\u989d\n     */\n    public static final String TOTAL_INSURE_AMOUNT = \"totalInsureAmount\";\n\n    /**\n     * \u6263\u6b3e\u603b\u91d1\u989d\n     */\n    public static final String TOTAL_DEDUCTION_AMOUNT = \"totalDeductionAmount\";\n\n    @Override\n    public void buildAggregation(SearchSourceBuilder sourceBuilder) {\n\n        //\u5f85\u6295\u4fdd\u8ba2\u5355\u6570\n        QueryBuilder unInsuredNumQuery = QueryBuilders.boolQuery()\n                .must(QueryBuilders.termsQuery(\"policyStatus\", \"10\"))\n                .must(QueryBuilders.termsQuery(\"enabledFlag\", EnabledFlagEnum.YES.getCode()));\n        AggregationBuilder unInsuredNumBuilder = AggregationBuilders.filter(InsurancePolicyPreSearch.UN_INSURED_NUM, unInsuredNumQuery)\n                .subAggregation(AggregationBuilders.count(InsurancePolicyPreSearch.ORDER_NUMBER).field(\"id\"));\n\n        //\u5df2\u6295\u4fdd\u8ba2\u5355\u6570\n        QueryBuilder insuredNumQuery = QueryBuilders.boolQuery()\n                .must(QueryBuilders.termsQuery(\"policyStatus\", \"20\"))\n                .must(QueryBuilders.termsQuery(\"enabledFlag\", EnabledFlagEnum.YES.getCode()));\n        AggregationBuilder insuredNumBuilder = AggregationBuilders.filter(InsurancePolicyPreSearch.INSURED_NUM, insuredNumQuery)\n                .subAggregation(AggregationBuilders.count(InsurancePolicyPreSearch.ORDER_NUMBER).field(\"id\"));\n\n        //\u53d6\u6d88\u6295\u4fdd\u6570\u91cf\n        QueryBuilder insureCancelNumQuery = QueryBuilders.boolQuery()\n                .must(QueryBuilders.termsQuery(\"policyStatus\", \"30\"))\n                .must(QueryBuilders.termsQuery(\"enabledFlag\", EnabledFlagEnum.YES.getCode()));\n        AggregationBuilder insureCancelNumBuilder = AggregationBuilders.filter(InsurancePolicyPreSearch.INSURED_CANCEL_NUM, insureCancelNumQuery)\n                .subAggregation(AggregationBuilders.count(InsurancePolicyPreSearch.ORDER_NUMBER).field(\"id\"));\n\n        //\u6295\u4fdd\u5931\u8d25\u6570\u91cfinsureFailNum\n        QueryBuilder insureFailNumQuery = QueryBuilders.boolQuery()\n                .must(QueryBuilders.termsQuery(\"policyStatus\", \"40\"))\n                .must(QueryBuilders.termsQuery(\"enabledFlag\", EnabledFlagEnum.YES.getCode()));\n        AggregationBuilder insureFailNumBuilder = AggregationBuilders.filter(InsurancePolicyPreSearch.INSURE_FAIL_NUM, insureFailNumQuery)\n                .subAggregation(AggregationBuilders.count(InsurancePolicyPreSearch.ORDER_NUMBER).field(\"id\"));\n\n        //\u9000\u4fdd\u5931\u8d25\u6570\u91cfinsureCancelFailNum\n        QueryBuilder insureCancelFailNumQuery = QueryBuilders.boolQuery()\n                .must(QueryBuilders.termsQuery(\"policyStatus\", \"50\"))\n                .must(QueryBuilders.termsQuery(\"enabledFlag\", EnabledFlagEnum.YES.getCode()));\n        AggregationBuilder insureCancelFailNumBuilder = AggregationBuilders.filter(InsurancePolicyPreSearch.INSURE_CANCEL_FAIL_NUM, insureCancelFailNumQuery)\n                .subAggregation(AggregationBuilders.count(InsurancePolicyPreSearch.ORDER_NUMBER).field(\"id\"));\n\n        //\u5f85\u63a8\u9001TMS\u6570\u91cfpendingPusNum\n        QueryBuilder pendingPusNumQuery = QueryBuilders.boolQuery()\n                .must(QueryBuilders.termsQuery(\"tmsBillStatus\", TmsBillStatusEnum.PENDING_PUSH.getCode()))\n                .must(QueryBuilders.termsQuery(\"enabledFlag\", EnabledFlagEnum.YES.getCode()));\n        AggregationBuilder pendingPusNumBuilder = AggregationBuilders.filter(InsurancePolicyPreSearch.PENDING_PUS_NUM, pendingPusNumQuery)\n                .subAggregation(AggregationBuilders.count(InsurancePolicyPreSearch.ORDER_NUMBER).field(\"id\"));\n\n        //\u5f85\u5bf9\u8d26\u6570\u91cftmsApproveNum\n        QueryBuilder tmsApproveNumQuery = QueryBuilders.boolQuery()\n                .must(QueryBuilders.termsQuery(\"tmsBillStatus\", TmsBillStatusEnum.TMS_APPROVE.getCode()))\n                .must(QueryBuilders.termsQuery(\"enabledFlag\", EnabledFlagEnum.YES.getCode()));\n        AggregationBuilder tmsApproveNumBuilder = AggregationBuilders.filter(InsurancePolicyPreSearch.TMS_APPROVE_NUM, tmsApproveNumQuery)\n                .subAggregation(AggregationBuilders.count(InsurancePolicyPreSearch.ORDER_NUMBER).field(\"id\"));\n\n        //\u5df2\u5bf9\u8d26\u6570\u91cftmsConfirmNum\n        QueryBuilder tmsConfirmNumQuery = QueryBuilders.boolQuery()\n                .must(QueryBuilders.termsQuery(\"tmsBillStatus\", TmsBillStatusEnum.TMS_CONFIRM.getCode()))\n                .must(QueryBuilders.termsQuery(\"enabledFlag\", EnabledFlagEnum.YES.getCode()));\n        AggregationBuilder tmsConfirmNumBuilder = AggregationBuilders.filter(InsurancePolicyPreSearch.TMS_CONFIRM_NUM, tmsConfirmNumQuery)\n                .subAggregation(AggregationBuilders.count(InsurancePolicyPreSearch.ORDER_NUMBER).field(\"id\"));\n\n        //\u5df2\u652f\u4ed8\u6570\u91cftmsPaiNum\n        QueryBuilder tmsPaiNumQuery = QueryBuilders.boolQuery()\n                .must(QueryBuilders.termsQuery(\"tmsBillStatus\", TmsBillStatusEnum.TMS_PAID.getCode()))\n                .must(QueryBuilders.termsQuery(\"enabledFlag\", EnabledFlagEnum.YES.getCode()));\n        AggregationBuilder tmsPaiNumBuilder = AggregationBuilders.filter(InsurancePolicyPreSearch.TMS_PAI_NUM, tmsPaiNumQuery)\n                .subAggregation(AggregationBuilders.count(InsurancePolicyPreSearch.ORDER_NUMBER).field(\"id\"));\n        sourceBuilder\n                .aggregation(AggregationBuilders.sum(InsurancePolicyPreSearch.TOTAL_INSURE_AMOUNT)\n                        .script(new Script(ScriptType.INLINE, \"painless\", \"Math.abs(doc['premiumAmount'].value)\", Collections.emptyMap()))\n                        )\n                .aggregation(AggregationBuilders.sum(InsurancePolicyPreSearch.TOTAL_DEDUCTION_AMOUNT)\n                        .script(new Script(ScriptType.INLINE, \"painless\", \"Math.abs(doc['deductionAmount'].value)\", Collections.emptyMap()))\n                        )\n                .aggregation(unInsuredNumBuilder)\n                .aggregation(insuredNumBuilder)\n                .aggregation(insureCancelNumBuilder)\n                .aggregation(insureFailNumBuilder)\n                .aggregation(insureCancelFailNumBuilder)\n                .aggregation(pendingPusNumBuilder)\n                .aggregation(tmsApproveNumBuilder)\n                .aggregation(tmsConfirmNumBuilder)\n                .aggregation(tmsPaiNumBuilder);\n    }\n}\n</code></pre> <p>\u67e5\u8be2\u53d6\u503c\u4ee3\u7801</p> <pre><code> public InsurancePolicyStatisticsDTO statisticsInsurancePolicy(InsurancePolicyBO insurancePolicyBO) {\n        Pagination&lt;InsurancePolicy&gt; pagination = (Pagination&lt;InsurancePolicy&gt;) esPreHandleUtils.newPagination(insurancePolicyBO);\n        //\u7ec4\u88c5es\u901a\u7528\u67e5\u8be2\u6761\u4ef6\n        String authCode = KeyValueConfigClient.getValue(VtsBaseConfigConstant.INSURANCE_STATISTICS_AUTH_CODE, EsConstant.INSURANCE_POLICY_AUTH_CODE);\n        SimpleQuery simpleQuery = getSimpleQuery(pagination, authCode);\n        SearchResponse searchResponse = esPreHandleUtils.getEsGroupStatisticsClient().searchResult(simpleQuery, new InsurancePolicyPreSearch());\n        InsurancePolicyStatisticsDTO insurancePolicyStatisticsDTO = new InsurancePolicyStatisticsDTO();\n\n        //\u5f85\u6295\u4fdd\u6570\u91cf\n        ParsedFilter unInsuredNum = searchResponse.getAggregations().get(InsurancePolicyPreSearch.UN_INSURED_NUM);\n        insurancePolicyStatisticsDTO.setUnInsuredNum(Objects.nonNull(unInsuredNum) ? Integer.parseInt(String.valueOf(unInsuredNum.getDocCount())) : 0);\n\n        //\u5df2\u6295\u4fdd\u6570\u91cf\n        ParsedFilter insuredNum = searchResponse.getAggregations().get(InsurancePolicyPreSearch.INSURED_NUM);\n        insurancePolicyStatisticsDTO.setInsuredNum(Objects.nonNull(insuredNum) ? Integer.parseInt(String.valueOf(insuredNum.getDocCount())) : 0);\n\n        //\u53d6\u6d88\u6295\u4fdd\u6570\u91cf\n        ParsedFilter insureCancelNum = searchResponse.getAggregations().get(InsurancePolicyPreSearch.INSURED_CANCEL_NUM);\n        insurancePolicyStatisticsDTO.setInsureCancelNum(Objects.nonNull(insureCancelNum) ? Integer.parseInt(String.valueOf(insureCancelNum.getDocCount())) : 0);\n\n        //\u6295\u4fdd\u5931\u8d25\u6570\u91cf\n        ParsedFilter insureFailNum = searchResponse.getAggregations().get(InsurancePolicyPreSearch.INSURE_FAIL_NUM);\n        insurancePolicyStatisticsDTO.setInsureFailNum(Objects.nonNull(insureFailNum) ? Integer.parseInt(String.valueOf(insureFailNum.getDocCount())) : 0);\n\n        //\u9000\u4fdd\u5931\u8d25\u6570\u91cf\n        ParsedFilter insureCancelFailNum = searchResponse.getAggregations().get(InsurancePolicyPreSearch.INSURE_CANCEL_FAIL_NUM);\n        insurancePolicyStatisticsDTO.setInsureCancelFailNum(Objects.nonNull(insureCancelFailNum) ? Integer.parseInt(String.valueOf(insureCancelFailNum.getDocCount())) : 0);\n\n        //\u5f85\u63a8\u9001TMS\u6570\u91cf\n        ParsedFilter pendingPusNum = searchResponse.getAggregations().get(InsurancePolicyPreSearch.PENDING_PUS_NUM);\n        insurancePolicyStatisticsDTO.setPendingPusNum(Objects.nonNull(pendingPusNum) ? Integer.parseInt(String.valueOf(pendingPusNum.getDocCount())) : 0);\n\n        //\u5f85\u5bf9\u8d26\u6570\u91cf\n        ParsedFilter tmsApproveNum = searchResponse.getAggregations().get(InsurancePolicyPreSearch.TMS_APPROVE_NUM);\n        insurancePolicyStatisticsDTO.setTmsApproveNum(Objects.nonNull(tmsApproveNum) ? Integer.parseInt(String.valueOf(tmsApproveNum.getDocCount())) : 0);\n\n        //\u5df2\u5bf9\u8d26\u6570\u91cf\n        ParsedFilter tmsConfirmNum = searchResponse.getAggregations().get(InsurancePolicyPreSearch.TMS_CONFIRM_NUM);\n        insurancePolicyStatisticsDTO.setTmsConfirmNum(Objects.nonNull(tmsConfirmNum) ? Integer.parseInt(String.valueOf(tmsConfirmNum.getDocCount())) : 0);\n\n        //\u5df2\u652f\u4ed8\u6570\u91cf\n        ParsedFilter tmsPaiNum = searchResponse.getAggregations().get(InsurancePolicyPreSearch.TMS_PAI_NUM);\n        insurancePolicyStatisticsDTO.setTmsPaiNum(Objects.nonNull(tmsPaiNum) ? Integer.parseInt(String.valueOf(tmsPaiNum.getDocCount())) : 0);\n\n        //\u6295\u4fdd\u603b\u91d1\u989d\n        ParsedSum totalInsureAmount = searchResponse.getAggregations().get(InsurancePolicyPreSearch.TOTAL_INSURE_AMOUNT);\n        BigDecimal policyTotalAmount = (Objects.nonNull(totalInsureAmount)) ?\n                BigDecimal.valueOf(Math.abs(totalInsureAmount.getValue())).setScale(2, RoundingMode.HALF_UP) : BigDecimal.ZERO;\n        insurancePolicyStatisticsDTO.setPolicyTotalAmount(policyTotalAmount);\n\n        //\u6263\u6b3e\u603b\u91d1\u989d\n        ParsedSum totalDeductionAmount = searchResponse.getAggregations().get(InsurancePolicyPreSearch.TOTAL_DEDUCTION_AMOUNT);\n        BigDecimal deductionTotalAmount = (Objects.nonNull(totalDeductionAmount)) ?\n                BigDecimal.valueOf(Math.abs(totalDeductionAmount.getValue())).setScale(2, RoundingMode.HALF_UP) : BigDecimal.ZERO;\n        insurancePolicyStatisticsDTO.setDeductionTotalAmount(deductionTotalAmount);\n        return insurancePolicyStatisticsDTO;\n    }\n</code></pre>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/es%E5%A4%8D%E6%9D%82%E7%BB%9F%E8%AE%A1-%E7%BB%9D%E5%AF%B9%E5%80%BC/#_2","title":"\u6838\u5fc3\u70b9","text":"<pre><code>sourceBuilder\n    .aggregation(AggregationBuilders.sum(InsurancePolicyPreSearch.TOTAL_INSURE_AMOUNT)\n        .script(new Script(ScriptType.INLINE, \"painless\", \"Math.abs(doc['premiumAmount'].value)\", Collections.emptyMap()))\n    )\n    .aggregation(AggregationBuilders.sum(InsurancePolicyPreSearch.TOTAL_DEDUCTION_AMOUNT)\n        .script(new Script(ScriptType.INLINE, \"painless\", \"Math.abs(doc['deductionAmount'].value)\", Collections.emptyMap()))\n    );\n</code></pre> <p>\u5b57\u6bb5\u672adouble\u7c7b\u578b\uff0c\u7528\u811a\u672c\u7edf\u8ba1\u7edd\u5bf9\u503c\u7684\u805a\u5408\u503c</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/es%E9%80%9A%E7%94%A8%E6%9F%A5%E8%AF%A2/","title":"Es\u901a\u7528\u67e5\u8be2","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/es%E9%80%9A%E7%94%A8%E6%9F%A5%E8%AF%A2/#_1","title":"\u7cbe\u786e\u67e5\u627e\u6570\u636e","text":"<p>GET ecs_vts_finance_payable_bill_new/_search</p> <pre><code>{\n  \"query\": {\n    \"term\": {\n      \"tradeNumber\": \"JY2204-30032801\"\n    }\n  }\n}\n</code></pre>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/es%E9%80%9A%E7%94%A8%E6%9F%A5%E8%AF%A2/#_2","title":"\u5224\u65ad\u67d0\u4e2a\u5b57\u6bb5\u662f\u5426\u4e3a\u7a7a","text":"<p>GET /vts_finance_fee_confirmed_order/_search</p> <pre><code>{\n  \"query\": {\n    \"bool\": {\n      \"must_not\": {\n        \"exists\": {\n          \"field\": \"transportOrder\"\n        }\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/es%E9%80%9A%E7%94%A8%E6%9F%A5%E8%AF%A2/#_3","title":"\u590d\u6742\u67e5\u627e","text":"<p>POST ecs_vts_finance_fee_confirmed_order/_search</p> <pre><code>{\n  \"query\": {\n    \"bool\": {\n      \"filter\": [\n        {\n          \"bool\": {\n            \"must\": [\n              {\n                \"bool\": {\n                  \"must\": [\n                    {\n                      \"term\": {\n                        \"enabledFlag\": {\n                          \"value\": \"1\",\n                          \"boost\": 1.0\n                        }\n                      }\n                    },\n                    {\n                      \"bool\": {\n                        \"should\": [\n                          {\n                            \"bool\": {\n                              \"must_not\": [\n                                {\n                                  \"terms\": {\n                                    \"transportOrder.transportCapacityType\": [\n                                      \"4\"\n                                    ],\n                                    \"boost\": 1.0\n                                  }\n                                }\n                              ],\n                              \"adjust_pure_negative\": true,\n                              \"boost\": 1.0\n                            }\n                          }\n                        ],\n                        \"adjust_pure_negative\": true,\n                        \"boost\": 1.0\n                      }\n                    },\n                    {\n                      \"bool\": {\n                        \"should\": [\n                          {\n                            \"bool\": {\n                              \"must_not\": [\n                                {\n                                  \"terms\": {\n                                    \"payableBillDetail.orderSource\": [\n                                      \"SHEIN\"\n                                    ],\n                                    \"boost\": 1.0\n                                  }\n                                }\n                              ],\n                              \"adjust_pure_negative\": true,\n                              \"boost\": 1.0\n                            }\n                          }\n                        ],\n                        \"adjust_pure_negative\": true,\n                        \"boost\": 1.0\n                      }\n                    },\n                    {\n                      \"term\": {\n                        \"approveStatus\": {\n                          \"value\": \"100\",\n                          \"boost\": 1.0\n                        }\n                      }\n                    },\n                    {\n                      \"terms\": {\n                        \"businessType\": [\n                          \"1\"\n                        ],\n                        \"boost\": 1.0\n                      }\n                    },\n                    {\n                      \"bool\": {\n                        \"should\": [\n                          {\n                            \"terms\": {\n                              \"transportOrder.orderStatus\": [\n                                \"50\"\n                              ],\n                              \"boost\": 1.0\n                            }\n                          },\n                          {\n                            \"bool\": {\n                              \"must\": [\n                                {\n                                  \"terms\": {\n                                    \"transportOrder.orderStatus\": [\n                                      \"40\"\n                                    ],\n                                    \"boost\": 1.0\n                                  }\n                                },\n                                {\n                                  \"term\": {\n                                    \"transportOrder.receiptFlag\": {\n                                      \"value\": \"10\",\n                                      \"boost\": 1.0\n                                    }\n                                  }\n                                },\n                                {\n                                  \"range\": {\n                                    \"transportOrder.signReportDate\": {\n                                      \"to\": \"1705852799000\",\n                                      \"include_lower\": true,\n                                      \"include_upper\": true,\n                                      \"boost\": 1.0\n                                    }\n                                  }\n                                },\n                                {\n                                  \"bool\": {\n                                    \"must_not\": [\n                                      {\n                                        \"term\": {\n                                          \"transportOrder.signReportDate\": {\n                                            \"value\": \"-62167420800000\",\n                                            \"boost\": 1.0\n                                          }\n                                        }\n                                      }\n                                    ],\n                                    \"adjust_pure_negative\": true,\n                                    \"boost\": 1.0\n                                  }\n                                },\n                                {\n                                  \"term\": {\n                                    \"transportOrder.expressStatus\": {\n                                      \"value\": \"40\",\n                                      \"boost\": 1.0\n                                    }\n                                  }\n                                }\n                              ],\n                              \"adjust_pure_negative\": true,\n                              \"boost\": 1.0\n                            }\n                          },\n                          {\n                            \"bool\": {\n                              \"must\": [\n                                {\n                                  \"terms\": {\n                                    \"transportOrder.orderStatus\": [\n                                      \"40\"\n                                    ],\n                                    \"boost\": 1.0\n                                  }\n                                },\n                                {\n                                  \"term\": {\n                                    \"transportOrder.receiptFlag\": {\n                                      \"value\": \"10\",\n                                      \"boost\": 1.0\n                                    }\n                                  }\n                                },\n                                {\n                                  \"term\": {\n                                    \"transportOrder.expressStatus\": {\n                                      \"value\": \"60\",\n                                      \"boost\": 1.0\n                                    }\n                                  }\n                                }\n                              ],\n                              \"adjust_pure_negative\": true,\n                              \"boost\": 1.0\n                            }\n                          },\n                          {\n                            \"bool\": {\n                              \"must\": [\n                                {\n                                  \"terms\": {\n                                    \"transportOrder.orderStatus\": [\n                                      \"40\"\n                                    ],\n                                    \"boost\": 1.0\n                                  }\n                                },\n                                {\n                                  \"range\": {\n                                    \"transportOrder.signReportDate\": {\n                                      \"to\": \"1705852799000\",\n                                      \"include_lower\": true,\n                                      \"include_upper\": true,\n                                      \"boost\": 1.0\n                                    }\n                                  }\n                                },\n                                {\n                                  \"bool\": {\n                                    \"must_not\": [\n                                      {\n                                        \"term\": {\n                                          \"transportOrder.signReportDate\": {\n                                            \"value\": \"-62167420800000\",\n                                            \"boost\": 1.0\n                                          }\n                                        }\n                                      }\n                                    ],\n                                    \"adjust_pure_negative\": true,\n                                    \"boost\": 1.0\n                                  }\n                                },\n                                {\n                                  \"terms\": {\n                                    \"transportOrder.receiptFlag\": [\n                                      \"20\"\n                                    ],\n                                    \"boost\": 1.0\n                                  }\n                                }\n                              ],\n                              \"adjust_pure_negative\": true,\n                              \"boost\": 1.0\n                            }\n                          }\n                        ],\n                        \"adjust_pure_negative\": true,\n                        \"boost\": 1.0\n                      }\n                    }\n                  ],\n                  \"adjust_pure_negative\": true,\n                  \"boost\": 1.0\n                }\n              }\n            ],\n            \"adjust_pure_negative\": true,\n            \"boost\": 1.0\n          }\n        }\n      ],\n      \"adjust_pure_negative\": true,\n      \"boost\": 1.0\n    }\n  }\n}\n</code></pre>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/es%E9%80%9A%E7%94%A8%E6%9F%A5%E8%AF%A2/#_4","title":"\u65b0\u589e\u5b57\u6bb5","text":"<p>PUT vts_finance_payable_bill/_mapping/ecs_vts_finance_payable_bill</p> <pre><code>{\n  \"properties\": {\n    \"placeOrderBy\": {\n      \"fields\": {\n        \"raw\": {\n          \"null_value\": \"\",\n          \"type\": \"keyword\"\n        }\n      },\n      \"type\": \"text\"\n    }\n  }\n}\n</code></pre>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/es%E9%80%9A%E7%94%A8%E6%9F%A5%E8%AF%A2/#_5","title":"\u65b0\u5efa\u7d22\u5f15","text":"<p>PUT vts_finance_fee_confirmed_order</p> <pre><code>{\n  \"aliases\": {\n    \"ecs_vts_finance_fee_confirmed_order\": {}\n  },\n  \"settings\": {\n    \"index\": {\n      \"refresh_interval\": \"1s\",\n      \"max_inner_result_window\": \"100000\",\n      \"max_result_window\": \"100000\",\n      \"number_of_replicas\": \"2\",\n      \"number_of_shards\": \"5\"\n    }\n  },\n  \"mappings\": {\n    \"ecs_vts_finance_fee_confirmed_order\": {\n      \"dynamic\": \"false\",\n      \"properties\": {\n        \"id\": {\n          \"type\": \"long\"\n        },\n        \"tradeNumber\": {\n          \"type\": \"keyword\"\n        },\n        \"demandOrderCode\": {\n          \"type\": \"keyword\"\n        },\n        \"approveStatus\": {\n          \"type\": \"keyword\"\n        },\n        \"frozenStatus\": {\n          \"type\": \"keyword\"\n        },\n        \"payChannel\": {\n          \"type\": \"keyword\"\n        },\n        \"confirmTime\": {\n          \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\",\n          \"type\": \"date\"\n        },\n        \"confirmUserName\": {\n          \"type\": \"keyword\"\n        },\n        \"userName\": {\n          \"type\": \"keyword\"\n        },\n        \"carModel\": {\n          \"type\": \"keyword\"\n        },\n        \"userMobile\": {\n          \"type\": \"keyword\"\n        },\n        \"userType\": {\n          \"type\": \"keyword\"\n        },\n        \"bidTime\": {\n          \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\",\n          \"type\": \"date\"\n        },\n        \"bidAmount\": {\n          \"type\": \"double\"\n        },\n        \"carNumber\": {\n          \"type\": \"keyword\"\n        },\n        \"carLength\": {\n          \"type\": \"keyword\"\n        },\n        \"platformCode\": {\n          \"type\": \"keyword\"\n        },\n        \"businessType\": {\n          \"type\": \"keyword\"\n        },\n        \"waybillNumbers\": {\n          \"type\": \"keyword\"\n        },\n        \"enabledFlag\": {\n          \"type\": \"keyword\"\n        },\n        \"payableBillDetail\": {\n          \"properties\": {\n            \"tradeNumber\": {\n              \"type\": \"keyword\"\n            },\n            \"confirmedTimeoutStatus\": {\n              \"type\": \"integer\"\n            },\n            \"confirmedUseTime\": {\n              \"type\": \"integer\"\n            },\n            \"hllAppealStatus\": {\n              \"type\": \"integer\"\n            },\n            \"goodsWeight\": {\n              \"type\": \"double\"\n            },\n            \"goodsVolume\": {\n              \"type\": \"double\"\n            },\n            \"customerRemark\": {\n              \"type\": \"keyword\"\n            }\n          }\n        },\n        \"orderTagList\": {\n          \"type\": \"nested\",\n          \"properties\": {\n            \"demandOrderId\": {\n              \"type\": \"long\"\n            },\n            \"demandOrderCode\": {\n              \"type\": \"keyword\"\n            },\n            \"tagCode\": {\n              \"type\": \"keyword\"\n            },\n            \"tagName\": {\n              \"type\": \"keyword\"\n            },\n            \"remark\": {\n              \"type\": \"keyword\"\n            }\n          }\n        },\n        \"transportOrder\": {\n          \"properties\": {\n            \"id\": {\n              \"type\": \"long\"\n            },\n            \"expressStatus\": {\n              \"type\": \"keyword\"\n            },\n            \"receiptFlag\": {\n              \"type\": \"keyword\"\n            },\n            \"confirmCostFlag\": {\n              \"type\": \"keyword\"\n            },\n            \"demandOrderCode\": {\n              \"type\": \"keyword\"\n            },\n            \"tradeCode\": {\n              \"type\": \"keyword\"\n            },\n            \"costWorkOrderAuditFlag\": {\n              \"type\": \"keyword\"\n            },\n            \"frozenName\": {\n              \"type\": \"keyword\"\n            },\n            \"thirdOrderCode\": {\n              \"type\": \"keyword\"\n            },\n            \"transportCapacityCode\": {\n              \"type\": \"keyword\"\n            },\n            \"transportCapacityType\": {\n              \"type\": \"keyword\"\n            },\n            \"driverName\": {\n              \"type\": \"keyword\"\n            },\n            \"userName\": {\n              \"type\": \"keyword\"\n            },\n            \"winType\": {\n              \"type\": \"keyword\"\n            },\n            \"driverPhone\": {\n              \"type\": \"keyword\"\n            },\n            \"plateNo\": {\n              \"type\": \"keyword\"\n            },\n            \"carLength\": {\n              \"type\": \"keyword\"\n            },\n            \"carType\": {\n              \"type\": \"keyword\"\n            },\n            \"dispatchDriverDate\": {\n              \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\",\n              \"type\": \"date\"\n            },\n            \"businessType\": {\n              \"type\": \"keyword\"\n            },\n            \"serviceType\": {\n              \"type\": \"keyword\"\n            },\n            \"startThreeAddress\": {\n              \"type\": \"keyword\"\n            },\n            \"endThreeAddress\": {\n              \"type\": \"keyword\"\n            },\n            \"placeOrderPerson\": {\n              \"type\": \"keyword\"\n            },\n            \"placeOrderTime\": {\n              \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\",\n              \"type\": \"date\"\n            },\n            \"companyNo\": {\n              \"type\": \"keyword\"\n            },\n            \"loadingTime\": {\n              \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\",\n              \"type\": \"date\"\n            },\n            \"finishDate\": {\n              \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\",\n              \"type\": \"date\"\n            },\n            \"destinationRequireDate\": {\n              \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\",\n              \"type\": \"date\"\n            },\n            \"expectedArriveDate\": {\n              \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\",\n              \"type\": \"date\"\n            },\n            \"returnDistance\": {\n              \"type\": \"double\"\n            },\n            \"referenceDistance\": {\n              \"type\": \"double\"\n            },\n            \"needCarType\": {\n              \"type\": \"keyword\"\n            },\n            \"waybillCode\": {\n              \"type\": \"keyword\"\n            },\n            \"requireArrivalTime\": {\n              \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\",\n              \"type\": \"date\"\n            },\n            \"loadService\": {\n              \"type\": \"keyword\"\n            },\n            \"unloadService\": {\n              \"type\": \"keyword\"\n            },\n            \"startDepartmentName\": {\n              \"type\": \"keyword\"\n            },\n            \"endDepartmentName\": {\n              \"type\": \"keyword\"\n            },\n            \"locationDepartmentName\": {\n              \"type\": \"keyword\"\n            },\n            \"needCarLength\": {\n              \"type\": \"double\"\n            },\n            \"insuredMoney\": {\n              \"type\": \"double\"\n            },\n            \"platformType\": {\n              \"type\": \"keyword\"\n            },\n            \"ycContractType\": {\n              \"type\": \"keyword\"\n            },\n            \"ycContractName\": {\n              \"type\": \"keyword\"\n            },\n            \"ycContractId\": {\n              \"type\": \"keyword\"\n            },\n            \"ycDepartmentName\": {\n              \"type\": \"keyword\"\n            },\n            \"ycTaiwanNum\": {\n              \"type\": \"keyword\"\n            },\n            \"signReportDate\": {\n              \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\",\n              \"type\": \"date\"\n            },\n            \"orderStatus\": {\n              \"type\": \"keyword\"\n            },\n            \"shipperReceiptStatus\": {\n              \"type\": \"integer\"\n            },\n            \"signDate\": {\n              \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\",\n              \"type\": \"date\"\n            },\n            \"exceptionType\": {\n              \"type\": \"integer\"\n            },\n            \"orderRiskFlag\": {\n              \"type\": \"keyword\"\n            },\n            \"orderRiskStatus\": {\n              \"type\": \"keyword\"\n            },\n            \"cancelCause\": {\n              \"type\": \"keyword\"\n            },\n            \"arrivePlateNo\": {\n              \"type\": \"keyword\"\n            },\n            \"orderStatusSub\": {\n              \"type\": \"keyword\"\n            },\n            \"arrivePlateFlag\": {\n              \"type\": \"keyword\"\n            },\n            \"vehicleInspectionStatus\": {\n              \"type\": \"keyword\"\n            },\n            \"pickGoodsFlag\": {\n              \"type\": \"keyword\"\n            },\n            \"takeTrackRate\": {\n              \"type\": \"double\"\n            },\n            \"deliveryTrackRate\": {\n              \"type\": \"double\"\n            },\n            \"score\": {\n              \"type\": \"double\"\n            },\n            \"executeDate\": {\n              \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\",\n              \"type\": \"date\"\n            },\n            \"deliveryDate\": {\n              \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\",\n              \"type\": \"date\"\n            },\n            \"pickupSignDate\": {\n              \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\",\n              \"type\": \"date\"\n            },\n            \"trackRate\": {\n              \"type\": \"double\"\n            },\n            \"cancelDate\": {\n              \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\",\n              \"type\": \"date\"\n            },\n            \"cancelOperatorName\": {\n              \"type\": \"keyword\"\n            },\n            \"pickupReportDate\": {\n              \"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\",\n              \"type\": \"date\"\n            },\n            \"orderRemark\": {\n              \"type\": \"keyword\"\n            },\n            \"warningFollowup\": {\n              \"type\": \"nested\",\n              \"properties\": {\n                \"id\": {\n                  \"type\": \"long\"\n                },\n                \"demandOrderCode\": {\n                  \"type\": \"keyword\"\n                },\n                \"warningContent\": {\n                  \"type\": \"keyword\"\n                },\n                \"warningContentCode\": {\n                  \"type\": \"keyword\"\n                }\n              }\n            },\n            \"orderVehicle\": {\n              \"properties\": {\n                \"tradeCode\": {\n                  \"type\": \"keyword\"\n                },\n                \"leakingUsableFlag\": {\n                  \"type\": \"keyword\"\n                },\n                \"pdaLeakingStatus\": {\n                  \"type\": \"keyword\"\n                },\n                \"ponchosAuditStatus\": {\n                  \"type\": \"keyword\"\n                },\n                \"ponchosStatus\": {\n                  \"type\": \"keyword\"\n                }\n              }\n            },\n            \"extra\": {\n              \"properties\": {\n                \"tradeCode\": {\n                  \"type\": \"keyword\"\n                },\n                \"demandOrderCode\": {\n                  \"type\": \"keyword\"\n                },\n                \"loadServiceType\": {\n                  \"type\": \"keyword\"\n                },\n                \"unloadServiceType\": {\n                  \"type\": \"keyword\"\n                },\n                \"unFrozenByName\": {\n                  \"type\": \"keyword\"\n                },\n                \"projectOrderFlag\": {\n                  \"type\": \"keyword\"\n                },\n                \"projectCode\": {\n                  \"type\": \"keyword\"\n                },\n                \"projectFollower\": {\n                  \"type\": \"keyword\"\n                },\n                \"projectTenderType\": {\n                  \"type\": \"integer\"\n                },\n                \"receiptType\": {\n                  \"type\": \"keyword\"\n                },\n                \"projectLineCode\": {\n                  \"type\": \"keyword\"\n                },\n                \"contractBorrowLineName\": {\n                  \"type\": \"keyword\"\n                },\n                \"pdaOutRangeFlag\": {\n                  \"type\": \"keyword\"\n                },\n                \"appOutRangeFlag\": {\n                  \"type\": \"keyword\"\n                },\n                \"lastRemarkBy\": {\n                  \"type\": \"keyword\"\n                },\n                \"businessAreaName\": {\n                  \"type\": \"text\",\n                  \"fields\": {\n                    \"raw\": {\n                      \"type\": \"keyword\",\n                      \"null_value\": \"\"\n                    }\n                  }\n                },\n                \"expensiveFlag\": {\n                  \"type\": \"keyword\"\n                },\n                \"vehicleInspectionStatus\": {\n                  \"type\": \"keyword\"\n                },\n                \"pdaPlateFakedType\": {\n                  \"type\": \"keyword\"\n                },\n                \"driverPlateFakedType\": {\n                  \"type\": \"keyword\"\n                },\n                \"driverBlacklistFlag\": {\n                  \"type\": \"keyword\"\n                },\n                \"plateBlacklistFlag\": {\n                  \"type\": \"keyword\"\n                },\n                \"carTypeLabel\": {\n                  \"type\": \"keyword\"\n                },\n                \"deliveryTimeoutFlag\": {\n                  \"type\": \"keyword\"\n                },\n                \"arriveDriversNumber\": {\n                  \"type\": \"integer\"\n                },\n                \"requireDriversNumber\": {\n                  \"type\": \"integer\"\n                },\n                \"beforeAssignFlag\": {\n                  \"type\": \"keyword\"\n                },\n                \"contractBorrowFlag\": {\n                  \"type\": \"keyword\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/%E5%AE%89%E8%A3%85ELK/","title":"\u5b89\u88c5ELK","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/%E5%AE%89%E8%A3%85ELK/#dockeres","title":"\u4f7f\u7528docker\u5b89\u88c5es","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/%E5%AE%89%E8%A3%85ELK/#es","title":"ES","text":"<ol> <li>docker\u4e0b\u8f7des7.3.0\u955c\u50cf <pre><code>docker pull docker.elastic.co/elasticsearch/elasticsearch:7.3.0\n</code></pre></li> <li>docker\u521b\u5efa\u4e00\u4e2a\u7f51\u7edc\uff0c\u65b9\u4fbfelk\u4f7f\u7528 <pre><code>docker network create esnet\n</code></pre></li> <li>\u542f\u52a8docker\u955c\u50cf <pre><code>docker run --name es  -p 9200:9200 -p 9300:9300  --network esnet -e \"discovery.type=single-node\" bdaab402b220\n</code></pre> \u53c2\u6570\u8bf4\u660e <pre><code>run:\u8fd0\u884c\n--name:\u5bb9\u5668\u540d\u79f0\n-p:\u7aef\u53e3\u6620\u5c04\n--network:\u4f7f\u7528\u7f51\u5361\n-e:\u914d\u7f6e\nbdaab402b220: \u955c\u50cfid\n</code></pre></li> <li>\u542f\u52a8\u4e4b\u540e \u8fdb\u5165\u5bb9\u5668\uff0c\u53ef\u4ee5\u81ea\u884c\u914d\u7f6ees\u96c6\u7fa4 <pre><code>docker exec -it 1491dbda35e5 /bin/bash\n</code></pre></li> </ol>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/%E5%AE%89%E8%A3%85ELK/#kibana","title":"kibana","text":"<ol> <li>docker\u5b89\u88c5es\u5bf9\u5e94\u7248\u672c\u7684kibana <pre><code>docker pull kibana:7.3.0\n</code></pre></li> <li>\u542f\u52a8kibana\u5bb9\u5668\uff0c\u4f7f\u7528es\u6240\u4f7f\u7528\u7684\u7f51\u5361 <pre><code>docker run --name kibana --net esnet -e ELASTICSEARCH_URL=http://127.0.0.1:9200 -p 5601:5601 -d 8bcee4a4f79d\n</code></pre></li> </ol>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/%E5%AE%89%E8%A3%85ELK/#logstash","title":"logstash","text":"<ol> <li>docker\u5b89\u88c5\u5bf9\u5e94\u7248\u672c\u7684logstash <pre><code>docker pull logstash:7.3.0\n</code></pre></li> <li>\u5728\u5bbf\u4e3b\u673a\u65b0\u5efa\u6587\u4ef6\u5939\uff0clogstash/config,logstash/pipeline\u914d\u7f6e\u6587\u4ef6 \u5728config\u5185\u65b0\u5efalogstash.yml/pipelines.yml</li> <li>logstash.yml\u914d\u7f6e <pre><code>config:\n  reload:\n    automatic: true\n    interval: 3s\nxpack:\n  management.enabled: false\n  monitoring.enabled: false\n</code></pre></li> <li>pipelines.yml\u914d\u7f6e</li> </ol> <p><pre><code>- pipeline.id: test\n  path.config: \"/usr/share/logstash/pipeline/logstash-test.conf\"\n</code></pre> \u5728pipeline\u5185\u65b0\u5efalogstash-test.conf</p> <pre><code>input {\n    file {\n        path =&gt; [\"/usr/share/logstash/pipeline/logs/test.log\"]\n        start_position =&gt; \"beginning\"\n        stat_interval =&gt; 1\n    }\n}\n\nfilter {\n  mutate {\n    gsub =&gt; [\"message\", \"\\r\", \"\"]\n  }\n  dissect {\n    mapping =&gt; {\"message\" =&gt; \"%{date} %{+date} [%{task} %{+task}] [%{type}] %{class} - %{info}\"}\n  }\n}\n\noutput {\n    elasticsearch { hosts =&gt; [\"172.18.0.2:9200\"] }\n    stdout { codec =&gt; rubydebug }\n}\n</code></pre> <ol> <li>\u7f16\u5199logstash\u914d\u7f6e\u6587\u4ef6 <pre><code>input {\n    beats {\n        port =&gt; 5044\n        codec =&gt; \"json\"\n    }\n}\n\noutput {\n  elasticsearch { hosts =&gt; [\"192.168.12.183:9200\"] }\n  stdout { codec =&gt; rubydebug }\n}\n</code></pre></li> <li>\u542f\u52a8logstash <pre><code>docker run -it -d -p 5044:5044 --name logstash --net esnet -v E:/docker-logstash/pipeline/:/usr/share/logstash/pipeline/ -v E:/docker-logstash/config/:/usr/share/logstash/config -d container\n</code></pre></li> <li>\u542f\u52a8\u4e4b\u540e\uff0c\u53ef\u4ee5\u5728logstash/pipeline/logs\u5185\u5199test.log\u6587\u4ef6\u5373\u53ef\u9a8c\u8bc1</li> </ol>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/","title":"ES","text":"<p>\u57fa\u4e8elucene\u7684\u5206\u5e03\u5f0f\u641c\u7d22\u5f15\u64ce</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_1","title":"\u5206\u5e03\u5f0f\u67b6\u6784\u539f\u7406","text":"<ul> <li>\u521b\u5efa\u7684\u7d22\u5f15\u6307\u5b9aN\u4e2ashard\uff0c\u652f\u6301\u6a2a\u5411\u6269\u5c55\uff0c\u63d0\u9ad8\u6027\u80fd\uff1b\u6bcf\u4e2ashard\u90fd\u6709\u4e00\u4e2aprimary shard,\u8d1f\u8d23\u5199\u5165\u6570\u636e\uff0c\u8fd8\u6709\u51e0\u4e2areplica shard\uff0cprimary shard\u5199\u5165\u6570\u636e\u540e\uff0c\u4f1a\u5c06\u6570\u636e\u540c\u6b65\u5230\u5176\u5b83\u51e0\u4e2areplica   shard</li> <li>es\u96c6\u7fa4\u591a\u4e2a\u8282\u70b9\uff0c\u4f1a\u81ea\u52a8\u9009\u4e3e\u4e00\u4e2a\u8282\u70b9\u4e3amaster\u8282\u70b9\uff0cmaster\u8282\u70b9\u8d1f\u8d23\u7ef4\u62a4\u7d22\u5f15\u5143\u6570\u636e\uff0c\u5207\u6362primary shard\u548creplica shard\u8eab\u4efd\u3002\u8981\u662fmaster\u8282\u70b9\u5b95\u673a\uff0c\u4f1a\u91cd\u65b0\u9009\u4e3e\u4e00\u4e2a\u8282\u70b9\u4e3amaster</li> </ul>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#es_1","title":"ES\u5199\u5165\u6570\u636e\u7684\u6d41\u7a0b","text":"<p>ES\u5199\u5165/\u67e5\u8be2\u6d41\u7a0b</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_2","title":"\u5199\u6570\u636e\u8fc7\u7a0b","text":"<ol> <li>\u5ba2\u6237\u7aef\u9009\u62e9\u4e00\u4e2anode\u53d1\u9001\u8bf7\u6c42\u8fc7\u53bb\uff0c\u8fd9\u4e2anode\u662fcoordinating node(\u534f\u8c03\u8282\u70b9)</li> <li>ciirdinating node\u5bf9document\u8fdb\u884c\u8def\u7531\uff0c\u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u5bf9\u5e94\u7684node(primary shard)</li> <li>\u5b9e\u9645\u7684node\u4e0aprimary shard\u5904\u7406\u8bf7\u6c42\uff0c\u5c06\u6570\u636e\u540c\u6b65\u5230replica node</li> <li>coordinating node\u53d1\u73b0primary node\u548c\u6240\u6709replica node\u90fd\u641e\u5b9a\u540e\uff0c\u8fd4\u56de\u54cd\u5e94\u7ed3\u679c\u7ed9\u5ba2\u6237\u7aef</li> </ol>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_3","title":"\u8bfb\u6570\u636e\u8fc7\u7a0b","text":"<ol> <li>\u901a\u8fc7doc id\u6765\u67e5\u8be2\uff0c\u6839\u636edoc id\u8fdb\u884chash\uff0c\u5224\u65ad\u51fa\u6765\u5f53\u65f6\u628adoc id\u5206\u914d\u5230\u54ea\u4e2ashard\u4e0a\u53bb\uff0c\u4ece\u54ea\u4e2ashard\u53bb\u67e5\u8be2</li> <li>\u5ba2\u6237\u7aef\u53d1\u9001\u8bf7\u6c42\u5230\u4efb\u610f\u4e00\u4e2anode\uff0c\u6210\u4e3acoordinate node</li> <li>coordinate node\u5bf9doc id\u8fdb\u884c\u54c8\u5e0c\u8def\u7531\uff0c\u8bf7\u6c42\u8f6c\u53d1\u5230\u5bf9\u5e94\u7684node\uff0c\u4f7f\u7528round-robin\u968f\u673a\u8f6e\u8be2\u7b97\u6cd5\uff0c\u5728primary shard\u4ee5\u53ca\u6240\u6709replica\u4e2d\u968f\u673a\u9009\u62e9\u4e00\u4e2a\uff0c\u8bfb\u8bf7\u6c42\u8d1f\u8f7d\u5747\u8861</li> <li>\u63a5\u6536\u8bf7\u6c42\u7684node\u8fd4\u56dedocument\u7ed9coordinate node</li> <li>coordinate node\u8fd4\u56dedocument\u7ed9\u5ba2\u6237\u7aef</li> </ol>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#es_2","title":"es\u641c\u7d22\u6570\u636e\u8fc7\u7a0b","text":"<ol> <li>\u5ba2\u6237\u7aef\u53d1\u9001\u8bf7\u6c42\u5230\u4e00\u4e2acoordinate node</li> <li>\u534f\u8c03\u8282\u70b9\u5c06\u641c\u7d22\u8bf7\u6c42\u8f6c\u53d1\u5230\u6240\u6709\u7684shard\u5bf9\u5e94\u7684primary shard\u6216replica shard</li> <li>query phase:\u6bcf\u4e2ashard\u5c06\u81ea\u5df1\u7684\u641c\u7d22\u7ed3\u679c\u8fd4\u56de\u7ed9\u534f\u8c03\u8282\u70b9\uff08doc id\uff09,\u7531\u534f\u8c03\u8282\u70b9\u8fdb\u884c\u6570\u636e\u5408\u5e76\u3001\u6392\u5e8f\u3001\u5206\u9875\u7b49\uff0c\u4ea7\u51fa\u6700\u7ec8\u7ed3\u679c</li> <li>fetch phase:\u7531\u534f\u8c03\u8282\u70b9\u6839\u636edoc id\u53bb\u5404\u4e2a\u8282\u70b9\u4e0a\u62c9\u53bb\u5b9e\u9645\u7684document\u6570\u636e\uff0c\u8fd4\u56de\u5ba2\u6237\u7aef</li> </ol>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_4","title":"\u5220\u9664/\u66f4\u65b0\u6570\u636e\u5e95\u5c42\u539f\u7406","text":"<ul> <li>\u5220\u9664\u64cd\u4f5c\uff1acommit\u4f1a\u751f\u6210\u4e00\u4e2a.del\u6587\u4ef6\uff0c\u5c06\u67d0\u4e2adoc\u6807\u8bc6\u4e3adeleted\u72b6\u6001</li> <li>\u66f4\u65b0\u64cd\u4f5c\uff1a\u539f\u6765\u7684doc\u6807\u8bc6\u4e3adeleted\u72b6\u6001\uff0c\u7136\u540e\u65b0\u5199\u5165\u4e00\u6761\u6570\u636e</li> </ul>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_5","title":"\u5012\u6392\u7d22\u5f15","text":"<p>\u6b63\u5411\u7d22\u5f15\u662f\u901a\u8fc7key\u627evalue\uff0c\u53cd\u5411\u7d22\u5f15\u5219\u662f\u901a\u8fc7value\u627ekey</p> <p></p> <p>\u5012\u6392\u7d22\u5f15\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_6","title":"\u6570\u5341\u4ebf\u7ea7\u522b\u6570\u636e\u4e0b\u5982\u4f55\u63d0\u9ad8\u67e5\u8be2\u6548\u7387","text":"<p>\u4e3b\u8981\u662ffilesystem cache\uff0c\u8ba9\u673a\u5668\u5185\u5b58\uff0c\u81f3\u5c11\u53ef\u4ee5\u5bb9\u7eb3\u603b\u6570\u636e\u91cf\u7684\u4e00\u534a</p> <p>\u6bd4\u5982\u73b0\u5728\u4e00\u884c\u6570\u636e\uff0cid,name,age...30\u4e2a\u5b57\u6bb5\u3002\u4f46\u662f\u73b0\u5728\u641c\u7d22\u53ea\u9700\u8981\u6839\u636eid,name,age3\u4e2a\u5b57\u6bb5\u6765\u641c\u7d22\uff0c\u5982\u679c\u5728es\u91cc\u5199\u5165\u4e86\u4e00\u884c\u6570\u636e\u6240\u6709\u5b57\u6bb5\uff0c\u5219\u5bfc\u81f490%\u7684\u6570\u636e\u4e0d\u662f\u7528\u6765\u641c\u7d22\u7684\uff0c\u5c31\u4f1a\u5360\u636efileasystem cache\u7684\u5185\u5b58\u3002</p> <p>\u89e3\u51b3\u4f7f\u7528es+hbase,hbase\u9002\u7528\u4e8e\u6d77\u91cf\u6570\u636e\u5728\u7ebf\u5b58\u50a8\uff0c\u4f46\u4e0d\u8981\u505a\u590d\u6742\u7684\u641c\u7d22</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/Postgressql/ReadME/","title":"ReadME","text":"<p>11\u7248\u672c</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/Postgressql/%E5%88%9D%E5%A7%8BPsql/","title":"\u521d\u59cbPsql","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/Postgressql/%E5%88%9D%E5%A7%8BPsql/#_1","title":"\u8868\u57fa\u7840\u64cd\u4f5c","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/Postgressql/%E5%88%9D%E5%A7%8BPsql/#_2","title":"\u521b\u5efa\u4e00\u4e2a\u65b0\u8868","text":"<pre><code>CREATE TABLE weather\n(\n    city    varchar(80),\n    temp_lo int,  -- \u6700\u4f4e\u6e29\u5ea6\n    temp_hi int,  -- \u6700\u9ad8\u6e29\u5ea6\n    prcp    real, -- \u6e7f\u5ea6\n    date    date\n);\n</code></pre> <ul> <li>\u8bf4\u660e\uff1avarchar(80)\u6307\u5b9a\u4e86\u4e00\u4e2a\u53ef\u4ee5\u5b58\u50a8\u6700\u957f 80 \u4e2a\u5b57\u7b26\u7684\u4efb\u610f\u5b57\u7b26\u4e32\u7684\u6570\u636e\u7c7b\u578b\u3002int\u662f\u666e\u901a\u7684\u6574\u6570\u7c7b\u578b\u3002real\u662f\u4e00\u79cd\u7528\u4e8e\u5b58\u50a8\u5355\u7cbe\u5ea6\u6d6e\u70b9\u6570\u7684\u7c7b\u578b\u3002date\u7c7b\u578b\u65f6\u95f4\u7c7b\u578b\u3002</li> <li>PostgreSQL\u652f\u6301\u6807\u51c6\u7684SQL\u7c7b\u578bint\u3001smallint\u3001real\u3001double precision\u3001char(N)\u3001varchar(N)   \u3001date\u3001time\u3001timestamp\u548cinterval\uff0c\u8fd8\u652f\u6301\u5176\u4ed6\u7684\u901a\u7528\u529f\u80fd\u7684\u7c7b\u578b\u548c\u4e30\u5bcc\u7684\u51e0\u4f55\u7c7b\u578b\u3002PostgreSQL\u4e2d\u53ef\u4ee5\u5b9a\u5236\u4efb\u610f\u6570\u91cf\u7684\u7528\u6237\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\u3002\u56e0\u800c\u7c7b\u578b\u540d\u5e76\u4e0d\u662f\u8bed\u6cd5\u5173\u952e\u5b57\uff0c\u9664\u4e86SQL\u6807\u51c6\u8981\u6c42\u652f\u6301\u7684\u7279\u4f8b\u5916</li> </ul> <pre><code>CREATE TABLE cities\n(\n    name     varchar(80),\n    location point\n);\n</code></pre> <ul> <li>point\u5c31\u662f\u4e00\u79cdPostgreSQL\u7279\u6709\u6570\u636e\u7c7b\u578b</li> </ul>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/Postgressql/%E5%88%9D%E5%A7%8BPsql/#_3","title":"\u5220\u9664\u4e00\u5f20\u8868","text":"<pre><code>DROP TABLE tablename;\n</code></pre>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/Postgressql/%E5%88%9D%E5%A7%8BPsql/#_4","title":"\u63d2\u5165\u6570\u636e","text":"<pre><code>INSERT INTO weather\nVALUES ('San Francisco', 46, 50, 0.25, '1994-11-27');\n</code></pre> <ul> <li>point\u7c7b\u578b\u8981\u6c42\u4e00\u4e2a\u5ea7\u6807\u5bf9\u4f5c\u4e3a\u8f93\u5165 <code>sql  INSERT INTO cities VALUES ('San Francisco', '(-194.0, 53.0)');</code></li> </ul>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/","title":"Index","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/#_1","title":"\u7b80\u4ecb","text":"<p>\u8bbe\u8ba1\u4e00\u4e2a\u5355\u673a\u5343\u4e07\u7ea7\u541e\u5410\u91cf\u7684\u952e\u503c\u6570\u636e\u5e93\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u6df1\u5165\u3001\u900f\u5f7b\u5730\u7814\u7a76\u4e86 Redis\uff0c\u5305\u62ec\u5b83\u7684\u6e90\u4ee3\u7801\u3001\u67b6\u6784\u8bbe\u8ba1\u4ee5\u53ca\u6838\u5fc3\u63a7\u5236\u70b9</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/#_2","title":"\u8bbe\u8ba1\u4f7f\u7528\u5f53\u4e2d\u7684\u5751","text":"<p>\u603b\u7684\u6765\u8bf4\u5206\u56db\u4e2a\u65b9\u9762\uff1a - CPU \u4f7f\u7528\u4e0a\u7684\u201c\u5751\u201d\uff0c\u4f8b\u5982\u6570\u636e\u7ed3\u6784\u7684\u590d\u6742\u5ea6\u3001\u8de8 CPU \u6838\u7684\u8bbf\u95ee\uff1b - \u5185\u5b58\u4f7f\u7528\u4e0a\u7684\u201c\u5751\u201d\uff0c\u4f8b\u5982\u4e3b\u4ece\u540c\u6b65\u548c AOF \u7684\u5185\u5b58\u7ade\u4e89\uff1b - \u5b58\u50a8\u6301\u4e45\u5316\u4e0a\u7684\u201c\u5751\u201d\uff0c\u4f8b\u5982\u5728 SSD \u4e0a\u505a\u5feb\u7167\u7684\u6027\u80fd\u6296\u52a8\uff1b - \u7f51\u7edc\u901a\u4fe1\u4e0a\u7684\u201c\u5751\u201d\uff0c\u4f8b\u5982\u591a\u5b9e\u4f8b\u65f6\u7684\u5f02\u5e38\u7f51\u7edc\u4e22\u5305\u3002</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/#redis","title":"Redis\u5168\u666f\u56fe\u5305\u62ec\u54ea\u4e9b","text":"<p>\u4e24\u5927\u7ef4\u5ea6\u3001\u4e09\u5927\u4e3b\u7ebf </p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/#redis1-11","title":"redis\u6838\u5fc3\u57fa\u7840\u7bc71-11\u538b\u7f29\u56fe\u7247","text":"<p> \u63a8\u8350\u524d\u5f80\u5e55\u5e03\u67e5\u770b\u539f\u6587\u6863\uff1ahttps://www.mubucm.com/doc/1bMEbiZTaGl</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E5%AE%9E%E7%8E%B0%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97/","title":"Redis\u5b9e\u73b0\u5ef6\u8fdf\u961f\u5217","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E5%AE%9E%E7%8E%B0%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97/#redis","title":"Redis\u5b9e\u73b0\u5ef6\u8fdf\u961f\u5217","text":"<ol> <li>\u5931\u6548\u76d1\u542c</li> <li>redisson\u5b9e\u73b0\u53d1\u5e03\u8ba2\u9605\u5ef6\u8fdf</li> </ol>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E5%AE%9E%E7%8E%B0%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97/#redis_1","title":"redis\u5931\u6548\u76d1\u542c\u4e8b\u4ef6","text":"<p>\u96c6\u6210KeyExpirationEventMessageListener\u7c7b\u5b9e\u73b0redis\u5931\u6548\u76d1\u542c\u4e8b\u4ef6</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E5%AE%9E%E7%8E%B0%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97/#_1","title":"\u6b64\u79cd\u5b9e\u73b0\u9762\u4e34\u7684\u95ee\u9898","text":"<ol> <li>redis\u7684\u5931\u6548\u76d1\u542c\u4e8b\u4ef6\u4f1a\u5b58\u5728\u4e00\u5b9a\u7684\u65f6\u95f4\u5dee\uff0c\u5e76\u4e14\u5f53\u6570\u636e\u91cf\u8d8a\u5927\u65f6\uff0c\u8bef\u5dee\u4f1a\u8d8a\u5927\u3002</li> <li>redis\u7684\u5931\u6548\u76d1\u542c\u4e8b\u4ef6\u4f1a\u5c06\u6240\u6709key\u5931\u6548\u90fd\u4f1a\u901a\u77e5\u5230onMessage,\u5982\u679c\u9488\u5bf9\u4e00\u4e2akey\uff0c\u5206\u5e03\u5f0f\u4e1a\u52a1\u7684\u573a\u666f\u4e0b\uff0c\u4f1a\u51fa\u73b0\u91cd\u590d\u6d88\u8d39\u7684\u95ee\u9898\u3002\uff08\u53ef\u4ee5\u589e\u52a0\u5206\u5e03\u5f0f\u9501\u7684\u5b9e\u73b0\uff0c\u4f46\u662fredisson\u5206\u5e03\u5f0f\u9501\u63d0\u4f9b\u4e86\u53e6\u4e00\u79cd\u5ef6\u8fdf\u961f\u5217\u7684\u5b9e\u73b0\u65b9\u5f0f\uff09</li> <li>Redis \u76ee\u524d\u7684\u8ba2\u9605\u4e0e\u53d1\u5e03\u529f\u80fd\u91c7\u53d6\u7684\u662f\u53d1\u9001\u5373\u5fd8\uff08fire and forget\uff09\u7b56\u7565,\u5f53\u8ba2\u9605\u4e8b\u4ef6\u65ad\u7ebf\u65f6\uff0c\u4f1a\u4e22\u5931\u6240\u6709\u5728\u65ad\u7ebf\u671f\u95f4\u5206\u7ed9\u5b83\u7684\u4e8b\u4ef6\u3002\u4e0d\u80fd\u786e\u4fdd\u6d88\u606f\u9001\u8fbe\u3002</li> </ol>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E5%AE%9E%E7%8E%B0%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97/#_2","title":"\u5f00\u53d1\u51c6\u5907","text":"<p>redis\u9700\u8981\u5728\u670d\u52a1\u7aef\u5f00\u542f\u914d\u7f6e\uff0c\u6253\u5f00redis\u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6 \u6dfb\u52a0<code>notify-keyspace-events Ex</code></p> <ul> <li>\u76f8\u5173\u53c2\u6570\u5982\u4e0b\uff1a</li> </ul> <pre><code>K\uff1akeyspace\u4e8b\u4ef6\uff0c\u4e8b\u4ef6\u4ee5__keyspace@&lt;db&gt;__\u4e3a\u524d\u7f00\u8fdb\u884c\u53d1\u5e03\uff1b\nE\uff1akeyevent\u4e8b\u4ef6\uff0c\u4e8b\u4ef6\u4ee5__keyevent@&lt;db&gt;__\u4e3a\u524d\u7f00\u8fdb\u884c\u53d1\u5e03\uff1b\ng\uff1a\u4e00\u822c\u6027\u7684\uff0c\u975e\u7279\u5b9a\u7c7b\u578b\u7684\u547d\u4ee4\uff0c\u6bd4\u5982del\uff0cexpire\uff0crename\u7b49\uff1b\n$\uff1a\u5b57\u7b26\u4e32\u7279\u5b9a\u547d\u4ee4\uff1b\nl\uff1a\u5217\u8868\u7279\u5b9a\u547d\u4ee4\uff1b\ns\uff1a\u96c6\u5408\u7279\u5b9a\u547d\u4ee4\uff1b\nh\uff1a\u54c8\u5e0c\u7279\u5b9a\u547d\u4ee4\uff1b\nz\uff1a\u6709\u5e8f\u96c6\u5408\u7279\u5b9a\u547d\u4ee4\uff1b\nx\uff1a\u8fc7\u671f\u4e8b\u4ef6\uff0c\u5f53\u67d0\u4e2a\u952e\u8fc7\u671f\u5e76\u5220\u9664\u65f6\u4f1a\u4ea7\u751f\u8be5\u4e8b\u4ef6\uff1b\ne\uff1a\u9a71\u9010\u4e8b\u4ef6\uff0c\u5f53\u67d0\u4e2a\u952e\u56e0maxmemore\u7b56\u7565\u800c\u88ab\u5220\u9664\u65f6\uff0c\u4ea7\u751f\u8be5\u4e8b\u4ef6\uff1b\nA\uff1ag$lshzxe\u7684\u522b\u540d\uff0c\u56e0\u6b64\u201dAKE\u201d\u610f\u5473\u7740\u6240\u6709\u4e8b\u4ef6\u3002\n</code></pre>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E5%AE%9E%E7%8E%B0%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97/#_3","title":"\u57fa\u7840\u5b9e\u73b0","text":"<ol> <li>\u52a0\u5165\u4f9d\u8d56</li> </ol> <pre><code>&lt;dependency&gt;\n&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n&lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <ol> <li>\u53ef\u6b63\u5e38\u8fde\u63a5\u5b58\u53d6redis\u6570\u636e\u4e4b\u540e\uff0c\u521b\u5efa\u76d1\u542c\u7c7b<code>RedisKeyExpirationListener</code>\u7ee7\u627f<code>KeyExpirationEventMessageListener</code>    \uff0c\u91cd\u5199<code>onMessage</code>\u65b9\u6cd5\u3002\uff08key\u5931\u6548\u4e4b\u540e\uff0c\u4f1a\u53d1\u51faonMessage\u65b9\u6cd5\uff0c\u4e4b\u5462\u4e2a\u83b7\u53d6\u5931\u6548\u7684key\u503c\uff0c\u4e0d\u80fd\u83b7\u53d6key\u5bf9\u5e94\u7684value\u503c\uff09\u3002</li> </ol> <pre><code>import com.dadi01.scrm.service.member.api.common.MemberStatusEnum;\nimport com.dadi01.scrm.service.member.provider.service.base.IBaseMemberService;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.data.redis.connection.Message;\nimport org.springframework.data.redis.listener.KeyExpirationEventMessageListener;\nimport org.springframework.data.redis.listener.RedisMessageListenerContainer;\nimport org.springframework.stereotype.Component;\n\n/**\n * @author lviter\n */\n@Component\n@Slf4j\npublic class RedisKeyExpirationListener extends KeyExpirationEventMessageListener {\n    private final IBaseMemberService baseMemberService;\n\n\n    private final static String MEMBER_LOCK_ACCOUNT_SUFFIX = \".lock_account\";\n    private final static String MEMBER_LOCK_ACCOUNT_DOMAIN_SUFFIX = \"T\";\n    private final static String MEMBER_LOCK_ACCOUNT_MEMBER_SUFFIX = \"M\";\n    private final static String MEMBER_REDISSON_LOCK = \".member_lock_redisson\";\n    private final static int WAIT_TIME = 5;\n    private final static int LEASE_TIME = 10;\n\n    public RedisKeyExpirationListener(RedisMessageListenerContainer redisMessageListenerContainer, IBaseMemberService baseMemberService) {\n        super(redisMessageListenerContainer);\n        this.baseMemberService = baseMemberService;\n    }\n\n    @Override\n    public void onMessage(Message message, byte[] pattern) {\n        //\u83b7\u53d6\u5931\u6548\u7684key\n        String expiredKey = message.toString();\n        log.info(\"================================get on message:{}====================\", expiredKey);\n        if (expiredKey.endsWith(MEMBER_LOCK_ACCOUNT_SUFFIX)) {\n            log.info(\"================================on message:{}====================\", expiredKey);\n            try {\n                log.info(\"=======\u5f85\u89e3\u9501\u8d26\u53f7\u89e3\u9501======expiredKey:{}\", expiredKey);\n                String tenantId = expiredKey.substring(expiredKey.indexOf(MEMBER_LOCK_ACCOUNT_DOMAIN_SUFFIX) + 1, expiredKey.indexOf(MEMBER_LOCK_ACCOUNT_MEMBER_SUFFIX));\n                String memberId = expiredKey.substring(expiredKey.indexOf(MEMBER_LOCK_ACCOUNT_MEMBER_SUFFIX) + 1, expiredKey.indexOf(MEMBER_LOCK_ACCOUNT_SUFFIX));\n                baseMemberService.updateAccount(Integer.parseInt(tenantId), Long.parseLong(memberId), MemberStatusEnum.NORMAL.getCode(), null);\n            } catch (Exception exception) {\n                log.info(\"auto unlock fail,expired key:{},exception:{}\", expiredKey, exception.getMessage());\n            }\n        }\n    }\n}\n</code></pre> <ol> <li>\u521b\u5efa\u4e00\u4e2a\u914d\u7f6e\u7c7b<code>RedisConfig</code></li> </ol> <pre><code>/**\n * @author lviter\n */\n@Configuration\npublic class RedisConfig {\n\n    @Value(\"${redis.dbIndex}\")\n    private Integer dbIndex;\n\n    private final String TOPIC = \"__keyevent@\" + dbIndex + \"__:expired\";\n    private final RedisConnectionFactory redisConnectionFactory;\n\n    public RedisConfig(RedisConnectionFactory redisConnectionFactory) {\n        this.redisConnectionFactory = redisConnectionFactory;\n    }\n\n\n    @Bean\n    public RedisMessageListenerContainer redisMessageListenerContainer() {\n        RedisMessageListenerContainer redisMessageListenerContainer = new RedisMessageListenerContainer();\n        redisMessageListenerContainer.setConnectionFactory(redisConnectionFactory);\n        //keyevent\u4e8b\u4ef6\uff0c\u4e8b\u4ef6\u4ee5__keyevent@&lt;db&gt;__\u4e3a\u524d\u7f00\u8fdb\u884c\u53d1\u5e03\n        //db\u4e3aredis\u7b2c\u51e0\u4e2a\u5e93 db2...\n//        redisMessageListenerContainer.addMessageListener(redisKeyExpirationListener, new PatternTopic(TOPIC));\n        return redisMessageListenerContainer;\n    }\n}\n</code></pre>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E5%AE%9E%E7%8E%B0%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97/#redissonwiki","title":"\u4f7f\u7528redisson\u5b9e\u73b0\u5ef6\u8fdf\u961f\u5217\u3010wiki\u3011","text":"<p>\u7531\u4e8e\u5ef6\u65f6\u961f\u5217\u6301\u4e45\u5316\u5728redis\u4e2d\uff0c\u6240\u4ee5\u673a\u5668\u5b95\u673a\u6570\u636e\u4e0d\u4f1a\u5f02\u5e38\u4e22\u5931\uff0c\u673a\u5668\u91cd\u542f\u540e\uff0c\u4f1a\u6b63\u5e38\u6d88\u8d39\u961f\u5217\u4e2d\u79ef\u7d2f\u7684\u4efb\u52a1</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E5%AE%9E%E7%8E%B0%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97/#redisson","title":"redisson\u5b9e\u73b0\u5ef6\u8fdf\u961f\u5217\u7684\u539f\u7406","text":"<p>\u4f7f\u7528redis\u7684zset\u6709\u5e8f\u6027\uff0c\u8f6e\u8be2zset\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\uff0c\u5230\u70b9\u540e\u5c06\u5185\u5bb9\u8fc1\u79fb\u81f3\u5f85\u6d88\u8d39\u7684\u961f\u5217</p> <ul> <li>Redisson\u5ef6\u8fdf\u961f\u5217\u4f7f\u7528\u4e09\u4e2a\u7ed3\u6784\u6765\u5b58\u50a8\uff0c\u4e00\u4e2a\u662fqueueName\u7684list\uff0c\u503c\u662f\u6dfb\u52a0\u7684\u5143\u7d20\uff1b\u4e00\u4e2a\u662ftimeoutSetName\u7684zset\uff0c\u503c\u662f\u6dfb\u52a0\u7684\u5143\u7d20\uff0cscore\u4e3atimeout\u503c\uff1b\u8fd8\u6709\u4e00\u4e2a\u662fgetName()\u7684blockingQueue\uff0c\u503c\u662f\u5230\u671f\u7684\u5143\u7d20\u3002</li> <li>\u5c06\u5143\u7d20\u53ca\u5ef6\u65f6\u4fe1\u606f\u5165\u961f\uff0c\u4e4b\u540e\u5b9a\u65f6\u4efb\u52a1\u5c06\u5230\u671f\u7684\u5143\u7d20\u8f6c\u79fb\u5230\u963b\u585e\u961f\u5217\u3002</li> <li>\u4f7f\u7528HashedWheelTimer\u505a\u5b9a\u65f6\uff0c\u5b9a\u65f6\u5230\u671f\u4e4b\u540e\u4ecezset\u4e2d\u53d6\u5934\u90e8100\u4e2a\u5230\u671f\u5143\u7d20\uff0c\u6240\u4ee5\u5b9a\u65f6\u548c\u8f6c\u79fb\u5230\u963b\u585e\u961f\u5217\u662f\u89e3\u8026\u7684\uff0c\u65e0\u8bba\u662f\u54ea\u4e2atask\u89e6\u53d1\u7684pushTask\uff0c\u6700\u7ec8\u90fd\u662f\u5148\u53d6zset\u7684\u5934\u90e8\u5148\u5230\u671f\u7684\u5143\u7d20\u3002</li> <li>\u5143\u7d20\u6570\u636e\u90fd\u662f\u5b58\u5728redis\u670d\u52a1\u7aef\u7684\uff0c\u5ba2\u6237\u7aef\u53ea\u662f\u6267\u884cHashedWheelTimer\u4efb\u52a1\uff0c\u6240\u4ee5\u5355\u4e2a\u5ba2\u6237\u7aef\u6302\u4e86\u4e0d\u5f71\u54cd\u670d\u52a1\u7aef\u6570\u636e\uff0c\u505a\u5230\u5206\u5e03\u5f0f\u7684\u9ad8\u53ef\u7528\u3002</li> </ul>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E5%AE%9E%E7%8E%B0%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97/#_4","title":"\u5ef6\u8fdf\u961f\u5217\u914d\u7f6e","text":"<pre><code>package com.dadi01.scrm.service.member.provider.config.redisson.delay;\n\nimport org.redisson.api.RBlockingQueue;\nimport org.redisson.api.RDelayedQueue;\nimport org.redisson.api.RedissonClient;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n/**\n * @author lviter\n * redisson\u5ef6\u8fdf\u961f\u5217\n */\n@Configuration\npublic class RedissonQueueConfig {\n\n    private final String queueName = \"queue\";\n\n    @Bean\n    public RBlockingQueue&lt;String&gt; rBlockingQueue(@Qualifier(\"redissonSingle\") RedissonClient redissonClient) {\n        return redissonClient.getBlockingQueue(queueName);\n    }\n\n    @Bean(name = \"rDelayedQueue\")\n    public RDelayedQueue&lt;String&gt; rDelayedQueue(@Qualifier(\"redissonSingle\") RedissonClient redissonClient,\n                                               @Qualifier(\"rBlockingQueue\") RBlockingQueue&lt;String&gt; blockQueue) {\n        return redissonClient.getDelayedQueue(blockQueue);\n    }\n}\n</code></pre> <p>\u5b9a\u4e49\u961f\u5217\u4f7f\u7528\u63a5\u53e3</p> <pre><code>package com.dadi01.scrm.service.member.provider.config.redisson.delay;\n\nimport java.util.concurrent.TimeUnit;\n\n/**\n * @author lviter\n */\npublic interface DelayQueue {\n\n    /**\n     * \u53d1\u5e03\n     *\n     * @param object\n     * @return\n     */\n    Boolean offer(Object object);\n\n    /**\n     * \u5e26\u5ef6\u8fdf\u529f\u80fd\u7684\u961f\u5217\n     *\n     * @param object\n     * @param time\n     * @param timeUnit\n     */\n    void offer(Object object, Long time, TimeUnit timeUnit);\n\n    void offerAsync(Object object, Long time, TimeUnit timeUnit);\n\n    Boolean offerAsync(Object object);\n}\n</code></pre> <p>\u5ef6\u8fdf\u961f\u5217\u5b9e\u73b0</p> <pre><code>package com.dadi01.scrm.service.member.provider.config.redisson.delay;\n\nimport org.redisson.api.RDelayedQueue;\nimport org.redisson.api.RFuture;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\nimport java.util.concurrent.ExecutionException;\nimport java.util.concurrent.TimeUnit;\n\n/**\n * @author lviter\n */\n@Component\npublic class RedissonDelayQueue implements DelayQueue {\n\n    private static Logger log = LoggerFactory.getLogger(RedissonDelayQueue.class);\n\n    @Resource(name = \"rDelayedQueue\")\n    private RDelayedQueue&lt;Object&gt; rDelayedQueue;\n\n\n    @Override\n    public Boolean offer(Object object) {\n        return rDelayedQueue.offer(object);\n    }\n\n    @Override\n    public void offer(Object object, Long time, TimeUnit timeUnit) {\n        rDelayedQueue.offer(object, time, timeUnit);\n    }\n\n    @Override\n    public void offerAsync(Object object, Long time, TimeUnit timeUnit) {\n        rDelayedQueue.offerAsync(object, time, timeUnit);\n    }\n\n    @Override\n    public Boolean offerAsync(Object object) {\n        boolean flag = false;\n        RFuture&lt;Boolean&gt; rFuture = rDelayedQueue.offerAsync(object);\n        try {\n            flag = rFuture.get();\n        } catch (InterruptedException | ExecutionException e) {\n            log.info(\"offerAsync exception:{}\", e.getMessage());\n            e.printStackTrace();\n        }\n        return flag;\n    }\n}\n</code></pre> <p>\u542f\u52a8\u4e00\u4e2a\u540e\u53f0\u76d1\u63a7\u7ebf\u7a0b</p> <pre><code>package com.dadi01.scrm.service.member.provider.config.redisson.delay;\n\nimport org.redisson.api.RBlockingQueue;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.PostConstruct;\nimport javax.annotation.Resource;\n\n/**\n * @author lviter\n */\n@Component\npublic class RedissonTask {\n    @Resource(name = \"rBlockingQueue\")\n    private RBlockingQueue&lt;Object&gt; rBlockingQueue;\n\n    @PostConstruct\n    public void take() {\n        new Thread(() -&gt; {\n            while (true) {\n                try {\n                    System.out.println(\"=========================\" + rBlockingQueue.take());\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }).start();\n    }\n}\n</code></pre> <p>\u4f7f\u7528\u5ef6\u8fdf\u961f\u5217\u53d1\u9001</p> <pre><code>package com.dadi01.scrm.service.member.provider.impl;\n\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.mybatis.spring.annotation.MapperScan;\nimport org.redisson.api.RDelayedQueue;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.test.context.ActiveProfiles;\nimport org.springframework.test.context.junit4.SpringRunner;\n\nimport javax.annotation.Resource;\nimport java.util.concurrent.TimeUnit;\n\n@RunWith(SpringRunner.class)\n@SpringBootTest\n@ActiveProfiles(value = \"llh\")\n@MapperScan(\"com.dadi01.scrm.service.member.provider.mapper\")\npublic class RDelayQueueTests {\n\n    @Resource(name = \"rDelayedQueue\")\n    private RDelayedQueue&lt;Object&gt; rDelayedQueue;\n\n    @Test\n    public void offerAsync() {\n\n        rDelayedQueue.offerAsync(\"llh send message\", 20, TimeUnit.SECONDS);\n    }\n}\n</code></pre>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/","title":"Redis\u6570\u636e\u7ed3\u6784","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#redishttpswwwkancloudcnkancloudredisbook63832","title":"redis\u6709\u54ea\u4e9b\u6570\u636e\u7ed3\u6784\uff08https://www.kancloud.cn/kancloud/redisbook/63832\uff09","text":"<p>\u57fa\u7840\u7684\u6570\u636e\u7ed3\u6784\u6709String\u3001Hash\u3001List\u3001Set\u3001ZSet\u4e94\u79cd\uff0c\u8fd8\u6709HyperLogLog\u3001GEO\u3001Pub\\Sub</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#redisvalue-type8","title":"redis\u5bf9\u4f7f\u7528\u8005\u66b4\u9732\u4e86\u4e94\u79cdvalue type,\u5176\u5e95\u5c42\u5b9e\u73b0\u7684\u6570\u636e\u7ed3\u6784\u67098\u79cd\uff0c\u5206\u522b\u662f\uff1a","text":"<ol> <li>SDS - simple synamic string -\u652f\u6301\u81ea\u52a8\u52a8\u6001\u6269\u5bb9\u7684\u5b57\u8282\u6570\u7ec4\uff08\u7b80\u5355\u52a8\u6001\u5b57\u7b26\u4e32--String\u7c7b\u578b\uff09</li> <li>list - \u94fe\u8868\uff08\u53cc\u5411\u94fe\u8868\uff09</li> <li>dict - \u4f7f\u7528\u53cc\u54c8\u5e0c\u8868\u5b9e\u73b0\uff0c\u652f\u6301\u5e73\u6ed1\u6269\u5bb9\u7684\u5b57\u5178\uff08\u54c8\u5e0c\u8868\uff09</li> <li>zskiplist - \u9644\u52a0\u4e86\u540e\u5411\u6307\u9488\u7684\u8df3\u8868</li> <li>intset - \u7528\u4e8e\u5b58\u50a8\u6574\u6570\u6570\u503c\u96c6\u5408\u7684\u81ea\u6709\u7ed3\u6784\uff08\u6574\u6570\u6570\u7ec4\uff09</li> <li>ziplist - \u5b9e\u73b0\u7c7b\u4f3c\u4e8eTLV,\u4f46\u6bd4TLV\u590d\u6742\uff0c\u7528\u4e8e\u5b58\u50a8\u4efb\u610f\u6570\u636e\u7684\u6709\u5e8f\u5e8f\u5217\u7684\u6570\u636e\u7ed3\u6784\uff08\u538b\u7f29\u5217\u8868\uff09</li> <li>quicklist - \u4ee5ziplist\u4f5c\u4e3a\u7ed3\u70b9\u7684\u53cc\u94fe\u8868\u7ed3\u6784</li> <li>zipmap - \u5c0f\u89c4\u6a21\u573a\u5408\u4f7f\u7528\u7684\u8f7b\u91cf\u7ea7\u5b57\u5178\u7ed3\u6784    </li> </ol>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#_1","title":"\u952e\u503c\u91c7\u7528\u4ec0\u4e48\u7ed3\u6784\u7ec4\u7ec7","text":"<p>\u4f7f\u7528\u54c8\u5e0c\u8868\u6765\u4fdd\u5b58\u6240\u6709\u952e\u503c\u5bf9\uff0c\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u6570\u7ec4\u7684\u6bcf\u4e2a\u5143\u7d20\u79f0\u4e3a\u4e00\u4e2a\u54c8\u5e0c\u6876\u3002\u54c8\u5e0c\u6876\u4e2d\u7684\u5143\u7d20\u4fdd\u5b58\u7684\u5e76\u4e0d\u662f\u503c\u672c\u8eab\uff0c\u800c\u662f\u6307\u5411\u5177\u4f53\u503c\u7684\u6307\u9488\u3002</p> <p></p> <p>\u5982\u56fe\uff0c\u5728\u54c8\u5e0c\u6876\u5185\uff0c\u4e00\u4e2aentry\u5185\u5b58\u653e\u4e86key,value\u7684\u952e\u503c\u6307\u9488\uff0c\u5206\u522b\u6307\u5411\u4e86\u4e0d\u540c\u6570\u636e\u7ed3\u6784\u7684\u503c\u3002 \u54c8\u5e0c\u8868\u6700\u5927\u597d\u5904\u662f\u53ef\u4ee5\u4f7f\u7528O(1)\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u6765\u5feb\u901f\u67e5\u627e\u5230\u952e\u503c\u5bf9==\u6211\u4eec\u53ea\u9700\u8981\u8ba1\u7b97\u952e\u7684\u54c8\u5e0c\u503c\uff0c\u5373\u53ef\u627e\u5230\u54c8\u5e0c\u6876\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u53ef\u4ee5\u8bbf\u95ee\u5230entry\u5143\u7d20\u3002</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#_2","title":"\u5f53\u5199\u5165\u5927\u91cf\u6570\u636e\u65f6\uff0c\u64cd\u4f5c\u53ef\u80fd\u4f1a\u53d8\u6162\uff0c\u4ec0\u4e48\u539f\u56e0\uff1f","text":"<p>\u54c8\u5e0c\u8868\u51b2\u7a81\u548crehash\u53ef\u80fd\u5e26\u6765\u64cd\u4f5c\u963b\u585e\u3002 redis\u89e3\u51b3\u54c8\u5e0c\u51b2\u7a81\u7684\u65b9\u5f0f\uff0c\u5c31\u662f\u94fe\u5f0f\u54c8\u5e0c\u3002\u6307\u540c\u4e00\u4e2a\u54c8\u5e0c\u6876\u4e2d\u7684\u591a\u4e2a\u5143\u7d20\u7528\u4e00\u4e2a\u94fe\u8868\u6765\u4fdd\u5b58\uff0c\u5b83\u4eec\u4e4b\u95f4\u4f9d\u6b21\u7528\u6307\u9488\u8fde\u63a5\u3002</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#string","title":"string\u5b57\u7b26\u4e32","text":"<p>\u5b57\u7b26\u4e32\u7c7b\u578b\u53ef\u4ee5\u5b58\u653e--\u7b80\u5355\u7684\u5b57\u7b26\u4e32\u3001\u590d\u6742\u7684\u5b57\u7b26\u4e32\uff08xml\u3001json\uff09\u3001\u6570\u5b57\uff08\u6574\u6570\u3001\u6d6e\u70b9\u6570\uff09\u3001\u4e8c\u8fdb\u5236\uff08\u56fe\u7247\u3001\u97f3\u9891\u3001\u89c6\u9891\uff09\uff0c\u6700\u5927\u4e0d\u80fd\u8d85\u8fc7512M</p> <ul> <li>\u4f7f\u7528\u573a\u666f<ul> <li>\u7f13\u5b58\u529f\u80fd\uff0c\u5927\u90e8\u5206\u8bf7\u6c42\u6570\u636e\u4eceredis\u83b7\u53d6\uff0c\u800c\u4e0d\u662f\u6301\u4e45\u5c42\uff0c\u652f\u6491\u9ad8\u5e76\u53d1\u8bbf\u95ee\u5bf9\u6301\u4e45\u5c42\u9020\u6210\u7684\u538b\u529b\uff0c\u7f13\u5b58\u53ef\u4ee5\u8d77\u5230\u52a0\u901f\u8bfb\u5199\u548c\u964d\u4f4e\u540e\u7aef\u538b\u529b\u7684\u4f5c\u7528</li> <li>\u8ba1\u6570\u5668\uff0c\u5feb\u901f\u8ba1\u6570\uff0c\u67e5\u8be2\u7f13\u5b58\uff0c\u6bd4\u5982\u767b\u5f55\u8f93\u5165\u4e94\u6b21\u5bc6\u7801\u9519\u8bef\u5c31\u9501\u5b9a\uff0c\u53ef\u4ee5\u7edf\u8ba1\u8f93\u5165\u5bc6\u7801\u6b21\u6570\u3002</li> <li>\u5171\u4eabtoken\uff0credis\u5f15\u5165\u89e3\u51b3\u6700\u5927\u7684\u95ee\u9898\u5c31\u662f\u5929\u7136\u7684\u5206\u5e03\u5f0f\uff0c\u4e00\u5904\u5199\u5165token\uff0c\u5199\u5165\u7528\u6237\u4fe1\u606f\uff0c\u591a\u5904\u8bbf\u95ee\u83b7\u53d6token\u5185json\u6570\u636e</li> <li>\u9650\u901f:\u7528\u6237\u83b7\u53d6\u624b\u673a\u77ed\u4fe1\u9a8c\u8bc1\u7801\uff0c\u4e3a\u4e86\u77ed\u4fe1\u63a5\u53e3\u4e0d\u88ab\u9891\u7e41\u8c03\u7528\uff0c\u9650\u5236\u7528\u6237\u6bcf\u5206\u949f\u83b7\u53d6\u9a8c\u8bc1\u7801\u7684\u9891\u7387</li> </ul> </li> </ul>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#hash","title":"hash\u54c8\u5e0c","text":"<p>hash\u7c7b\u578b\u662f\u6307\u952e\u672c\u8eab\u53c8\u662f\u4e00\u79cd\u952e\u503c\u5bf9\u7ed3\u6784\uff0c\u5982\uff1a</p> <p></p> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u662f\u4f7f\u7528hash\u7ed3\u6784\u5b58\u50a8\u7684Map</p> <pre><code>    /**\n     * HashSet\n     * \n     * @param key \u952e\n     * @param map \u5bf9\u5e94\u591a\u4e2a\u952e\u503c\n     * @return true \u6210\u529f false \u5931\u8d25\n     */\n    public boolean hmset(String key, Map&lt;String, Object&gt; map) {\n        try {\n            redisTemplate.opsForHash().putAll(key, map);\n            return true;\n        } catch (Exception e) {\n            e.printStackTrace();\n            return false;\n        }\n    }\n</code></pre>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#list","title":"list\u5217\u8868","text":"<p>\u5217\u8868\u7c7b\u578b\u7528\u6765\u50a8\u5b58\u591a\u4e2a\u6709\u5e8f\u7684\u5b57\u7b26\u4e32\uff0c\u4e00\u4e2a\u5217\u8868\u6700\u591a\u53ef\u4ee5\u50a8\u5b582\u768432\u6b21\u65b9-1\u4e2a\u5143\u7d20\uff0c\u53ef\u4ee5\u901a\u8fc7\u7d22\u5f15\u4e0b\u6807\u83b7\u53d6\u67d0\u4e2a\u6216\u67d0\u4e2a\u8303\u56f4\u5185\u7684\u5143\u7d20\u5217\u8868</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E6%A0%B8%E5%BF%831-11%E5%9F%BA%E7%A1%80%E7%AF%87/","title":"Redis\u6838\u5fc3-\u521d\u7ea7\u7bc7","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E6%A0%B8%E5%BF%8312-21%E9%AB%98%E7%BA%A7%E7%AF%87/","title":"Redis\u6838\u5fc3-\u9ad8\u7ea7\u7bc7","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/","title":"\u6d88\u606f\u961f\u5217","text":"<p>\u7f3a\u70b9\uff1a\u7cfb\u7edf\u53ef\u7528\u6027\u964d\u4f4e\uff1b\u7cfb\u7edf\u590d\u6742\u5ea6\u63d0\u9ad8\uff1b\u6570\u636e\u4e00\u81f4\u6027\u95ee\u9898</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/#_2","title":"\u4e3a\u4ec0\u4e48\u7528\u6d88\u606f\u961f\u5217\uff1f","text":"<ol> <li>\u89e3\u8026<ol> <li>\u901a\u8fc7MQ,Pub/Sub\u53d1\u5e03\u8ba2\u9605\u6d88\u606f\u6a21\u578b\uff0c\u53ef\u4ee5\u505a\u5230\u7cfb\u7edf\u89e3\u8026</li> <li>A\u7cfb\u7edf\u4ea7\u751f\u6570\u636e\uff0c\u53d1\u9001\u5230MQ\uff0c\u54ea\u4e2a\u7cfb\u7edf\u9700\u8981\uff0c\u81ea\u5df1\u53bbMQ\u6d88\u8d39\u5373\u53ef</li> <li>\u65b0\u589e\u4e00\u4e2a\u7cfb\u7edf\uff0c\u5982\u679c\u9700\u8981\uff0c\u76f4\u63a5\u53ef\u4ee5\u5bf9\u63a5\u6d88\u8d39</li> <li>\u5982\u679c\u54ea\u4e2a\u7cfb\u7edf\u4e0d\u9700\u8981\u6570\u636e\uff0c\u76f4\u63a5\u53d6\u6d88\u6d88\u8d39\u5373\u53ef</li> </ol> </li> <li>\u5f02\u6b65<ol> <li>\u7528\u6237\u53cd\u95ee\u6bcf\u4e2a\u89e3\u8026\u8bf7\u6c42\u5fc5\u987b\u5728200ms\u4ee5\u5185\u5b8c\u6210\uff0c\u5bf9\u7528\u6237\u65e0\u611f\u77e5</li> <li>\u5f02\u6b65\u5904\u7406\uff0c\u53d1\u9001\u5230\u961f\u5217\u6548\u7387\u5feb\uff0c\u4e0d\u5f71\u54cd\u5f53\u524d\u7cfb\u7edf\u4e1a\u52a1</li> </ol> </li> <li>\u524a\u5cf0<ol> <li>\u5728\u67d0\u4e2a\u65f6\u95f4\u70b9\uff0c\u8bbf\u95ee\u91cf\u7a81\u7136\u66b4\u589e\uff0c\u5168\u90e8\u6253\u5230\u6570\u636e\u5e93\u53ef\u80fd\u5bfc\u81f4\u6570\u636e\u5e93\u4e0d\u53ef\u7528\uff0c\u7cfb\u7edf\u6302\u6389</li> </ol> </li> </ol>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/#_3","title":"\u5982\u4f55\u4fdd\u8bc1\u6d88\u606f\u961f\u5217\u7684\u9ad8\u53ef\u7528","text":"<p>RabbitMq\u662f\u57fa\u4e8e\u4e3b\u4ece\u505a\u9ad8\u53ef\u7528\u7684</p> <ol> <li>\u5355\u673a\u6a21\u5f0f</li> <li>\u666e\u901a\u96c6\u7fa4\u6a21\u5f0f\uff08\u65e0\u9ad8\u53ef\u7528\uff0c\u53ea\u662f\u63d0\u9ad8\u4e86\u541e\u5410\u91cf\uff09<ol> <li>\u591a\u53f0\u673a\u5668\u4e0a\u542f\u52a8\u591a\u4e2aRabbitMQ\u5b9e\u4f8b\uff0c\u6bcf\u4e2a\u673a\u5668\u542f\u52a8\u4e00\u4e2a</li> <li>\u521b\u5efa\u7684queue\uff0c\u53ea\u4f1a\u653e\u5728\u4e00\u4e2aRabbitMq\u5b9e\u4f8b\uff0c\u4f46\u6bcf\u4e2a\u5b9e\u4f8b\u90fd\u540c\u6b65queue\u7684\u5143\u6570\u636e\uff08queue\u7684\u914d\u7f6e\u4fe1\u606f\uff09\uff0c\u6d88\u8d39\u65f6\uff0c\u5982\u679c\u8fde\u63a5\u5230\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u90a3\u5b9e\u4f8b\u4f1a\u4ecequeue\u6240\u5728\u5b9e\u4f8b\u4e0a\u62c9\u53d6\u6570\u636e</li> <li>\u5982\u679c\u653equeue\u7684\u5b9e\u4f8b\u5b95\u673a\uff0c\u4f1a\u5bfc\u81f4\u5176\u5b83\u5b9e\u4f8b\u65e0\u6cd5\u62c9\u53d6\uff0c\u5982\u679c\u5f00\u542f\u4e86\u6d88\u606f\u6301\u4e45\u5316\uff0c\u8ba9RabbitMQ\u843d\u5730\u5b58\u50a8\u6d88\u606f\uff0c\u4e0d\u4e00\u5b9a\u4f1a\u4e22\uff0c\u7b49\u5b9e\u4f8b\u6062\u590d\uff0c\u53ef\u4ee5\u7ee7\u7eed\u4ece\u8fd9\u4e2aqueue\u62c9\u53d6\u6570\u636e</li> </ol> </li> <li>\u955c\u50cf\u96c6\u7fa4\u6a21\u5f0f\uff08\u9ad8\u53ef\u7528\u6027\uff09<ol> <li>\u5728\u955c\u50cf\u96c6\u7fa4\u6a21\u5f0f\u4e0b\uff0c\u521b\u5efa\u7684queue\uff0c\u65e0\u8bba\u5143\u6570\u636e\u8fd8\u662fqueue\u91cc\u7684\u6d88\u606f\u90fd\u4f1a\u5b58\u5728\u4e8e\u591a\u4e2a\u5b9e\u4f8b\u4e0a\uff0c\u6bcf\u4e2a\u8282\u70b9\u90fd\u6709queue\u7684\u4e00\u4e2a\u5b8c\u6574\u955c\u50cf\uff0c\u6bcf\u6b21\u5199\u6d88\u606f\u5230queue\u7684\u65f6\u5019\uff0c\u4f1a\u81ea\u52a8\u628a\u6d88\u606f\u540c\u6b65\u5230\u591a\u4e2a\u5b9e\u4f8b\u7684queue\u4e0a</li> <li>\u597d\u5904\uff1a\u4efb\u4f55\u4e00\u4e2a\u673a\u5668\u5b95\u673a\uff0c\u522b\u7684consumer\u90fd\u53ef\u4ee5\u53bb\u5176\u5b83\u8282\u70b9\u4e0a\u6d88\u8d39\u6570\u636e</li> <li>\u7f3a\u70b9\uff1a\u6027\u80fd\u5f00\u9500\u5927\uff0c\u6d88\u606f\u9700\u8981\u540c\u6b65\u5230\u6240\u6709\u673a\u5668\uff0c\u5bfc\u81f4\u7f51\u7edc\u5e26\u5bbd\u538b\u529b\u548c\u6d88\u8017\u5f88\u91cd\uff1b\u6ca1\u6709\u6269\u5c55\u6027\uff0c\u52a0\u673a\u5668\uff0c\u65b0\u589e\u7684\u673a\u5668\u4e5f\u5305\u542b\u4e86queue\u7684\u6240\u6709\u6570\u636e</li> </ol> </li> </ol>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/#_4","title":"\u5982\u4f55\u4fdd\u8bc1\u5e42\u7b49\u6027","text":"<p>\u4e00\u4e2a\u6570\u636e\uff0c\u6216\u8005\u4e00\u4e2a\u8bf7\u6c42\uff0c\u91cd\u590d\u591a\u5c11\u6b21\uff0c\u786e\u4fdd\u5bf9\u5e94\u7684\u6570\u636e\u662f\u4e0d\u4f1a\u6539\u53d8\u7684\uff0c\u4e0d\u80fd\u51fa\u9519\u5c31\u662f\u5e42\u7b49\u6027</p> <p>\u89e3\u51b3\uff1a\u6bd4\u5982\u5199\u5e93\u64cd\u4f5c\uff0c\u73b0\u6839\u636e\u4e3b\u952e\u67e5\u8be2\uff0c\u5982\u679c\u6570\u636e\u6709\u4e86\u5c31\u4e0d\u518d\u63d2\u5165\uff1b\u6216\u8005\u5199\u5165redis\uff0c\u53bb\u68c0\u9a8c\u662f\u5426\u64cd\u4f5c\u8fc7\uff1b\u6216\u8005\u6bcf\u6761\u6d88\u606f\u589e\u52a0\u5168\u5267\u552f\u4e00\u7684id\uff0c\u5148\u53bb\u67e5\u8be2\u518d\u64cd\u4f5c</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/#_5","title":"\u4fdd\u8bc1\u6d88\u606f\u7684\u53ef\u9760\u6027\u4f20\u8f93","text":"<p>rabbitmq\u6d88\u606f\u4e22\u5931\u76843\u79cd\u60c5\u51b5</p> <ol> <li> <p>\u6d88\u606f\u5728\u4f20\u5165\u8fc7\u7a0b\u4e2d\u4e22\u5931    \u89e3\u51b3\uff1a\u5f00\u542fconfirm\u6a21\u5f0f\uff0c\u751f\u4ea7\u8005\u90a3\u91cc\u8bbe\u7f6e\u5f00\u542fconfirm,\u6bcf\u6b21\u5199\u7684\u6d88\u606f\u90fd\u4f1a\u5206\u914d\u4e00\u4e2a\u552f\u4e00\u7684id,\u5982\u679c\u5199\u5165\u4e86RabbitMQ\uff0c\u4f1a\u56de\u4f20\u4e00\u4e2aack\u6d88\u606f\u3002\u5982\u679c\u6ca1\u80fd\u5904\u7406\uff0c\u4f1a\u56de\u8c03\u4e00\u4e2anack\u63a5\u53e3\uff0c\u901a\u77e5\u6d88\u606f\u63a5\u6536\u5931\u8d25\u3002</p> </li> <li> <p>RabbitMQ\u6536\u5230\u6d88\u606f\uff0c\u6682\u5b58\u5728\u5185\u5b58\u4e2d\uff0c\u8fd8\u6ca1\u6d88\u8d39\uff0c\u81ea\u5df1\u6302\u6389\uff0c\u5185\u5b58\u4e2d\u7684\u6570\u636e\u641e\u4e22    \u89e3\u51b3\uff1a</p> <ul> <li>\u5f00\u542fRabbitMQ\u7684\u6301\u4e45\u5316\uff0c\u6d88\u606f\u5199\u5165\u540e\u6301\u4e45\u5316\u5230\u78c1\u76d8\uff0cRabbitMq\u6302\u4e86\u6062\u590d\u540e\u4f1a\u81ea\u52a8\u8bfb\u53d6\u4e4b\u524d\u5b58\u50a8\u7684\u6570\u636e\uff0c\u4e00\u822c\u6570\u636e\u4e0d\u4f1a\u4e22\u5931<ul> <li>\u8bbe\u7f6e\u6301\u4e45\u5316\u6b65\u9aa4\uff1a\uff08\u9700\u8981\u540c\u65f6\u8bbe\u7f6e\u8fd9\u4e24\u4e2a\u6301\u4e45\u5316\u624d\u884c\uff0cRabbitMQ\u54ea\u6015\u6302\u4e86\u518d\u91cd\u542f\uff0c\u4e5f\u4f1a\u4ece\u78c1\u76d8\u4e0a\u91cd\u542f\u6062\u590dqueue\u548c\u6570\u636e\uff09</li> <li>\u521b\u5efaqueue\u7684\u65f6\u5019\u5c06\u5176\u8bbe\u7f6e\u4e3a\u6301\u4e45\u5316\uff1a\u53ef\u4ee5\u4fdd\u8bc1\u6301\u4e45\u5316queue\u7684\u5143\u6570\u636e\uff0c\u4f46\u662f\u4e0d\u4f1a\u6301\u4e45\u5316queue\u91cc\u7684\u6570\u636e\uff1b \u53d1\u9001\u6d88\u606f\u7684\u65f6\u5019\u5c06\u6d88\u606f\u7684deliveryMode\u8bbe\u7f6e\u4e3a2:\u5c06\u6d88\u606f\u8bbe\u7f6e\u6301\u4e45\u5316</li> </ul> </li> <li>\u7ed3\u5408confirm\u673a\u5236\u914d\u5408\u4f7f\u7528\uff0c\u53ea\u6709\u6d88\u606f\u88ab\u6301\u4e45\u5316\u5230\u78c1\u76d8\u540e\uff0c\u624d\u4f1a\u901a\u77e5\u751f\u4ea7\u8005ack</li> </ul> </li> <li> <p>\u6d88\u8d39\u8005\u6536\u5230\u6d88\u606f\uff0c\u4f46\u8fd8\u6ca1\u6765\u5f97\u53ca\u5904\u7406\uff0c\u5c31\u6302\u4e86    \u89e3\u51b3\uff1aRabbitMQ\u63d0\u4f9b\u7684ack\u673a\u5236\uff0c\u5173\u95ed\u81ea\u52a8ack,\u5728\u4e1a\u52a1\u903b\u8f91\u5904\u7406\u5b8c\u540e\u8c03\u7528\u4e00\u4e2a\u624b\u52a8ack\u7684api</p> </li> </ol>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/#_6","title":"\u4fdd\u8bc1\u6d88\u606f\u7684\u987a\u5e8f\u6027","text":"<p>\u62c6\u5206\u591a\u4e2aqueue\uff0c\u4e00\u4e2aqueue\u4e00\u4e2aconsumer\uff0c\u4e00\u4e2aqueue\u5bf9\u5e94\u4e00\u4e2aconsumer\uff0c\u7136\u540e\u8fd9\u4e2aconsumer\u5185\u90e8\u7528\u5185\u5b58\u961f\u5217\u505a\u6392\u961f\uff1bmq\u672c\u8eab\u662f\u65e0\u5e8f\u7684\uff0c\u9700\u8981\u624b\u52a8\u5c06\u591a\u4e2aqueue\u6392\u5e8f\u6216\u8005\u5728\u5185\u5b58\u5185\u6392\u961f\u5904\u7406</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/#_7","title":"\u89e3\u51b3\u6d88\u606f\u961f\u5217\u7684\u5ef6\u65f6\u4ee5\u53ca\u8fc7\u671f\u5931\u6548\u95ee\u9898","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/#mq","title":"\u5927\u91cf\u6d88\u606f\u5728mq\u91cc\u79ef\u538b\u4e86\u51e0\u4e2a\u5c0f\u65f6\u8fd8\u6ca1\u89e3\u51b3","text":"<ul> <li>\u5148\u4fee\u590dconsumer\u95ee\u9898\uff0c\u786e\u4fdd\u6062\u590d\u6d88\u8d39\u901f\u5ea6\uff0c\u7136\u540e\u505c\u6389\u73b0\u6709\u7684consumer</li> <li>\u5199\u4e00\u4e2a\u4e34\u65f6\u5206\u53d1\u6570\u636e\u7684consumer\u7a0b\u5e8f\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u90e8\u7f72\u53bb\u6d88\u8d39\u79ef\u538b\u7684\u6570\u636e\uff0c\u6d88\u8d39\u540e\u4e0d\u505a\u8017\u65f6\u5904\u7406\uff0c\u76f4\u63a5\u5747\u5300\u8f6e\u8be2\u5199\u5165\u4e34\u65f6\u5efa\u7acb\u597d\u768410\u500d\u6570\u91cf\u7684queue</li> <li>\u4e34\u65f6\u5f81\u752810\u500d\u673a\u5668\u6765\u90e8\u7f72consumer\uff0c\u6bcf\u4e00\u6279consumer\u6d88\u8d39\u4e00\u4e2a\u4e34\u65f6queue\u7684\u6570\u636e</li> <li>\u5feb\u901f\u6d88\u8d39\u5b8c\u79ef\u538b\u6570\u636e\u540e\uff0c\u6062\u590d\u539f\u5148\u90e8\u7f72\u7684\u67b6\u6784\uff0c\u91cd\u65b0\u7528\u539f\u5148\u7684consumer\u673a\u5668\u6765\u6d88\u8d39</li> </ul>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/#mq_1","title":"mq\u6d88\u606f\u8fc7\u671f\u5931\u6548\u4e86","text":"<p>\u6279\u91cf\u91cd\u5bfc\uff0c\u5c06\u4e22\u5931\u7684\u6570\u636e\uff0c\u5199\u4e34\u65f6\u7a0b\u5e8f\uff0c\u67e5\u8be2\u51fa\u6765\uff0c\u91cd\u65b0\u704c\u5165mq\u91cc</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/#_8","title":"\u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2a\u6d88\u606f\u961f\u5217","text":"<ol> <li>\u652f\u6301\u53ef\u4f38\u7f29\uff0c\u9700\u8981\u65f6\u5feb\u901f\u6269\u5bb9\uff0c\u589e\u52a0\u541e\u5410\u91cf\u548c\u5bb9\u91cf</li> <li>mq\u6570\u636e\u843d\u78c1\u76d8\uff0c\u987a\u5e8f\u5199</li> <li>\u53ef\u7528\u6027\uff0c\u6302\u4e86\u91cd\u65b0\u9009\u4e3e</li> <li>\u652f\u6301\u6570\u636e0\u4e22\u5931</li> </ol>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/Kafka/Kafka%E5%85%A5%E9%97%A8/","title":"\u6587\u6863","text":"<ul> <li>\u539f\u6587\u94fe\u63a5\uff1ahttps://www.springcloud.cc/apache-kafka-zhcn.html</li> <li>0.11.0\u6587\u6863</li> </ul>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/Kafka/Kafka%E5%85%A5%E9%97%A8/#_2","title":"\u80cc\u666f\u7b80\u4ecb","text":"<p>kafka\uff0c\u5206\u5e03\u5f0f\u7684\u57fa\u4e8e\u53d1\u5e03/\u8ba2\u9605\u6a21\u5f0f\u7684\u6d88\u606f\u961f\u5217\uff0c\u4e3b\u8981\u5e94\u7528\u4e8e\u5927\u6570\u636e\u5b9e\u65f6\u5904\u7406\u9886\u57df</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/Kafka/Kafka%E5%85%A5%E9%97%A8/#abc","title":"ABC\u706b\u7206","text":"<ul> <li>AI\u4eba\u5de5\u667a\u80fd</li> <li>BigData\u5927\u6570\u636e</li> <li>Cloud\u4e91\u8ba1\u7b97</li> </ul>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/Kafka/Kafka%E5%85%A5%E9%97%A8/#kafka","title":"Kafka\u4ecb\u7ecd","text":"<p>\u4f5c\u7528\uff1a\u80fd\u591f\u6709\u6548\u9694\u79bb\u4e0a\u4e0b\u6e38\u4e1a\u52a1\uff0c\u5c06\u4e0a\u6e38\u7a81\u589e\u7684\u6d41\u91cf\u7f13\u5b58\u8d77\u6765\uff0c\u4ee5\u5e73\u6ed1\u65b9\u5f0f\u4f20\u5bfc\u5230\u4e0b\u6e38\u5b50\u7cfb\u7edf\u4e2d\uff0c\u907f\u514d\u4e86\u6d41\u91cf\u7684\u4e0d\u89c4\u5219\u51b2\u51fb\u3002\u751a\u81f3\u53ef\u4ee5\u5728\u4e1a\u52a1\u4e2d\u5b9e\u73b0\uff1a\u6d88\u606f\u5f15\u64ce\u5e94\u7528\uff0c\u5e94\u7528\u7a0b\u5e8f\u96c6\u6210\uff0c\u5206\u5e03\u5f0f\u5b58\u50a8\u6784\u5efa\uff0c\u751a\u81f3\u6d41\u5904\u7406\u5e94\u7528\u7684\u5f00\u53d1\u4e0e\u90e8\u7f72</p> <ul> <li>\u89e3\u8026</li> <li>\u5bb9\u9519\uff1a\u96c6\u7fa4\u90e8\u7f72\uff0c\u80fd\u4fdd\u8bc1\u53ef\u7528\u6027\uff0cleader\u6545\u969c\u4f1a\u91cd\u65b0\u9009\u4e3e\u526f\u672c\u4e2d\u7684follower\u4e3a\u65b0\u7684leader</li> <li>\u7f13\u51b2\uff1a\u53ef\u4ee5\u63a7\u5236\u548c\u4f18\u5316\u6570\u636e\u6d41\u7ecf\u8fc7\u7cfb\u7edf\u7684\u901f\u5ea6\uff0c\u89e3\u51b3\u751f\u4ea7\u6d88\u606f\u548c\u6d88\u8d39\u6d88\u606f\u7684\u5904\u7406\u901f\u5ea6\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5</li> <li>\u5f02\u6b65</li> <li>\u524a\u5cf0</li> </ul>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/Kafka/Kafka%E5%85%A5%E9%97%A8/#_3","title":"\u57fa\u7840\u7ed3\u6784","text":"<ol> <li>Producer\uff1a\u751f\u4ea7\u8005\uff0c\u5411Kafka broker\u53d1\u6d88\u606f\u7684\u5ba2\u6237\u7aef</li> <li>Consumer\uff1a\u6d88\u8d39\u8005\uff0c\u5411Kafka broker\u53d6\u6d88\u606f\u7684\u5ba2\u6237\u7aef</li> <li>Consumer Group\uff08CG\uff09\uff1a\u6d88\u8d39\u8005\u7ec4\uff0c\u591a\u4e2aconsumer\u7ec4\u6210\u3002\u6d88\u8d39\u8005\u7ec4\u5185\u6bcf\u4e2a\u6d88\u8d39\u8005\u8d1f\u8d23\u6d88\u8d39\u4e0d\u540c\u5206\u533a\u7684\u6570\u636e\uff0c\u4e00\u4e2a\u5206\u533a\u53ea\u80fd\u7531\u4e00\u4e2a\u7ec4\u5185\u6d88\u8d39\u8005\u6d88\u8d39\uff1b\u6d88\u8d39\u8005\u4e4b\u95f4\u4e92\u4e0d\u5f71\u54cd\uff0c\u6d88\u8d39\u8005\u7ec4\u662f\u903b\u8f91\u4e0a\u7684\u4e00\u4e2a\u8ba2\u9605\u8005</li> <li>Broker\uff1a\u4e00\u53f0Kafka\u670d\u52a1\u5668\u5c31\u662f\u4e00\u4e2abroker\u3002\u4e00\u4e2a\u96c6\u7fa4\u6709\u591a\u4e2abroker\u7ec4\u6210\uff0c\u4e00\u4e2abroker\u53ef\u4ee5\u5bb9\u7eb3\u591a\u4e2atopic</li> <li>Topic\uff1a\u961f\u5217\uff0c\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u9762\u5411\u7684\u90fd\u662f\u4e00\u4e2atopic</li> <li>Partition\uff1a\u6269\u5c55\u6027\uff0c\u4e00\u4e2a\u5927\u7684topic\u53ef\u4ee5\u5206\u5e03\u5230\u591a\u4e2abroker\u670d\u52a1\u5668\u4e0a\uff0c\u4e00\u4e2atopic\u53ef\u4ee5\u5206\u4e3a\u591a\u4e2apartition\uff0c\u6bcf\u4e2apartition\u662f\u4e00\u4e2a\u6709\u5e8f\u7684\u961f\u5217</li> <li>Replica\uff1a\u526f\u672c\uff0c\u96c6\u7fa4\u4e2d\u67d0\u4e2a\u8282\u70b9\u53d1\u751f\u6545\u969c\u65f6\uff0c\u8be5\u8282\u70b9\u7684partition\u6570\u636e\u4e0d\u4e22\u5931\uff0c\u4e14kafka\u4ecd\u80fd\u7ee7\u7eed\u5de5\u4f5c\uff0c\u4e00\u4e2atopic\u7684\u6bcf\u4e2a\u5206\u533a\u90fd\u6709\u82e5\u5e72\u4e2a\u526f\u672c\uff0c\u4e00\u4e2aleader\u548c\u82e5\u5e72\u4e2afollower</li> <li>leader\uff1a\u6bcf\u4e2a\u5206\u533a\u591a\u4e2a\u526f\u672c\u7684\u4e3b\u8282\u70b9\uff0c\u751f\u4ea7\u8005\u53d1\u9001/\u6d88\u8d39\u8005\u6d88\u8d39\u7684\u6570\u636e\u5bf9\u8c61\u90fd\u662fleader</li> <li>follower\uff1a\u5b9e\u65f6\u4eceleader\u4e2d\u540c\u6b65\u6570\u636e\uff0c\u4fdd\u6301\u548cleader\u6570\u636e\u7684\u540c\u6b65\u3002leader\u53d1\u751f\u6545\u969c\u65f6\uff0c\u67d0\u4e2afollower\u4f1a\u6210\u4e3a\u65b0\u7684leader</li> </ol>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/Kafka/Kafka%E5%85%A5%E9%97%A8/#_4","title":"\u6781\u7b80\u6570\u636e\u7ed3\u6784","text":"<p>\u6d88\u606f\u961f\u5217\u662f\u4ee5log\u6587\u4ef6\u7684\u5f62\u5f0f\u5b58\u50a8\uff0c\u6d88\u606f\u751f\u4ea7\u8005\u53ea\u80fd\u5c06\u6d88\u606f\u6dfb\u52a0\u5230\u65e2\u6709\u7684\u6587\u4ef6\u5c3e\u90e8\uff0c\u6ca1\u6709\u4efb\u4f55ID\u4fe1\u606f\u7528\u4e8e\u6d88\u606f\u7684\u5b9a\u4f4d\uff0c\u5b8c\u5168\u4f9d\u9760\u6587\u4ef6\u5185\u7684\u4f4d\u79fb\uff0c\u56e0\u6b64\u6d88\u606f\u7684\u4f7f\u7528\u8005\u53ea\u80fd\u4f9d\u9760\u6587\u4ef6\u4f4d\u79fb\u987a\u5e8f\u8bfb\u53d6\u6d88\u606f\uff0c\u8fd9\u6837\u4e5f\u5c31\u4e0d\u9700\u8981\u7ef4\u62a4\u590d\u6742\u7684\u652f\u6301\u968f\u5373\u8bfb\u53d6\u7684\u7d22\u5f15\u7ed3\u6784\uff08\u6240\u4ee5\u53ef\u4ee5\u4fdd\u8bc1\uff0c\u5206\u533a\u5185\u90e8\u6709\u5e8f\uff0c\u4f46\u662f\u5168\u5c40\u5e76\u4e0d\u6709\u5e8f\u3002\uff09</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/Kafka/Kafka%E5%85%A5%E9%97%A8/#_5","title":"\u6700\u5927\u5316\u6570\u636e\u4f20\u8f93\u6548\u7387","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/Kafka/Kafka%E5%85%A5%E9%97%A8/#_6","title":"\u6587\u6863","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/RabbitMq/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8/","title":"RabbitMQ\u5b89\u88c5\u53ca\u4f7f\u7528","text":""},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/RabbitMq/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8/#linuxrabbitmq","title":"\u4e00.Linux\u7cfb\u7edf\u4e2d\u5b89\u88c5RabbitMQ","text":"<p>\u7531\u4e8eRabbitMQ\u4f9d\u8d56\u4e8eErlang,\u6240\u4ee5\u5148\u8981\u5728\u673a\u5668\u4e0a\u5b89\u88c5Erlang\u73af\u5883</p>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/RabbitMq/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8/#_1","title":"\u5355\u673a\u7248","text":"<p>1.\u5b89\u88c5GCC GCC-C++ Openssl\u7b49\u6a21\u5757</p> <pre><code>yum -y install make gcc gcc-c++ kernel-devel m4 ncurses-devel openssl-devel\n</code></pre> <p>2.\u5b89\u88c5ncurses</p> <pre><code>yum -y install ncurses-devel\n</code></pre> <p>3.\u5b89\u88c5erlang\u73af\u5883</p> <pre><code>wget http://erlang.org/download/otp_src_18.2.1.tar.gz     --\u8fd9\u4e00\u6b65\u6bd4\u8f83\u6162\ntar xvfz otp_src_18.2.1.tar.gz \n\u7136\u540e\u8fdb\u5165\u89e3\u538b\u540e\u7684\u6587\u4ef6,\u6267\u884c\u4e0b\u9762\u547d\u4ee4\n./configure \nmake install\n</code></pre>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/RabbitMq/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8/#erlangrabbitmq","title":"\u7ecf\u8fc7\u4e0a\u8ff0\u6b65\u9aa4,\u5c31\u7b97\u5b8c\u6210Erlang\u73af\u5883\u7684\u642d\u5efa\u4e86,\u63a5\u4e0b\u6765\u5b89\u88c5RabbitMQ","text":"<p>4.\u4e0b\u8f7drabbitmq-server-3.6.9.tar.xz</p> <pre><code>wget http://www.rabbitmq.com/releases/rabbitmq-server/v3.6.9/rabbitmq-server-generic-unix-3.6.9.tar.xz\n</code></pre> <p>5.\u5bf9\u4e8e\u4e0b\u8f7dxz\u5305\u8fdb\u884c\u89e3\u538b\uff0c\u9996\u5148\u5148\u4e0b\u8f7dxz\u538b\u7f29\u5de5\u5177</p> <pre><code>yum install xz\n</code></pre> <p>6.\u5bf9rabbitmq\u5305\u8fdb\u884c\u89e3\u538b</p> <pre><code>xz -d xz -d rabbitmq-server-generic-unix-3.6.9.tar.xz\n\ntar -xvf rabbitmq-server-generic-unix-3.6.9.tar\n</code></pre> <p>7.\u590d\u5236\u89e3\u538b\u5305\u5230/usr/local/\u4e0b,\u5e76\u6539\u540drabbitmq</p> <pre><code>cp -r rabbitmq_server-3.6.9 /usr/local/rabbitmq\n</code></pre> <p>8.\u8fd9\u79cd\u4e0b\u8f7d\u7684\u65b9\u5f0f\u89e3\u538b\u540e\u76f4\u63a5\u53ef\u4ee5\u4f7f\u7528\uff0c\u65e0\u9700\u518d\u7f16\u8bd1\u5b89\u88c5</p> <pre><code>\u8fdb\u5165\u5230rabbit\u6587\u4ef6\u5185\uff0c\u5176\u547d\u4ee4\u6587\u4ef6\u5b58\u5728\u4e8esbin\u6587\u4ef6\u5939\u4e0b\uff0c\u56e0\u6b64\u9700\u8981\u5c06sbin\u6587\u4ef6\u5939\u7684\u8def\u5f84\u6dfb\u52a0\u5230PATH\u4e2d\uff1a\u4fee\u6539/etc/profile\n\nexport PATH=/usr/local/rabbitmq/sbin:$PATH   \n\n\u6267\u884c\u4e00\u4e0b\u547d\u4ee4\u4f7f\u5f97PATH\u8def\u5f84\u66f4\u65b0\uff0crabbitMQ\u5b89\u88c5\u6210\u529f\nsource /etc/profile\n</code></pre> <p>9.\u540e\u53f0\u542f\u52a8RabbitMQ\u8bbe\u7f6e</p> <pre><code>rabbitmq-plugins enable rabbitmq_management   #\u542f\u52a8\u540e\u53f0\u7ba1\u7406\nrabbitmq-server -detached    #\u540e\u53f0\u8fd0\u884crabbitmq\n</code></pre> <p>10.\u8bbe\u7f6e\u7aef\u53e3\u53f7\u6216\u8005\u5173\u95ed\u9632\u706b\u5899,\u4ee5\u4fbf\u5916\u90e8\u8bbf\u95ee</p> <pre><code>iptables -I INPUT -p tcp --dport 15672 -j ACCEPT\n\u6216\nservice iptables stop\n</code></pre> <p>11.RabbitMQ\u9875\u9762\u9ed8\u8ba4\u662f\u88ab\u7981\u6b62,\u5982\u679c\u9700\u8981\u8bbf\u95ee,\u5fc5\u987b\u521b\u5efa\u7528\u6237,\u5e76\u4e14\u8bbe\u7f6e\u6743\u9650,\u5982\u4e0b\u8bbe\u7f6e</p> <pre><code>\u6dfb\u52a0\u7528\u6237:rabbitmqctl add_user admin admin\n\u6dfb\u52a0\u6743\u9650:rabbitmqctl set_permissions -p \"/\" admin \".*\" \".*\" \".*\"\n\u4fee\u6539\u7528\u6237\u89d2\u8272:rabbitmqctl set_user_tags admin administrator\n</code></pre>"},{"location":"%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/RabbitMq/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8/#rabbitmq_1","title":"\u4e8c.RabbitMQ\u4f7f\u7528","text":"<p>1.\u8ba2\u9605\u6a21\u5f0f</p> <p>\u5f53\u591a\u4e2a\u961f\u5217\u4e0e\u4ea4\u6362\u673a\u7ed1\u5b9a\u65f6,\u6d88\u606f\u7684\u751f\u4ea7\u8005\u751f\u4ea7\u6d88\u606f\u5e76\u4f20\u9012\u5230\u4ea4\u6362\u673a,\u4ea4\u6362\u673a\u6839\u636ebinding\u628a\u6d88\u606f\u4f20\u9012\u7ed9\u6240\u6709\u7ed1\u5b9a\u7684\u961f\u5217.\u5982\u679c\u961f\u5217\u4e0b\u9762\u6709\u591a\u4e2a\u6d88\u606f\u7684\u6d88\u8d39\u8005,\u5219\u4f1a\u8f6e\u8be2\u6d88\u8d39\u6d88\u606f.\u961f\u5217\u91c7\u7528\u7684\u662f\u533f\u540d\u961f\u5217,\u533f\u540d\u961f\u5217\u4f1a\u968f\u673a\u4ea7\u751f\u4e00\u4e2a\u961f\u5217\u540d,\u5e76\u4e14\u6d88\u8d39\u8005\u5982\u679c\u4e0d\u5b58\u5728\u4ee5\u540e,\u961f\u5217\u4e5f\u4f1a\u81ea\u52a8\u6d88\u5931.</p> <pre><code>/**\n * rabbitmq \u914d\u7f6e\u7c7b\n * */\n@Configuration\npublic class RabbitMQConfig {\n    //\u5f97\u5230\u4e00\u4e2a\u53d1\u5e03\u8ba2\u9605\u7684\u4ea4\u6362\u673a\n    @Bean\n    public FanoutExchange getFanoutExchange() {\n        return new FanoutExchange(\"fanoutexchange\");\n    }\n\n    //\u5f97\u5230\u4e09\u4e2a\u961f\u5217\n    @Bean\n    public Queue createQueue1(){\n        return new AnonymousQueue();\n    }\n\n    @Bean\n    public Queue createQueue2() {\n        return new AnonymousQueue();\n    }\n    @Bean\n    public Queue createQueue3() {\n        return new AnonymousQueue();\n    }\n\n    //\u7ed1\u5b9a\u961f\u5217\u548c\u4ea4\u6362\u673a\n    @Bean\n    public Binding getBinding1(Queue createQueue1,FanoutExchange fanoutExchange){\n        return BindingBuilder.bind(createQueue1).to(fanoutExchange);\n    }\n\n    @Bean\n    public Binding getBinding2(Queue createQueue2, FanoutExchange fanoutExchange) {\n        return BindingBuilder.bind(createQueue2).to(fanoutExchange);\n    }\n\n    @Bean\n    public Binding getBinding(Queue createQueue3, FanoutExchange fanoutExchange) {\n        return BindingBuilder.bind(createQueue3).to(fanoutExchange);\n    }\n\n}\n</code></pre> <pre><code>/**\n * \u6d88\u606f\u7684\u751f\u4ea7\u8005\n * */\n@Component\npublic class MessageProvider {\n    @Autowired\n    private AmqpTemplate amqpTemplate;\n    @Autowired\n    private FanoutExchange fanoutExchange;\n\n    public void sendMessage(String message){\n        this.amqpTemplate.convertAndSend(fanoutExchange.getName(),null,message);\n    }\n}\n</code></pre> <pre><code>@Component\n@RabbitListener(queues = \"#{createQueue1.name}\")\npublic class MessageCustomer {\n\n    @RabbitHandler\n    public void getMessage(String message){\n        System.out.println(\"\u7b2c\u4e00\u4e2a\u4fe1\u606f\u63a5\u6536\u8005:\"+message);\n    }\n}\n</code></pre> <pre><code>@Component\n@RabbitListener(queues = \"#{createQueue2.name}\")\npublic class SecondMessageCustomer {\n    @RabbitHandler\n    public void getMessage(String message) {\n        System.out.println(\"\u7b2c\u4e8c\u4e2a\u4fe1\u606f\u63a5\u6536\u8005:\"+message);\n    }\n}\n</code></pre> <pre><code>@Component\n@RabbitListener(queues = \"#{createQueue3.name}\")\npublic class ThirdMessageCustomer {\n    @RabbitHandler\n    public void getMessage(String message) {\n        System.out.println(\"\u7b2c\u4e09\u4e2a\u4fe1\u606f\u63a5\u6536\u8005:\"+message);\n    }\n}\n</code></pre> <pre><code>/**\n * \u6d4b\u8bd5\u7c7b\n * */\n@RunWith(SpringRunner.class)\n@SpringBootTest\npublic class RabbitMQTest {\n    @Autowired\n    private MessageProvider messageProvider;\n    @Test\n    public void messageTest() {\n        messageProvider.sendMessage(\"hello\");\n    }\n}\n</code></pre> <p>2.\u70b9\u5bf9\u70b9\u6a21\u5f0f</p> <p>\u961f\u5217\u548c\u4ea4\u6362\u673a\u7ed1\u5b9a\u4ea7\u751f\u4e00\u4e2abinding.\u5f53routing key\u4e0ebinding key\u5b8c\u5168\u5339\u914d\u7684\u65f6\u5019,\u6d88\u606f\u624d\u4f1a\u88ab\u6295\u9012</p> <pre><code>//\u70b9\u5bf9\u70b9\u6a21\u5f0f\n@Bean(\"directexchange\")\npublic DirectExchange getDirectExchange() {\n    return new DirectExchange(\"directexchange\");\n}\n@Bean(\"directqueue\")\npublic Queue getDirectQueue() {\n    return new Queue(\"directqueue\");\n}\n@Bean\npublic Binding getDirectBindingKey(@Qualifier(value = \"directqueue\") Queue queue,@Qualifier(value = \"directexchange\") Exchange exchange) {\n    return BindingBuilder.bind(queue).to(exchange).with(\"direct_key\").noargs();\n}\n</code></pre> <pre><code>//\u70b9\u5bf9\u70b9\u6a21\u5f0f\npublic void sendMessageFaceToFace(String message) {\n    this.amqpTemplate.convertAndSend(directExchange.getName(),\"direct_key\",message);\n}\n</code></pre> <p>\u70b9\u5bf9\u70b9\u62c9\u53d6\u6a21\u5f0f:</p> <p>\u6d88\u8d39\u8005\u4e0d\u662f\u548c\u961f\u5217\u4fdd\u6301\u957f\u8fde\u63a5\u72b6\u6001,\u800c\u662f\u4e3b\u52a8\u62c9\u53d6\u6d88\u606f</p> <pre><code>@Component\npublic class AckMessageCustomer {\n    public void processMessage2() throws IOException, TimeoutException {\n        ConnectionFactory factory = new ConnectionFactory();\n        factory.setHost(\"192.168.245.128\");\n        factory.setPort(5672);\n        factory.setUsername(\"admin\");\n        factory.setPassword(\"admin\");\n        Connection connection = factory.newConnection();\n        Channel channel = connection.createChannel();\n        //pull\u65b9\u5f0f\u83b7\u53d6\u4fe1\u606f\n        GetResponse response = channel.basicGet(\"directqueue\", false);\n        channel.basicAck(response.getEnvelope().getDeliveryTag(),false);\n        //channel.basicAck(tag, false);//\u786e\u8ba4\u6536\u5230\u4fe1\u606f.\u7b2c\u4e8c\u4e2a\u53c2\u6570\u5982\u679c\u4e3atrue\u65f6,\u8868\u793atag\u5c0f\u4e8e\u5f53\u524dtag\u7684\u4fe1\u606f\u90fd\u4f1a\u88ab\u4e00\u6b21\u6027\u786e\u8ba4\n        connection.close();\n    }\n}\n</code></pre> <p>3.rabbitmq\u6d88\u606f\u7684\u786e\u8ba4\u673a\u5236</p> <p>(1)\u6d88\u606f\u751f\u4ea7\u8005\u5230\u4ea4\u6362\u673a\u4e4b\u95f4\u7684\u6d88\u606f\u786e\u8ba4:</p> <p>\u901a\u8fc7\u5b9e\u73b0ConfirmCallback \u63a5\u53e3\uff0c\u6d88\u606f\u53d1\u9001\u5230 Broker \u540e\u89e6\u53d1\u56de\u8c03\uff0c\u786e\u8ba4\u6d88\u606f\u662f\u5426\u5230\u8fbe Broker \u670d\u52a1\u5668</p> <p>(2)\u4ea4\u6362\u673a\u5230\u961f\u5217\u4e4b\u95f4\u7684\u6d88\u606f\u786e\u8ba4:</p> <p>\u901a\u8fc7\u5b9e\u73b0ReturnCallbac\u63a5\u53e3,\u542f\u52a8\u6d88\u606f\u5931\u8d25\u8fd4\u56de,\u6bd4\u5982\u8def\u7531\u4e0d\u5230\u961f\u5217\u65f6\u89e6\u53d1\u56de\u8c03</p> <pre><code>@Component\npublic class RabbitTemplateConfig implements RabbitTemplate.ReturnCallback,RabbitTemplate.ConfirmCallback {\n    @Autowired\n    private RabbitTemplate rabbitTemplate;\n\n    @PostConstruct\n    public void init(){\n        rabbitTemplate.setConfirmCallback(this);\n    }\n\n    @Override\n    public void confirm(CorrelationData correlationData, boolean ack, String cause) {\n        System.out.println(\"\u4ea4\u6362\u673a\u786e\u8ba4\u4fe1\u606f:\u552f\u4e00\u6807\u8bc6\"+correlationData+\",\u786e\u8ba4\u7ed3\u679c:\"+ack+\",\u5931\u8d25\u539f\u56e0:\"+cause);\n    }\n\n    @Override\n    public void returnedMessage(Message message, int replyCode, String replyText, String exchange, String routingKey) {\n        System.out.println(\"\u961f\u5217\u6536\u5230\u4fe1\u606f:\"+message+\",\u56de\u590d\u6d88\u606f\u7801:\"+replyCode+\",\u56de\u590d\u5185\u5bb9:\"+replyText+\",\u4ea4\u6362\u673a:\"+exchange+\",\u8def\u7531\u952e:\"+routingKey);\n    }\n}\n</code></pre> <p>(3)\u961f\u5217\u548c\u6d88\u8d39\u8005\u4e4b\u95f4\u7684\u6d88\u606f\u786e\u8ba4:</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u662f,\u6d88\u8d39\u8005\u6536\u5230\u6d88\u606f,\u961f\u5217\u5c31\u5220\u9664\u8fd9\u6761\u6d88\u606f,\u65e0\u8bba\u6d88\u8d39\u8005\u662f\u5426\u6b63\u786e\u5904\u7406\u8fd9\u6761\u6d88\u606f.\u4e3a\u4e86\u4fdd\u8bc1\u6570\u636e\u4e0d\u88ab\u4e22\u5931\uff0cRabbitMQ\u652f\u6301\u6d88\u606f\u786e\u8ba4\u673a\u5236\uff0c\u5373ack.\u5f53\u6d88\u8d39\u8005\u6b63\u786e\u5904\u7406\u5b8c\u6d88\u606f\u4ee5\u540e,\u624d\u901a\u77e5\u961f\u5217\u5220\u9664\u76f8\u5e94\u7684\u6d88\u606f,\u800c\u4e0d\u662f\u4e00\u6536\u5230\u6d88\u606f\u5c31\u7acb\u5373\u901a\u77e5\u961f\u5217\u5220\u9664\u6d88\u606f.</p> <p>ack\u7684\u6a21\u5f0f\u6709\u4e09\u79cd:</p> <pre><code>AcknowledgeMode.NONE\uff1a\u81ea\u52a8\u786e\u8ba4\nAcknowledgeMode.AUTO\uff1a\u6839\u636e\u60c5\u51b5\u786e\u8ba4\nAcknowledgeMode.MANUAL\uff1a\u624b\u52a8\u786e\u8ba4\n</code></pre> <pre><code>@Component\n@RabbitListener(queues = \"directqueue\")\npublic class AckMessageCustomer {\n\n    @RabbitHandler\n    public void processMessage2(String message, Channel channel, @Header(AmqpHeaders.DELIVERY_TAG) long tag) throws IOException {\n        System.out.println(message);\n        try {\n            channel.basicAck(tag, false);//\u786e\u8ba4\u6536\u5230\u4fe1\u606f.\u7b2c\u4e8c\u4e2a\u53c2\u6570\u5982\u679c\u4e3atrue\u65f6,\u8868\u793atag\u5c0f\u4e8e\u5f53\u524dtag\u7684\u4fe1\u606f\u90fd\u4f1a\u88ab\u4e00\u6b21\u6027\u786e\u8ba4\n        } catch (IOException e) {\n            channel.basicNack(tag,false,true);//\u672a\u6536\u5230\u4fe1\u606f.\u7b2c\u4e09\u4e2a\u53c2\u6570\u5982\u679c\u4e3atrue\u65f6,\u8868\u793a\u8981\u91cd\u590d\u53d1\u9001\u8fd9\u6761\u6d88\u606f\n            channel.basicReject(tag,true);//\u4e22\u5f03\u4fe1\u606f\n        }\n    }\n}\n</code></pre>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/ClickHouse%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85/","title":"ClickHouse\u96c6\u7fa4\u5b89\u88c5","text":""},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/ClickHouse%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85/#clickhouse","title":"Clickhouse \u96c6\u7fa4\u5b89\u88c5","text":""},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/ClickHouse%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85/#_1","title":"\u524d\u671f\u51c6\u5907","text":"<p>1.\u8bbe\u7f6e\u4e3b\u673a\u540d\u548chosts\u6620\u5c04 </p> <p>2.\u5173\u95ed\u9632\u706b\u5899\u548cSELinux </p> <p>3.\u914d\u7f6entp\u65f6\u95f4\u540c\u6b65 </p> <p>4.\u5b89\u88c5zookeeper\u548cJDK\u73af\u5883</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/ClickHouse%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85/#_2","title":"\u4e00\u3001\u5b89\u88c5\u5355\u673a","text":""},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/ClickHouse%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85/#3centos7","title":"(3\u53f0\u90fd\u64cd\u4f5c,\u4ee5CentOS7\u4e3a\u4f8b)","text":"<p>1.1 \u5728\u7ebf\u5b89\u88c5</p> <p>\u4ece\u5b98\u65b9\u4ed3\u5e93\u5b89\u88c5 (\u4f7f\u7528root\u7528\u6237\u5728\u6240\u6709\u8282\u70b9\u64cd\u4f5c)</p> <pre><code>#\u4f7f\u7528\u811a\u672c\u5b89\u88c5yum\u6e90\ncurl -s https://packagecloud.io/install/repositories/altinity/clickhouse/script.rpm.sh | sudo bash\n\u200b\n#yum \u5b89\u88c5 server \u4ee5\u53ca client\nyum install -y clickhouse-server clickhouse-client\n\u200b\n#\u67e5\u770b\u662f\u5426\u5b89\u88c5\u5b8c\u6210\nsudo yum list installed 'clickhouse*'\n</code></pre> <p>\u79bb\u7ebf\u5b89\u88c5</p> <pre><code>\u5982\u679c\u7f51\u7edc\u65e0\u6cd5\u8fde\u63a5\u5c31\u91c7\u7528\u79bb\u7ebf\u65b9\u5f0f\u5b89\u88c5\uff0c\u4e0a\u4f20rpm\u5305\u5230/apps/source/\n[root@ddyw-data-center-dev01 ~]# cd /apps/source/\n[root@ddyw-data-center-dev01 source]# ll\n-rw-r--r--. 1 root root      6384 7\u6708  29 10:09 clickhouse-client-20.8.3.18-1.el7.x86_64.rpm\n-rw-r--r--. 1 root root  69093220 7\u6708  29 10:09 clickhouse-common-static-20.8.3.18-1.el7.x86_64.rpm\n-rw-r--r--. 1 root root  36772044 7\u6708  29 10:09 clickhouse-server-20.8.3.18-1.el7.x86_64.rpm\n-rw-r--r--. 1 root root     14472 7\u6708  29 10:09 clickhouse-server-common-20.8.3.18-1.el7.x86_64.rpm\n[root@ddyw-data-center-dev01 source]# yum install -y clickhouse-*\n</code></pre> <p>1.2 \u4fee\u6539\u914d\u7f6e\u53c2\u6570</p> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6config.xml (\u5728node01\u8282\u70b9\u64cd\u4f5c) \u5f00\u8d77\u8fdc\u7a0b\u8bbf\u95ee\u6a21\u5f0f,\u914d\u7f6e\u6570\u636e\u76ee\u5f55\u4fee\u6539\uff0c\u7531\u4e8e\u9ed8\u8ba4\u7aef\u53e39000\u88ab\u5360\u7528\uff0c\u4fee\u6539\u4e3a9002</p> <pre><code># vim /etc/clickhouse-server/config.xml\n    &lt;http_port&gt;8123&lt;/http_port&gt;\n    &lt;tcp_port&gt;9002&lt;/tcp_port&gt;    //\u66f4\u6539\u9ed8\u8ba4\u76849000\u7aef\u53e3\n    &lt;mysql_port&gt;9004&lt;/mysql_port&gt;\n\n    &lt;listen_host&gt;::&lt;/listen_host&gt;    //\u6ce8\u91ca\u6253\u5f00\n\u200b\n    &lt;path&gt;/apps/clickhouse/data/&lt;/path&gt;   //\u8bbe\u7f6e\u6570\u636e\u5b58\u50a8\u76ee\u5f55\n    &lt;tmp_path&gt;/apps/clickhouse/tmp/&lt;/tmp_path&gt;   //\u8bbe\u7f6e\u7f13\u5b58\u76ee\u5f55\n\u200b\n# \u6dfb\u52a0ClickHouse\u5206\u5e03\u5f0fDDL\u8bb0\u5f55\u81ea\u52a8\u6e05\u7406\u914d\u7f6e\n    &lt;distributed_ddl&gt;\n        &lt;!-- Path in ZooKeeper to queue with DDL queries --&gt;\n        &lt;path&gt;/clickhouse/task_queue/ddl&lt;/path&gt;\n        &lt;cleanup_delay_period&gt;60&lt;/cleanup_delay_period&gt;   //\u641c\u7d22ddl \u589e\u52a0\u4ee5\u4e0b3\u884c\n        &lt;task_max_lifetime&gt;86400&lt;/task_max_lifetime&gt;\n        &lt;max_tasks_in_queue&gt;200&lt;/max_tasks_in_queue&gt;\n        &lt;!-- Settings from this profile will be used to execute DDL queries --&gt;\n        &lt;!-- &lt;profile&gt;default&lt;/profile&gt; --&gt;\n    &lt;/distributed_ddl&gt;\n\u200b\ncleanup_delay_period\uff1a\u68c0\u67e5DDL\u8bb0\u5f55\u6e05\u7406\u7684\u95f4\u9694\uff0c\u5355\u4f4d\u4e3a\u79d2\uff0c\u9ed8\u8ba460\u79d2\u3002\ntask_max_lifetime\uff1a\u5206\u5e03\u5f0fDDL\u8bb0\u5f55\u53ef\u4ee5\u4fdd\u7559\u7684\u6700\u5927\u65f6\u957f\uff0c\u5355\u4f4d\u4e3a\u79d2\uff0c\u9ed8\u8ba4\u4fdd\u75597\u5929\u3002\nmax_tasks_in_queue\uff1a\u5206\u5e03\u5f0fDDL\u961f\u5217\u4e2d\u53ef\u4ee5\u4fdd\u7559\u7684\u6700\u5927\u8bb0\u5f55\u6570\uff0c\u9ed8\u8ba4\u4e3a1000\u6761\u3002\n</code></pre>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/ClickHouse%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85/#etcmetrikaxml","title":"\u4e8c\u3001\u751f\u6210 /etc/metrika.xml \u914d\u7f6e\u6587\u4ef6","text":"<p>2.1 \u65b0\u5efametrika.xml\u6587\u4ef6, \u914d\u7f6e\u96c6\u7fa4\u4fe1\u606f (\u5728node01\u8282\u70b9\u64cd\u4f5c)</p> <pre><code># vim /etc/metrika.xml\n\u200b\n&lt;?xml version=\"1.0\"?&gt;\n&lt;yandex&gt;\n&lt;clickhouse_remote_servers&gt;\n    &lt;ddyw_ck_dev&gt; &lt;!--\u96c6\u7fa4\u540d\u79f0\uff0c\u81ea\u5b9a\u4e49 \u6bcf\u4e2a\u5206\u7247\u53ea\u67091\u4e2a\u526f\u672c--&gt;\n        &lt;shard&gt; &lt;!--\u5206\u72471--&gt;\n            &lt;replica&gt;\n                &lt;host&gt;ddyw-data-center-dev01&lt;/host&gt;\n                &lt;port&gt;9002&lt;/port&gt;\n            &lt;/replica&gt;\n        &lt;/shard&gt;\n        &lt;shard&gt; &lt;!--\u5206\u72472--&gt;\n            &lt;replica&gt;\n                &lt;host&gt;ddyw-data-center-dev02&lt;/host&gt;\n                &lt;port&gt;9002&lt;/port&gt;\n            &lt;/replica&gt;\n        &lt;/shard&gt;\n        &lt;shard&gt; &lt;!--\u5206\u72473--&gt;\n            &lt;replica&gt;\n                &lt;host&gt;ddyw-data-center-dev03&lt;/host&gt;\n                &lt;port&gt;9002&lt;/port&gt;\n            &lt;/replica&gt;\n        &lt;/shard&gt;\n    &lt;/ddyw_ck_dev&gt;  &lt;!--\u8fd9\u91cc\u7684\u96c6\u7fa4\u540d\u79f0\u4e5f\u8bb0\u5f97\u4fee\u6539--&gt;\n&lt;/clickhouse_remote_servers&gt;\n\u200b\n\u200b\n&lt;zookeeper-servers&gt; &lt;!--\u914d\u7f6ezookeeper\u96c6\u7fa4\u5730\u5740--&gt;\n  &lt;node index=\"1\"&gt;\n    &lt;host&gt;ddyw-data-center-dev01&lt;/host&gt;\n    &lt;port&gt;2181&lt;/port&gt;\n  &lt;/node&gt;\n\u200b\n  &lt;node index=\"2\"&gt;\n    &lt;host&gt;ddyw-data-center-dev02&lt;/host&gt;\n    &lt;port&gt;2181&lt;/port&gt;\n  &lt;/node&gt;\n  &lt;node index=\"3\"&gt;\n    &lt;host&gt;ddyw-data-center-dev03&lt;/host&gt;\n    &lt;port&gt;2181&lt;/port&gt;\n  &lt;/node&gt;\n&lt;/zookeeper-servers&gt;\n\u200b\n&lt;macros&gt;\n    &lt;replica&gt;ddyw-data-center-dev02&lt;/replica&gt;\n&lt;/macros&gt;\n\u200b\n\u200b\n&lt;networks&gt;\n   &lt;ip&gt;::/0&lt;/ip&gt;\n&lt;/networks&gt;\n\u200b\n\u200b\n&lt;clickhouse_compression&gt;\n&lt;case&gt;\n  &lt;min_part_size&gt;10000000000&lt;/min_part_size&gt;\n  &lt;min_part_size_ratio&gt;0.01&lt;/min_part_size_ratio&gt;\n  &lt;method&gt;lz4&lt;/method&gt;\n&lt;/case&gt;\n&lt;/clickhouse_compression&gt;\n\u200b\n&lt;/yandex&gt;\n</code></pre> <p>2.2 \u4fee\u6539users.xml\u914d\u7f6e\u6587\u4ef6,\u6dfb\u52a0\u5bc6\u7801 (\u5728node01\u8282\u70b9\u64cd\u4f5c)</p> <pre><code>\u4fee\u6539\u9ed8\u8ba4\u7528\u6237\u5bc6\u7801\u4ee5\u53ca\u6dfb\u52a0\u65b0\u7528\u6237\u7684\u5bc6\u7801\uff0c\u5bc6\u7801\u7531\u4e0b\u9762\u968f\u673a\u751f\u6210\n# \u751f\u6210\u968f\u673a\u5bc6\u7801\n[root@sky-node04 ~]# PASSWORD=$(base64 &lt; /dev/urandom | head -c8); echo \"$PASSWORD\";\nynjb8b6h\n\u200b\n# \u52a0\u5bc6\u968f\u673a\u5bc6\u7801\n[root@sky-node04 ~]# echo -n \"$PASSWORD\" | sha256sum | tr -d '-'\n40897635036b520fd85c160a42c08465434c7b91c611cedaa3615714030ec7d9\n\u200b\n# \u5728&lt;/default&gt;\u548c&lt;/users&gt;\u4e4b\u95f4\u63d2\u5165\u81ea\u5b9a\u4e49\u5bc6\u7801\u914d\u7f6e\n[root@sky-node04 ~]# vim /etc/clickhouse-server/users.xml\n        &lt;/default&gt;\n        &lt;dd01dev&gt;    &lt;!--\u81ea\u5b9a\u4e49ck\u6570\u636e\u5e93\u7528\u6237\u540d--&gt;\n            &lt;password_sha256_hex&gt;e4e727cd493ec6e316258dc7b68a56de401cce62a393dceb99f2a082695584ca&lt;/password_sha256_hex&gt;\n            &lt;networks incl=\"networks\" replace=\"replace\"&gt;\n                &lt;ip&gt;::/0&lt;/ip&gt;\n            &lt;/networks&gt;\n            &lt;quota&gt;default&lt;/quota&gt;\n            &lt;profile&gt;default&lt;/profile&gt;\n        &lt;/dd01dev&gt;    &lt;!--\u8fd9\u91cc\u4e5f\u4fee\u6539--&gt;\n        &lt;guest01&gt;\n            &lt;password&gt;guest01&lt;/password&gt;\n                &lt;networks incl=\"networks\" replace=\"replace\"&gt;\n                &lt;ip&gt;::/0&lt;/ip&gt;\n            &lt;/networks&gt;\n            &lt;quota&gt;default&lt;/quota&gt;\n            &lt;profile&gt;readonly&lt;/profile&gt;\n        &lt;/guest01&gt;\n    &lt;/users&gt;\n</code></pre> <p>2.3 \u540c\u6b65node01\u8282\u70b9\u7684\u914d\u7f6e\u5230\u5176\u4ed6\u4e24\u53f0\u8282\u70b9 (\u5728node01\u8282\u70b9\u64cd\u4f5c)</p> <pre><code>[root@sky-node04 ~]# scp /etc/clickhouse-server/config.xml root@sky-node05:/etc/clickhouse-server/\n[root@sky-node04 ~]# scp /etc/clickhouse-server/config.xml root@sky-node06:/etc/clickhouse-server/\n\u200b\n[root@sky-node04 ~]# scp /etc/metrika.xml root@sky-node05:/etc/\n[root@sky-node04 ~]# scp /etc/metrika.xml root@sky-node06:/etc/\n\u200b\n[root@sky-node04 ~]# scp /etc/clickhouse-server/users.xml root@sky-node05:/etc/clickhouse-server/\n[root@sky-node04 ~]# scp /etc/clickhouse-server/users.xml root@sky-node06:/etc/clickhouse-server/\n</code></pre>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/ClickHouse%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85/#_3","title":"\u4e09\u3001\u542f\u52a8\u548c\u9a8c\u8bc1","text":"<p>3.1 \u542f\u52a8ClickServer (\u6240\u6709\u8282\u70b9\u64cd\u4f5c) \u9996\u5148\u4fdd\u8bc1\u5f00\u542fZookeeper\u6b63\u5e38\uff0c\u6bcf\u4e00\u4e2a\u8282\u70b9\u5f00\u542fck</p> <pre><code>\u521b\u5efa\u76f8\u5173\u76ee\u5f55\u53ca\u6743\u9650\nmkdir -p /apps/clickhouse\nchown -R clickhouse:clickhouse /apps/clickhouse\n\u200b\n#\u5f00\u673a\u542f\u52a8clickhouse-server\nsystemctl enable clickhouse-server\n\u200b\n#\u542f\u52a8clickhouse-server\nsystemctl start clickhouse-server\n\u200b\n#\u67e5\u770bclickhouse-server\u8fd0\u884c\u72b6\u6001\nsystemctl status clickhouse-server\n\u200b\n#\u5173\u95edclickhouse-server\nsystemctl stop clickhouse-server\n\u200b\n#\u67e5\u770b\u65e5\u5fd7\ntail -f /var/log/clickhouse-server/clickhouse-server.log\ntail -f /var/log/clickhouse-server/clickhouse-server.err.log\n\u200b\n#\u5f00\u542fDebug\u8c03\u8bd5\u6a21\u5f0f\nclickhouse-server start\n</code></pre> <p>3.2 \u8fde\u63a5\u6570\u636e\u5e93</p> <pre><code># clickhouse-client\u8fdb\u5165\u64cd\u4f5c\u6570\u636e\u5e93\nclickhouse-client --host=&lt;host&gt; --port=&lt;port&gt; --user=&lt;user&gt; --password=&lt;password&gt;\n\u200b\n\u4f8b\u5982\uff1a\nclickhouse-client --host=sky-node04 --port=9002 --user=dd01test --password=''\n\u200b\n[root@sky-node04 ~]# clickhouse-client --host=sky-node04 --port=9002 --user=dd01test --password=''\nClickHouse client version 20.8.3.18.\nConnecting to sky-node04:9002 as user dd01test.\nConnected to ClickHouse server version 20.8.3 revision 54438.\n\u200b\nsky-node04 :) show databases   //\u67e5\u770b\u6570\u636e\u5e93\n\u200b\nSHOW DATABASES\n\u200b\n\u250c\u2500name\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 _temporary_and_external_tables \u2502\n\u2502 default                        \u2502\n\u2502 system                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u200b\n3 rows in set. Elapsed: 0.001 sec.\n\u200b\nsky-node04 :) select * from system.clusters;   //\u67e5\u770b\u7cfb\u7edf\u8868\nsky-node04 :) select cluster,shard_num,replica_num,host_name,port,user from system.clusters;   //\u6216\u8005\u4f7f\u7528\u6307\u5b9a\u5b57\u6bb5\u7684\u67e5\u8be2\u8bed\u53e5\uff0c\u65b9\u4fbf\u89c2\u5bdf\uff0c\u5982\u4e0b\u6240\u793a\n\u200b\nSELECT\n    cluster,\n    shard_num,\n    replica_num,\n    host_name,\n    port,\n    user\nFROM system.clusters\n\u200b\n\u250c\u2500cluster\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500shard_num\u2500\u252c\u2500replica_num\u2500\u252c\u2500host_name\u2500\u2500\u252c\u2500port\u2500\u252c\u2500user\u2500\u2500\u2500\u2500\u2510\n\u2502 ddyw_ck_japan_test                \u2502         1 \u2502           1 \u2502 sky-node04 \u2502 9002 \u2502 default \u2502\n\u2502 ddyw_ck_japan_test                \u2502         2 \u2502           1 \u2502 sky-node05 \u2502 9002 \u2502 default \u2502\n\u2502 ddyw_ck_japan_test                \u2502         3 \u2502           1 \u2502 sky-node06 \u2502 9002 \u2502 default \u2502\n\u2502 test_cluster_two_shards           \u2502         1 \u2502           1 \u2502 127.0.0.1  \u2502 9000 \u2502 default \u2502\n\u2502 test_cluster_two_shards           \u2502         2 \u2502           1 \u2502 127.0.0.2  \u2502 9000 \u2502 default \u2502\n\u2502 test_cluster_two_shards_localhost \u2502         1 \u2502           1 \u2502 localhost  \u2502 9000 \u2502 default \u2502\n\u2502 test_cluster_two_shards_localhost \u2502         2 \u2502           1 \u2502 localhost  \u2502 9000 \u2502 default \u2502\n\u2502 test_shard_localhost              \u2502         1 \u2502           1 \u2502 localhost  \u2502 9000 \u2502 default \u2502\n\u2502 test_shard_localhost_secure       \u2502         1 \u2502           1 \u2502 localhost  \u2502 9440 \u2502 default \u2502\n\u2502 test_unavailable_shard            \u2502         1 \u2502           1 \u2502 localhost  \u2502 9000 \u2502 default \u2502\n\u2502 test_unavailable_shard            \u2502         2 \u2502           1 \u2502 localhost  \u2502    1 \u2502 default \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u200b\n11 rows in set. Elapsed: 0.002 sec.\n\u200b\nsky-node04 :)\n</code></pre> <p>\u53c2\u8003\u6587\u6863  \u521d\u8bc6ClickHouse\u2014\u2014\u5b89\u88c5\u4e0e\u5165\u95e8 https://segmentfault.com/a/1190000038991230 ClickHouse\u5b9e\u6218-ClickHouse\u5b89\u88c5\u90e8\u7f72 https://developer.aliyun.com/article/780045 Clickhouse\u96c6\u7fa4\u5b89\u88c5\u90e8\u7f72 https://www.cnblogs.com/biehongli/p/14462096.html Clickhouse \u96c6\u7fa4\u5b89\u88c5(\u5b8c\u6574\u7248) https://blog.csdn.net/weixin_42003671/article/details/112849897 </p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/%E6%95%B0%E6%8D%AE%E7%A0%94%E5%8F%91%E6%B5%81%E7%A8%8B/","title":"\u5165\u95e8","text":"<p>\u5b89\u88c5Groovy\uff0c\u65b0\u5efaGroovy\u9879\u76ee</p> <ul> <li>Groovy\u57fa\u672c\u8bed\u6cd5\uff1ahttps://blog.csdn.net/weixin_52851967/article/details/125390597</li> <li>\u57fa\u7840\u8bed\u6cd5\u5982\u4e0b</li> </ul> <pre><code>package com.llh.test\n\nclass GroovyTest {\n\n    static void main(String[] args) {\n        println \"hello world\"\n        println(geBigDecimal())\n        System.out.println(\"\u8fd9\u79cd\u65b9\u5f0f\u4e5f\u652f\u6301\")\n        def def001 = getDef()\n        println(def001.isBigDecimal())\n\n        //GString\u7c7b\u578b\n        def testName = \"call me\"\n        //GString\u7c7b\u578b\uff0cGroovy\u7279\u6709\n        def text = \"Hello : ${testName}\"\n        println testName.toString()\n        println text.toString()\n\n        //\u591a\u884c\u5b57\u7b26\u4e32\u4fdd\u7559\u683c\u5f0f\n        def mail = '''\\\n       abc\n        efg\n        '''\n        println(mail)\n\n        //\u586b\u5145\n        def str = \"groovy hello\"\n        println str.center(14, \"R\")\n        println str.padLeft(14, \"L\")\n        println str.padRight(14, \"0\")\n\n        def str2 = \"G\"\n        def str3 = \"g\"\n        //\u6bd4\u8f83unicode\u7801\n        println str3 &gt; str2\n        //\u6bd4\u8f83\u5b57\u7b26\u4e32\n        println str3 &lt;=&gt; str2\n\n        //\u5b57\u7b26\u4e32\u76f8\u51cf\n        println str - str3\n\n//        switch...case\u652f\u6301\u5404\u79cd\u7c7b\u578b\n        switch (\"abc\") {\n            case \"ll\":\n                println \"ll\"\n                break\n            case \"ABC\":\n                println \"123\"\n                break\n            default: println(\"456\")\n        }\n\n        //\u8303\u56f4\u5faa\u73af\n        def sum = 0\n        for (i in 0..9) {\n            sum += i\n            println(sum)\n\n        }\n\n        for (i in [\"\u5f20\u4e09\": 23, \"lucy\": 19, \"Bob\": 30]) {\n            print(i.key)\n            sum += i.value\n        }\n\n    }\n\n    static def getDef() {\n        return \"\u4e2d\u6587\"\n    }\n\n    /**\n     * \u83b7\u53d6\u5b57\u7b26\u4e32\n     * @return\n     */\n    static String getString() {\n        return \"1231231\"\n    }\n\n    static Integer getInteger() {\n        return 123123\n    }\n\n    static Long getLong() {\n        //\u6ce8\u91ca\n        /*\n        \u6ce8\u91ca\n         */\n        return 123123123123L\n    }\n\n    static Double getDouble() {\n        return 0.123123123123\n    }\n\n    static Float getFloat() {\n        return 0.123123123123\n    }\n\n    static BigDecimal geBigDecimal() {\n        return 123\n    }\n}\n</code></pre>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/%E6%95%B0%E6%8D%AE%E7%A0%94%E5%8F%91%E6%B5%81%E7%A8%8B/#hivedoris","title":"Hive/Doris","text":""},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/%E6%95%B0%E6%8D%AE%E7%A0%94%E5%8F%91%E6%B5%81%E7%A8%8B/#hive","title":"hive\u662f\u4ec0\u4e48","text":"<p>hive\u57fa\u4e8ehadoop\u7684\u4e00\u4e2a\u6570\u636e\u4ed3\u5e93\u5de5\u5177\uff0c\u53ef\u4ee5\u5c06\u7ed3\u6784\u5316\u7684\u6570\u636e\u6587\u4ef6\u6620\u5c04\u4e3a\u4e00\u5f20\u6570\u636e\u5e93\u8868\uff0c\u63d0\u4f9b\u7c7bsql\u67e5\u8be2\u529f\u80fd</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/%E6%95%B0%E6%8D%AE%E7%A0%94%E5%8F%91%E6%B5%81%E7%A8%8B/#_2","title":"\u57fa\u672c\u8bed\u6cd5","text":"<pre><code>show\ncreate table vts_llh_dwd.first_test;\nshow\ncreate table vts_llh_dwd.first_test;\nuse\nvts_llh_dwd;\ncreate\ndatabase if not exists vts_llh_dwd;\n\nuse\nvts_llh_dwd;\n\ndrop table if exists first_test;\ncreate table if not exists first_test\n(\n    id\n    int\n    comment\n    '\u7f16\u53f7',\n    name\n    string\n    comment\n    '\u59d3\u540d'\n) comment '\u7b2c\u4e00\u5f20\u6d4b\u8bd5\u8868'\n    TBLPROPERTIES\n(\n    'author' =\n    'llh',\n    'desc' =\n    '\u7b2c\u4e00\u4e2a\u6d4b\u8bd5\u8868',\n    'remark' =\n    '\u5907\u6ce8\u4fe1\u606f'\n);\nalter table vts_llh_dwd.first_test\n    add columns (etl_update_time string comment '\u66f4\u65b0\u65f6\u95f4');\nshow\ntables;\n\nselect *\nfrom vts_llh_dwd.first_test limit 10;\n</code></pre>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/%E6%95%B0%E6%8D%AE%E7%A0%94%E5%8F%91%E6%B5%81%E7%A8%8B/#hadoop","title":"\u76f4\u63a5\u4f7f\u7528hadoop\u6240\u9762\u4e34\u7684\u95ee\u9898","text":"<ul> <li>\u4eba\u5458\u5b66\u4e60\u6210\u672c\u592a\u9ad8</li> <li>\u9879\u76ee\u5468\u671f\u8981\u6c42\u592a\u77ed</li> <li>MapReduce\u5b9e\u73b0\u590d\u6742\u67e5\u8be2\u903b\u8f91\u5f00\u53d1\u96be\u5ea6\u592a\u5927</li> </ul>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/%E6%95%B0%E6%8D%AE%E7%A0%94%E5%8F%91%E6%B5%81%E7%A8%8B/#_3","title":"\u6570\u636e\u4ed3\u5e93\u5206\u5c42","text":"<p>\u6570\u4ed3\u7684\u5206\u5c42\u7684\u6bcf\u4e00\u5c42\u90fd\u6709\u81ea\u5df1\u7684\u804c\u8d23\uff0c\u540c\u65f6\u90fd\u662f\u57fa\u4e8e\u4e0b\u4e00\u5c42\u6216\u8005\u4e0b\u9762\u591a\u5c42\u505a\u6570\u636e\u5904\u7406\u4e4b\u540e\u7684\u7ed3\u679c</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/%E6%95%B0%E6%8D%AE%E7%A0%94%E5%8F%91%E6%B5%81%E7%A8%8B/#ods","title":"ODS","text":"<ol> <li>\u8d34\u6e90\u5c42\uff0c\u63a5\u8fd1\u6570\u636e\u6e90\u7684\u4e00\u5c42\uff0c\u6570\u636e\u6700\u539f\u59cb\uff0c\u6700\u771f\u5b9e\u672a\u7ecf\u592a\u591a\u5904\u7406</li> <li>\u8fd8\u8d77\u5230\u4e00\u4e2a\u6570\u636e\u5907\u4efd\u4f5c\u7528\uff0c\u7279\u6b8a\u884c\u4e1a\uff0cODS\u5c42\u6570\u636e\u751a\u81f3\u4f1a\u4fdd\u7559\u4e00\u5e74\u751a\u81f3\u591a\u5e74</li> <li>\u65e5\u5fd7\u6570\u636e\u4f30\u7b97\uff0c\u4e5f\u5c24\u4e3a\u91cd\u8981\uff0c\u78c1\u76d8\u4e00\u822c\u9700\u8981\u4fdd\u755930%\u7f13\u51b2\u7a7a\u95f4\uff0c\u6570\u636e\u672c\u8eab\u53ef\u4ee5\u505a\u538b\u7f29\uff0c\u6570\u4ed3\u8fd8\u8981\u505a\u5206\u5c42\uff0c\u6570\u636e\u672c\u8eab\u5b58\u50a8\u8fd8\u4f1a\u6709\u5907\u4efd\u673a\u5236\uff08HDFS/Kafka\u7b49\u6846\u67b6\uff09</li> <li>ODS\u5c42\u4e5f\u5e76\u4e0d\u610f\u5473\u7740\u4e00\u5b9a\u5c31\u662f\u672a\u7ecf\u4efb\u4f55\u5904\u7406\u7684\u6570\u636e\uff0c\u4f01\u4e1a\u7ea7\u9879\u76ee\uff0c\u56e0\u4e3a\u771f\u5b9e\u73af\u5883\u53ef\u80fd\u5b58\u5728\u91c7\u96c6\u9519\u8bef\uff0cbug\uff0c\u7f51\u7edc\u7b49\u95ee\u9898\uff0c\u4f1a\u9020\u6210\u539f\u59cb\u6570\u636e\u5b58\u5728\u95ee\u9898<ul> <li>\u5b57\u6bb5\u7f3a\u5931</li> <li>\u6570\u636e\u5b57\u6bb5\u4e0d\u7edf\u4e00</li> <li>\u683c\u5f0f\u9519\u8bef</li> <li>\u6570\u636e\u6765\u6e90\u6df7\u4e71</li> <li>\u6570\u636e\u7c7b\u578b\u4e0d\u6613\uff0c\u5982json,xml,text\u7b49</li> </ul> </li> <li>\u4e00\u822c\u4f01\u4e1a\u7ea7ODS\u4f1a\u5bf9\u539f\u59cb\u6570\u636e\uff0c\u505a\u4e00\u4e9b\u57fa\u672c\u5904\u7406<ul> <li>\u6570\u636e\u6765\u6e90\u533a\u5206</li> <li>\u6309\u65f6\u95f4\u5206\u533a\u5b58\u50a8\uff0c\u6309\u5929\uff0c\u5e74\uff0c\u6708\uff0c\u65e5</li> <li>\u57fa\u672c\u6570\u636e\u5904\u7406\uff0c\u683c\u5f0f\u9519\u8bef\u4e22\u5f03\uff0c\u5173\u952e\u4fe1\u606f\u4e22\u5931\u7684\u8fc7\u6ee4</li> <li>\u5f53\u7136\uff0cDWD\u5c42\u4e5f\u662f\u53ef\u4ee5\u505a\u8fd9\u4e00\u5c42\u5904\u7406\u4f18\u5316\uff0c\u5173\u952e\u770b\u516c\u53f8\u6280\u672f\u89c4\u8303</li> </ul> </li> <li>ODS\u5c42\u5efa\u8868\u65f6\uff0c\u5982\u679c\u65f6hive\u8fdb\u884c\u5904\u7406\uff0c\u4e00\u822c\u5efa\u5916\u90e8\u8868<ul> <li>hive\u7684\u5916\u90e8\u8868\uff0c\u76f8\u5bf9\u7684\u662f\u4e1a\u52a1\u8868</li> <li>\u5916\u90e8\u8868\u5b58\u653e\u6570\u636e\u6587\u4ef6\u53ef\u4ee5\u4e0d\u662f\u5728hive\u7684hdfs\u9ed8\u8ba4\u4f4d\u7f6e\uff0chive\u5bf9\u5e94\u8868\u5220\u9664\u65f6\uff0c\u5bf9\u5e94\u6570\u636e\u6587\u4ef6\u5e76\u4e0d\u4f1a\u88ab\u5220\u9664\uff0c\u8fd9\u6837\u53ef\u4ee5\u9632\u6b62\u8bef\u64cd\u4f5c</li> <li>\u4e1a\u52a1\u8868\u5219\u76f8\u53cd\uff0c\u6570\u636e\u6587\u4ef6\u5b58\u653e\u5728hive\u5bf9\u5e94\u7684\u9ed8\u8ba4\u4f4d\u7f6e\uff0c\u8868\u5220\u9664\u5bf9\u5e94\u6587\u4ef6\u4e5f\u4f1a\u88ab\u5220\u9664</li> <li>\u5927\u6570\u636e\u5f00\u53d1\uff0c\u4f7f\u7528hive\u65f6\uff0c\u4e00\u822c\u90fd\u662f\u7528\u5916\u90e8\u8868</li> </ul> </li> </ol>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/%E6%95%B0%E6%8D%AE%E7%A0%94%E5%8F%91%E6%B5%81%E7%A8%8B/#dwd","title":"DWD","text":"<ol> <li>DWD\u53c8\u53eb\u6570\u636e\u660e\u7ec6\u8868\uff0c\u5f88\u591a\u65f6\u5019\u5b58\u50a8\u7684\u662f\u4e8b\u5b9e\u8868\u4e3a\u4e3b</li> <li>\u5728DWD\u5c42\uff0c\u4f1a\u6709ETL\uff08extract transform load\uff09 \u63d0\u53d6\u8f6c\u6362\u52a0\u8f7d\u5904\u7406\uff0c\u903b\u8f91\u8f83\u590d\u6742\uff0c\u7528hive\u4e00\u822c\u65e0\u6cd5\u6ee1\u8db3\u8981\u6c42\uff0c\u8fd9\u4e9b\u903b\u8f91\u4e00\u822c\u662f\u7f16\u5199\u4ee3\u7801\u5b9e\u73b0\uff0c\u4f7f\u7528\u811a\u672c\u8fdb\u884c\u5468\u671f\u6027\u8c03\u7528<ol> <li>\u7b5b\u9009\u5b57\u6bb5\uff0c\u53bb\u9664\u5e9f\u5f03\uff0c\u683c\u5f0f\u9519\u8bef\uff0c\u4e22\u5931\u5173\u952e\u5b57\u6bb5\u7684\u4fe1\u606f</li> <li>\u6570\u636e\u89c4\u8303\u5316\uff0c\u53ef\u80fd\u4e0d\u540c\u4e1a\u52a1\u4e0d\u540c\u6765\u6e90\u7684\u6570\u636e\u7c7b\u578b\u7a7a\u503c\u4e0d\u540c\uff0c\u8fd9\u65f6\u5019\u4f1a\u5728DWD\u5c42\u505a\u62b9\u5e73\u3002\u5982\uff1aboolean\u7c7b\u578b\u6709true/fals,1/0\u7684\uff1b\u5b57\u7b26\u4e32\u4ee3\u8868\u7a7a\u7684\u6709\"\"/null\u7684\uff1b\u65e5\u671f\u683c\u5f0f\u5dee\u5f02\u66f4\u5927\u7684</li> </ol> </li> <li>DWD\u5b58\u50a8\u6570\u636e\uff0c\u4e00\u822c\u5c31\u662f\u7ef4\u5ea6\u8868\uff0c\u4e8b\u5b9e\u8868\uff0c\u5b9e\u4f53\u8868\u7b49\u6570\u636e<ol> <li>\u7ef4\u5ea6\u8868\uff0c\u4e00\u4e9b\u7ef4\u5ea6\u4fe1\u606f\uff0c\u4e00\u822c\u76f4\u63a5\u5b58\u50a8\u7ef4\u5ea6\u4fe1\u606f\uff0c\u8868\u4e00\u822c\u4e0d\u4f1a\u5f88\u5927</li> <li>\u4e8b\u5b9e\u8868\uff0c\u5c31\u662f\u8868\u8ff0\u4e00\u4e9b\u4e8b\u5b9e\u4fe1\u606f\uff0c\u5982\u8ba2\u5355\uff0c\u6536\u85cf\uff0c\u8d2d\u7269\u8f66\u8fd9\u4e9b\uff0c\u6570\u636e\u91cf\u5927\uff0c\u4e00\u822c\u5b58\u50a8\u7ef4\u5ea6\u4e3b\u952e\uff0c\u5177\u4f53\u7ef4\u5ea6\u503c\u5728\u540e\u7eed\u5904\u7406\u5206\u6790\u65f6\u518d\u4e34\u65f6\u5173\u8054</li> <li>\u5b9e\u4f53\u8868\uff0c\u7c7b\u4f3cjavabean\uff0c\u7528\u6765\u63cf\u8ff0\u4fe1\u606f\uff0c\u5982\u4f18\u60e0\u5238\u8868\uff0c\u4fc3\u9500\u8868\uff0c\u5185\u90e8\u5c31\u662f\u63cf\u8ff0\u4fe1\u606f\uff0c\u5927\u90e8\u5206\u65f6\u5168\u91cf\u5bfc\u5165</li> </ol> </li> <li>\u4e8b\u5b9e\u8868\u4e2d\u6570\u636e\uff0c\u4e00\u822c\u4e0d\u662f\u6240\u6709\u7ef4\u5ea6\u90fd\u6309\u7167\u7ef4\u5ea6\u4e3b\u952e\u505a\u4fe1\u606f\u5b58\u50a8<ol> <li>\u6570\u4ed3\u7406\u8bba\u4e2d\uff0c\u53bb\u9664\u6570\u636e\u5197\u4f59\u7684\u601d\u60f3\uff0c\u4e00\u822c\u4f1a\u5c06\u7ef4\u5ea6\u4fe1\u606f\u5355\u72ec\u5b58\u653e\uff0c\u5176\u4ed6\u8868\u8981\u7528\u65f6\uff0c\u8bb0\u5f55\u5bf9\u5e94\u7ef4\u5ea6\u7684id\u3002</li> <li>\u5373\u4f7f\u7ef4\u5ea6\u6570\u636e\u53d8\u5316\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u5230\u591a\u4e2a\u8868\uff0c\u964d\u4f4e\u4e86\u6570\u636e\u5197\u4f59</li> </ol> </li> <li>\u505a\u6570\u636e\u6620\u5c04<ol> <li>\u5982\u5c06GPS\u7ecf\u7eac\u5ea6\u8f6c\u6362\u4e3a\u7701\u5e02\u533a\u8be6\u7ec6\u5730\u5740</li> <li>ip\u5730\u5740\u4e5f\u8f6c\u6362\u4f4d\u7701\u5e02\u533a\u8be6\u7ec6\u5730\u5740</li> <li>\u5c06\u65f6\u95f4\u8f6c\u6362\u4e3a\u5e74\uff0c\u6708\uff0c\u65e5\u751a\u81f3\u5468\uff0c\u5b63\u5ea6\u7ef4\u5ea6\u4fe1\u606f</li> </ol> </li> </ol>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/%E6%95%B0%E6%8D%AE%E7%A0%94%E5%8F%91%E6%B5%81%E7%A8%8B/#dws","title":"DWS","text":"<ol> <li>\u6570\u636e\u670d\u52a1\u5c42\uff0c\u6570\u636e\u805a\u5408\u5c42\uff0c\u4e3a\u66f4\u4e0a\u5c42\u7684ADS\u5c42\u6216\u8005\u76f4\u63a5\u9762\u5411\u9700\u6c42\u65b9\u670d\u52a1</li> <li>DWS\u5efa\u6a21\uff0c\u4e00\u822c\u7528\u4e3b\u9898\u5efa\u6a21\uff0c\u7ef4\u5ea6\u5efa\u6a21\u7b49\u65b9\u5f0f<ol> <li>\u4e3b\u9898\u5efa\u6a21\uff0c\u56f4\u7ed5\u67d0\u4e00\u4e2a\u4e1a\u52a1\u4e3b\u4f53\u8fdb\u884c\u6570\u636e\u5efa\u6a21\uff0c\u5c06\u76f8\u5173\u6570\u636e\u62bd\u79bb\u63d0\u53d6<ul> <li>\u6d41\u91cf\u7ed8\u753b\u6309\u7167\u5929\uff0c\u6708\u805a\u5408</li> <li>\u6bcf\u65e5\u65b0\u7528\u6237\u8fdb\u884c\u805a\u5408</li> <li>\u6bcf\u65e5\u6d3b\u8dc3\u7528\u6237\u805a\u5408 2.\u7ef4\u5ea6\u5efa\u6a21\uff0c\u6839\u636e\u4e1a\u52a1\u9700\u8981\uff0c\u63d0\u524d\u5c06\u540e\u7eed\u6570\u636e\u67e5\u8be2\u5904\u7406\u9700\u8981\u7684\u7ef4\u5ea6\u6570\u636e\u62bd\u79bb\u51fa\u6765\uff0c\u65b9\u4fbf\u540e\u7eed\u67e5\u8be2\u7528</li> <li>\u8fd0\u8425\u4f4d\u7ef4\u5ea6\u6570\u636e\u805a\u5408</li> <li>\u6e20\u9053\u62c9\u65b0\u7ef4\u5ea6\u6570\u636e\u805a\u5408</li> </ul> </li> </ol> </li> </ol>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/%E6%95%B0%E6%8D%AE%E7%A0%94%E5%8F%91%E6%B5%81%E7%A8%8B/#ads","title":"ADS","text":"<ol> <li>\u5e94\u7528\u670d\u52a1\u5c42\uff0c\u76f4\u63a5\u5bf9\u63a5OLAP\u5206\u6790\uff0c\u6216\u8005\u4e1a\u52a1\u5c42\u6570\u636e\u8c03\u7528\u63a5\u53e3</li> <li>\u6700\u9876\u5c42\uff0c\u4e00\u822c\u662f\u7ed3\u679c\u7c7b\u578b\u6570\u636e\uff0c\u53ef\u4ee5\u76f4\u63a5\u5c55\u793a\u7684\u6570\u636e\uff0c\u6570\u636e\u62bd\u79bb\u5206\u6790\u6210\u90fd\u6700\u9ad8\u7684\u4e00\u5c42\u6570\u636e</li> <li>\u9700\u6c42\u6700\u660e\u786e\u7684\u4e00\u5c42\uff0c\u63a5\u53e3\u76f8\u5bf9\u6700\u56fa\u5316</li> </ol>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/Groovy/Groovy%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/","title":"Groovy","text":"<p>\u4f7f\u7528java jvm\u865a\u62df\u673a\u8fd0\u884c(jdk\u7c7b\u5e93\u90fd\u53ef\u5f15\u5165\u4f7f\u7528)</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/Groovy/Groovy%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_1","title":"\u4ee3\u7801\u793a\u4f8b","text":"<pre><code>import java.time.LocalDate\nimport java.time.LocalDateTime\nimport java.time.format.DateTimeFormatter\n\ndef main() {\n    def params = \"{llv}\"\n    println(\"1231\" + params)\n\n    def startDate = \"2023-01-01\"\n    def endDate = \"2023-01-31\"\n    monthDemo(startDate, endDate)\n\n\n}\n\ndef monthDemo(def startDate, def endDate) {\n    def df = DateTimeFormatter.ofPattern(\"yyyy-MM-dd\")\n    def dtf = DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\")\n    def now = LocalDate.now()\n    if (LocalDate.parse(endDate).isAfter(now)) {\n        endDate = now.format(df)\n    }\n    def startDate1 = now.withDayOfMonth(1).format(df)\n    def endDate1 = now.format(df)\n    def startDate2 = LocalDate.parse(startDate).withDayOfMonth(1).format(df)\n    def endDate2 = LocalDate.parse(startDate).withDayOfMonth(1).plusMonths(1).minusDays(1).format(df)\n    //\u5982\u679c\u6ee1\u8db3\u67e5\u8be2\u5f53\u524d\u6708\u4efd\n    if (startDate1.compareTo(startDate) == 0 &amp;&amp; endDate1.compareTo(endDate) == 0) {\n        isFullMonth = true\n        startLastDate = LocalDate.parse(startDate).minusMonths(1).format(df)\n        endLastDate = LocalDate.parse(endDate).minusMonths(1).format(df)\n    } else if (startDate2.compareTo(startDate) == 0 &amp;&amp; endDate2.compareTo(endDate) == 0) {\n        //\u5982\u679c\u6ee1\u8db3\u67e5\u8be2\u6ee1\u6708\n        isFullMonth = true\n        startLastDate = LocalDate.parse(startDate).minusMonths(1).withDayOfMonth(1).format(df)\n        endLastDate = LocalDate.parse(startDate).withDayOfMonth(1).minusDays(1).format(df)\n    } else {\n        isFullMonth = false\n    }\n    def startTime = LocalDateTime.parse(startDate + \" 00:00:00\", dtf).format(dtf)\n    def endTime = LocalDateTime.parse(endDate + \" 23:59:59\", dtf).format(dtf)\n\n    println(\"start: \" + startDate + \" end: \" + endDate)\n    println(\"startTime: \" + startTime + \" endTime: \" + endTime)\n    println(\"\u662f\u5426\u67e5\u8be2\u6ee1\u6708: \" + isFullMonth)\n}\n\nreturn main()\n</code></pre>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/Presto/PrestoSQL%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/","title":"Presto","text":"<p>\u5b98\u7f51</p> <p>Presto is an open source SQL query engine that's fast, reliable, and efficient at scale. Use Presto to run interactive/ad hoc queries at sub-second performance for your high volume apps.</p> <p>\u672c\u8eab\u4e0d\u63d0\u4f9b\u5b58\u50a8\uff0c\u4e0d\u662f\u6570\u636e\u5e93\uff0c\u901a\u8fc7connector\u53d6\u8fde\u63a5\u5bf9\u5e94\u7684\u6570\u636e\u5e93\uff0c\u5b8c\u6210\u6570\u636e\u67e5\u8be2\u548c\u8ba1\u7b97\u3002\u57fa\u4e8e\u5185\u5b58\u8ba1\u7b97\uff0c\u9002\u7528\u4ea4\u4e92\u5f0f\u5206\u6790\u67e5\u8be2</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/Presto/PrestoSQL%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#presto_1","title":"Presto\u67b6\u6784","text":"<p>master-slave\u67b6\u6784\uff0c\u7531\u4e00\u4e2aCoordinator\u8282\u70b9\uff0c\u4e00\u4e2aDiscovery \u8282\u70b9\uff0c\u548c\u591a\u4e2aWorker\u8282\u70b9\u7ec4\u6210</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/Presto/PrestoSQL%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#_1","title":"\u7ec4\u6210\u90e8\u5206","text":"<ul> <li>Coordinator(\u534f\u8c03\u5668): \u8d1f\u8d23\u89e3\u6790SQL\u8bed\u53e5\uff0c\u751f\u6210\u6267\u884c\u8ba1\u5212\uff0c\u5206\u53d1\u6267\u884c\u4efb\u52a1\u7ed9Worker\u8282\u70b9\u6267\u884c\u3002</li> <li>Discovery(\u53d1\u73b0\u670d\u52a1): \u901a\u5e38\u5185\u5d4c\u4e8eCoordinator\u8282\u70b9\u4e2d\u3002</li> <li>Worker(\u5de5\u4f5c\u8282\u70b9): \u8d1f\u8d23\u5b9e\u9645\u6267\u884c\u67e5\u8be2\u4efb\u52a1\uff0c\u4ece\u5bf9\u5e94\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u6570\u636e\uff1bWorker\u542f\u52a8\u540e\u5411\uff1b</li> <li>Discovery Server\u670d\u52a1\u6ce8\u518c\uff0cCoordinator\u4eceDiscovery Server\u83b7\u5f97\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u7684Worker\u8282\u70b9\u3002</li> </ul>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/Presto/PrestoSQL%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#_2","title":"\u5e94\u7528\u573a\u666f","text":""},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/Presto/PrestoSQL%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/#_3","title":"\u9047\u5230\u7684\u8bed\u6cd5\u95ee\u9898","text":"<p>set session hive.insert_existing_partitions_behavior = 'overwrite'; \u89e3\u6790\uff1apresto\u4e0d\u652f\u6301 insert overwrite\uff0c\u6240\u4ee5\u63d0\u4f9b\u4e86\u4e09\u79cd\u6a21\u5f0f\uff1a</p> <ol> <li>set session hive.insert_existing_partitions_behavior = 'overwrite';</li> <li>set session hive.insert_existing_partitions_behavior = 'append';</li> <li>set session hive.insert_existing_partitions_behavior = 'error';</li> </ol>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/StarRocks-DorisDB/","title":"StarRocks","text":"<p>\u5b98\u65b9\u6587\u6863</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/StarRocks-DorisDB/DorisDB%E4%BA%86%E8%A7%A3/","title":"DorisDB","text":"<p>\u6781\u901fSQL\u67e5\u8be2\uff0c\u5411\u91cf\u5316\u6267\u884c\u5f15\u64ce\uff0c\u4e9a\u79d2\u7ea7\u67e5\u8be2\u5ef6\u65f6\u3002DorisDB\u91c7\u7528\u5173\u7cfb\u6a21\u578b\uff0c \u4f7f\u7528\u4e25\u683c\u7684\u6570\u636e\u7c7b\u578b\uff0c \u4f7f\u7528\u5217\u5f0f\u5b58\u50a8\u5f15\u64ce\uff0c \u901a\u8fc7\u7f16\u7801\u548c\u538b\u7f29\u6280\u672f\uff0c \u964d\u4f4e\u8bfb\u5199\u653e\u5927. \u4f7f\u7528\u5411\u91cf\u5316\u6267\u884c\u65b9\u5f0f\uff0c \u5145\u5206\u6316\u6398\u591a\u6838CPU\u7684\u5e76\u884c\u8ba1\u7b97\u80fd\u529b\uff0c \u4ece\u800c\u663e\u8457\u63d0\u5347\u67e5\u8be2\u6027\u80fd</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/StarRocks-DorisDB/DorisDB%E4%BA%86%E8%A7%A3/#_1","title":"\u7279\u6027","text":"<ul> <li>DorisDB\u91c7\u7528\u5206\u5e03\u5f0f\u67b6\u6784\uff0c\u5b58\u50a8\u5bb9\u91cf\u548c\u8ba1\u7b97\u80fd\u529b\u53ef\u8fd1\u4f3c\u7ebf\u6027\u6c34\u5e73\u6269\u5c55\u3002DorisDB\u96c6\u7fa4\u7684\u89c4\u6a21\u53ef\u6269\u5c55\u5230\u6570\u767e\u8282\u70b9\uff0c\u652f\u6301\u7684\u6570\u636e\u89c4\u6a21\u53ef\u8fbe\u523010PB\u7ea7\u522b</li> <li>\u81ea\u6cbb\u7cfb\u7edf\uff0c\u7ba1\u7406\u7b80\u5355</li> <li>\u6807\u51c6SQL\uff0cDorisDB\u652f\u6301\u6807\u51c6\u7684SQL\u8bed\u6cd5\uff0c\u5305\u62ec\u805a\u5408\uff0cJOIN\uff0c\u6392\u5e8f\uff0c\u7a97\u53e3\u51fd\u6570\uff0c\u81ea\u5b9a\u4e49\u51fd\u6570\u7b49\u529f\u80fd\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u6807\u51c6\u7684SQL\u5bf9\u6570\u636e\u8fdb\u884c\u7075\u6d3b\u7684\u5206\u6790\u8fd0\u7b97</li> <li>\u6d41\u6279\u5bfc\u5165\uff0cDorisDB\u652f\u6301\u5b9e\u65f6\u548c\u6279\u91cf\u4e24\u79cd\u6570\u636e\u5bfc\u5165\u65b9\u5f0f\uff0c \u652f\u6301\u7684\u6570\u636e\u6e90\u6709Kafka\uff0c HDFS\uff0c \u672c\u5730\u6587\u4ef6. \u652f\u6301\u7684\u6570\u636e\u683c\u5f0f\u6709ORC\uff0c Parquet\u548cCSV\u7b49.   DorisDB\u53ef\u4ee5\u5b9e\u65f6\u6d88\u8d39Kafka\u6570\u636e\u6765\u5b8c\u6210\u6570\u636e\u5bfc\u5165\uff0c\u4fdd\u8bc1\u6570\u636e\u4e0d\u4e22\u4e0d\u91cd\uff08exactly once\uff09\u3002DorisDB\u4e5f\u53ef\u4ee5\u4ece\u672c\u5730\u6216\u8005\u8fdc\u7a0b\uff08HDFS\uff09\u6279\u91cf\u5bfc\u5165\u6570\u636e</li> </ul>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/StarRocks-DorisDB/DorisDB%E4%BA%86%E8%A7%A3/#_2","title":"\u5206\u533a/\u5206\u6876/\u8868","text":""},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/StarRocks-DorisDB/DorisDB%E4%BA%86%E8%A7%A3/#_3","title":"\u4e00\u5b9a\u8981\u8bbe\u7f6e\u5206\u7edf\uff0c\u53ef\u4ee5\u4e0d\u8bbe\u7f6e\u5206\u533a","text":"<p>\u7528\u6237\u6570\u636e\u88ab\u6c34\u5e73\u5212\u5206\u4e3a\u82e5\u5e72\u4e2a\u6570\u636e\u5206\u7247\uff08Tablet\uff0c\u4e5f\u79f0\u4f5c\u6570\u636e\u5206\u6876\uff09\u3002\u6bcf\u4e2a Tablet \u5305\u542b\u82e5\u5e72\u6570\u636e\u884c\u3002\u5404\u4e2a Tablet \u4e4b\u95f4\u7684\u6570\u636e\u6ca1\u6709\u4ea4\u96c6\uff0c\u5e76\u4e14\u5728\u7269\u7406\u4e0a\u662f\u72ec\u7acb\u5b58\u50a8\u7684\u3002 \u591a\u4e2a Tablet \u5728\u903b\u8f91\u4e0a\u5f52\u5c5e\u4e8e\u4e0d\u540c\u7684\u5206\u533a\uff08Partition\uff09\u3002\u4e00\u4e2a Tablet \u53ea\u5c5e\u4e8e\u4e00\u4e2a Partition\u3002\u800c\u4e00\u4e2a Partition \u5305\u542b\u82e5\u5e72\u4e2a Tablet\u3002\u56e0\u4e3a Tablet \u5728\u7269\u7406\u4e0a\u662f\u72ec\u7acb\u5b58\u50a8\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u89c6\u4e3a Partition \u5728\u7269\u7406\u4e0a\u4e5f\u662f\u72ec\u7acb\u3002Tablet \u662f\u6570\u636e\u79fb\u52a8\u3001\u590d\u5236\u7b49\u64cd\u4f5c\u7684\u6700\u5c0f\u7269\u7406\u5b58\u50a8\u5355\u5143\u3002 \u82e5\u5e72\u4e2a Partition \u7ec4\u6210\u4e00\u4e2a Table\u3002Partition \u53ef\u4ee5\u89c6\u4e3a\u662f\u903b\u8f91\u4e0a\u6700\u5c0f\u7684\u7ba1\u7406\u5355\u5143\u3002\u6570\u636e\u7684\u5bfc\u5165\u4e0e\u5220\u9664\uff0c\u90fd\u53ef\u4ee5\u6216\u4ec5\u80fd\u9488\u5bf9\u4e00\u4e2a Partition \u8fdb\u884c</p> <ol> <li>partition partition\u5217\u53ef\u4ee5\u6307\u5b9a\u4e00\u5217\u6216\u8005\u591a\u5217\uff0c\u5206\u533a\u5217\u5fc5\u987b\u4e3akey\u5217\uff0c\u5f53\u4e0d\u4f7f\u7528partition    by\u5efa\u8868\u7684\u65f6\u5019\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u751f\u6210\u4e00\u4e2a\u548c\u8868\u540d\u540c\u540d\u7684\uff0c\u5168\u503c\u8303\u56f4\u7684partition\uff0c\u8be5partition\u5bf9\u7528\u6237\u4e0d\u53ef\u89c1\uff0c\u5e76\u4e14\u4e0d\u53ef\u4fee\u6539</li> <li>range\u5206\u533a\uff0c\u5206\u533a\u5217\u901a\u5e38\u4e3a\u65f6\u95f4\u5217\uff0c\u4ee5\u65b9\u4fbf\u7ba1\u7406\u65b0\u65e7\u6570\u636e\uff0c\u5206\u533a\u7684\u5220\u9664\u4e0d\u4f1a\u6539\u53d8\u5df2\u5b58\u5728\u5206\u533a\u7684\u8303\u56f4\u3002\u5220\u9664\u5206\u533a\u53ef\u80fd\u51fa\u73b0\u7a7a\u6d1e\u3002\u901a\u8fc7 VALUES LESS THAN \u8bed\u53e5\u589e\u52a0\u5206\u533a\u65f6\uff0c\u5206\u533a\u7684\u4e0b\u754c\u7d27\u63a5\u4e0a\u4e00\u4e2a\u5206\u533a\u7684\u4e0a\u754c\u3002</li> <li>list\u5206\u533a\uff0c\u5206\u533a\u5217\u652f\u6301 BOOLEAN, TINYINT, SMALLINT, INT, BIGINT, LARGEINT, DATE, DATETIME, CHAR, VARCHAR    \u6570\u636e\u7c7b\u578b\uff0c\u5206\u533a\u503c\u4e3a\u679a\u4e3e\u503c\u3002\u53ea\u6709\u5f53\u6570\u636e\u4e3a\u76ee\u6807\u5206\u533a\u679a\u4e3e\u503c\u5176\u4e2d\u4e4b\u4e00\u65f6\uff0c\u624d\u53ef\u4ee5\u547d\u4e2d\u5206\u533a</li> <li>bucket\uff0c\u5206\u6876\u5217\u7684\u9009\u62e9\uff0c\u662f\u5728 \u67e5\u8be2\u541e\u5410 \u548c \u67e5\u8be2\u5e76\u53d1 \u4e4b\u95f4\u7684\u4e00\u79cd\u6743\u8861</li> </ol>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/StarRocks-DorisDB/DorisDB%E4%BA%86%E8%A7%A3/#_4","title":"\u5206\u533a\u521b\u5efa\u89c4\u5219(\u8981\u6ce8\u610f\uff0c\u53d1\u751f\u8fc7\u9519\u8bef)","text":"<ol> <li>\u5206\u533a\u540d\u79f0\u4ec5\u652f\u6301\u5b57\u6bcd\u5f00\u5934\uff0c\u7531\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\u7ec4\u6210\u3002</li> <li>\u4ec5\u652f\u6301\u4ee5\u4e0b\u7c7b\u578b\u7684\u5217\u4f5c\u4e3a Range \u5206\u533a\u5217\uff1aTINYINT, SMALLINT, INT, BIGINT, LARGEINT, DATE, DATETIME\u3002</li> <li>\u5206\u533a\u4e3a\u5de6\u95ed\u53f3\u5f00\u533a\u95f4\uff0c\u9996\u4e2a\u5206\u533a\u7684\u5de6\u8fb9\u754c\u4e3a\u6700\u5c0f\u503c\u3002</li> <li>NULL \u503c\u53ea\u4f1a\u5b58\u653e\u5728\u5305\u542b \u6700\u5c0f\u503c \u7684\u5206\u533a\u4e2d\u3002\u5f53\u5305\u542b\u6700\u5c0f\u503c\u7684\u5206\u533a\u88ab\u5220\u9664\u540e\uff0cNULL \u503c\u5c06\u65e0\u6cd5\u5bfc\u5165\u3002</li> <li>\u53ef\u4ee5\u6307\u5b9a\u4e00\u5217\u6216\u591a\u5217\u4f5c\u4e3a\u5206\u533a\u5217\u3002\u5982\u679c\u5206\u533a\u503c\u7f3a\u7701\uff0c\u5219\u4f1a\u9ed8\u8ba4\u586b\u5145\u6700\u5c0f\u503c\u3002</li> </ol> <p>\u672c\u4eba\u5c31\u56e0\u4e3a\u5206\u533a\u4f7f\u75282023-03\u4e2d\u5212\u7ebf\u5bfc\u81f4\u5728shell\u811a\u672c\u4e2d\u521b\u5efa\u4e34\u65f6\u5206\u533a\u65f6\u62a5\u9519</p> <p>\u5927\u6570\u636eHadoop\u4e4b\u2014\u2014DorisDB\u4ecb\u7ecd\u4e0e\u73af\u5883\u90e8\u7f72\uff08StarRocks\uff09</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/StarRocks-DorisDB/DorisDB%E8%AF%AD%E6%B3%95/","title":"\u8bed\u6cd5","text":"<ol> <li>\u67e5\u770b\u8868\u7ed3\u6784</li> </ol> <pre><code>DESC table;\n</code></pre> <ol> <li>\u67e5\u8be2\u5206\u533a\u4fe1\u606f</li> </ol> <pre><code>SHOW\nTEMPORARY PARTITIONS FROM table_name;\n//\u4e34\u65f6\u5206\u533a\nSHOW PARTITIONS FROM table_name; \n</code></pre> <ol> <li>\u67e5\u770b\u524d\u7aef\u8282\u70b9 SHOW PROC '/frontends'</li> <li>\u67e5\u770b\u540e\u7aef\u8282\u70b9 SHOW PROC '/backends'</li> <li>\u67e5\u770b\u8868\u6570\u636e\u5927\u5c0f SHOW DATA # \u67e5\u770b\u6240\u6709\u8868\u5927\u5c0f SHOW DATA FROM org_project_data_2 # \u67e5\u770b\u6307\u5b9a\u8868\u5927\u5c0f</li> <li>\u67e5\u770b\u8868\u5206\u533a SHOW PARTITIONS FROM new_table_name</li> <li>\u67e5\u770bload\u6570\u636e\u7684lable\u7684\u4efb\u52a1\u6267\u884c\u60c5\u51b5 SHOW LOAD WHERE label=\"my_label1\"</li> <li>\u91cd\u547d\u540d\u8868 ALTER TABLE test_table RENAME new_table_name</li> </ol>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hadoop/%E5%88%9D%E8%AF%86/","title":"Hadoop\u6982\u8ff0","text":""},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hadoop/%E5%88%9D%E8%AF%86/#hadoop_1","title":"Hadoop\u4f18\u70b9","text":"<ul> <li>\u9ad8\u53ef\u9760\uff1a\u7ef4\u62a4\u591a\u4e2a\u6570\u636e\u526f\u672c\uff0c\u5373\u4f7fHadoop\u67d0\u4e2a\u8ba1\u7b97\u5143\u7d20\u6216\u5b58\u50a8\u51fa\u73b0\u6545\u969c\u4e5f\u4e0d\u4f1a\u5bfc\u81f4\u6570\u636e\u6d41\u5931</li> <li>\u9ad8\u6269\u5c55\uff1a\u5728\u96c6\u7fa4\u5206\u914d\u4efb\u52a1\u6570\u636e\uff0c\u53ef\u65b9\u4fbf\u5730\u6269\u5c55\u8282\u70b9</li> <li>\u9ad8\u6548\uff1a\u5728MapReduce\u7684\u601d\u60f3\u4e0b\uff0cHadoop\u662f\u5e76\u884c\u5de5\u4f5c\u7684\uff0c\u52a0\u5feb\u4efb\u52a1\u5904\u7406\u901f\u5ea6</li> <li>\u9ad8\u5bb9\u9519\uff1a\u81ea\u52a8\u5c06\u5931\u8d25\u7684\u4efb\u52a1\u91cd\u65b0\u5206\u914d</li> </ul>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hadoop/%E5%88%9D%E8%AF%86/#_1","title":"\u7ec4\u4ef6\u7ec4\u6210","text":"<ul> <li>MapReduce(\u8ba1\u7b97)</li> <li>Yarn(\u8d44\u6e90\u8c03\u5ea6)</li> <li>HDFS(\u6570\u636e\u5b58\u50a8)</li> <li>Common(\u8f85\u52a9\u5de5\u5177)</li> </ul>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hadoop/%E5%88%9D%E8%AF%86/#hdfs","title":"HDFS\u67b6\u6784\u6982\u8ff0","text":"<p>\u6982\u8ff0\uff1aHadoop Distributed File System\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\uff0c\u5185\u7f6e\u4e09\u79cd\u7ec4\u4ef6\uff08\uff09</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hive/hive%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95DDL/","title":"Hive","text":"<p>https://www.docs4dev.com/docs/zh/apache-hive/3.1.1/reference/LanguageManual_DDL.html</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hive/hive%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95DDL/#createdropalteruse-database","title":"Create/Drop/Alter/Use Database","text":"<p>SCHEMA \u548c DATABASE \u7684\u7528\u6cd5\u662f\u76f8\u540c\u7684</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hive/hive%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95DDL/#create-database","title":"Create Database","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cHive \u521b\u5efa\u6258\u7ba1\u8868\uff0c\u5176\u4e2d\u6587\u4ef6\uff0c\u5143\u6570\u636e\u548c\u7edf\u8ba1\u4fe1\u606f\u7531\u5185\u90e8 Hive \u8fdb\u7a0b Management</p> <pre><code>CREATE (DATABASE|SCHEMA) [IF NOT EXISTS] database_name\n  [COMMENT database_comment]\n  [LOCATION hdfs_path]\n  [MANAGEDLOCATION hdfs_path]\n  [WITH DBPROPERTIES (property_name=property_value, ...)];\n</code></pre>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hive/hive%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95DDL/#drop-database","title":"Drop Database","text":"<pre><code>DROP (DATABASE|SCHEMA) [IF EXISTS] database_name [RESTRICT|CASCADE];\n</code></pre>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hive/hive%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95DDL/#alter-database","title":"Alter Database","text":"<pre><code>ALTER (DATABASE|SCHEMA) database_name SET DBPROPERTIES (property_name=property_value, ...);   -- (Note: SCHEMA added in Hive 0.14.0)\n\nALTER (DATABASE|SCHEMA) database_name SET OWNER [USER|ROLE] user_or_role;   -- (Note: Hive 0.13.0 and later; SCHEMA added in Hive 0.14.0)\n\nALTER (DATABASE|SCHEMA) database_name SET LOCATION hdfs_path; -- (Note: Hive 2.2.1, 2.4.0 and later)\n\nALTER (DATABASE|SCHEMA) database_name SET MANAGEDLOCATION hdfs_path; -- (Note: Hive 4.0.0 and later)\n</code></pre>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hive/hive%E8%AF%AD%E6%B3%95/","title":"Hive","text":"<p>https://www.docs4dev.com/docs/zh/apache-hive/3.1.1/reference/</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hive/hive%E8%AF%AD%E6%B3%95/#_1","title":"\u9047\u5230\u7684\u8bed\u6cd5","text":""},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hive/hive%E8%AF%AD%E6%B3%95/#insert-into-insert-overwrite","title":"insert into \u548cinsert overwrite\u533a\u522b","text":"<p>\u533a\u522b\u4e00</p> <ul> <li>insert into \uff1a\u5176\u5b9e\u662f\u5c06\u6570\u636e\u8ffd\u52a0\u5230\u8868\u7684\u672b\u5c3e\uff0c\u6ce8\u610f\uff1a\u4e0d\u662f\u8986\u76d6\uff0c\u662f\u8ffd\u52a0\u3002</li> <li>insert overwrite:\u5176\u5b9e\u662f\u5c06\u91cd\u5199\u8868\uff08\u6216\u5206\u533a\uff09\u4e2d\u7684\u5185\u5bb9\uff0c\u5373\u5c06\u539f\u6765\u7684hive\u8868\uff08\u6216\u5206\u533a\uff09\u4e2d\u7684\u6570\u636e\u5220\u9664\u6389\uff0c\u518d\u8fdb\u884c\u63d2\u5165\u6570\u636e\u64cd\u4f5c\u3002\uff08\u5982\u679chive \u8868\u793a\u5206\u533a\u8868\u7684\u8bdd\uff0cinsert overwrite   \u64cd\u4f5c\u53ea\u662f\u4f1a\u91cd\u5199\u5f53\u524d\u5206\u533a\u7684\u6570\u636e\uff0c\u662f\u4e0d\u4f1a\u91cd\u5199\u5176\u4ed6\u5206\u533a\u7684\u6570\u636e\u7684\u3002\uff09</li> </ul> <p>\u533a\u522b\u4e8c</p> <ul> <li>hive &gt; insert into dwd_user select * from ods_user; insert into \u662f\u53ef\u4ee5\u7701\u7565table\u5173\u952e\u5b57</li> <li>hive &gt; insert overwrite table dwd_user select * from ods_user; \u8986\u76d6\u4e4b\u524d\u7684\u6570\u636e\uff0ctable\u5173\u952e\u5b57\u4e0d\u53ef\u7701\u7565</li> </ul>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hive/hive%E8%AF%AD%E6%B3%95/#if","title":"if\u8bed\u6cd5","text":"<p>if\u548ccase\u5dee\u4e0d\u591a\uff0c\u90fd\u662f\u5904\u7406\u5355\u4e2a\u5217\u7684\u67e5\u8be2\u7ed3\u679c \u8868\u8fbe\u5f0f:</p> <pre><code>if(boolean testCondition, T valueTrue, T valueFalseOrNull)\n</code></pre> <p>\u5f53\u6761\u4ef6testCondition\u4e3aTRUE\u65f6\uff0c\u8fd4\u56devalueTrue\uff1b\u5426\u5219\u8fd4\u56devalueFalseOrNull \uff08if\u4e2d\u7684\u7b49\u4e8e\u6761\u4ef6\u7528\u201c=\u201d\u6216\u201c==\u201d\u5747\u53ef\uff09</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hive/hive%E8%AF%AD%E6%B3%95/#order-by-id-desc-nulls-last","title":"order by  id DESC nulls last \u6392\u5e8f\u5b57\u6bb5","text":"<ol> <li>order by\u540e\u9762\u53ef\u4ee5\u6709\u591a\u5217\u8fdb\u884c\u6392\u5e8f\uff0c\u9ed8\u8ba4\u6309\u5b57\u5178\u6392\u5e8f\u3002</li> <li>order by\u4e3a\u5168\u5c40\u6392\u5e8f\u3002</li> <li>order by\u9700\u8981reduce\u64cd\u4f5c\uff0c\u4e14\u53ea\u6709\u4e00\u4e2areduce\uff0c\u65e0\u6cd5\u914d\u7f6e(\u56e0\u4e3a\u591a\u4e2areduce\u65e0\u6cd5\u5b8c\u6210\u5168\u5c40\u6392\u5e8f)</li> </ol>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hive/hive%E8%AF%AD%E6%B3%95/#with-as","title":"with as\u8bed\u6cd5","text":"<p>with as\u5c31\u7c7b\u4f3c\u4e8e\u4e00\u4e2a\u89c6\u56fe\u6216\u4e34\u65f6\u8868\uff0c\u53ef\u4ee5\u7528\u6765\u5b58\u50a8\u4e00\u90e8\u5206\u7684sql\u8bed\u53e5\u4f5c\u4e3a\u522b\u540d\uff0c\u4e0d\u540c\u7684\u662fwith as \u5c5e\u4e8e\u4e00\u6b21\u6027\u7684\uff0c\u800c\u4e14\u5fc5\u987b\u8981\u548c\u5176\u4ed6sql\u4e00\u8d77\u4f7f\u7528\u624d\u53ef\u4ee5</p> <pre><code>with dwd_test as (\nselect  user_id\n        , user_name as name\n        , trade_number as tradeNumber\n        , business_type as businessType\n        , win_bid_date as bidDate\n        , loading_date as loadingDate\n        , demand_order_code as demandOrderCode\n        , user_mobile as userMobile\nfrom dwd_test.test001\nwhere loading_date between '${startDate}' and '${endDate}'\n    /*and user_id &gt; 0*/\n    &lt;%if(isNotEmpty(userType)){%&gt;\n        and user_type = ${userType}\n    &lt;%}%&gt;\n    &lt;%if(isNotEmpty(businessType)){%&gt;\n        and business_type = ${businessType}\n    &lt;%}%&gt;\n        and ${bdDataScope}\n&lt;%if(isEmpty(orderBy)) {print(' order by user_id desc nulls last ');}%&gt;      \n&lt;%if(isNotEmpty(orderBy)) {print(' order by ' + orderBy + ' nulls last ');}%&gt;  \n)\nselect\n    dt.*\nfrom dwd_test dt\n</code></pre>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hive/hive%E8%AF%AD%E6%B3%95/#row_number-overpartition-byorder-by","title":"row_number over(partition by,order by)\u7528\u6cd5","text":"<p>row_number() over(partition by \u5206\u7ec4\u5217 order by \u6392\u5e8f\u5217 desc) \u5728\u4f7f\u7528 row_number() over()\u51fd\u6570\u7684\u65f6\u5019\uff0cover()\u91cc\u9762\u7684\u5206\u7ec4\u4ee5\u53ca\u6392\u5e8f\u7684\u6267\u884c\u665a\u4e8e where\u3001group by\u3001order by \u7684\u6267\u884c</p> <ul> <li>partition\uff1a\u6309\u7167month\u5206\u6210\u533a\u5757</li> <li>order by \uff1a\u6392\u5e8f\u662f\u5728partition\u5206\u6210\u7684\u533a\u5757\u4e2d\u5206\u522b\u8fdb\u884c\u3002</li> <li>row_number()\uff1a\u5bf9\u5404\u4e2a\u5206\u533a\u5206\u522b\u6dfb\u52a0\u7f16\u53f7\uff0c\u7c7b\u4f3c\u4e8erownum\u7684\u9012\u589e\u5e8f\u5217</li> </ul> <p>\u5b9e\u4f8b\uff1a\u53d6\u5206\u7ec4\u5185\u7684\u6392\u7b2c\u4e8c\u7684\u6570\u636e\u53ef\u7528\u6b64\u79cd\u65b9\u5f0f</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hive/hive%E8%AF%AD%E6%B3%95/#leastgreatest","title":"least/greatest\u51fd\u6570","text":"<p>least\u51fd\u6570</p> <ol> <li>\u53d6\u591a\u5217\u6700\u5c0f\u503cselect least(-99, 0, 73) -- -99</li> <li>\u5b58\u5728null\u6216\u8005\u5b57\u7b26\u4e32\uff0c\u6709null\u53d6null\uff0c\u6709\u5b57\u7b26\u4e32\u53d6null\uff0cselect least(-99, 0, 73, null) --null ;select least(-99, 0, 73, 'string') --null</li> <li>\u5b58\u5728\u65e5\u671f\uff0c\u53d6\u6700\u5c0f\u65e5\u671f select least('2022-01-01','2022-06-01','2022-06-09') -- 2022-01-01</li> </ol> <p>greatest\u51fd\u6570</p> <ol> <li>\u53d6\u591a\u5217\u6700\u5927\u503c select greatest(-99, 0, 73) --73</li> <li>\u5b58\u5728null\u53d6\u5230null</li> <li>\u5b58\u5728\u65e5\u671f\uff0c\u53d6\u6700\u5927\u65e5\u671f select greatest('2022-01-01','2022-06-01','2022-06-09') --2022-06-09\uff08\u5982\u679c\u4e0d\u786e\u5b9a\u65e5\u671f\u6709\u65e0\u7a7a\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u7a7a\u503c\u9ed8\u8ba4\u65f6\u95f4\uff0c\u518d\u7528\u51fd\u6570\uff09</li> </ol>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hive/hive%E8%AF%AD%E6%B3%95/#floorceilround","title":"\u5c0f\u6570\u53d6\u6574\u51fd\u6570\uff08floor\uff0cceil\uff0cround\u51fd\u6570\uff09","text":"<ol> <li>floor()\u5411\u4e0b\u53d6\u6574\u51fd\u6570 select floor(1.4)  # \u7ed3\u679c\u662f\uff1a1</li> <li>ceil()\u5411\u4e0a\u53d6\u6574 select ceil(1.4)  #\u7ed3\u679c\u662f\uff1a2</li> <li>round()\u56db\u820d\u4e94\u5165 select round(1.455, 2)  #\u7ed3\u679c\u662f\uff1a1.46\uff0c\u5373\u56db\u820d\u4e94\u5165\u5230\u5341\u5206\u4f4d</li> </ol>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/hive/hive%E8%AF%AD%E6%B3%95/#datediffdate_add","title":"\u5185\u7f6e\u65f6\u95f4\u51fd\u6570datediff/date_add","text":"<ol> <li>datediff\u51fd\u6570</li> </ol> <p>\u65e5\u671f\u6bd4\u8f83\u51fd\u6570\uff0c\u8fd4\u56de\u7ed3\u675f\u65e5\u671f\u51cf\u53bb\u5f00\u59cb\u65e5\u671f\u7684\u5929\u6570\uff08\u4e24\u4e2a\u65e5\u671f\u5fc5\u987b\u662f'yyyy-MM-dd'\u7684\u683c\u5f0f\uff0c\u5426\u5219\u6267\u884c\u7ed3\u679c\u4f1a\u662fNULL\uff09</p> <pre><code>datediff(string enddate,string startdate)\n</code></pre> <p>\u4f8b\u5982\uff1aselect datediff('2022-12-31','2022-12-20');\u6267\u884c\u7ed3\u679c11</p> <ol> <li>date_add\u65e5\u671f\u589e\u52a0\u51fd\u6570</li> </ol> <p>\u8fd4\u56de\u5f00\u59cb\u65e5\u671fstartdate\u589e\u52a0days\u5929\u540e\u7684\u65e5\u671f\u3002</p> <pre><code>date_add(string startdate, intdays)\n</code></pre> <p>\u4f8b\u5982\uff1aselect date_add('2022-12-20',11);\u6267\u884c\u7ed3\u679c:2022-12-31</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/member/%E4%BC%9A%E5%91%98%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%9B%B8%E5%85%B3/","title":"\u4f1a\u5458\u5927\u6570\u636e\u76f8\u5173","text":""},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/member/%E4%BC%9A%E5%91%98%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%9B%B8%E5%85%B3/#_1","title":"\u4f1a\u5458\u5927\u6570\u636e\u67b6\u6784\u56fe","text":""},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/%E8%B0%83%E5%BA%A6/AzKaban/%E5%A4%9A%E4%BB%BB%E5%8A%A1%E6%B5%81%E5%B9%B6%E8%A1%8C/","title":"\u591a\u4efb\u52a1\u6d41\u5e76\u884c\uff0c\u4e00\u6761\u5931\u8d25\u5f71\u54cd\u53e6\u4e00\u6761","text":"<p>azkaban\u5728\u4f7f\u7528\u9ed8\u8ba4\u7684\u8bbe\u7f6e\u4e0b\u3002\u5f53azkaban\u6709\u5e76\u884c\u7684\u4e24\u6761\u4efb\u52a1\u7ebf\u65f6\uff0c\u5176\u4e2d\u4e00\u4e2a\u8282\u70b9\u5931\u8d25\uff0c\u5176\u4ed6\u672a\u4f9d\u8d56\u6b64\u8282\u70b9\u7684\u4efb\u52a1\u4e5f\u4f1a\u88ab\u53d6\u6d88\u3002\u4f8b\u5982C\u4efb\u52a1\u5931\u8d25\uff0c\u53e6\u4e00\u6761\u7ebf\u7684D\u4efb\u52a1\u4e5f\u88ab\u53d6\u6d88\u4e86</p>"},{"location":"%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6/%E8%B0%83%E5%BA%A6/AzKaban/%E5%A4%9A%E4%BB%BB%E5%8A%A1%E6%B5%81%E5%B9%B6%E8%A1%8C/#_2","title":"\u5931\u8d25\u4efb\u52a1\uff0c\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u91cd\u8bd5","text":"<ul> <li>retries=5 # \u91cd\u8bd5\u6b21\u6570</li> <li>retry.backoff=3000 # \u91cd\u8bd5\u95f4\u9694\u65f6\u95f4 </li> </ul>"},{"location":"%E5%B7%A5%E5%85%B7%E7%B1%BB/Mermaid/","title":"Mermaid","text":""},{"location":"%E5%B7%A5%E5%85%B7%E7%B1%BB/Mermaid/#_1","title":"\u7b80\u4ecb","text":"<p>\u5728\u7ebf\u7f51\u7ad9\uff1ahttps://mermaid.live/</p>"},{"location":"%E5%B7%A5%E5%85%B7%E7%B1%BB/java%E8%B0%83%E7%94%A8%E6%96%B9%E6%B3%95%E7%B1%BB/","title":"java\u76f4\u63a5\u8c03\u7528\u65b9\u6cd5\u5de5\u5177","text":"<p>\u4e00\u3001\u53c2\u6570\u5b9e\u4f53\u7c7b</p> <pre><code>import lombok.Data;\n\nimport java.io.Serializable;\nimport java.util.List;\n\n/**\n * @author lviter\n */\n@Data\npublic class InvocationDTO implements Serializable {\n\n    /**\n     * beanName\n     */\n    private String beanName;\n    /**\n     * \u65b9\u6cd5\u540d\n     */\n    private String methodName;\n    /**\n     * \u662f\u5426\u5f00\u542f\u4e8b\u52a1\n     */\n    private Boolean openTransaction;\n    /**\n     * \u53c2\u6570\u5217\u8868\n     */\n    private List&lt;Parameter&gt; parameterList;\n\n    @Data\n    public static class Parameter {\n        /**\n         * \u53c2\u6570\u7c7b\u578b \u7c7b\u4f3c: com.omega.api.model.BillInfo\n         */\n        private String paramType;\n        /**\n         * \u8f6c\u6362\u7c7b\u578b\n         */\n        private String convertType;\n        /**\n         * \u503c\n         */\n        private Object value;\n    }\n}\n</code></pre> <p>\u4e8c\u3001SpringUtils\u5de5\u5177\u7c7b</p> <pre><code>@Configuration\npublic class SpringUtils implements ApplicationContextAware {\n    private static final Logger logger = LoggerFactory.getLogger(SpringUtils.class);\n\n    public static String applicationName = null;\n    public static String applicationAbbr = null;\n\n    private static ApplicationContext ctx = null;\n\n    public static Object getBean(String beanName) {\n        if (ctx != null) {\n            try {\n                return ctx.getBean(beanName);\n            } catch (Exception e) {\n                logger.warn(\"\u83b7\u53d6Bean\u5931\u8d25\uff01 beanName: \" + beanName, e);\n                return null;\n            }\n        }\n\n        return null;\n    }\n\n    public static &lt;T&gt; T getBean(String beanName, Class&lt;T&gt; requiredType) {\n        T result = null;\n        if (ctx != null) {\n            try {\n                result = ctx.getBean(beanName, requiredType);\n            } catch (Exception e) {\n                logger.warn(\"\u83b7\u53d6Bean\u5931\u8d25\uff01 beanName: \" + beanName, e);\n            }\n        }\n\n        return result;\n    }\n\n    public static &lt;T&gt; T getBean(Class&lt;T&gt; requiredType) {\n        T result = null;\n        if (ctx != null) {\n            try {\n                result = ctx.getBean(requiredType);\n            } catch (Exception e) {\n                logger.warn(\"\u83b7\u53d6Bean\u5931\u8d25\uff01\", e);\n            }\n        }\n\n        return result;\n    }\n\n    public static void publishEvent(ApplicationEvent event) {\n        if (ctx != null) {\n            ctx.publishEvent(event);\n        }\n    }\n\n    public static ApplicationContext getApplicationContext() {\n        return ctx;\n    }\n\n    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {\n        applicationName = applicationContext.getId();\n        ctx = applicationContext;\n        applicationAbbr = getProperty(\"spring.application.abbr\", applicationName);\n    }\n\n    public static String getProperty(String key) {\n        return getProperty(key, \"\");\n    }\n\n    public static String getProperty(String key, String defaultValue) {\n        String result = defaultValue;\n        Environment environment = getBean(Environment.class);\n        if (environment != null) {\n            result = environment.getProperty(key, defaultValue);\n        }\n\n        return result;\n    }\n}\n</code></pre> <p>\u4e09\u3001Aop\u5de5\u5177\u7c7b</p> <pre><code>/**\n * AopTargetUtils\n * \u7528\u4e8e\u83b7\u53d6Spring AOP\u4ee3\u7406\u80cc\u540e\u7684\u771f\u5b9e\u76ee\u6807\u5bf9\u8c61\uff08\u652f\u6301JDK\u52a8\u6001\u4ee3\u7406\u548cCGLIB\u4ee3\u7406\uff09\n *\n * @author Lv.\n * @date 2025/7/7 14:49\n */\npublic class AopTargetUtils {\n\n    /**\n     * CGLIB\u4ee3\u7406\u4e2d\u56de\u8c03\u5b57\u6bb5\u540d\u79f0\n     */\n    private static final String CGLIB_CALLBACK_FIELD = \"CGLIB$CALLBACK_0\";\n\n    /**\n     * JDK\u52a8\u6001\u4ee3\u7406\u4e2d\u7ed1\u5b9a\u7684InvocationHandler\u5b57\u6bb5\u540d\u79f0\n     */\n    private static final String JDK_PROXY_HANDLER_FIELD = \"h\";\n\n    /**\n     * \u83b7\u53d6\u4ee3\u7406\u5bf9\u8c61\u80cc\u540e\u7684\u771f\u5b9e\u76ee\u6807\u5bf9\u8c61\n     *\n     * @param proxy \u4ee3\u7406\u5bf9\u8c61\n     * @return \u771f\u5b9e\u76ee\u6807\u5bf9\u8c61\uff0c\u5982\u679c\u975e\u4ee3\u7406\u5219\u8fd4\u56de\u81ea\u8eab\n     * @throws RuntimeException \u5982\u679c\u83b7\u53d6\u8fc7\u7a0b\u4e2d\u53d1\u751f\u5f02\u5e38\n     */\n    public static Object getTarget(Object proxy) {\n        if (!AopUtils.isAopProxy(proxy)) {\n            return proxy;\n        }\n\n        try {\n            if (AopUtils.isJdkDynamicProxy(proxy)) {\n                return getJdkDynamicProxyTargetObject(proxy);\n            } else {\n                return getCglibDynamicProxyTargetObject(proxy);\n            }\n        } catch (Exception e) {\n            throw new RuntimeException(\"\u83b7\u53d6\u4ee3\u7406\u76ee\u6807\u5bf9\u8c61\u5931\u8d25\", e);\n        }\n    }\n\n    /**\n     * \u83b7\u53d6JDK\u52a8\u6001\u4ee3\u7406\u7684\u76ee\u6807\u5bf9\u8c61\n     */\n    private static Object getJdkDynamicProxyTargetObject(Object proxy) throws Exception {\n        Object invocationHandler = getFieldValue(proxy, JDK_PROXY_HANDLER_FIELD);\n        Object advised = getFieldValue(invocationHandler, \"advised\");\n        return ((AdvisedSupport) advised).getTargetSource().getTarget();\n    }\n\n    /**\n     * \u83b7\u53d6CGLIB\u4ee3\u7406\u7684\u76ee\u6807\u5bf9\u8c61\n     */\n    private static Object getCglibDynamicProxyTargetObject(Object proxy) throws Exception {\n        Object dynamicAdvisedInterceptor = getFieldValue(proxy, CGLIB_CALLBACK_FIELD);\n        Object advised = getFieldValue(dynamicAdvisedInterceptor, \"advised\");\n        return ((AdvisedSupport) advised).getTargetSource().getTarget();\n    }\n\n    /**\n     * \u4f7f\u7528\u53cd\u5c04\u83b7\u53d6\u6307\u5b9a\u5b57\u6bb5\u7684\u503c\n     *\n     * @param obj       \u8981\u83b7\u53d6\u5b57\u6bb5\u7684\u5bf9\u8c61\n     * @param fieldName \u5b57\u6bb5\u540d\u79f0\n     * @return \u5b57\u6bb5\u503c\n     * @throws Exception \u53cd\u5c04\u5f02\u5e38\n     */\n    private static Object getFieldValue(Object obj, String fieldName) throws Exception {\n        Field field = obj.getClass().getDeclaredField(fieldName);\n        field.setAccessible(true);\n        return field.get(obj);\n    }\n\n    /**\n     * \u6cdb\u578b\u65b9\u6cd5\uff1a\u83b7\u53d6\u4ee3\u7406\u5bf9\u8c61\u80cc\u540e\u7684\u771f\u5b9e\u76ee\u6807\u5bf9\u8c61\u5e76\u8f6c\u6362\u4e3a\u76ee\u6807\u7c7b\u578b\n     *\n     * @param proxy      \u4ee3\u7406\u5bf9\u8c61\n     * @param targetType \u76ee\u6807\u7c7b\u578b\n     * @param &lt;T&gt;        \u6cdb\u578b\n     * @return \u8f6c\u6362\u540e\u7684\u76ee\u6807\u5bf9\u8c61\n     * @throws RuntimeException \u5982\u679c\u7c7b\u578b\u4e0d\u5339\u914d\u6216\u83b7\u53d6\u5931\u8d25\n     */\n    public static &lt;T&gt; T getTarget(Object proxy, Class&lt;T&gt; targetType) {\n        Object target = getTarget(proxy);\n        if (!targetType.isInstance(target)) {\n            throw new IllegalArgumentException(\"\u76ee\u6807\u5bf9\u8c61\u4e0d\u662f\u671f\u671b\u7684\u7c7b\u578b\uff1a\" + targetType.getName());\n        }\n        return targetType.cast(target);\n    }\n}\n</code></pre> <p>\u56db\u3001\u65b9\u6cd5\u8c03\u7528\u5de5\u5177\u7c7b</p> <pre><code>/**\n * \u8c03\u7528\u65b9\u6cd5\u5de5\u5177\u7c7b\n *\n * @author Lv.\n * @date 2025/7/8 9:20\n */\n@Slf4j\npublic class InvocationUtil {\n    /**\n     * \u8c03\u7528\u6307\u5b9aBean\u7684\u65b9\u6cd5\uff08\u652f\u6301\u4e8b\u52a1\u63a7\u5236\uff09\n     *\n     * @param dto \u5305\u542b\u8c03\u7528\u53c2\u6570\u7684 InvocationDTO\n     */\n    public void invocation(InvocationDTO dto) {\n        if (dto == null || dto.getParameterList() == null) {\n            log.warn(\"\u8c03\u7528\u53c2\u6570\u4e3a\u7a7a\");\n            return;\n        }\n        try {\n            // \u83b7\u53d6Bean\u548c\u5b9e\u9645\u76ee\u6807\u5bf9\u8c61\n            Object bean = SpringUtils.getBean(dto.getBeanName());\n            Object target = AopTargetUtils.getTarget(bean);\n            Class&lt;?&gt; clz = target.getClass();\n\n            // \u6784\u5efa\u53c2\u6570\u7c7b\u578b\u548c\u503c\n            int length = dto.getParameterList().size();\n            Class&lt;?&gt;[] parameterTypes = new Class[length];\n            Object[] params = new Object[length];\n\n            for (int i = 0; i &lt; length; i++) {\n                InvocationDTO.Parameter param = dto.getParameterList().get(i);\n                parameterTypes[i] = Class.forName(param.getParamType());\n\n                if (\"object\".equals(param.getConvertType())) {\n                    String json = JSON.toJSONString(param.getValue());\n                    params[i] = JsonUtils.serializable(json, parameterTypes[i]);\n                } else {\n                    params[i] = param.getValue();\n                }\n            }\n\n            // \u83b7\u53d6\u65b9\u6cd5\n            Method method = clz.getMethod(dto.getMethodName(), parameterTypes);\n            ReflectionUtils.makeAccessible(method);\n\n            // \u662f\u5426\u542f\u7528\u4e8b\u52a1\n            if (Boolean.TRUE.equals(dto.getOpenTransaction())) {\n                TransactionTemplate transactionTemplate = SpringUtils.getBean(TransactionTemplate.class);\n                transactionTemplate.execute(action -&gt; {\n                    try {\n                        method.invoke(target, params);\n                    } catch (Exception e) {\n                        log.error(\"\u4e8b\u52a1\u5185\u8c03\u7528 {}#{} \u5f02\u5e38\", dto.getBeanName(), dto.getMethodName(), e);\n                        throw new ApplicationException(ResponseCode.ONLY_THROW_MSG, \"\u65b9\u6cd5\u8c03\u7528\u5931\u8d25: \" + dto.getMethodName(), e);\n                    }\n                    return null;\n                });\n            } else {\n                method.invoke(target, params);\n            }\n\n        } catch (ClassNotFoundException e) {\n            log.error(\"\u7c7b\u672a\u627e\u5230: {}\", dto.getBeanName(), e);\n        } catch (NoSuchMethodException e) {\n            log.error(\"\u65b9\u6cd5\u4e0d\u5b58\u5728: {}\", dto.getMethodName(), e);\n        } catch (Exception e) {\n            log.error(\"\u8c03\u7528 {}#{} \u53d1\u751f\u672a\u77e5\u5f02\u5e38\", dto.getBeanName(), dto.getMethodName(), e);\n        }\n    }\n}\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E7%B1%BB/%E5%8A%A0%E8%A7%A3%E5%AF%86%E7%B1%BB/%E5%8A%A0%E8%A7%A3%E5%AF%86%E6%93%8D%E4%BD%9C/","title":"\u52a0\u89e3\u5bc6\u64cd\u4f5c","text":"<pre><code>import javax.crypto.Cipher;\nimport javax.crypto.SecretKey;\nimport javax.crypto.spec.SecretKeySpec;\npublic class Test {\n\n    /**\n     * \u968f\u610f\u5b9a\u4e00\u4e2a\u79c1\u94a5\uff08\u957f\u5ea6\u5fc5\u987b\u4e3a24\u4f4d\uff09\n     */\n    public static final String SECRET_KEY = \"ABCDEFGHIJKLMN1234567890\";\n\n    /**\n     * \u52a0\u5bc6\n     *\n     * @param inStr     \u9700\u8981\u52a0\u5bc6\u7684\u5185\u5bb9\n     * @param secretKey \u5bc6\u94a5\n     * @return \u52a0\u5bc6\u540e\u7684\u6570\u636e\n     */\n\n    public static String encrypt(String inStr, String secretKey) {\n        SecretKey deskey = new SecretKeySpec(secretKey.getBytes(), \"DESede\");\n        Cipher cipher;\n        String outStr = null;\n        try {\n            cipher = Cipher.getInstance(\"DESede\");\n            cipher.init(Cipher.ENCRYPT_MODE, deskey);\n            outStr = byte2hex(cipher.doFinal(inStr.getBytes()));\n        } catch (Exception e) {\n            System.out.println(\"\u5f02\u5e38\uff1a\" + e);\n        }\n        return outStr;\n\n    }\n\n    /**\n     * \u89e3\u5bc6\n     *\n     * @param inStr     \u9700\u8981\u89e3\u5bc6\u7684\u5185\u5bb9\n     * @param secretKey \u5bc6\u94a5\n     * @return \u89e3\u5bc6\u540e\u7684\u6570\u636e\n     */\n\n    public static String decrypt(String inStr, String secretKey) {\n        SecretKey deskey = new SecretKeySpec(secretKey.getBytes(), \"DESede\");\n        Cipher cipher;\n        String outStr = null;\n        try {\n            cipher = Cipher.getInstance(\"DESede\");\n            cipher.init(Cipher.DECRYPT_MODE, deskey);\n            outStr = new String(cipher.doFinal(hex2byte(inStr)));\n        } catch (Exception e) {\n            System.out.println(\"\u5f02\u5e38\uff1a\" + e);\n\n        }\n        return outStr;\n\n    }\n\n    /**\n     * \u8f6c\u5316\u4e3a16\u8fdb\u5236\u5b57\u7b26\u4e32\u65b9\u6cd5\n     *\n     * @param digest \u9700\u8981\u8f6c\u6362\u7684\u5b57\u8282\u7ec4\n     * @return \u8f6c\u6362\u540e\u7684\u5b57\u7b26\u4e32\n     */\n\n    private static String byte2hex(byte[] digest) {\n        StringBuffer hs = new StringBuffer();\n        String stmp = \"\";\n        for (int n = 0; n &lt; digest.length; n++) {\n            stmp = Integer.toHexString(digest[n] &amp; 0XFF);\n            if (stmp.length() == 1) {\n                hs.append(\"0\" + stmp);\n            } else {\n                hs.append(stmp);\n            }\n        }\n        return hs.toString().toUpperCase();\n    }\n\n    /**\n     * \u5341\u516d\u8fdb\u8f6c\u4e8c\u8fdb\u5236\n     *\n     * @param hexStr \u5f85\u8f6c\u636216\u8fdb\u5236\u5b57\u7b26\u4e32\n     * @return \u4e8c\u8fdb\u5236\u5b57\u8282\u7ec4\n     */\n\n    public static byte[] hex2byte(String hexStr) {\n        if (hexStr == null)\n            return null;\n        hexStr = hexStr.trim();\n        int len = hexStr.length();\n        if (len == 0 || len % 2 == 1)\n            return null;\n        byte[] digest = new byte[len / 2];\n        try {\n            for (int i = 0; i &lt; hexStr.length(); i += 2) {\n                digest[i / 2] = (byte) Integer.decode(\"0x\" + hexStr.substring(i, i + 2)).intValue();\n            }\n            return digest;\n        } catch (Exception e) {\n            return null;\n        }\n    }\n\n    public static void main(String[] args) {\n        System.out.println(\"\u53d1\u9001\uff1a\" + encrypt(\"\u665a\u4e0a\u52a0\u73ed\u5417\uff1f\", SECRET_KEY));\n        String chat = \"6C06B92FFCF2CDC7\";\n        System.out.println(decrypt(chat, SECRET_KEY));\n    }\n}\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/","title":"\u6570\u636e\u5e93\u4e13\u533a","text":"<p>mysql</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/#shardingsphere","title":"\u5206\u5e93\u5206\u8868\u6846\u67b6ShardingSphere","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/","title":"ShardingSphere\u7b80\u4ecb\u53ca\u4f7f\u7528","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#shardingsphere","title":"ShardingSphere\u200b","text":"<pre><code>Apache ShardingSphere \u662f\u4e00\u5957\u5f00\u6e90\u7684\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u4e2d\u95f4\u4ef6\u89e3\u51b3\u65b9\u6848\u7ec4\u6210\u7684\u751f\u6001\u5708\uff0c\u5b83\u7531 JDBC\u3001Proxy \u548c Sidecar\uff08\u89c4\u5212\u4e2d\uff09\u8fd9 3 \u6b3e\u76f8\u4e92\u72ec\u7acb\uff0c\u5374\u53c8\u80fd\u591f\u6df7\u5408\u90e8\u7f72\u914d\u5408\u4f7f\u7528\u7684\u4ea7\u54c1\u7ec4\u6210\u3002 \u5b83\u4eec\u5747\u63d0\u4f9b\u6807\u51c6\u5316\u7684\u6570\u636e\u5206\u7247\u3001\u5206\u5e03\u5f0f\u4e8b\u52a1\u548c\u6570\u636e\u5e93\u6cbb\u7406\u529f\u80fd\uff0c\u53ef\u9002\u7528\u4e8e\u5982 Java \u540c\u6784\u3001\u5f02\u6784\u8bed\u8a00\u3001\u4e91\u539f\u751f\u7b49\u5404\u79cd\u591a\u6837\u5316\u7684\u5e94\u7528\u573a\u666f\u3002\n</code></pre> <p>Apache ShardingSphere \u5b9a\u4f4d\u4e3a\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\u95f4\u4ef6\uff0c\u65e8\u5728\u5145\u5206\u5408\u7406\u5730\u5728\u5206\u5e03\u5f0f\u7684\u573a\u666f\u4e0b\u5229\u7528\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u8ba1\u7b97\u548c\u5b58\u50a8\u80fd\u529b\uff0c\u800c\u5e76\u975e\u5b9e\u73b0\u4e00\u4e2a\u5168\u65b0\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u3002 \u5b83\u901a\u8fc7\u5173\u6ce8\u4e0d\u53d8\uff0c\u8fdb\u800c\u6293\u4f4f\u4e8b\u7269\u672c\u8d28\u3002\u5173\u7cfb\u578b\u6570\u636e\u5e93\u5f53\u4eca\u4f9d\u7136\u5360\u6709\u5de8\u5927\u5e02\u573a\uff0c\u662f\u5404\u4e2a\u516c\u53f8\u6838\u5fc3\u4e1a\u52a1\u7684\u57fa\u77f3\uff0c\u672a\u6765\u4e5f\u96be\u4e8e\u64bc\u52a8\uff0c\u6211\u4eec\u76ee\u524d\u9636\u6bb5\u66f4\u52a0\u5173\u6ce8\u5728\u539f\u6709\u57fa\u7840\u4e0a\u7684\u589e\u91cf\uff0c\u800c\u975e\u98a0\u8986\u3002</p> <p>Apache ShardingSphere 5.x \u7248\u672c\u5f00\u59cb\u81f4\u529b\u4e8e\u53ef\u63d2\u62d4\u67b6\u6784\uff0c\u9879\u76ee\u7684\u529f\u80fd\u7ec4\u4ef6\u80fd\u591f\u7075\u6d3b\u7684\u4ee5\u53ef\u63d2\u62d4\u7684\u65b9\u5f0f\u8fdb\u884c\u6269\u5c55\u3002 \u76ee\u524d\uff0c\u6570\u636e\u5206\u7247\u3001\u8bfb\u5199\u5206\u79bb\u3001\u6570\u636e\u52a0\u5bc6\u3001\u5f71\u5b50\u5e93\u538b\u6d4b\u7b49\u529f\u80fd\uff0c\u4ee5\u53ca MySQL\u3001PostgreSQL\u3001SQLServer\u3001Oracle \u7b49 SQL \u4e0e\u534f\u8bae\u7684\u652f\u6301\uff0c\u5747\u901a\u8fc7\u63d2\u4ef6\u7684\u65b9\u5f0f\u7ec7\u5165\u9879\u76ee\u3002</p> <p></p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_1","title":"\u7b80\u4ecb","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#shardingsphere-jdbc","title":"ShardingSphere-JDBC","text":"<p>\u5b9a\u4f4d\u4e3a\u8f7b\u91cf\u7ea7 Java \u6846\u67b6\uff0c\u5728 Java \u7684 JDBC \u5c42\u63d0\u4f9b\u7684\u989d\u5916\u670d\u52a1\u3002 \u5b83\u4f7f\u7528\u5ba2\u6237\u7aef\u76f4\u8fde\u6570\u636e\u5e93\uff0c\u4ee5 jar \u5305\u5f62\u5f0f\u63d0\u4f9b\u670d\u52a1\uff0c\u65e0\u9700\u989d\u5916\u90e8\u7f72\u548c\u4f9d\u8d56\uff0c\u53ef\u7406\u89e3\u4e3a\u589e\u5f3a\u7248\u7684 JDBC \u9a71\u52a8\uff0c\u5b8c\u5168\u517c\u5bb9 JDBC \u548c\u5404\u79cd ORM \u6846\u67b6\u3002</p> <ul> <li>\u9002\u7528\u4e8e\u4efb\u4f55\u57fa\u4e8e JDBC \u7684 ORM \u6846\u67b6\uff0c\u5982\uff1aJPA, Hibernate, Mybatis, Spring JDBC Template \u6216\u76f4\u63a5\u4f7f\u7528 JDBC\u3002</li> <li>\u652f\u6301\u4efb\u4f55\u7b2c\u4e09\u65b9\u7684\u6570\u636e\u5e93\u8fde\u63a5\u6c60\uff0c\u5982\uff1aDBCP, C3P0, BoneCP, Druid, HikariCP \u7b49\u3002</li> <li>\u652f\u6301\u4efb\u610f\u5b9e\u73b0 JDBC \u89c4\u8303\u7684\u6570\u636e\u5e93\uff0c\u76ee\u524d\u652f\u6301 MySQL\uff0cOracle\uff0cSQLServer\uff0cPostgreSQL \u4ee5\u53ca\u4efb\u4f55\u9075\u5faa SQL92 \u6807\u51c6\u7684\u6570\u636e\u5e93\u3002</li> </ul> <p></p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#shardingsphere-proxy","title":"ShardingSphere-Proxy","text":"<p>\u5b9a\u4f4d\u4e3a\u900f\u660e\u5316\u7684\u6570\u636e\u5e93\u4ee3\u7406\u7aef\uff0c\u63d0\u4f9b\u5c01\u88c5\u4e86\u6570\u636e\u5e93\u4e8c\u8fdb\u5236\u534f\u8bae\u7684\u670d\u52a1\u7aef\u7248\u672c\uff0c\u7528\u4e8e\u5b8c\u6210\u5bf9\u5f02\u6784\u8bed\u8a00\u7684\u652f\u6301\u3002 \u76ee\u524d\u63d0\u4f9b MySQL \u548c PostgreSQL \u7248\u672c\uff0c\u5b83\u53ef\u4ee5\u4f7f\u7528\u4efb\u4f55\u517c\u5bb9 MySQL/PostgreSQL \u534f\u8bae\u7684\u8bbf\u95ee\u5ba2\u6237\u7aef(\u5982\uff1aMySQL Command Client, MySQL Workbench, Navicat \u7b49)\u64cd\u4f5c\u6570\u636e\uff0c\u5bf9 DBA \u66f4\u52a0\u53cb\u597d\u3002</p> <ul> <li>\u5411\u5e94\u7528\u7a0b\u5e8f\u5b8c\u5168\u900f\u660e\uff0c\u53ef\u76f4\u63a5\u5f53\u505a MySQL/PostgreSQL \u4f7f\u7528\u3002</li> <li>\u9002\u7528\u4e8e\u4efb\u4f55\u517c\u5bb9 MySQL/PostgreSQL \u534f\u8bae\u7684\u7684\u5ba2\u6237\u7aef\u3002</li> </ul> <p></p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#shardingsphere-sidecartodo","title":"ShardingSphere-Sidecar(TODO)","text":"<p>\u5b9a\u4f4d\u4e3a Kubernetes \u7684\u4e91\u539f\u751f\u6570\u636e\u5e93\u4ee3\u7406\uff0c\u4ee5 Sidecar \u7684\u5f62\u5f0f\u4ee3\u7406\u6240\u6709\u5bf9\u6570\u636e\u5e93\u7684\u8bbf\u95ee\u3002 \u901a\u8fc7\u65e0\u4e2d\u5fc3\u3001\u96f6\u4fb5\u5165\u7684\u65b9\u6848\u63d0\u4f9b\u4e0e\u6570\u636e\u5e93\u4ea4\u4e92\u7684\u7684\u556e\u5408\u5c42\uff0c\u5373 <code>Database Mesh</code>\uff0c\u53c8\u53ef\u79f0\u6570\u636e\u5e93\u7f51\u683c\u3002</p> <p>Database Mesh \u7684\u5173\u6ce8\u91cd\u70b9\u5728\u4e8e\u5982\u4f55\u5c06\u5206\u5e03\u5f0f\u7684\u6570\u636e\u8bbf\u95ee\u5e94\u7528\u4e0e\u6570\u636e\u5e93\u6709\u673a\u4e32\u8054\u8d77\u6765\uff0c\u5b83\u66f4\u52a0\u5173\u6ce8\u7684\u662f\u4ea4\u4e92\uff0c\u662f\u5c06\u6742\u4e71\u65e0\u7ae0\u7684\u5e94\u7528\u4e0e\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u4ea4\u4e92\u8fdb\u884c\u6709\u6548\u5730\u68b3\u7406\u3002 \u4f7f\u7528 Database Mesh\uff0c\u8bbf\u95ee\u6570\u636e\u5e93\u7684\u5e94\u7528\u548c\u6570\u636e\u5e93\u7ec8\u5c06\u5f62\u6210\u4e00\u4e2a\u5de8\u5927\u7684\u7f51\u683c\u4f53\u7cfb\uff0c\u5e94\u7528\u548c\u6570\u636e\u5e93\u53ea\u9700\u5728\u7f51\u683c\u4f53\u7cfb\u4e2d\u5bf9\u53f7\u5165\u5ea7\u5373\u53ef\uff0c\u5b83\u4eec\u90fd\u662f\u88ab\u556e\u5408\u5c42\u6240\u6cbb\u7406\u7684\u5bf9\u8c61\u3002</p> <p></p> ShardingSphere-JDBC ShardingSphere-Proxy ShardingSphere-Sidecar \u6570\u636e\u5e93 \u4efb\u610f MySQL/PostgreSQL MySQL/PostgreSQL \u8fde\u63a5\u6d88\u8017\u6570 \u9ad8 \u4f4e \u9ad8 \u5f02\u6784\u8bed\u8a00 \u4ec5 Java \u4efb\u610f \u4efb\u610f \u6027\u80fd \u635f\u8017\u4f4e \u635f\u8017\u7565\u9ad8 \u635f\u8017\u4f4e \u65e0\u4e2d\u5fc3\u5316 \u662f \u5426 \u662f \u9759\u6001\u5165\u53e3 \u65e0 \u6709 \u65e0"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_2","title":"\u6df7\u5408\u67b6\u6784","text":"<p>ShardingSphere-JDBC \u91c7\u7528\u65e0\u4e2d\u5fc3\u5316\u67b6\u6784\uff0c\u9002\u7528\u4e8e Java \u5f00\u53d1\u7684\u9ad8\u6027\u80fd\u7684\u8f7b\u91cf\u7ea7 OLTP \u5e94\u7528\uff1bShardingSphere-Proxy \u63d0\u4f9b\u9759\u6001\u5165\u53e3\u4ee5\u53ca\u5f02\u6784\u8bed\u8a00\u7684\u652f\u6301\uff0c\u9002\u7528\u4e8e OLAP \u5e94\u7528\u4ee5\u53ca\u5bf9\u5206\u7247\u6570\u636e\u5e93\u8fdb\u884c\u7ba1\u7406\u548c\u8fd0\u7ef4\u7684\u573a\u666f\u3002</p> <p>Apache ShardingSphere \u662f\u591a\u63a5\u5165\u7aef\u5171\u540c\u7ec4\u6210\u7684\u751f\u6001\u5708\u3002 \u901a\u8fc7\u6df7\u5408\u4f7f\u7528 ShardingSphere-JDBC \u548c ShardingSphere-Proxy\uff0c\u5e76\u91c7\u7528\u540c\u4e00\u6ce8\u518c\u4e2d\u5fc3\u7edf\u4e00\u914d\u7f6e\u5206\u7247\u7b56\u7565\uff0c\u80fd\u591f\u7075\u6d3b\u7684\u642d\u5efa\u9002\u7528\u4e8e\u5404\u79cd\u573a\u666f\u7684\u5e94\u7528\u7cfb\u7edf\uff0c\u4f7f\u5f97\u67b6\u6784\u5e08\u66f4\u52a0\u81ea\u7531\u5730\u8c03\u6574\u9002\u5408\u4e0e\u5f53\u524d\u4e1a\u52a1\u7684\u6700\u4f73\u7cfb\u7edf\u67b6\u6784\u3002</p> <p></p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_3","title":"\u529f\u80fd\u5217\u8868","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_4","title":"\u6570\u636e\u5206\u7247","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_5","title":"\u80cc\u666f","text":"<p>\u4f20\u7edf\u7684\u5c06\u6570\u636e\u96c6\u4e2d\u5b58\u50a8\u81f3\u5355\u4e00\u6570\u636e\u8282\u70b9\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u5728\u6027\u80fd\u3001\u53ef\u7528\u6027\u548c\u8fd0\u7ef4\u6210\u672c\u8fd9\u4e09\u65b9\u9762\u5df2\u7ecf\u96be\u4e8e\u6ee1\u8db3\u4e92\u8054\u7f51\u7684\u6d77\u91cf\u6570\u636e\u573a\u666f\u3002</p> <p>\u4ece\u6027\u80fd\u65b9\u9762\u6765\u8bf4\uff0c\u7531\u4e8e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u5927\u591a\u91c7\u7528 B+ \u6811\u7c7b\u578b\u7684\u7d22\u5f15\uff0c\u5728\u6570\u636e\u91cf\u8d85\u8fc7\u9608\u503c\u7684\u60c5\u51b5\u4e0b\uff0c\u7d22\u5f15\u6df1\u5ea6\u7684\u589e\u52a0\u4e5f\u5c06\u4f7f\u5f97\u78c1\u76d8\u8bbf\u95ee\u7684 IO \u6b21\u6570\u589e\u52a0\uff0c\u8fdb\u800c\u5bfc\u81f4\u67e5\u8be2\u6027\u80fd\u7684\u4e0b\u964d\uff1b\u540c\u65f6\uff0c\u9ad8\u5e76\u53d1\u8bbf\u95ee\u8bf7\u6c42\u4e5f\u4f7f\u5f97\u96c6\u4e2d\u5f0f\u6570\u636e\u5e93\u6210\u4e3a\u7cfb\u7edf\u7684\u6700\u5927\u74f6\u9888\u3002</p> <p>\u4ece\u53ef\u7528\u6027\u7684\u65b9\u9762\u6765\u8bb2\uff0c\u670d\u52a1\u5316\u7684\u65e0\u72b6\u6001\u578b\uff0c\u80fd\u591f\u8fbe\u5230\u8f83\u5c0f\u6210\u672c\u7684\u968f\u610f\u6269\u5bb9\uff0c\u8fd9\u5fc5\u7136\u5bfc\u81f4\u7cfb\u7edf\u7684\u6700\u7ec8\u538b\u529b\u90fd\u843d\u5728\u6570\u636e\u5e93\u4e4b\u4e0a\u3002\u800c\u5355\u4e00\u7684\u6570\u636e\u8282\u70b9\uff0c\u6216\u8005\u7b80\u5355\u7684\u4e3b\u4ece\u67b6\u6784\uff0c\u5df2\u7ecf\u8d8a\u6765\u8d8a\u96be\u4ee5\u627f\u62c5\u3002\u6570\u636e\u5e93\u7684\u53ef\u7528\u6027\uff0c\u5df2\u6210\u4e3a\u6574\u4e2a\u7cfb\u7edf\u7684\u5173\u952e\u3002</p> <p>\u4ece\u8fd0\u7ef4\u6210\u672c\u65b9\u9762\u8003\u8651\uff0c\u5f53\u4e00\u4e2a\u6570\u636e\u5e93\u5b9e\u4f8b\u4e2d\u7684\u6570\u636e\u8fbe\u5230\u9608\u503c\u4ee5\u4e0a\uff0c\u5bf9\u4e8e DBA \u7684\u8fd0\u7ef4\u538b\u529b\u5c31\u4f1a\u589e\u5927\u3002\u6570\u636e\u5907\u4efd\u548c\u6062\u590d\u7684\u65f6\u95f4\u6210\u672c\u90fd\u5c06\u968f\u7740\u6570\u636e\u91cf\u7684\u5927\u5c0f\u800c\u6108\u53d1\u4e0d\u53ef\u63a7\u3002\u4e00\u822c\u6765\u8bb2\uff0c\u5355\u4e00\u6570\u636e\u5e93\u5b9e\u4f8b\u7684\u6570\u636e\u7684\u9608\u503c\u5728 1TB \u4e4b\u5185\uff0c\u662f\u6bd4\u8f83\u5408\u7406\u7684\u8303\u56f4\u3002</p> <p>\u5728\u4f20\u7edf\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u65e0\u6cd5\u6ee1\u8db3\u4e92\u8054\u7f51\u573a\u666f\u9700\u8981\u7684\u60c5\u51b5\u4e0b\uff0c\u5c06\u6570\u636e\u5b58\u50a8\u81f3\u539f\u751f\u652f\u6301\u5206\u5e03\u5f0f\u7684 NoSQL \u7684\u5c1d\u8bd5\u8d8a\u6765\u8d8a\u591a\u3002 \u4f46 NoSQL \u5bf9 SQL \u7684\u4e0d\u517c\u5bb9\u6027\u4ee5\u53ca\u751f\u6001\u5708\u7684\u4e0d\u5b8c\u5584\uff0c\u4f7f\u5f97\u5b83\u4eec\u5728\u4e0e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u535a\u5f08\u4e2d\u59cb\u7ec8\u65e0\u6cd5\u5b8c\u6210\u81f4\u547d\u4e00\u51fb\uff0c\u800c\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7684\u5730\u4f4d\u5374\u4f9d\u7136\u4e0d\u53ef\u64bc\u52a8\u3002</p> <p>\u6570\u636e\u5206\u7247\u6307\u6309\u7167\u67d0\u4e2a\u7ef4\u5ea6\u5c06\u5b58\u653e\u5728\u5355\u4e00\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u5206\u6563\u5730\u5b58\u653e\u81f3\u591a\u4e2a\u6570\u636e\u5e93\u6216\u8868\u4e2d\u4ee5\u8fbe\u5230\u63d0\u5347\u6027\u80fd\u74f6\u9888\u4ee5\u53ca\u53ef\u7528\u6027\u7684\u6548\u679c\u3002 \u6570\u636e\u5206\u7247\u7684\u6709\u6548\u624b\u6bb5\u662f\u5bf9\u5173\u7cfb\u578b\u6570\u636e\u5e93\u8fdb\u884c\u5206\u5e93\u548c\u5206\u8868\u3002\u5206\u5e93\u548c\u5206\u8868\u5747\u53ef\u4ee5\u6709\u6548\u7684\u907f\u514d\u7531\u6570\u636e\u91cf\u8d85\u8fc7\u53ef\u627f\u53d7\u9608\u503c\u800c\u4ea7\u751f\u7684\u67e5\u8be2\u74f6\u9888\u3002 \u9664\u6b64\u4e4b\u5916\uff0c\u5206\u5e93\u8fd8\u80fd\u591f\u7528\u4e8e\u6709\u6548\u7684\u5206\u6563\u5bf9\u6570\u636e\u5e93\u5355\u70b9\u7684\u8bbf\u95ee\u91cf\uff1b\u5206\u8868\u867d\u7136\u65e0\u6cd5\u7f13\u89e3\u6570\u636e\u5e93\u538b\u529b\uff0c\u4f46\u5374\u80fd\u591f\u63d0\u4f9b\u5c3d\u91cf\u5c06\u5206\u5e03\u5f0f\u4e8b\u52a1\u8f6c\u5316\u4e3a\u672c\u5730\u4e8b\u52a1\u7684\u53ef\u80fd\uff0c\u4e00\u65e6\u6d89\u53ca\u5230\u8de8\u5e93\u7684\u66f4\u65b0\u64cd\u4f5c\uff0c\u5206\u5e03\u5f0f\u4e8b\u52a1\u5f80\u5f80\u4f1a\u4f7f\u95ee\u9898\u53d8\u5f97\u590d\u6742\u3002 \u4f7f\u7528\u591a\u4e3b\u591a\u4ece\u7684\u5206\u7247\u65b9\u5f0f\uff0c\u53ef\u4ee5\u6709\u6548\u7684\u907f\u514d\u6570\u636e\u5355\u70b9\uff0c\u4ece\u800c\u63d0\u5347\u6570\u636e\u67b6\u6784\u7684\u53ef\u7528\u6027\u3002</p> <p>\u901a\u8fc7\u5206\u5e93\u548c\u5206\u8868\u8fdb\u884c\u6570\u636e\u7684\u62c6\u5206\u6765\u4f7f\u5f97\u5404\u4e2a\u8868\u7684\u6570\u636e\u91cf\u4fdd\u6301\u5728\u9608\u503c\u4ee5\u4e0b\uff0c\u4ee5\u53ca\u5bf9\u6d41\u91cf\u8fdb\u884c\u758f\u5bfc\u5e94\u5bf9\u9ad8\u8bbf\u95ee\u91cf\uff0c\u662f\u5e94\u5bf9\u9ad8\u5e76\u53d1\u548c\u6d77\u91cf\u6570\u636e\u7cfb\u7edf\u7684\u6709\u6548\u624b\u6bb5\u3002 \u6570\u636e\u5206\u7247\u7684\u62c6\u5206\u65b9\u5f0f\u53c8\u5206\u4e3a\u5782\u76f4\u5206\u7247\u548c\u6c34\u5e73\u5206\u7247\u3002</p> <p>\u5782\u76f4\u5206\u7247</p> <p>\u6309\u7167\u4e1a\u52a1\u62c6\u5206\u7684\u65b9\u5f0f\u79f0\u4e3a\u5782\u76f4\u5206\u7247\uff0c\u53c8\u79f0\u4e3a\u7eb5\u5411\u62c6\u5206\uff0c\u5b83\u7684\u6838\u5fc3\u7406\u5ff5\u662f\u4e13\u5e93\u4e13\u7528\u3002 \u5728\u62c6\u5206\u4e4b\u524d\uff0c\u4e00\u4e2a\u6570\u636e\u5e93\u7531\u591a\u4e2a\u6570\u636e\u8868\u6784\u6210\uff0c\u6bcf\u4e2a\u8868\u5bf9\u5e94\u7740\u4e0d\u540c\u7684\u4e1a\u52a1\u3002\u800c\u62c6\u5206\u4e4b\u540e\uff0c\u5219\u662f\u6309\u7167\u4e1a\u52a1\u5c06\u8868\u8fdb\u884c\u5f52\u7c7b\uff0c\u5206\u5e03\u5230\u4e0d\u540c\u7684\u6570\u636e\u5e93\u4e2d\uff0c\u4ece\u800c\u5c06\u538b\u529b\u5206\u6563\u81f3\u4e0d\u540c\u7684\u6570\u636e\u5e93\u3002 \u4e0b\u56fe\u5c55\u793a\u4e86\u6839\u636e\u4e1a\u52a1\u9700\u8981\uff0c\u5c06\u7528\u6237\u8868\u548c\u8ba2\u5355\u8868\u5782\u76f4\u5206\u7247\u5230\u4e0d\u540c\u7684\u6570\u636e\u5e93\u7684\u65b9\u6848\u3002</p> <p></p> <p>\u6c34\u5e73\u5206\u7247</p> <p>\u6c34\u5e73\u5206\u7247\u53c8\u79f0\u4e3a\u6a2a\u5411\u62c6\u5206\u3002 \u76f8\u5bf9\u4e8e\u5782\u76f4\u5206\u7247\uff0c\u5b83\u4e0d\u518d\u5c06\u6570\u636e\u6839\u636e\u4e1a\u52a1\u903b\u8f91\u5206\u7c7b\uff0c\u800c\u662f\u901a\u8fc7\u67d0\u4e2a\u5b57\u6bb5\uff08\u6216\u67d0\u51e0\u4e2a\u5b57\u6bb5\uff09\uff0c\u6839\u636e\u67d0\u79cd\u89c4\u5219\u5c06\u6570\u636e\u5206\u6563\u81f3\u591a\u4e2a\u5e93\u6216\u8868\u4e2d\uff0c\u6bcf\u4e2a\u5206\u7247\u4ec5\u5305\u542b\u6570\u636e\u7684\u4e00\u90e8\u5206\u3002 \u4f8b\u5982\uff1a\u6839\u636e\u4e3b\u952e\u5206\u7247\uff0c\u5076\u6570\u4e3b\u952e\u7684\u8bb0\u5f55\u653e\u5165 0 \u5e93\uff08\u6216\u8868\uff09\uff0c\u5947\u6570\u4e3b\u952e\u7684\u8bb0\u5f55\u653e\u5165 1 \u5e93\uff08\u6216\u8868\uff09\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002</p> <p></p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_6","title":"\u5206\u7247\u67b6\u6784","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_7","title":"\u6570\u636e\u5206\u7247","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_8","title":"\u6838\u5fc3\u6982\u5ff5","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#sql","title":"SQL","text":"<p>\u903b\u8f91\u8868</p> <p>\u6c34\u5e73\u62c6\u5206\u7684\u6570\u636e\u5e93\uff08\u8868\uff09\u7684\u76f8\u540c\u903b\u8f91\u548c\u6570\u636e\u7ed3\u6784\u8868\u7684\u603b\u79f0\u3002\u4f8b\uff1a\u8ba2\u5355\u6570\u636e\u6839\u636e\u4e3b\u952e\u5c3e\u6570\u62c6\u5206\u4e3a 10 \u5f20\u8868\uff0c\u5206\u522b\u662f <code>t_order_0</code> \u5230 <code>t_order_9</code>\uff0c\u4ed6\u4eec\u7684\u903b\u8f91\u8868\u540d\u4e3a <code>t_order</code>\u3002</p> <p>\u771f\u5b9e\u8868</p> <p>\u5728\u5206\u7247\u7684\u6570\u636e\u5e93\u4e2d\u771f\u5b9e\u5b58\u5728\u7684\u7269\u7406\u8868\u3002\u5373\u4e0a\u4e2a\u793a\u4f8b\u4e2d\u7684 <code>t_order_0</code> \u5230 <code>t_order_9</code></p> <p>\u6570\u636e\u8282\u70b9</p> <p>\u6570\u636e\u5206\u7247\u7684\u6700\u5c0f\u5355\u5143\u3002\u7531\u6570\u636e\u6e90\u540d\u79f0\u548c\u6570\u636e\u8868\u7ec4\u6210\uff0c\u4f8b\uff1a<code>ds_0.t_order_0</code></p> <p>\u7ed1\u5b9a\u8868</p> <p>\u6307\u5206\u7247\u89c4\u5219\u4e00\u81f4\u7684\u4e3b\u8868\u548c\u5b50\u8868\u3002\u4f8b\u5982\uff1a<code>t_order</code> \u8868\u548c <code>t_order_item</code> \u8868\uff0c\u5747\u6309\u7167 <code>order_id</code> \u5206\u7247\uff0c\u5219\u6b64\u4e24\u5f20\u8868\u4e92\u4e3a\u7ed1\u5b9a\u8868\u5173\u7cfb\u3002\u7ed1\u5b9a\u8868\u4e4b\u95f4\u7684\u591a\u8868\u5173\u8054\u67e5\u8be2\u4e0d\u4f1a\u51fa\u73b0\u7b1b\u5361\u5c14\u79ef\u5173\u8054\uff0c\u5173\u8054\u67e5\u8be2\u6548\u7387\u5c06\u5927\u5927\u63d0\u5347\u3002\u4e3e\u4f8b\u8bf4\u660e\uff0c\u5982\u679c SQL \u4e3a\uff1a</p> <pre><code>SELECT i.*\nFROM t_order o\n         JOIN t_order_item i ON o.order_id = i.order_id\nWHERE o.order_id in (10, 11);\n</code></pre> <p>\u5728\u4e0d\u914d\u7f6e\u7ed1\u5b9a\u8868\u5173\u7cfb\u65f6\uff0c\u5047\u8bbe\u5206\u7247\u952e <code>order_id</code> \u5c06\u6570\u503c 10 \u8def\u7531\u81f3\u7b2c 0 \u7247\uff0c\u5c06\u6570\u503c 11 \u8def\u7531\u81f3\u7b2c 1 \u7247\uff0c\u90a3\u4e48\u8def\u7531\u540e\u7684 SQL \u5e94\u8be5\u4e3a 4 \u6761\uff0c\u5b83\u4eec\u5448\u73b0\u4e3a\u7b1b\u5361\u5c14\u79ef:</p> <pre><code>SELECT i.*\nFROM t_order_0 o\n         JOIN t_order_item_0 i ON o.order_id = i.order_id\nWHERE o.order_id in (10, 11);\nSELECT i.*\nFROM t_order_0 o\n         JOIN t_order_item_1 i ON o.order_id = i.order_id\nWHERE o.order_id in (10, 11);\nSELECT i.*\nFROM t_order_1 o\n         JOIN t_order_item_0 i ON o.order_id = i.order_id\nWHERE o.order_id in (10, 11);\nSELECT i.*\nFROM t_order_1 o\n         JOIN t_order_item_1 i ON o.order_id = i.order_id\nWHERE o.order_id in (10, 11);\n</code></pre> <p>\u5728\u914d\u7f6e\u7ed1\u5b9a\u8868\u5173\u7cfb\u540e\uff0c\u8def\u7531\u7684 SQL \u5e94\u8be5\u4e3a 2 \u6761\uff1a</p> <pre><code>SELECT i.*\nFROM t_order_0 o\n         JOIN t_order_item_0 i ON o.order_id = i.order_id\nWHERE o.order_id in (10, 11);\nSELECT i.*\nFROM t_order_1 o\n         JOIN t_order_item_1 i ON o.order_id = i.order_id\nWHERE o.order_id in (10, 11);\n</code></pre> <p>\u5176\u4e2d <code>t_order</code> \u5728 FROM \u7684\u6700\u5de6\u4fa7\uff0cShardingSphere \u5c06\u4f1a\u4ee5\u5b83\u4f5c\u4e3a\u6574\u4e2a\u7ed1\u5b9a\u8868\u7684\u4e3b\u8868\u3002 \u6240\u6709\u8def\u7531\u8ba1\u7b97\u5c06\u4f1a\u53ea\u4f7f\u7528\u4e3b\u8868\u7684\u7b56\u7565\uff0c\u90a3\u4e48 <code>t_order_item</code> \u8868\u7684\u5206\u7247\u8ba1\u7b97\u5c06\u4f1a\u4f7f\u7528 <code>t_order</code> \u7684\u6761\u4ef6\u3002\u6545\u7ed1\u5b9a\u8868\u4e4b\u95f4\u7684\u5206\u533a\u952e\u8981\u5b8c\u5168\u76f8\u540c\u3002</p> <p>\u5e7f\u64ad\u8868</p> <p>\u6307\u6240\u6709\u7684\u5206\u7247\u6570\u636e\u6e90\u4e2d\u90fd\u5b58\u5728\u7684\u8868\uff0c\u8868\u7ed3\u6784\u548c\u8868\u4e2d\u7684\u6570\u636e\u5728\u6bcf\u4e2a\u6570\u636e\u5e93\u4e2d\u5747\u5b8c\u5168\u4e00\u81f4\u3002\u9002\u7528\u4e8e\u6570\u636e\u91cf\u4e0d\u5927\u4e14\u9700\u8981\u4e0e\u6d77\u91cf\u6570\u636e\u7684\u8868\u8fdb\u884c\u5173\u8054\u67e5\u8be2\u7684\u573a\u666f\uff0c\u4f8b\u5982\uff1a\u5b57\u5178\u8868\u3002</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_9","title":"\u5206\u7247","text":"<p>\u5206\u7247\u952e</p> <p>\u7528\u4e8e\u5206\u7247\u7684\u6570\u636e\u5e93\u5b57\u6bb5\uff0c\u662f\u5c06\u6570\u636e\u5e93\uff08\u8868\uff09\u6c34\u5e73\u62c6\u5206\u7684\u5173\u952e\u5b57\u6bb5\u3002\u4f8b\uff1a\u5c06\u8ba2\u5355\u8868\u4e2d\u7684\u8ba2\u5355\u4e3b\u952e\u7684\u5c3e\u6570\u53d6\u6a21\u5206\u7247\uff0c\u5219\u8ba2\u5355\u4e3b\u952e\u4e3a\u5206\u7247\u5b57\u6bb5\u3002 SQL \u4e2d\u5982\u679c\u65e0\u5206\u7247\u5b57\u6bb5\uff0c\u5c06\u6267\u884c\u5168\u8def\u7531\uff0c\u6027\u80fd\u8f83\u5dee\u3002 \u9664\u4e86\u5bf9\u5355\u5206\u7247\u5b57\u6bb5\u7684\u652f\u6301\uff0cApache ShardingSphere \u4e5f\u652f\u6301\u6839\u636e\u591a\u4e2a\u5b57\u6bb5\u8fdb\u884c\u5206\u7247\u3002</p> <p>\u5206\u7247\u7b97\u6cd5</p> <p>\u901a\u8fc7\u5206\u7247\u7b97\u6cd5\u5c06\u6570\u636e\u5206\u7247\uff0c\u652f\u6301\u901a\u8fc7 <code>=</code>\u3001<code>&gt;=</code>\u3001<code>&lt;=</code>\u3001<code>&gt;</code>\u3001<code>&lt;</code>\u3001<code>BETWEEN</code> \u548c <code>IN</code> \u5206\u7247\u3002 \u5206\u7247\u7b97\u6cd5\u9700\u8981\u5e94\u7528\u65b9\u5f00\u53d1\u8005\u81ea\u884c\u5b9e\u73b0\uff0c\u53ef\u5b9e\u73b0\u7684\u7075\u6d3b\u5ea6\u975e\u5e38\u9ad8\u3002</p> <p>\u76ee\u524d\u63d0\u4f9b4\u79cd\u5206\u7247\u7b97\u6cd5\u3002 \u7531\u4e8e\u5206\u7247\u7b97\u6cd5\u548c\u4e1a\u52a1\u5b9e\u73b0\u7d27\u5bc6\u76f8\u5173\uff0c\u56e0\u6b64\u5e76\u672a\u63d0\u4f9b\u5185\u7f6e\u5206\u7247\u7b97\u6cd5\uff0c\u800c\u662f\u901a\u8fc7\u5206\u7247\u7b56\u7565\u5c06\u5404\u79cd\u573a\u666f\u63d0\u70bc\u51fa\u6765\uff0c\u63d0\u4f9b\u66f4\u9ad8\u5c42\u7ea7\u7684\u62bd\u8c61\uff0c\u5e76\u63d0\u4f9b\u63a5\u53e3\u8ba9\u5e94\u7528\u5f00\u53d1\u8005\u81ea\u884c\u5b9e\u73b0\u5206\u7247\u7b97\u6cd5\u3002</p> <ul> <li>\u6807\u51c6\u5206\u7247\u7b97\u6cd5</li> </ul> <p>\u5bf9\u5e94 StandardShardingAlgorithm\uff0c\u7528\u4e8e\u5904\u7406\u4f7f\u7528\u5355\u4e00\u952e\u4f5c\u4e3a\u5206\u7247\u952e\u7684 <code>=</code>\u3001<code>IN</code>\u3001<code>BETWEEN AND</code>\u3001<code>&gt;</code>\u3001<code>&lt;</code>\u3001<code>&gt;=</code>\u3001<code>&lt;=</code>\u8fdb\u884c\u5206\u7247\u7684\u573a\u666f\u3002\u9700\u8981\u914d\u5408 StandardShardingStrategy \u4f7f\u7528\u3002</p> <ul> <li>\u590d\u5408\u5206\u7247\u7b97\u6cd5</li> </ul> <p>\u5bf9\u5e94 ComplexKeysShardingAlgorithm\uff0c\u7528\u4e8e\u5904\u7406\u4f7f\u7528\u591a\u952e\u4f5c\u4e3a\u5206\u7247\u952e\u8fdb\u884c\u5206\u7247\u7684\u573a\u666f\uff0c\u5305\u542b\u591a\u4e2a\u5206\u7247\u952e\u7684\u903b\u8f91\u8f83\u590d\u6742\uff0c\u9700\u8981\u5e94\u7528\u5f00\u53d1\u8005\u81ea\u884c\u5904\u7406\u5176\u4e2d\u7684\u590d\u6742\u5ea6\u3002\u9700\u8981\u914d\u5408 ComplexShardingStrategy \u4f7f\u7528\u3002</p> <ul> <li>Hint\u5206\u7247\u7b97\u6cd5</li> </ul> <p>\u5bf9\u5e94 HintShardingAlgorithm\uff0c\u7528\u4e8e\u5904\u7406\u4f7f\u7528 <code>Hint</code> \u884c\u5206\u7247\u7684\u573a\u666f\u3002\u9700\u8981\u914d\u5408 HintShardingStrategy \u4f7f\u7528\u3002</p> <p>\u5206\u7247\u7b56\u7565</p> <p>\u5305\u542b\u5206\u7247\u952e\u548c\u5206\u7247\u7b97\u6cd5\uff0c\u7531\u4e8e\u5206\u7247\u7b97\u6cd5\u7684\u72ec\u7acb\u6027\uff0c\u5c06\u5176\u72ec\u7acb\u62bd\u79bb\u3002\u771f\u6b63\u53ef\u7528\u4e8e\u5206\u7247\u64cd\u4f5c\u7684\u662f\u5206\u7247\u952e + \u5206\u7247\u7b97\u6cd5\uff0c\u4e5f\u5c31\u662f\u5206\u7247\u7b56\u7565\u3002\u76ee\u524d\u63d0\u4f9b 5 \u79cd\u5206\u7247\u7b56\u7565\u3002</p> <ul> <li>\u6807\u51c6\u5206\u7247\u7b56\u7565</li> </ul> <p>\u5bf9\u5e94 StandardShardingStrategy\u3002\u63d0\u4f9b\u5bf9 SQ L\u8bed\u53e5\u4e2d\u7684 <code>=</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>IN</code> \u548c <code>BETWEEN AND</code> \u7684\u5206\u7247\u64cd\u4f5c\u652f\u6301\u3002 StandardShardingStrategy \u53ea\u652f\u6301\u5355\u5206\u7247\u952e\uff0c\u63d0\u4f9b PreciseShardingAlgorithm \u548c RangeShardingAlgorithm \u4e24\u4e2a\u5206\u7247\u7b97\u6cd5\u3002 PreciseShardingAlgorithm \u662f\u5fc5\u9009\u7684\uff0c\u7528\u4e8e\u5904\u7406 <code>=</code> \u548c <code>IN</code> \u7684\u5206\u7247\u3002 RangeShardingAlgorithm \u662f\u53ef\u9009\u7684\uff0c\u7528\u4e8e\u5904\u7406 <code>BETWEEN AND</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>\u5206\u7247\uff0c\u5982\u679c\u4e0d\u914d\u7f6e RangeShardingAlgorithm\uff0cSQL \u4e2d\u7684 <code>BETWEEN AND</code> \u5c06\u6309\u7167\u5168\u5e93\u8def\u7531\u5904\u7406\u3002</p> <ul> <li>\u590d\u5408\u5206\u7247\u7b56\u7565</li> </ul> <p>\u5bf9\u5e94 ComplexShardingStrategy\u3002\u590d\u5408\u5206\u7247\u7b56\u7565\u3002\u63d0\u4f9b\u5bf9 SQL \u8bed\u53e5\u4e2d\u7684 <code>=</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>IN</code> \u548c <code>BETWEEN AND</code> \u7684\u5206\u7247\u64cd\u4f5c\u652f\u6301\u3002 ComplexShardingStrategy \u652f\u6301\u591a\u5206\u7247\u952e\uff0c\u7531\u4e8e\u591a\u5206\u7247\u952e\u4e4b\u95f4\u7684\u5173\u7cfb\u590d\u6742\uff0c\u56e0\u6b64\u5e76\u672a\u8fdb\u884c\u8fc7\u591a\u7684\u5c01\u88c5\uff0c\u800c\u662f\u76f4\u63a5\u5c06\u5206\u7247\u952e\u503c\u7ec4\u5408\u4ee5\u53ca\u5206\u7247\u64cd\u4f5c\u7b26\u900f\u4f20\u81f3\u5206\u7247\u7b97\u6cd5\uff0c\u5b8c\u5168\u7531\u5e94\u7528\u5f00\u53d1\u8005\u5b9e\u73b0\uff0c\u63d0\u4f9b\u6700\u5927\u7684\u7075\u6d3b\u5ea6\u3002</p> <ul> <li>Hint\u5206\u7247\u7b56\u7565</li> </ul> <p>\u5bf9\u5e94 HintShardingStrategy\u3002\u901a\u8fc7 Hint \u6307\u5b9a\u5206\u7247\u503c\u800c\u975e\u4ece SQL \u4e2d\u63d0\u53d6\u5206\u7247\u503c\u7684\u65b9\u5f0f\u8fdb\u884c\u5206\u7247\u7684\u7b56\u7565\u3002</p> <ul> <li>\u4e0d\u5206\u7247\u7b56\u7565</li> </ul> <p>\u5bf9\u5e94 NoneShardingStrategy\u3002\u4e0d\u5206\u7247\u7684\u7b56\u7565\u3002</p> <p>SQLHint</p> <p>\u5bf9\u4e8e\u5206\u7247\u5b57\u6bb5\u975e SQL \u51b3\u5b9a\uff0c\u800c\u7531\u5176\u4ed6\u5916\u7f6e\u6761\u4ef6\u51b3\u5b9a\u7684\u573a\u666f\uff0c\u53ef\u4f7f\u7528 SQL Hint \u7075\u6d3b\u7684\u6ce8\u5165\u5206\u7247\u5b57\u6bb5\u3002 \u4f8b\uff1a\u5185\u90e8\u7cfb\u7edf\uff0c\u6309\u7167\u5458\u5de5\u767b\u5f55\u4e3b\u952e\u5206\u5e93\uff0c\u800c\u6570\u636e\u5e93\u4e2d\u5e76\u65e0\u6b64\u5b57\u6bb5\u3002SQL Hint \u652f\u6301\u901a\u8fc7 Java API \u548c SQL \u6ce8\u91ca\uff08\u5f85\u5b9e\u73b0\uff09\u4e24\u79cd\u65b9\u5f0f\u4f7f\u7528\u3002 \u8be6\u60c5\u8bf7\u53c2\u89c1\u5f3a\u5236\u5206\u7247\u8def\u7531</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_10","title":"\u914d\u7f6e","text":"<p>\u5206\u7247\u89c4\u5219</p> <p>\u5206\u7247\u89c4\u5219\u914d\u7f6e\u7684\u603b\u5165\u53e3\u3002\u5305\u542b\u6570\u636e\u6e90\u914d\u7f6e\u3001\u8868\u914d\u7f6e\u3001\u7ed1\u5b9a\u8868\u914d\u7f6e\u4ee5\u53ca\u8bfb\u5199\u5206\u79bb\u914d\u7f6e\u7b49\u3002</p> <p>\u6570\u636e\u6e90\u914d\u7f6e</p> <p>\u771f\u5b9e\u6570\u636e\u6e90\u5217\u8868\u3002</p> <p>\u8868\u914d\u7f6e</p> <p>\u903b\u8f91\u8868\u540d\u79f0\u3001\u6570\u636e\u8282\u70b9\u4e0e\u5206\u8868\u89c4\u5219\u7684\u914d\u7f6e\u3002</p> <p>\u6570\u636e\u8282\u70b9\u914d\u7f6e</p> <p>\u7528\u4e8e\u914d\u7f6e\u903b\u8f91\u8868\u4e0e\u771f\u5b9e\u8868\u7684\u6620\u5c04\u5173\u7cfb\u3002\u53ef\u5206\u4e3a\u5747\u5300\u5206\u5e03\u548c\u81ea\u5b9a\u4e49\u5206\u5e03\u4e24\u79cd\u5f62\u5f0f\u3002</p> <ul> <li>\u5747\u5300\u5206\u5e03</li> </ul> <p>\u6307\u6570\u636e\u8868\u5728\u6bcf\u4e2a\u6570\u636e\u6e90\u5185\u5448\u73b0\u5747\u5300\u5206\u5e03\u7684\u6001\u52bf\uff0c\u4f8b\u5982\uff1a</p> <pre><code>db0\n  \u251c\u2500\u2500 t_order0 \n  \u2514\u2500\u2500 t_order1 \ndb1\n  \u251c\u2500\u2500 t_order0 \n  \u2514\u2500\u2500 t_order1\n</code></pre> <p>\u90a3\u4e48\u6570\u636e\u8282\u70b9\u914d\u7f6e\u5982\u4e0b\uff1a</p> <pre><code>db0.t_order0, db0.t_order1, db1.t_order0, db1.t_order1\n</code></pre> <ul> <li>\u81ea\u5b9a\u4e49\u5206\u5e03</li> </ul> <p>\u6307\u6570\u636e\u8868\u5448\u73b0\u6709\u7279\u5b9a\u89c4\u5219\u7684\u5206\u5e03\uff0c\u4f8b\u5982\uff1a</p> <pre><code>db0\n  \u251c\u2500\u2500 t_order0 \n  \u2514\u2500\u2500 t_order1 \ndb1\n  \u251c\u2500\u2500 t_order2\n  \u251c\u2500\u2500 t_order3\n  \u2514\u2500\u2500 t_order4\n</code></pre> <p>\u90a3\u4e48\u6570\u636e\u8282\u70b9\u7684\u914d\u7f6e\u5982\u4e0b\uff1a</p> <pre><code>db0.t_order0, db0.t_order1, db1.t_order2, db1.t_order3, db1.t_order4\n</code></pre> <p>\u5206\u7247\u7b56\u7565\u914d\u7f6e</p> <p>\u5bf9\u4e8e\u5206\u7247\u7b56\u7565\u5b58\u6709\u6570\u636e\u6e90\u5206\u7247\u7b56\u7565\u548c\u8868\u5206\u7247\u7b56\u7565\u4e24\u79cd\u7ef4\u5ea6\u3002</p> <ul> <li>\u6570\u636e\u6e90\u5206\u7247\u7b56\u7565</li> </ul> <p>\u5bf9\u5e94\u4e8e DatabaseShardingStrategy\u3002\u7528\u4e8e\u914d\u7f6e\u6570\u636e\u88ab\u5206\u914d\u7684\u76ee\u6807\u6570\u636e\u6e90\u3002</p> <ul> <li>\u8868\u5206\u7247\u7b56\u7565</li> </ul> <p>\u5bf9\u5e94\u4e8e TableShardingStrategy\u3002\u7528\u4e8e\u914d\u7f6e\u6570\u636e\u88ab\u5206\u914d\u7684\u76ee\u6807\u8868\uff0c\u8be5\u76ee\u6807\u8868\u5b58\u5728\u4e0e\u8be5\u6570\u636e\u7684\u76ee\u6807\u6570\u636e\u6e90\u5185\u3002\u6545\u8868\u5206\u7247\u7b56\u7565\u662f\u4f9d\u8d56\u4e0e\u6570\u636e\u6e90\u5206\u7247\u7b56\u7565\u7684\u7ed3\u679c\u7684\u3002</p> <p>\u4e24\u79cd\u7b56\u7565\u7684 API \u5b8c\u5168\u76f8\u540c\u3002</p> <p>\u81ea\u589e\u4e3b\u952e\u751f\u6210\u7b56\u7565</p> <p>\u901a\u8fc7\u5728\u5ba2\u6237\u7aef\u751f\u6210\u81ea\u589e\u4e3b\u952e\u66ff\u6362\u4ee5\u6570\u636e\u5e93\u539f\u751f\u81ea\u589e\u4e3b\u952e\u7684\u65b9\u5f0f\uff0c\u505a\u5230\u5206\u5e03\u5f0f\u4e3b\u952e\u65e0\u91cd\u590d\u3002</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_11","title":"\u884c\u8868\u8fbe\u5f0f","text":"<p>\u8bed\u6cd5\u8bf4\u660e</p> <p>\u884c\u8868\u8fbe\u5f0f\u7684\u4f7f\u7528\u975e\u5e38\u76f4\u89c2\uff0c\u53ea\u9700\u8981\u5728\u914d\u7f6e\u4e2d\u4f7f\u7528 <code>${ expression }</code> \u6216 <code>$-&gt;{ expression }</code> \u6807\u8bc6\u884c\u8868\u8fbe\u5f0f\u5373\u53ef\u3002 \u76ee\u524d\u652f\u6301\u6570\u636e\u8282\u70b9\u548c\u5206\u7247\u7b97\u6cd5\u8fd9\u4e24\u4e2a\u90e8\u5206\u7684\u914d\u7f6e\u3002\u884c\u8868\u8fbe\u5f0f\u7684\u5185\u5bb9\u4f7f\u7528\u7684\u662f Groovy \u7684\u8bed\u6cd5\uff0cGroovy \u80fd\u591f\u652f\u6301\u7684\u6240\u6709\u64cd\u4f5c\uff0c\u884c\u8868\u8fbe\u5f0f\u5747\u80fd\u591f\u652f\u6301\u3002\u4f8b\u5982\uff1a</p> <p><code>${begin..end}</code> \u8868\u793a\u8303\u56f4\u533a\u95f4</p> <p><code>${[unit1, unit2, unit_x]}</code> \u8868\u793a\u679a\u4e3e\u503c</p> <p>\u884c\u8868\u8fbe\u5f0f\u4e2d\u5982\u679c\u51fa\u73b0\u8fde\u7eed\u591a\u4e2a <code>${ expression }</code> \u6216 <code>$-&gt;{ expression }</code> \u8868\u8fbe\u5f0f\uff0c\u6574\u4e2a\u8868\u8fbe\u5f0f\u6700\u7ec8\u7684\u7ed3\u679c\u5c06\u4f1a\u6839\u636e\u6bcf\u4e2a\u5b50\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u8fdb\u884c\u7b1b\u5361\u5c14\u7ec4\u5408\u3002</p> <p>\u4f8b\u5982\uff0c\u4ee5\u4e0b\u884c\u8868\u8fbe\u5f0f\uff1a</p> <pre><code>${['online', 'offline']}_table${1..3}\n</code></pre> <p>\u914d\u7f6e\u6570\u636e\u8282\u70b9</p> <p>\u5bf9\u4e8e\u5747\u5300\u5206\u5e03\u7684\u6570\u636e\u8282\u70b9\uff0c\u5982\u679c\u6570\u636e\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>db0\n  \u251c\u2500\u2500 t_order0 \n  \u2514\u2500\u2500 t_order1 \ndb1\n  \u251c\u2500\u2500 t_order0 \n  \u2514\u2500\u2500 t_order1\n</code></pre> <p>\u7528\u884c\u8868\u8fbe\u5f0f\u53ef\u4ee5\u7b80\u5316\u4e3a\uff1a</p> <pre><code>db${0..1}.t_order${0..1}\n</code></pre> <p>\u6216\u8005</p> <pre><code>db$-&gt;{0..1}.t_order$-&gt;{0..1}\n</code></pre> <p>\u5bf9\u4e8e\u81ea\u5b9a\u4e49\u7684\u6570\u636e\u8282\u70b9\uff0c\u5982\u679c\u6570\u636e\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>db0\n  \u251c\u2500\u2500 t_order0 \n  \u2514\u2500\u2500 t_order1 \ndb1\n  \u251c\u2500\u2500 t_order2\n  \u251c\u2500\u2500 t_order3\n  \u2514\u2500\u2500 t_order4\n</code></pre> <p>\u7528\u884c\u8868\u8fbe\u5f0f\u53ef\u4ee5\u7b80\u5316\u4e3a\uff1a</p> <pre><code>db0.t_order${0..1},db1.t_order${2..4}\n</code></pre> <p>\u6216\u8005</p> <pre><code>db0.t_order$-&gt;{0..1},db1.t_order$-&gt;{2..4}\n</code></pre> <p>\u5bf9\u4e8e\u6709\u524d\u7f00\u7684\u6570\u636e\u8282\u70b9\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u884c\u8868\u8fbe\u5f0f\u7075\u6d3b\u914d\u7f6e\uff0c\u5982\u679c\u6570\u636e\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>db0\n  \u251c\u2500\u2500 t_order_00\n  \u251c\u2500\u2500 t_order_01\n  \u251c\u2500\u2500 t_order_02\n  \u251c\u2500\u2500 t_order_03\n  \u251c\u2500\u2500 t_order_04\n  \u251c\u2500\u2500 t_order_05\n  \u251c\u2500\u2500 t_order_06\n  \u251c\u2500\u2500 t_order_07\n  \u251c\u2500\u2500 t_order_08\n  \u251c\u2500\u2500 t_order_09\n  \u251c\u2500\u2500 t_order_10\n  \u251c\u2500\u2500 t_order_11\n  \u251c\u2500\u2500 t_order_12\n  \u251c\u2500\u2500 t_order_13\n  \u251c\u2500\u2500 t_order_14\n  \u251c\u2500\u2500 t_order_15\n  \u251c\u2500\u2500 t_order_16\n  \u251c\u2500\u2500 t_order_17\n  \u251c\u2500\u2500 t_order_18\n  \u251c\u2500\u2500 t_order_19\n  \u2514\u2500\u2500 t_order_20\ndb1\n  \u251c\u2500\u2500 t_order_00\n  \u251c\u2500\u2500 t_order_01\n  \u251c\u2500\u2500 t_order_02\n  \u251c\u2500\u2500 t_order_03\n  \u251c\u2500\u2500 t_order_04\n  \u251c\u2500\u2500 t_order_05\n  \u251c\u2500\u2500 t_order_06\n  \u251c\u2500\u2500 t_order_07\n  \u251c\u2500\u2500 t_order_08\n  \u251c\u2500\u2500 t_order_09\n  \u251c\u2500\u2500 t_order_10\n  \u251c\u2500\u2500 t_order_11\n  \u251c\u2500\u2500 t_order_12\n  \u251c\u2500\u2500 t_order_13\n  \u251c\u2500\u2500 t_order_14\n  \u251c\u2500\u2500 t_order_15\n  \u251c\u2500\u2500 t_order_16\n  \u251c\u2500\u2500 t_order_17\n  \u251c\u2500\u2500 t_order_18\n  \u251c\u2500\u2500 t_order_19\n  \u2514\u2500\u2500 t_order_20\n</code></pre> <p>\u53ef\u4ee5\u4f7f\u7528\u5206\u5f00\u914d\u7f6e\u7684\u65b9\u5f0f\uff0c\u5148\u914d\u7f6e\u5305\u542b\u524d\u7f00\u7684\u6570\u636e\u8282\u70b9\uff0c\u518d\u914d\u7f6e\u4e0d\u542b\u524d\u7f00\u7684\u6570\u636e\u8282\u70b9\uff0c\u518d\u5229\u7528\u884c\u8868\u8fbe\u5f0f\u7b1b\u5361\u5c14\u79ef\u7684\u7279\u6027\uff0c\u81ea\u52a8\u7ec4\u5408\u5373\u53ef\u3002 \u4e0a\u9762\u7684\u793a\u4f8b\uff0c\u7528\u884c\u8868\u8fbe\u5f0f\u53ef\u4ee5\u7b80\u5316\u4e3a\uff1a</p> <pre><code>db${0..1}.t_order_0${0..9}, db${0..1}.t_order_${10..20}\n</code></pre> <p>\u6216\u8005</p> <pre><code>db$-&gt;{0..1}.t_order_0$-&gt;{0..9}, db$-&gt;{0..1}.t_order_$-&gt;{10..20}\n</code></pre> <p>\u914d\u7f6e\u5206\u7247\u7b97\u6cd5</p> <p>\u5bf9\u4e8e\u53ea\u6709\u4e00\u4e2a\u5206\u7247\u952e\u7684\u4f7f\u7528 <code>=</code> \u548c <code>IN</code> \u8fdb\u884c\u5206\u7247\u7684 SQL\uff0c\u53ef\u4ee5\u4f7f\u7528\u884c\u8868\u8fbe\u5f0f\u4ee3\u66ff\u7f16\u7801\u65b9\u5f0f\u914d\u7f6e\u3002</p> <p>\u884c\u8868\u8fbe\u5f0f\u5185\u90e8\u7684\u8868\u8fbe\u5f0f\u672c\u8d28\u4e0a\u662f\u4e00\u6bb5 Groovy \u4ee3\u7801\uff0c\u53ef\u4ee5\u6839\u636e\u5206\u7247\u952e\u8fdb\u884c\u8ba1\u7b97\u7684\u65b9\u5f0f\uff0c\u8fd4\u56de\u76f8\u5e94\u7684\u771f\u5b9e\u6570\u636e\u6e90\u6216\u771f\u5b9e\u8868\u540d\u79f0\u3002</p> <p>\u4f8b\u5982\uff1a\u5206\u4e3a 10 \u4e2a\u5e93\uff0c\u5c3e\u6570\u4e3a 0 \u7684\u8def\u7531\u5230\u540e\u7f00\u4e3a 0 \u7684\u6570\u636e\u6e90\uff0c \u5c3e\u6570\u4e3a 1 \u7684\u8def\u7531\u5230\u540e\u7f00\u4e3a 1 \u7684\u6570\u636e\u6e90\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u7528\u4e8e\u8868\u793a\u5206\u7247\u7b97\u6cd5\u7684\u884c\u8868\u8fbe\u5f0f\u4e3a\uff1a</p> <pre><code>ds${id % 10}\n</code></pre> <p>\u6216\u8005</p> <pre><code>ds$-&gt;{id % 10}\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_12","title":"\u5185\u6838\u5256\u6790","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_13","title":"\u89e3\u6790\u5f15\u64ce","text":"<p>\u62bd\u8c61\u8bed\u6cd5\u6811</p> <p>\u89e3\u6790\u8fc7\u7a0b\u5206\u4e3a\u8bcd\u6cd5\u89e3\u6790\u548c\u8bed\u6cd5\u89e3\u6790\u3002 \u8bcd\u6cd5\u89e3\u6790\u5668\u7528\u4e8e\u5c06 SQL \u62c6\u89e3\u4e3a\u4e0d\u53ef\u518d\u5206\u7684\u539f\u5b50\u7b26\u53f7\uff0c\u79f0\u4e3a Token\u3002\u5e76\u6839\u636e\u4e0d\u540c\u6570\u636e\u5e93\u65b9\u8a00\u6240\u63d0\u4f9b\u7684\u5b57\u5178\uff0c\u5c06\u5176\u5f52\u7c7b\u4e3a\u5173\u952e\u5b57\uff0c\u8868\u8fbe\u5f0f\uff0c\u5b57\u9762\u91cf\u548c\u64cd\u4f5c\u7b26\u3002 \u518d\u4f7f\u7528\u8bed\u6cd5\u89e3\u6790\u5668\u5c06 \u8bcd\u6cd5\u89e3\u6790\u5668\u7684\u8f93\u51fa \u8f6c\u6362\u4e3a\u62bd\u8c61\u8bed\u6cd5\u6811\u3002</p> <p>\u4f8b\u5982\uff0c\u4ee5\u4e0b SQL\uff1a</p> <pre><code>SELECT id, name\nFROM t_user\nWHERE status = 'ACTIVE'\n  AND age &gt; 18\n</code></pre> <p>\u89e3\u6790\u4e4b\u540e\u7684\u4e3a\u62bd\u8c61\u8bed\u6cd5\u6811\u89c1\u4e0b\u56fe\u3002</p> <p></p> <p>\u4e3a\u4e86\u4fbf\u4e8e\u7406\u89e3\uff0c\u62bd\u8c61\u8bed\u6cd5\u6811\u4e2d\u7684\u5173\u952e\u5b57\u7684 Token \u7528\u7eff\u8272\u8868\u793a\uff0c\u53d8\u91cf\u7684 Token \u7528\u7ea2\u8272\u8868\u793a\uff0c\u7070\u8272\u8868\u793a\u9700\u8981\u8fdb\u4e00\u6b65\u62c6\u5206\u3002</p> <p>\u6700\u540e\uff0c\u901a\u8fc7<code>visitor</code>\u5bf9\u62bd\u8c61\u8bed\u6cd5\u6811\u904d\u5386\u6784\u9020\u57df\u6a21\u578b\uff0c\u901a\u8fc7\u57df\u6a21\u578b(<code>SQLStatement</code>)\u53bb\u63d0\u70bc\u5206\u7247\u6240\u9700\u7684\u4e0a\u4e0b\u6587\uff0c\u5e76\u6807\u8bb0\u6709\u53ef\u80fd\u9700\u8981\u6539\u5199\u7684\u4f4d\u7f6e\u3002 \u4f9b\u5206\u7247\u4f7f\u7528\u7684\u89e3\u6790\u4e0a\u4e0b\u6587\u5305\u542b\u67e5\u8be2\u9009\u62e9\u9879\uff08Select Items\uff09\u3001\u8868\u4fe1\u606f\uff08Table\uff09\u3001\u5206\u7247\u6761\u4ef6\uff08Sharding Condition\uff09\u3001\u81ea\u589e\u4e3b\u952e\u4fe1\u606f\uff08Auto increment Primary Key\uff09\u3001\u6392\u5e8f\u4fe1\u606f\uff08Order By\uff09\u3001\u5206\u7ec4\u4fe1\u606f\uff08Group By\uff09\u4ee5\u53ca\u5206\u9875\u4fe1\u606f\uff08Limit\u3001Rownum\u3001Top\uff09\u3002 SQL \u7684\u4e00\u6b21\u89e3\u6790\u8fc7\u7a0b\u662f\u4e0d\u53ef\u9006\u7684\uff0c\u4e00\u4e2a\u4e2a Token \u6309 SQL \u539f\u672c\u7684\u987a\u5e8f\u4f9d\u6b21\u8fdb\u884c\u89e3\u6790\uff0c\u6027\u80fd\u5f88\u9ad8\u3002 \u8003\u8651\u5230\u5404\u79cd\u6570\u636e\u5e93 SQL \u65b9\u8a00\u7684\u5f02\u540c\uff0c\u5728\u89e3\u6790\u6a21\u5757\u63d0\u4f9b\u4e86\u5404\u7c7b\u6570\u636e\u5e93\u7684 SQL \u65b9\u8a00\u5b57\u5178\u3002</p> <p>SQL \u89e3\u6790\u5f15\u64ce</p> <p>\u529f\u80fd\u70b9</p> <ul> <li>\u63d0\u4f9b\u72ec\u7acb\u7684SQL\u89e3\u6790\u529f\u80fd</li> <li>\u53ef\u4ee5\u975e\u5e38\u65b9\u4fbf\u7684\u5bf9\u8bed\u6cd5\u89c4\u5219\u8fdb\u884c\u6269\u5145\u548c\u4fee\u6539(\u4f7f\u7528\u4e86<code>ANTLR</code>)</li> <li>\u652f\u6301\u591a\u79cd\u65b9\u8a00\u7684SQL\u89e3\u6790</li> </ul> <p>API\u4f7f\u7528</p> <pre><code># \u5f15\u5165maven\u4f9d\u8d56\n&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.shardingsphere&lt;/groupId&gt;\n    &lt;artifactId&gt;shardingsphere-sql-parser-engine&lt;/artifactId&gt;\n    &lt;version&gt;${project.version}&lt;/version&gt;\n&lt;/dependency&gt;\n        // \u6839\u636e\u9700\u8981\u5f15\u5165\u6307\u5b9a\u65b9\u8a00\u7684\u89e3\u6790\u6a21\u5757\uff08\u4ee5MySQL\u4e3a\u4f8b\uff09,\u53ef\u4ee5\u6dfb\u52a0\u6240\u6709\u652f\u6301\u7684\u65b9\u8a00\uff0c\u4e5f\u53ef\u4ee5\u53ea\u6dfb\u52a0\u4f7f\u7528\u5230\u7684\n&lt;dependency&gt;\n&lt;groupId&gt;org.apache.shardingsphere&lt;/groupId&gt;\n&lt;artifactId&gt;shardingsphere-sql-parser-mysql&lt;/artifactId&gt;\n&lt;version&gt;${project.version}&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <ul> <li>\u83b7\u53d6\u8bed\u6cd5\u6811</li> </ul> <pre><code>/**\n * databaseType type:String \u53ef\u80fd\u503c MySQL,Oracle\uff0cPostgreSQL\uff0cSQL92\uff0cSQLServer\n * sql type:String \u89e3\u6790\u7684SQL\n * useCache type:boolean \u662f\u5426\u4f7f\u7528\u7f13\u5b58\n * @return parse tree\n */\nParseTree tree=new SQLParserEngine(databaseType).parse(sql,useCache); \n</code></pre> <ul> <li>\u83b7\u53d6SQLStatement</li> </ul> <pre><code>/**\n * databaseType type:String \u53ef\u80fd\u503c MySQL,Oracle\uff0cPostgreSQL\uff0cSQL92\uff0cSQLServer\n * useCache type:boolean \u662f\u5426\u4f7f\u7528\u7f13\u5b58\n * @return SQLStatement\n */\nParseTree tree=new SQLParserEngine(databaseType).parse(sql,useCache);\n        SQLVisitorEngine sqlVisitorEngine=new SQLVisitorEngine(databaseType,\"STATEMENT\");\n        SQLStatement sqlStatement=sqlVisitorEngine.visit(tree);\n</code></pre> <ul> <li>SQL\u683c\u5f0f\u5316</li> </ul> <pre><code>/**\n * databaseType type:String \u53ef\u80fd\u503c MySQL\n * useCache type:boolean \u662f\u5426\u4f7f\u7528\u7f13\u5b58\n * @return String\n */\nParseTree tree=new SQLParserEngine(databaseType).parse(sql,useCache);\n        SQLVisitorEngine sqlVisitorEngine=new SQLVisitorEngine(databaseType,\"FORMAT\");\n        String formatedSql=sqlVisitorEngine.visit(tree);\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_14","title":"\u8def\u7531\u5f15\u64ce","text":"<p>\u6839\u636e\u89e3\u6790\u4e0a\u4e0b\u6587\u5339\u914d\u6570\u636e\u5e93\u548c\u8868\u7684\u5206\u7247\u7b56\u7565\uff0c\u5e76\u751f\u6210\u8def\u7531\u8def\u5f84\u3002 \u5bf9\u4e8e\u643a\u5e26\u5206\u7247\u952e\u7684 SQL\uff0c\u6839\u636e\u5206\u7247\u952e\u7684\u4e0d\u540c\u53ef\u4ee5\u5212\u5206\u4e3a\u5355\u7247\u8def\u7531(\u5206\u7247\u952e\u7684\u64cd\u4f5c\u7b26\u662f\u7b49\u53f7)\u3001\u591a\u7247\u8def\u7531(\u5206\u7247\u952e\u7684\u64cd\u4f5c\u7b26\u662f IN)\u548c\u8303\u56f4\u8def\u7531(\u5206\u7247\u952e\u7684\u64cd\u4f5c\u7b26\u662f BETWEEN)\u3002 \u4e0d\u643a\u5e26\u5206\u7247\u952e\u7684 SQL \u5219\u91c7\u7528\u5e7f\u64ad\u8def\u7531\u3002</p> <p>\u5206\u7247\u8def\u7531</p> <p>\u7528\u4e8e\u6839\u636e\u5206\u7247\u952e\u8fdb\u884c\u8def\u7531\u7684\u573a\u666f\uff0c\u53c8\u7ec6\u5206\u4e3a\u76f4\u63a5\u8def\u7531\u3001\u6807\u51c6\u8def\u7531\u548c\u7b1b\u5361\u5c14\u79ef\u8def\u7531\u8fd9 3 \u79cd\u7c7b\u578b</p> <ul> <li>\u76f4\u63a5\u8def\u7531</li> </ul> <p>\u6ee1\u8db3\u76f4\u63a5\u8def\u7531\u7684\u6761\u4ef6\u76f8\u5bf9\u82db\u523b\uff0c\u5b83\u9700\u8981\u901a\u8fc7 Hint\uff08\u4f7f\u7528 HintAPI \u76f4\u63a5\u6307\u5b9a\u8def\u7531\u81f3\u5e93\u8868\uff09\u65b9\u5f0f\u5206\u7247\uff0c\u5e76\u4e14\u662f\u53ea\u5206\u5e93\u4e0d\u5206\u8868\u7684\u524d\u63d0\u4e0b\uff0c\u5219\u53ef\u4ee5\u907f\u514d SQL \u89e3\u6790\u548c\u4e4b\u540e\u7684\u7ed3\u679c\u5f52\u5e76\u3002 \u56e0\u6b64\u5b83\u7684\u517c\u5bb9\u6027\u6700\u597d\uff0c\u53ef\u4ee5\u6267\u884c\u5305\u62ec\u5b50\u67e5\u8be2\u3001\u81ea\u5b9a\u4e49\u51fd\u6570\u7b49\u590d\u6742\u60c5\u51b5\u7684\u4efb\u610f SQL\u3002\u76f4\u63a5\u8def\u7531\u8fd8\u53ef\u4ee5\u7528\u4e8e\u5206\u7247\u952e\u4e0d\u5728 SQL \u4e2d\u7684\u573a\u666f\u3002\u4f8b\u5982\uff0c\u8bbe\u7f6e\u7528\u4e8e\u6570\u636e\u5e93\u5206\u7247\u7684\u952e\u4e3a <code>3</code></p> <pre><code>hintManager.setDatabaseShardingValue(3);\n</code></pre> <p>\u5047\u5982\u8def\u7531\u7b97\u6cd5\u4e3a <code>value % 2</code>\uff0c\u5f53\u4e00\u4e2a\u903b\u8f91\u5e93 <code>t_order</code> \u5bf9\u5e94 2 \u4e2a\u771f\u5b9e\u5e93 <code>t_order_0</code> \u548c <code>t_order_1</code> \u65f6\uff0c\u8def\u7531\u540e SQL \u5c06\u5728 <code>t_order_1</code> \u4e0a\u6267\u884c\u3002\u4e0b\u65b9\u662f\u4f7f\u7528 API \u7684\u4ee3\u7801\u6837\u4f8b\uff1a</p> <pre><code>String sql=\"SELECT * FROM t_order\";\n        try(\n        HintManager hintManager=HintManager.getInstance();\n        Connection conn=dataSource.getConnection();\n        PreparedStatement pstmt=conn.prepareStatement(sql)){\n        hintManager.setDatabaseShardingValue(3);\n        try(ResultSet rs=pstmt.executeQuery()){\n        while(rs.next()){\n        //...\n        }\n        }\n        }\n</code></pre> <ul> <li>\u6807\u51c6\u8def\u7531</li> </ul> <p>\u6807\u51c6\u8def\u7531\u662f ShardingSphere \u6700\u4e3a\u63a8\u8350\u4f7f\u7528\u7684\u5206\u7247\u65b9\u5f0f\uff0c\u5b83\u7684\u9002\u7528\u8303\u56f4\u662f\u4e0d\u5305\u542b\u5173\u8054\u67e5\u8be2\u6216\u4ec5\u5305\u542b\u7ed1\u5b9a\u8868\u4e4b\u95f4\u5173\u8054\u67e5\u8be2\u7684 SQL\u3002 \u5f53\u5206\u7247\u8fd0\u7b97\u7b26\u662f\u7b49\u4e8e\u53f7\u65f6\uff0c\u8def\u7531\u7ed3\u679c\u5c06\u843d\u5165\u5355\u5e93\uff08\u8868\uff09\uff0c\u5f53\u5206\u7247\u8fd0\u7b97\u7b26\u662f BETWEEN \u6216 IN \u65f6\uff0c\u5219\u8def\u7531\u7ed3\u679c\u4e0d\u4e00\u5b9a\u843d\u5165\u552f\u4e00\u7684\u5e93\uff08\u8868\uff09\uff0c\u56e0\u6b64\u4e00\u6761\u903b\u8f91 SQL \u6700\u7ec8\u53ef\u80fd\u88ab\u62c6\u5206\u4e3a\u591a\u6761\u7528\u4e8e\u6267\u884c\u7684\u771f\u5b9e SQL\u3002 \u4e3e\u4f8b\u8bf4\u660e\uff0c\u5982\u679c\u6309\u7167 <code>order_id</code> \u7684\u5947\u6570\u548c\u5076\u6570\u8fdb\u884c\u6570\u636e\u5206\u7247\uff0c\u4e00\u4e2a\u5355\u8868\u67e5\u8be2\u7684 SQL \u5982\u4e0b\uff1a</p> <pre><code>SELECT*FROM t_order WHERE order_id IN(1,2);\n</code></pre> <p>\u90a3\u4e48\u8def\u7531\u7684\u7ed3\u679c\u4e3a\uff1a</p> <pre><code>SELECT *\nFROM t_order_0\nWHERE order_id IN (1, 2);\nSELECT *\nFROM t_order_1\nWHERE order_id IN (1, 2);\n</code></pre> <p>\u7ed1\u5b9a\u8868\u7684\u5173\u8054\u67e5\u8be2\u4e0e\u5355\u8868\u67e5\u8be2\u590d\u6742\u5ea6\u548c\u6027\u80fd\u76f8\u5f53\u3002\u4e3e\u4f8b\u8bf4\u660e\uff0c\u5982\u679c\u4e00\u4e2a\u5305\u542b\u7ed1\u5b9a\u8868\u7684\u5173\u8054\u67e5\u8be2\u7684 SQL \u5982\u4e0b\uff1a</p> <pre><code>SELECT *\nFROM t_order_0 o\n         JOIN t_order_item_0 i ON o.order_id = i.order_id\nWHERE order_id IN (1, 2);\nSELECT *\nFROM t_order_1 o\n         JOIN t_order_item_1 i ON o.order_id = i.order_id\nWHERE order_id IN (1, 2);\n</code></pre> <ul> <li>\u7b1b\u5361\u5c14\u8def\u7531</li> </ul> <p>\u7b1b\u5361\u5c14\u8def\u7531\u662f\u6700\u590d\u6742\u7684\u60c5\u51b5\uff0c\u5b83\u65e0\u6cd5\u6839\u636e\u7ed1\u5b9a\u8868\u7684\u5173\u7cfb\u5b9a\u4f4d\u5206\u7247\u89c4\u5219\uff0c\u56e0\u6b64\u975e\u7ed1\u5b9a\u8868\u4e4b\u95f4\u7684\u5173\u8054\u67e5\u8be2\u9700\u8981\u62c6\u89e3\u4e3a\u7b1b\u5361\u5c14\u79ef\u7ec4\u5408\u6267\u884c\u3002 \u5982\u679c\u4e0a\u4e2a\u793a\u4f8b\u4e2d\u7684 SQL \u5e76\u672a\u914d\u7f6e\u7ed1\u5b9a\u8868\u5173\u7cfb\uff0c\u90a3\u4e48\u8def\u7531\u7684\u7ed3\u679c\u5e94\u4e3a\uff1a</p> <pre><code>SELECT *\nFROM t_order_0 o\n         JOIN t_order_item_0 i ON o.order_id = i.order_id\nWHERE order_id IN (1, 2);\nSELECT *\nFROM t_order_0 o\n         JOIN t_order_item_1 i ON o.order_id = i.order_id\nWHERE order_id IN (1, 2);\nSELECT *\nFROM t_order_1 o\n         JOIN t_order_item_0 i ON o.order_id = i.order_id\nWHERE order_id IN (1, 2);\nSELECT *\nFROM t_order_1 o\n         JOIN t_order_item_1 i ON o.order_id = i.order_id\nWHERE order_id IN (1, 2);\n</code></pre> <p>\u5e7f\u64ad\u8def\u7531</p> <p>\u5bf9\u4e8e\u4e0d\u643a\u5e26\u5206\u7247\u952e\u7684 SQL\uff0c\u5219\u91c7\u53d6\u5e7f\u64ad\u8def\u7531\u7684\u65b9\u5f0f\u3002\u6839\u636e SQL \u7c7b\u578b\u53c8\u53ef\u4ee5\u5212\u5206\u4e3a\u5168\u5e93\u8868\u8def\u7531\u3001\u5168\u5e93\u8def\u7531\u3001\u5168\u5b9e\u4f8b\u8def\u7531\u3001\u5355\u64ad\u8def\u7531\u548c\u963b\u65ad\u8def\u7531\u8fd9 5 \u79cd\u7c7b\u578b\u3002</p> <ul> <li>\u5168\u5e93\u8868\u8def\u7531</li> </ul> <p>\u5168\u5e93\u8868\u8def\u7531\u7528\u4e8e\u5904\u7406\u5bf9\u6570\u636e\u5e93\u4e2d\u4e0e\u5176\u903b\u8f91\u8868\u76f8\u5173\u7684\u6240\u6709\u771f\u5b9e\u8868\u7684\u64cd\u4f5c\uff0c\u4e3b\u8981\u5305\u62ec\u4e0d\u5e26\u5206\u7247\u952e\u7684 DQL \u548c DML\uff0c\u4ee5\u53ca DDL \u7b49\u3002\u4f8b\u5982\uff1a</p> <pre><code>SELECT *\nFROM t_order\nWHERE good_prority IN (1, 10);\n</code></pre> <p>\u5219\u4f1a\u904d\u5386\u6240\u6709\u6570\u636e\u5e93\u4e2d\u7684\u6240\u6709\u8868\uff0c\u9010\u4e00\u5339\u914d\u903b\u8f91\u8868\u548c\u771f\u5b9e\u8868\u540d\uff0c\u80fd\u591f\u5339\u914d\u5f97\u4e0a\u5219\u6267\u884c\u3002\u8def\u7531\u540e\u6210\u4e3a</p> <pre><code>SELECT *\nFROM t_order_0\nWHERE good_prority IN (1, 10);\nSELECT *\nFROM t_order_1\nWHERE good_prority IN (1, 10);\nSELECT *\nFROM t_order_2\nWHERE good_prority IN (1, 10);\nSELECT *\nFROM t_order_3\nWHERE good_prority IN (1, 10);\n</code></pre> <ul> <li>\u5168\u5e93\u8def\u7531</li> </ul> <p>\u5168\u5e93\u8def\u7531\u7528\u4e8e\u5904\u7406\u5bf9\u6570\u636e\u5e93\u7684\u64cd\u4f5c\uff0c\u5305\u62ec\u7528\u4e8e\u5e93\u8bbe\u7f6e\u7684 SET \u7c7b\u578b\u7684\u6570\u636e\u5e93\u7ba1\u7406\u547d\u4ee4\uff0c\u4ee5\u53ca TCL \u8fd9\u6837\u7684\u4e8b\u52a1\u63a7\u5236\u8bed\u53e5\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f1a\u6839\u636e\u903b\u8f91\u5e93\u7684\u540d\u5b57\u904d\u5386\u6240\u6709\u7b26\u5408\u540d\u5b57\u5339\u914d\u7684\u771f\u5b9e\u5e93\uff0c\u5e76\u5728\u771f\u5b9e\u5e93\u4e2d\u6267\u884c\u8be5\u547d\u4ee4\uff0c\u4f8b\u5982</p> <pre><code>SET\nautocommit=0;\n</code></pre> <p>\u5728 <code>t_order</code> \u4e2d\u6267\u884c\uff0c<code>t_order</code> \u6709 2 \u4e2a\u771f\u5b9e\u5e93\u3002\u5219\u5b9e\u9645\u4f1a\u5728 <code>t_order_0</code> \u548c <code>t_order_1</code> \u4e0a\u90fd\u6267\u884c\u8fd9\u4e2a\u547d\u4ee4</p> <ul> <li>\u5168\u5b9e\u4f8b\u8def\u7531</li> </ul> <p>\u5168\u5b9e\u4f8b\u8def\u7531\u7528\u4e8e DCL \u64cd\u4f5c\uff0c\u6388\u6743\u8bed\u53e5\u9488\u5bf9\u7684\u662f\u6570\u636e\u5e93\u7684\u5b9e\u4f8b\u3002\u65e0\u8bba\u4e00\u4e2a\u5b9e\u4f8b\u4e2d\u5305\u542b\u591a\u5c11\u4e2a Schema\uff0c\u6bcf\u4e2a\u6570\u636e\u5e93\u7684\u5b9e\u4f8b\u53ea\u6267\u884c\u4e00\u6b21\u3002\u4f8b\u5982\uff1a</p> <pre><code>CREATE\nUSER customer@127.0.0.1 identified BY '123';\n</code></pre> <p>\u8fd9\u4e2a\u547d\u4ee4\u5c06\u5728\u6240\u6709\u7684\u771f\u5b9e\u6570\u636e\u5e93\u5b9e\u4f8b\u4e2d\u6267\u884c\uff0c\u4ee5\u786e\u4fdd customer \u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u6bcf\u4e00\u4e2a\u5b9e\u4f8b\u3002</p> <ul> <li>\u5355\u6ce2\u8def\u7531</li> </ul> <p>\u5355\u64ad\u8def\u7531\u7528\u4e8e\u83b7\u53d6\u67d0\u4e00\u771f\u5b9e\u8868\u4fe1\u606f\u7684\u573a\u666f\uff0c\u5b83\u4ec5\u9700\u8981\u4ece\u4efb\u610f\u5e93\u4e2d\u7684\u4efb\u610f\u771f\u5b9e\u8868\u4e2d\u83b7\u53d6\u6570\u636e\u5373\u53ef\u3002\u4f8b\u5982\uff1a</p> <pre><code>DESCRIBE t_order;\n</code></pre> <p>t_order \u7684\u4e24\u4e2a\u771f\u5b9e\u8868 t_order_0\uff0ct_order_1 \u7684\u63cf\u8ff0\u7ed3\u6784\u76f8\u540c\uff0c\u6240\u4ee5\u8fd9\u4e2a\u547d\u4ee4\u5728\u4efb\u610f\u771f\u5b9e\u8868\u4e0a\u9009\u62e9\u6267\u884c\u4e00\u6b21\u3002</p> <ul> <li>\u963b\u65ad\u8def\u7531</li> </ul> <p>\u963b\u65ad\u8def\u7531\u7528\u4e8e\u5c4f\u853d SQL \u5bf9\u6570\u636e\u5e93\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982\uff1a</p> <pre><code>USE\norder_db;\n</code></pre> <p>\u8fd9\u4e2a\u547d\u4ee4\u4e0d\u4f1a\u5728\u771f\u5b9e\u6570\u636e\u5e93\u4e2d\u6267\u884c\uff0c\u56e0\u4e3a ShardingSphere \u91c7\u7528\u7684\u662f\u903b\u8f91 Schema \u7684\u65b9\u5f0f\uff0c\u65e0\u9700\u5c06\u5207\u6362\u6570\u636e\u5e93 Schema \u7684\u547d\u4ee4\u53d1\u9001\u81f3\u6570\u636e\u5e93\u4e2d\u3002</p> <p>\u8def\u7531\u5f15\u64ce\u7684\u6574\u4f53\u7ed3\u6784\u5212\u5206\u5982\u4e0b\u56fe\u3002</p> <p></p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_15","title":"\u5206\u5e03\u5f0f\u4e8b\u52a1","text":"<p>\u6570\u636e\u5e93\u4e8b\u52a1\u9700\u8981\u6ee1\u8db3 <code>ACID</code>\uff08\u539f\u5b50\u6027\u3001\u4e00\u81f4\u6027\u3001\u9694\u79bb\u6027\u3001\u6301\u4e45\u6027\uff09\u56db\u4e2a\u7279\u6027\u3002</p> <ul> <li>\u539f\u5b50\u6027\uff08Atomicity\uff09\u6307\u4e8b\u52a1\u4f5c\u4e3a\u6574\u4f53\u6765\u6267\u884c\uff0c\u8981\u4e48\u5168\u90e8\u6267\u884c\uff0c\u8981\u4e48\u5168\u4e0d\u6267\u884c\u3002</li> <li>\u4e00\u81f4\u6027\uff08Consistency\uff09\u6307\u4e8b\u52a1\u5e94\u786e\u4fdd\u6570\u636e\u4ece\u4e00\u4e2a\u4e00\u81f4\u7684\u72b6\u6001\u8f6c\u53d8\u4e3a\u53e6\u4e00\u4e2a\u4e00\u81f4\u7684\u72b6\u6001\u3002</li> <li>\u9694\u79bb\u6027\uff08Isolation\uff09\u6307\u591a\u4e2a\u4e8b\u52a1\u5e76\u53d1\u6267\u884c\u65f6\uff0c\u4e00\u4e2a\u4e8b\u52a1\u7684\u6267\u884c\u4e0d\u5e94\u5f71\u54cd\u5176\u4ed6\u4e8b\u52a1\u7684\u6267\u884c\u3002</li> <li>\u6301\u4e45\u6027\uff08Durability\uff09\u6307\u5df2\u63d0\u4ea4\u7684\u4e8b\u52a1\u4fee\u6539\u6570\u636e\u4f1a\u88ab\u6301\u4e45\u4fdd\u5b58\u3002</li> </ul> <p>\u5728\u5355\u4e00\u6570\u636e\u8282\u70b9\u4e2d\uff0c\u4e8b\u52a1\u4ec5\u9650\u4e8e\u5bf9\u5355\u4e00\u6570\u636e\u5e93\u8d44\u6e90\u7684\u8bbf\u95ee\u63a7\u5236\uff0c\u79f0\u4e4b\u4e3a\u672c\u5730\u4e8b\u52a1\u3002\u51e0\u4e4e\u6240\u6709\u7684\u6210\u719f\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u90fd\u63d0\u4f9b\u4e86\u5bf9\u672c\u5730\u4e8b\u52a1\u7684\u539f\u751f\u652f\u6301\u3002 \u4f46\u662f\u5728\u57fa\u4e8e\u5fae\u670d\u52a1\u7684\u5206\u5e03\u5f0f\u5e94\u7528\u73af\u5883\u4e0b\uff0c\u8d8a\u6765\u8d8a\u591a\u7684\u5e94\u7528\u573a\u666f\u8981\u6c42\u5bf9\u591a\u4e2a\u670d\u52a1\u7684\u8bbf\u95ee\u53ca\u5176\u76f8\u5bf9\u5e94\u7684\u591a\u4e2a\u6570\u636e\u5e93\u8d44\u6e90\u80fd\u7eb3\u5165\u5230\u540c\u4e00\u4e2a\u4e8b\u52a1\u5f53\u4e2d\uff0c\u5206\u5e03\u5f0f\u4e8b\u52a1\u5e94\u8fd0\u800c\u751f\u3002</p> <p>\u5173\u7cfb\u578b\u6570\u636e\u5e93\u867d\u7136\u5bf9\u672c\u5730\u4e8b\u52a1\u63d0\u4f9b\u4e86\u5b8c\u7f8e\u7684 <code>ACID</code> \u539f\u751f\u652f\u6301\u3002 \u4f46\u5728\u5206\u5e03\u5f0f\u7684\u573a\u666f\u4e0b\uff0c\u5b83\u5374\u6210\u4e3a\u7cfb\u7edf\u6027\u80fd\u7684\u684e\u688f\u3002\u5982\u4f55\u8ba9\u6570\u636e\u5e93\u5728\u5206\u5e03\u5f0f\u573a\u666f\u4e0b\u6ee1\u8db3 <code>ACID</code> \u7684\u7279\u6027\u6216\u627e\u5bfb\u76f8\u5e94\u7684\u66ff\u4ee3\u65b9\u6848\uff0c\u662f\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u91cd\u70b9\u5de5\u4f5c\u3002</p> <p>\u672c\u5730\u4e8b\u52a1</p> <p>\u5728\u4e0d\u5f00\u542f\u4efb\u4f55\u5206\u5e03\u5f0f\u4e8b\u52a1\u7ba1\u7406\u5668\u7684\u524d\u63d0\u4e0b\uff0c\u8ba9\u6bcf\u4e2a\u6570\u636e\u8282\u70b9\u5404\u81ea\u7ba1\u7406\u81ea\u5df1\u7684\u4e8b\u52a1\u3002 \u5b83\u4eec\u4e4b\u95f4\u6ca1\u6709\u534f\u8c03\u4ee5\u53ca\u901a\u4fe1\u7684\u80fd\u529b\uff0c\u4e5f\u5e76\u4e0d\u4e92\u76f8\u77e5\u6653\u5176\u4ed6\u6570\u636e\u8282\u70b9\u4e8b\u52a1\u7684\u6210\u529f\u4e0e\u5426\u3002 \u672c\u5730\u4e8b\u52a1\u5728\u6027\u80fd\u65b9\u9762\u65e0\u4efb\u4f55\u635f\u8017\uff0c\u4f46\u5728\u5f3a\u4e00\u81f4\u6027\u4ee5\u53ca\u6700\u7ec8\u4e00\u81f4\u6027\u65b9\u9762\u5219\u529b\u4e0d\u4ece\u5fc3\u3002</p> <p>\u4e24\u9636\u6bb5\u63d0\u4ea4</p> <p>XA\u534f\u8bae\u6700\u65e9\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u6a21\u578b\u662f\u7531 <code>X/Open</code> \u56fd\u9645\u8054\u76df\u63d0\u51fa\u7684 <code>X/Open Distributed Transaction Processing (DTP)</code> \u6a21\u578b\uff0c\u7b80\u79f0 XA \u534f\u8bae\u3002</p> <p>\u57fa\u4e8eXA\u534f\u8bae\u5b9e\u73b0\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u5bf9\u4e1a\u52a1\u4fb5\u5165\u5f88\u5c0f\u3002 \u5b83\u6700\u5927\u7684\u4f18\u52bf\u5c31\u662f\u5bf9\u4f7f\u7528\u65b9\u900f\u660e\uff0c\u7528\u6237\u53ef\u4ee5\u50cf\u4f7f\u7528\u672c\u5730\u4e8b\u52a1\u4e00\u6837\u4f7f\u7528\u57fa\u4e8eXA\u534f\u8bae\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u3002 XA\u534f\u8bae\u80fd\u591f\u4e25\u683c\u4fdd\u969c\u4e8b\u52a1 <code>ACID</code> \u7279\u6027\u3002</p> <p>\u4e25\u683c\u4fdd\u969c\u4e8b\u52a1 <code>ACID</code> \u7279\u6027\u662f\u4e00\u628a\u53cc\u5203\u5251\u3002 \u4e8b\u52a1\u6267\u884c\u5728\u8fc7\u7a0b\u4e2d\u9700\u8981\u5c06\u6240\u9700\u8d44\u6e90\u5168\u90e8\u9501\u5b9a\uff0c\u5b83\u66f4\u52a0\u9002\u7528\u4e8e\u6267\u884c\u65f6\u95f4\u786e\u5b9a\u7684\u77ed\u4e8b\u52a1\u3002 \u5bf9\u4e8e\u957f\u4e8b\u52a1\u6765\u8bf4\uff0c\u6574\u4e2a\u4e8b\u52a1\u8fdb\u884c\u671f\u95f4\u5bf9\u6570\u636e\u7684\u72ec\u5360\uff0c\u5c06\u5bfc\u81f4\u5bf9\u70ed\u70b9\u6570\u636e\u4f9d\u8d56\u7684\u4e1a\u52a1\u7cfb\u7edf\u5e76\u53d1\u6027\u80fd\u8870\u9000\u660e\u663e\u3002 \u56e0\u6b64\uff0c\u5728\u9ad8\u5e76\u53d1\u7684\u6027\u80fd\u81f3\u4e0a\u573a\u666f\u4e2d\uff0c\u57fa\u4e8eXA\u534f\u8bae\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u5e76\u4e0d\u662f\u6700\u4f73\u9009\u62e9\u3002</p> <p>\u67d4\u6027\u4e8b\u52a1</p> <p>\u5982\u679c\u5c06\u5b9e\u73b0\u4e86 <code>ACID</code> \u7684\u4e8b\u52a1\u8981\u7d20\u7684\u4e8b\u52a1\u79f0\u4e3a\u521a\u6027\u4e8b\u52a1\u7684\u8bdd\uff0c\u90a3\u4e48\u57fa\u4e8e <code>BASE</code> \u4e8b\u52a1\u8981\u7d20\u7684\u4e8b\u52a1\u5219\u79f0\u4e3a\u67d4\u6027\u4e8b\u52a1\u3002 <code>BASE</code> \u662f\u57fa\u672c\u53ef\u7528\u3001\u67d4\u6027\u72b6\u6001\u548c\u6700\u7ec8\u4e00\u81f4\u6027\u8fd9\u4e09\u4e2a\u8981\u7d20\u7684\u7f29\u5199\u3002</p> <ul> <li>\u57fa\u672c\u53ef\u7528\uff08Basically Available\uff09\u4fdd\u8bc1\u5206\u5e03\u5f0f\u4e8b\u52a1\u53c2\u4e0e\u65b9\u4e0d\u4e00\u5b9a\u540c\u65f6\u5728\u7ebf\u3002</li> <li>\u67d4\u6027\u72b6\u6001\uff08Soft state\uff09\u5219\u5141\u8bb8\u7cfb\u7edf\u72b6\u6001\u66f4\u65b0\u6709\u4e00\u5b9a\u7684\u5ef6\u65f6\uff0c\u8fd9\u4e2a\u5ef6\u65f6\u5bf9\u5ba2\u6237\u6765\u8bf4\u4e0d\u4e00\u5b9a\u80fd\u591f\u5bdf\u89c9\u3002</li> <li>\u800c\u6700\u7ec8\u4e00\u81f4\u6027\uff08Eventually consistent\uff09\u901a\u5e38\u662f\u901a\u8fc7\u6d88\u606f\u4f20\u9012\u7684\u65b9\u5f0f\u4fdd\u8bc1\u7cfb\u7edf\u7684\u6700\u7ec8\u4e00\u81f4\u6027\u3002</li> </ul> <p>\u5728 <code>ACID</code> \u4e8b\u52a1\u4e2d\u5bf9\u9694\u79bb\u6027\u7684\u8981\u6c42\u5f88\u9ad8\uff0c\u5728\u4e8b\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u5fc5\u987b\u5c06\u6240\u6709\u7684\u8d44\u6e90\u9501\u5b9a\u3002 \u67d4\u6027\u4e8b\u52a1\u7684\u7406\u5ff5\u5219\u662f\u901a\u8fc7\u4e1a\u52a1\u903b\u8f91\u5c06\u4e92\u65a5\u9501\u64cd\u4f5c\u4ece\u8d44\u6e90\u5c42\u9762\u4e0a\u79fb\u81f3\u4e1a\u52a1\u5c42\u9762\u3002\u901a\u8fc7\u653e\u5bbd\u5bf9\u5f3a\u4e00\u81f4\u6027\u8981\u6c42\uff0c\u6765\u6362\u53d6\u7cfb\u7edf\u541e\u5410\u91cf\u7684\u63d0\u5347\u3002</p> <p>\u57fa\u4e8e <code>ACID</code> \u7684\u5f3a\u4e00\u81f4\u6027\u4e8b\u52a1\u548c\u57fa\u4e8e <code>BASE</code> \u7684\u6700\u7ec8\u4e00\u81f4\u6027\u4e8b\u52a1\u90fd\u4e0d\u662f\u94f6\u5f39\uff0c\u53ea\u6709\u5728\u6700\u9002\u5408\u7684\u573a\u666f\u4e2d\u624d\u80fd\u53d1\u6325\u5b83\u4eec\u7684\u6700\u5927\u957f\u5904\u3002 \u53ef\u901a\u8fc7\u4e0b\u8868\u8be6\u7ec6\u5bf9\u6bd4\u5b83\u4eec\u4e4b\u95f4\u7684\u533a\u522b\uff0c\u4ee5\u5e2e\u52a9\u5f00\u53d1\u8005\u8fdb\u884c\u6280\u672f\u9009\u578b\u3002</p> \u672c\u5730\u4e8b\u52a1 \u4e24\uff08\u4e09\uff09\u9636\u6bb5\u4e8b\u52a1 \u67d4\u6027\u4e8b\u52a1 \u4e1a\u52a1\u6539\u9020 \u65e0 \u65e0 \u5b9e\u73b0\u76f8\u5173\u63a5\u53e3 \u4e00\u81f4\u6027 \u4e0d\u652f\u6301 \u652f\u6301 \u6700\u7ec8\u4e00\u81f4 \u9694\u79bb\u6027 \u4e0d\u652f\u6301 \u652f\u6301 \u4e1a\u52a1\u65b9\u4fdd\u8bc1 \u5e76\u53d1\u6027\u80fd \u65e0\u5f71\u54cd \u4e25\u91cd\u8870\u9000 \u7565\u5fae\u8870\u9000 \u9002\u5408\u573a\u666f \u4e1a\u52a1\u65b9\u5904\u7406\u4e0d\u4e00\u81f4 \u77ed\u4e8b\u52a1 &amp; \u4f4e\u5e76\u53d1 \u957f\u4e8b\u52a1 &amp; \u9ad8\u5e76\u53d1"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_16","title":"\u6838\u5fc3\u6982\u5ff5","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#xa","title":"XA\u4e24\u9636\u6bb5\u4e8b\u52a1","text":"<p>\u4e24\u9636\u6bb5\u4e8b\u52a1\u63d0\u4ea4\u91c7\u7528\u7684\u662f X/OPEN \u7ec4\u7ec7\u6240\u5b9a\u4e49\u7684DTP\u6a21\u578b\u6240\u62bd\u8c61\u7684 AP\uff08\u5e94\u7528\u7a0b\u5e8f\uff09, TM\uff08\u4e8b\u52a1\u7ba1\u7406\u5668\uff09\u548c RM\uff08\u8d44\u6e90\u7ba1\u7406\u5668\uff09 \u6982\u5ff5\u6765\u4fdd\u8bc1\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u5f3a\u4e00\u81f4\u6027\u3002 \u5176\u4e2d TM \u4e0e RM \u95f4\u91c7\u7528 XA \u7684\u534f\u8bae\u8fdb\u884c\u53cc\u5411\u901a\u4fe1\u3002 \u4e0e\u4f20\u7edf\u7684\u672c\u5730\u4e8b\u52a1\u76f8\u6bd4\uff0cXA \u4e8b\u52a1\u589e\u52a0\u4e86\u51c6\u5907\u9636\u6bb5\uff0c\u6570\u636e\u5e93\u9664\u4e86\u88ab\u52a8\u63a5\u53d7\u63d0\u4ea4\u6307\u4ee4\u5916\uff0c\u8fd8\u53ef\u4ee5\u53cd\u5411\u901a\u77e5\u8c03\u7528\u65b9\u4e8b\u52a1\u662f\u5426\u53ef\u4ee5\u88ab\u63d0\u4ea4\u3002 <code>TM</code> \u53ef\u4ee5\u6536\u96c6\u6240\u6709\u5206\u652f\u4e8b\u52a1\u7684\u51c6\u5907\u7ed3\u679c\uff0c\u5e76\u4e8e\u6700\u540e\u8fdb\u884c\u539f\u5b50\u63d0\u4ea4\uff0c\u4ee5\u4fdd\u8bc1\u4e8b\u52a1\u7684\u5f3a\u4e00\u81f4\u6027\u3002</p> <p></p> <p>Java \u901a\u8fc7\u5b9a\u4e49 JTA \u63a5\u53e3\u5b9e\u73b0\u4e86 XA \u6a21\u578b\uff0cJTA \u63a5\u53e3\u4e2d\u7684 <code>ResourceManager</code> \u9700\u8981\u6570\u636e\u5e93\u5382\u5546\u63d0\u4f9b XA \u9a71\u52a8\u5b9e\u73b0\uff0c <code>TransactionManager</code> \u5219\u9700\u8981\u4e8b\u52a1\u7ba1\u7406\u5668\u7684\u5382\u5546\u5b9e\u73b0\uff0c\u4f20\u7edf\u7684\u4e8b\u52a1\u7ba1\u7406\u5668\u9700\u8981\u540c\u5e94\u7528\u670d\u52a1\u5668\u7ed1\u5b9a\uff0c\u56e0\u6b64\u4f7f\u7528\u7684\u6210\u672c\u5f88\u9ad8\u3002 \u800c\u5d4c\u5165\u5f0f\u7684\u4e8b\u52a1\u7ba1\u5668\u53ef\u4ee5\u4ee5 jar \u5305\u7684\u5f62\u5f0f\u63d0\u4f9b\u670d\u52a1\uff0c\u540c Apache ShardingSphere \u96c6\u6210\u540e\uff0c\u53ef\u4fdd\u8bc1\u5206\u7247\u540e\u8de8\u5e93\u4e8b\u52a1\u5f3a\u4e00\u81f4\u6027\u3002</p> <p>\u901a\u5e38\uff0c\u53ea\u6709\u4f7f\u7528\u4e86\u4e8b\u52a1\u7ba1\u7406\u5668\u5382\u5546\u6240\u63d0\u4f9b\u7684 XA \u4e8b\u52a1\u8fde\u63a5\u6c60\uff0c\u624d\u80fd\u652f\u6301 XA \u7684\u4e8b\u52a1\u3002Apache ShardingSphere \u5728\u6574\u5408 XA \u4e8b\u52a1\u65f6\uff0c\u91c7\u7528\u5206\u79bb XA \u4e8b\u52a1\u7ba1\u7406\u548c\u8fde\u63a5\u6c60\u7ba1\u7406\u7684\u65b9\u5f0f\uff0c\u505a\u5230\u5bf9\u5e94\u7528\u7a0b\u5e8f\u7684\u96f6\u4fb5\u5165\u3002</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#seata","title":"SEATA \u67d4\u6027\u4e8b\u52a1","text":"<p>Seata\u662f\u963f\u91cc\u96c6\u56e2\u548c\u8682\u8681\u91d1\u670d\u8054\u5408\u6253\u9020\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u6846\u67b6\u3002 \u5176 AT \u4e8b\u52a1\u7684\u76ee\u6807\u662f\u5728\u5fae\u670d\u52a1\u67b6\u6784\u4e0b\uff0c\u63d0\u4f9b\u589e\u91cf\u7684\u4e8b\u52a1 ACID \u8bed\u610f\uff0c\u8ba9\u5f00\u53d1\u8005\u50cf\u4f7f\u7528\u672c\u5730\u4e8b\u52a1\u4e00\u6837\uff0c\u4f7f\u7528\u5206\u5e03\u5f0f\u4e8b\u52a1\uff0c\u6838\u5fc3\u7406\u5ff5\u540c Apache ShardingSphere \u4e00\u8109\u76f8\u627f\u3002</p> <p>Seata AT \u4e8b\u52a1\u6a21\u578b\u5305\u542bTM (\u4e8b\u52a1\u7ba1\u7406\u5668)\uff0cRM (\u8d44\u6e90\u7ba1\u7406\u5668) \u548c TC (\u4e8b\u52a1\u534f\u8c03\u5668)\u3002 TC \u662f\u4e00\u4e2a\u72ec\u7acb\u90e8\u7f72\u7684\u670d\u52a1\uff0cTM \u548c RM \u4ee5 jar \u5305\u7684\u65b9\u5f0f\u540c\u4e1a\u52a1\u5e94\u7528\u4e00\u540c\u90e8\u7f72\uff0c\u5b83\u4eec\u540c TC \u5efa\u7acb\u957f\u8fde\u63a5\uff0c\u5728\u6574\u4e2a\u4e8b\u52a1\u751f\u547d\u5468\u671f\u5185\uff0c\u4fdd\u6301\u8fdc\u7a0b\u901a\u4fe1\u3002 TM \u662f\u5168\u5c40\u4e8b\u52a1\u7684\u53d1\u8d77\u65b9\uff0c\u8d1f\u8d23\u5168\u5c40\u4e8b\u52a1\u7684\u5f00\u542f\uff0c\u63d0\u4ea4\u548c\u56de\u6eda\u3002 RM \u662f\u5168\u5c40\u4e8b\u52a1\u7684\u53c2\u4e0e\u8005\uff0c\u8d1f\u8d23\u5206\u652f\u4e8b\u52a1\u7684\u6267\u884c\u7ed3\u679c\u4e0a\u62a5\uff0c\u5e76\u4e14\u901a\u8fc7 TC \u7684\u534f\u8c03\u8fdb\u884c\u5206\u652f\u4e8b\u52a1\u7684\u63d0\u4ea4\u548c\u56de\u6eda\u3002</p> <p>Seata \u7ba1\u7406\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u5178\u578b\u751f\u547d\u5468\u671f\uff1a</p> <ol> <li>TM \u8981\u6c42 TC \u5f00\u59cb\u4e00\u4e2a\u5168\u65b0\u7684\u5168\u5c40\u4e8b\u52a1\u3002TC \u751f\u6210\u4e00\u4e2a\u4ee3\u8868\u8be5\u5168\u5c40\u4e8b\u52a1\u7684 XID\u3002</li> <li>XID \u8d2f\u7a7f\u4e8e\u5fae\u670d\u52a1\u7684\u6574\u4e2a\u8c03\u7528\u94fe\u3002</li> <li>\u4f5c\u4e3a\u8be5 XID \u5bf9\u5e94\u5230\u7684 TC \u4e0b\u7684\u5168\u5c40\u4e8b\u52a1\u7684\u4e00\u90e8\u5206\uff0cRM \u6ce8\u518c\u672c\u5730\u4e8b\u52a1\u3002</li> <li>TM \u8981\u6c42 TC \u63d0\u4ea4\u6216\u56de\u6eda XID \u5bf9\u5e94\u7684\u5168\u5c40\u4e8b\u52a1\u3002</li> <li>TC \u9a71\u52a8 XID \u5bf9\u5e94\u7684\u5168\u5c40\u4e8b\u52a1\u4e0b\u7684\u6240\u6709\u5206\u652f\u4e8b\u52a1\u5b8c\u6210\u63d0\u4ea4\u6216\u56de\u6eda\u3002</li> </ol> <p></p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_17","title":"\u5b9e\u73b0\u539f\u7406","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#xa_1","title":"XA\u4e24\u9636\u6bb5\u4e8b\u52a1","text":"<p><code>XAShardingTransactionManager</code> \u4e3aApache ShardingSphere \u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684XA\u5b9e\u73b0\u7c7b\u3002 \u5b83\u4e3b\u8981\u8d1f\u8d23\u5bf9\u591a\u6570\u636e\u6e90\u8fdb\u884c\u7ba1\u7406\u548c\u9002\u914d\uff0c\u5e76\u4e14\u5c06\u76f8\u5e94\u4e8b\u52a1\u7684\u5f00\u542f\u3001\u63d0\u4ea4\u548c\u56de\u6eda\u64cd\u4f5c\u59d4\u6258\u7ed9\u5177\u4f53\u7684 XA \u4e8b\u52a1\u7ba1\u7406\u5668\u3002</p> <p></p> <p>\u5f00\u542f\u5168\u5c40\u4e8b\u52a1</p> <p>\u6536\u5230\u63a5\u5165\u7aef\u7684 <code>set autoCommit=0</code> \u65f6\uff0c<code>XAShardingTransactionManager</code> \u5c06\u8c03\u7528\u5177\u4f53\u7684 XA \u4e8b\u52a1\u7ba1\u7406\u5668\u5f00\u542f XA \u5168\u5c40\u4e8b\u52a1\uff0c\u4ee5 XID \u7684\u5f62\u5f0f\u8fdb\u884c\u6807\u8bb0\u3002</p> <p>\u6267\u884c\u771f\u5b9e\u5206\u7247SQL</p> <p><code>XAShardingTransactionManager</code>\u5c06\u6570\u636e\u5e93\u8fde\u63a5\u6240\u5bf9\u5e94\u7684 XAResource \u6ce8\u518c\u5230\u5f53\u524d XA \u4e8b\u52a1\u4e2d\u4e4b\u540e\uff0c\u4e8b\u52a1\u7ba1\u7406\u5668\u4f1a\u5728\u6b64\u9636\u6bb5\u53d1\u9001 <code>XAResource.start</code> \u547d\u4ee4\u81f3\u6570\u636e\u5e93\u3002 \u6570\u636e\u5e93\u5728\u6536\u5230 <code>XAResource.end</code> \u547d\u4ee4\u4e4b\u524d\u7684\u6240\u6709 SQL \u64cd\u4f5c\uff0c\u4f1a\u88ab\u6807\u8bb0\u4e3a XA \u4e8b\u52a1\u3002</p> <pre><code>XAResource1.start             ## Enlist\u9636\u6bb5\u6267\u884c\nstatement.execute(\"sql1\");    ## \u6a21\u62df\u6267\u884c\u4e00\u4e2a\u5206\u7247SQL1\nstatement.execute(\"sql2\");    ## \u6a21\u62df\u6267\u884c\u4e00\u4e2a\u5206\u7247SQL2\nXAResource1.end               ## \u63d0\u4ea4\u9636\u6bb5\u6267\u884c\n</code></pre> <p>\u63d0\u4ea4\u6216\u56de\u6eda\u4e8b\u52a1</p> <p><code>XAShardingTransactionManager</code> \u5728\u63a5\u6536\u5230\u63a5\u5165\u7aef\u7684\u63d0\u4ea4\u547d\u4ee4\u540e\uff0c\u4f1a\u59d4\u6258\u5b9e\u9645\u7684 XA \u4e8b\u52a1\u7ba1\u7406\u8fdb\u884c\u63d0\u4ea4\u52a8\u4f5c\uff0c \u4e8b\u52a1\u7ba1\u7406\u5668\u5c06\u6536\u96c6\u5230\u7684\u5f53\u524d\u7ebf\u7a0b\u4e2d\u6240\u6709\u6ce8\u518c\u7684 XAResource\uff0c\u5e76\u53d1\u9001 <code>XAResource.end</code> \u6307\u4ee4\uff0c\u7528\u4ee5\u6807\u8bb0\u6b64 XA \u4e8b\u52a1\u8fb9\u754c\u3002 \u63a5\u7740\u4f1a\u4f9d\u6b21\u53d1\u9001 <code>prepare</code> \u6307\u4ee4\uff0c\u6536\u96c6\u6240\u6709\u53c2\u4e0e XAResource \u6295\u7968\u3002 \u82e5\u6240\u6709 XAResource \u7684\u53cd\u9988\u7ed3\u679c\u5747\u4e3a\u6b63\u786e\uff0c\u5219\u8c03\u7528 <code>commit</code> \u6307\u4ee4\u8fdb\u884c\u6700\u7ec8\u63d0\u4ea4\uff1b \u82e5\u6709\u4efb\u610f XAResource \u7684\u53cd\u9988\u7ed3\u679c\u4e0d\u6b63\u786e\uff0c\u5219\u8c03\u7528 <code>rollback</code> \u6307\u4ee4\u8fdb\u884c\u56de\u6eda\u3002 \u5728\u4e8b\u52a1\u7ba1\u7406\u5668\u53d1\u51fa\u63d0\u4ea4\u6307\u4ee4\u540e\uff0c\u4efb\u4f55 XAResource \u4ea7\u751f\u7684\u5f02\u5e38\u90fd\u4f1a\u901a\u8fc7\u6062\u590d\u65e5\u5fd7\u8fdb\u884c\u91cd\u8bd5\uff0c\u4ee5\u4fdd\u8bc1\u63d0\u4ea4\u9636\u6bb5\u7684\u64cd\u4f5c\u539f\u5b50\u6027\uff0c\u548c\u6570\u636e\u5f3a\u4e00\u81f4\u6027\u3002</p> <pre><code>XAResource1.prepare           ## ack: yes\nXAResource2.prepare           ## ack: yes\nXAResource1.commit\nXAResource2.commit\n\nXAResource1.prepare           ## ack: yes\nXAResource2.prepare           ## ack: no\nXAResource1.rollback\nXAResource2.rollback\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#seata_1","title":"Seata \u67d4\u6027\u4e8b\u52a1","text":"<p>\u6574\u5408 Seata AT \u4e8b\u52a1\u65f6\uff0c\u9700\u8981\u5c06 TM\uff0cRM \u548c TC \u7684\u6a21\u578b\u878d\u5165 Apache ShardingSphere \u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u751f\u6001\u4e2d\u3002 \u5728\u6570\u636e\u5e93\u8d44\u6e90\u4e0a\uff0cSeata \u901a\u8fc7\u5bf9\u63a5 <code>DataSource</code> \u63a5\u53e3\uff0c\u8ba9 JDBC \u64cd\u4f5c\u53ef\u4ee5\u540c TC \u8fdb\u884c\u8fdc\u7a0b\u901a\u4fe1\u3002 \u540c\u6837\uff0cApache ShardingSphere \u4e5f\u662f\u9762\u5411 <code>DataSource</code> \u63a5\u53e3\uff0c\u5bf9\u7528\u6237\u914d\u7f6e\u7684\u6570\u636e\u6e90\u8fdb\u884c\u805a\u5408\u3002 \u56e0\u6b64\uff0c\u5c06 <code>DataSource</code> \u5c01\u88c5\u4e3a \u57fa\u4e8eSeata \u7684 <code>DataSource</code> \u540e\uff0c\u5c31\u53ef\u4ee5\u5c06 Seata AT \u4e8b\u52a1\u878d\u5165\u5230 Apache ShardingSphere\u7684\u5206\u7247\u751f\u6001\u4e2d\u3002</p> <p></p> <p>\u5f15\u64ce\u521d\u59cb\u5316</p> <p>\u5305\u542b Seata \u67d4\u6027\u4e8b\u52a1\u7684\u5e94\u7528\u542f\u52a8\u65f6\uff0c\u7528\u6237\u914d\u7f6e\u7684\u6570\u636e\u6e90\u4f1a\u6839\u636e <code>seata.conf</code> \u7684\u914d\u7f6e\uff0c\u9002\u914d\u4e3a Seata \u4e8b\u52a1\u6240\u9700\u7684 <code>DataSourceProxy</code>\uff0c\u5e76\u4e14\u6ce8\u518c\u81f3 RM \u4e2d\u3002</p> <p>\u5f00\u542f\u5168\u5c40\u4e8b\u52a1</p> <p>TM \u63a7\u5236\u5168\u5c40\u4e8b\u52a1\u7684\u8fb9\u754c\uff0cTM \u901a\u8fc7\u5411 TC \u53d1\u9001 Begin \u6307\u4ee4\uff0c\u83b7\u53d6\u5168\u5c40\u4e8b\u52a1 ID\uff0c\u6240\u6709\u5206\u652f\u4e8b\u52a1\u901a\u8fc7\u6b64\u5168\u5c40\u4e8b\u52a1 ID\uff0c\u53c2\u4e0e\u5230\u5168\u5c40\u4e8b\u52a1\u4e2d\uff1b\u5168\u5c40\u4e8b\u52a1 ID \u7684\u4e0a\u4e0b\u6587\u5b58\u653e\u5728\u5f53\u524d\u7ebf\u7a0b\u53d8\u91cf\u4e2d\u3002</p> <p>\u6267\u884c\u771f\u5b9e\u5206\u7247SQL</p> <p>\u5904\u4e8e Seata \u5168\u5c40\u4e8b\u52a1\u4e2d\u7684\u5206\u7247 SQL \u901a\u8fc7 RM \u751f\u6210 undo \u5feb\u7167\uff0c\u5e76\u4e14\u53d1\u9001 <code>participate</code> \u6307\u4ee4\u81f3 TC\uff0c\u52a0\u5165\u5230\u5168\u5c40\u4e8b\u52a1\u4e2d\u3002 \u7531\u4e8e Apache ShardingSphere \u7684\u5206\u7247\u7269\u7406 SQL \u91c7\u53d6\u591a\u7ebf\u7a0b\u65b9\u5f0f\u6267\u884c\uff0c\u56e0\u6b64\u6574\u5408 Seata AT \u4e8b\u52a1\u65f6\uff0c\u9700\u8981\u5728\u4e3b\u7ebf\u7a0b\u548c\u5b50\u7ebf\u7a0b\u95f4\u8fdb\u884c\u5168\u5c40\u4e8b\u52a1 ID \u7684\u4e0a\u4e0b\u6587\u4f20\u9012\u3002</p> <p>\u63d0\u4ea4\u6216\u56de\u6eda\u4e8b\u52a1</p> <p>\u63d0\u4ea4 Seata \u4e8b\u52a1\u65f6\uff0cTM \u4f1a\u5411 TC \u53d1\u9001\u5168\u5c40\u4e8b\u52a1\u7684\u63d0\u4ea4\u6216\u56de\u6eda\u6307\u4ee4\uff0cTC \u6839\u636e\u5168\u5c40\u4e8b\u52a1 ID \u534f\u8c03\u6240\u6709\u5206\u652f\u4e8b\u52a1\u8fdb\u884c\u63d0\u4ea4\u6216\u56de\u6eda\u3002</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_18","title":"\u5206\u5e03\u5f0f\u6cbb\u7406","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_19","title":"\u6cbb\u7406","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_20","title":"\u914d\u7f6e\u4e2d\u5fc3","text":"<p>\u914d\u7f6e\u4e2d\u5fc3\u6570\u636e\u7ed3\u6784</p> <p>\u914d\u7f6e\u4e2d\u5fc3\u5728\u5b9a\u4e49\u7684\u547d\u540d\u7a7a\u95f4\u4e0b\uff0c\u4ee5 YAML \u683c\u5f0f\u5b58\u50a8\uff0c\u5305\u62ec\u6570\u636e\u6e90\u4fe1\u606f\uff0c\u89c4\u5219\u4fe1\u606f\u3001\u6743\u9650\u914d\u7f6e\u548c\u5c5e\u6027\u914d\u7f6e\uff0c\u53ef\u901a\u8fc7\u4fee\u6539\u8282\u70b9\u6765\u5b9e\u73b0\u5bf9\u4e8e\u914d\u7f6e\u7684\u52a8\u6001\u7ba1\u7406\u3002</p> <pre><code>namespace\n    \u251c\u2500\u2500authentication                            # \u6743\u9650\u914d\u7f6e\n    \u251c\u2500\u2500props                                     # \u5c5e\u6027\u914d\u7f6e\n    \u251c\u2500\u2500schemas                                   # Schema \u914d\u7f6e\n    \u251c      \u251c\u2500\u2500${schema_1}                        # Schema \u540d\u79f01\n    \u251c      \u251c      \u251c\u2500\u2500datasource                  # \u6570\u636e\u6e90\u914d\u7f6e\n    \u251c      \u251c      \u251c\u2500\u2500rule                        # \u89c4\u5219\u914d\u7f6e\n    \u251c      \u251c      \u251c\u2500\u2500table                       # \u8868\u7ed3\u6784\u914d\u7f6e\n    \u251c      \u251c\u2500\u2500${schema_2}                        # Schema \u540d\u79f02\n    \u251c      \u251c      \u251c\u2500\u2500datasource                  # \u6570\u636e\u6e90\u914d\u7f6e\n    \u251c      \u251c      \u251c\u2500\u2500rule                        # \u89c4\u5219\u914d\u7f6e\n    \u251c      \u251c      \u251c\u2500\u2500table                       # \u8868\u7ed3\u6784\u914d\u7f6e\n</code></pre> <p>/authentication</p> <p>\u6743\u9650\u914d\u7f6e\uff0c\u53ef\u914d\u7f6e\u8bbf\u95ee ShardingSphere-Proxy \u7684\u7528\u6237\u540d\u548c\u5bc6\u7801</p> <pre><code>username: root\npassword: root\n</code></pre> <p>/props</p> <p>\u5c5e\u6027\u914d\u7f6e\uff0c\u8be6\u60c5\u8bf7\u53c2\u89c1\u914d\u7f6e\u624b\u518c\u3002</p> <pre><code>executor-size: 20\nsql-show: true\n</code></pre> <p>/schemas/${schemeName}/datasource</p> <p>\u591a\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7684\u96c6\u5408\uff0c\u4e0d\u540c\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u5c5e\u6027\u81ea\u9002\u914d\uff08\u4f8b\u5982\uff1aDBCP\uff0cC3P0\uff0cDruid, HikariCP\uff09\u3002</p> <pre><code>dataSources:\n  ds_0: \n    dataSourceClassName: com.zaxxer.hikari.HikariDataSource\n    props:\n      url: jdbc:mysql://127.0.0.1:3306/demo_ds_0?serverTimezone=UTC&amp;useSSL=false\n      password: null\n      maxPoolSize: 50\n      maintenanceIntervalMilliseconds: 30000\n      connectionTimeoutMilliseconds: 30000\n      idleTimeoutMilliseconds: 60000\n      minPoolSize: 1\n      username: root\n      maxLifetimeMilliseconds: 1800000\n  ds_1: \n    dataSourceClassName: com.zaxxer.hikari.HikariDataSource\n    props:\n      url: jdbc:mysql://127.0.0.1:3306/demo_ds_1?serverTimezone=UTC&amp;useSSL=false\n      password: null\n      maxPoolSize: 50\n      maintenanceIntervalMilliseconds: 30000\n      connectionTimeoutMilliseconds: 30000\n      idleTimeoutMilliseconds: 60000\n      minPoolSize: 1\n      username: root\n      maxLifetimeMilliseconds: 1800000\n</code></pre> <p>/schemas/${schemeName}/rule</p> <p>\u89c4\u5219\u914d\u7f6e\uff0c\u53ef\u5305\u62ec\u6570\u636e\u5206\u7247\u3001\u8bfb\u5199\u5206\u79bb\u3001\u6570\u636e\u52a0\u5bc6\u3001\u5f71\u5b50\u5e93\u538b\u6d4b\u7b49\u914d\u7f6e\u3002</p> <pre><code>rules:\n- !SHARDING\n  xxx\n\n- !REPLICA_QUERY\n  xxx\n\n- !ENCRYPT\n  xxx\n</code></pre> <p>/schemas/${schemeName}/table</p> <p>\u8868\u7ed3\u6784\u914d\u7f6e\uff0c\u6682\u4e0d\u652f\u6301\u52a8\u6001\u4fee\u6539\u3002</p> <pre><code>tables:                                       # \u8868\n  t_order:                                    # \u8868\u540d\n    columns:                                  # \u5217\n      id:                                     # \u5217\u540d\n        caseSensitive: false\n        dataType: 0\n        generated: false\n        name: id\n        primaryKey: trues\n      order_id:\n        caseSensitive: false\n        dataType: 0\n         generated: false\n         name: order_id\n         primaryKey: false\n    indexs:                                   # \u7d22\u5f15\n      t_user_order_id_index:                  # \u7d22\u5f15\u540d\n        name: t_user_order_id_index\n  t_order_item:\n    columns:\n      order_id:\n        caseSensitive: false\n        dataType: 0\n        generated: false\n        name: order_id\n        primaryKey: false\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_21","title":"\u6ce8\u518c\u4e2d\u5fc3","text":"<p>\u6ce8\u518c\u4e2d\u5fc3\u6570\u636e\u7ed3\u6784</p> <p>\u6ce8\u518c\u4e2d\u5fc3\u5728\u5b9a\u4e49\u7684\u547d\u540d\u7a7a\u95f4\u7684 <code>states</code> \u8282\u70b9\u4e0b\uff0c\u521b\u5efa\u6570\u636e\u5e93\u8bbf\u95ee\u5bf9\u8c61\u8fd0\u884c\u8282\u70b9\uff0c\u7528\u4e8e\u533a\u5206\u4e0d\u540c\u6570\u636e\u5e93\u8bbf\u95ee\u5b9e\u4f8b\u3002\u5305\u62ec <code>proxynodes</code> \u548c <code>datanodes</code> \u8282\u70b9\u3002</p> <pre><code>namespace\n   \u251c\u2500\u2500states\n   \u251c    \u251c\u2500\u2500proxynodes\n   \u251c    \u251c     \u251c\u2500\u2500${your_instance_ip_a}@${your_instance_pid_x}@${UUID}\n   \u251c    \u251c     \u251c\u2500\u2500${your_instance_ip_b}@${your_instance_pid_y}@${UUID}\n   \u251c    \u251c     \u251c\u2500\u2500....\n   \u251c    \u251c\u2500\u2500datanodes\n   \u251c    \u251c     \u251c\u2500\u2500${schema_1}\n   \u251c    \u251c     \u251c      \u251c\u2500\u2500${ds_0}\n   \u251c    \u251c     \u251c      \u251c\u2500\u2500${ds_1}\n   \u251c    \u251c     \u251c\u2500\u2500${schema_2}\n   \u251c    \u251c     \u251c      \u251c\u2500\u2500${ds_0}\n   \u251c    \u251c     \u251c      \u251c\u2500\u2500${ds_1}\n   \u251c    \u251c     \u251c\u2500\u2500....\n</code></pre> <p>/states/proxynodes</p> <p>\u6570\u636e\u5e93\u8bbf\u95ee\u5bf9\u8c61\u8fd0\u884c\u5b9e\u4f8b\u4fe1\u606f\uff0c\u5b50\u8282\u70b9\u662f\u5f53\u524d\u8fd0\u884c\u5b9e\u4f8b\u7684\u6807\u8bc6\u3002 \u8fd0\u884c\u5b9e\u4f8b\u6807\u8bc6\u7531\u8fd0\u884c\u670d\u52a1\u5668\u7684 IP \u5730\u5740\u548c PID \u6784\u6210\u3002\u8fd0\u884c\u5b9e\u4f8b\u6807\u8bc6\u5747\u4e3a\u4e34\u65f6\u8282\u70b9\uff0c\u5f53\u5b9e\u4f8b\u4e0a\u7ebf\u65f6\u6ce8\u518c\uff0c\u4e0b\u7ebf\u65f6\u81ea\u52a8\u6e05\u7406\u3002 \u6ce8\u518c\u4e2d\u5fc3\u76d1\u63a7\u8fd9\u4e9b\u8282\u70b9\u7684\u53d8\u5316\u6765\u6cbb\u7406\u8fd0\u884c\u4e2d\u5b9e\u4f8b\u5bf9\u6570\u636e\u5e93\u7684\u8bbf\u95ee\u7b49\u3002</p> <p>/states/datanodes</p> <p>\u53ef\u4ee5\u6cbb\u7406\u8bfb\u5199\u5206\u79bb\u4ece\u5e93\uff0c\u53ef\u52a8\u6001\u6dfb\u52a0\u5220\u9664\u4ee5\u53ca\u7981\u7528\u3002</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_22","title":"\u5b89\u88c5\u4f7f\u7528","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#shardingsphere-jdbc_1","title":"ShardingSphere-JDBC","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#maven","title":"\u5f15\u5165maven\u4f9d\u8d56","text":"<pre><code># latest.release.version\u6362\u6210\u6307\u5b9a\u7248\u672c\n&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.shardingsphere&lt;/groupId&gt;\n    &lt;artifactId&gt;shardingsphere-jdbc-core&lt;/artifactId&gt;\n    &lt;version&gt;${latest.release.version}&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#yaml","title":"\u914d\u7f6e\u8bf4\u660e\uff08yaml\uff09","text":"<pre><code># \u6570\u636e\u5206\u7247\ndataSources: # \u7701\u7565\u6570\u636e\u6e90\u914d\u7f6e\n\nrules:\n- !SHARDING\n  tables: # \u6570\u636e\u5206\u7247\u89c4\u5219\u914d\u7f6e\n    &lt;logic-table-name&gt; (+): # \u903b\u8f91\u8868\u540d\u79f0\n      actualDataNodes (?): # \u7531\u6570\u636e\u6e90\u540d + \u8868\u540d\u7ec4\u6210\uff08\u53c2\u8003Inline\u8bed\u6cd5\u89c4\u5219\uff09\n      databaseStrategy (?): # \u5206\u5e93\u7b56\u7565\uff0c\u7f3a\u7701\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u5206\u5e93\u7b56\u7565\uff0c\u4ee5\u4e0b\u7684\u5206\u7247\u7b56\u7565\u53ea\u80fd\u9009\u5176\u4e00\n        standard: # \u7528\u4e8e\u5355\u5206\u7247\u952e\u7684\u6807\u51c6\u5206\u7247\u573a\u666f\n          shardingColumn: # \u5206\u7247\u5217\u540d\u79f0\n          shardingAlgorithmName: # \u5206\u7247\u7b97\u6cd5\u540d\u79f0\n        complex: # \u7528\u4e8e\u591a\u5206\u7247\u952e\u7684\u590d\u5408\u5206\u7247\u573a\u666f\n          shardingColumns: #\u5206\u7247\u5217\u540d\u79f0\uff0c\u591a\u4e2a\u5217\u4ee5\u9017\u53f7\u5206\u9694\n          shardingAlgorithmName: # \u5206\u7247\u7b97\u6cd5\u540d\u79f0\n        hint: # Hint \u5206\u7247\u7b56\u7565\n          shardingAlgorithmName: # \u5206\u7247\u7b97\u6cd5\u540d\u79f0\n        none: # \u4e0d\u5206\u7247\n      tableStrategy: # \u5206\u8868\u7b56\u7565\uff0c\u540c\u5206\u5e93\u7b56\u7565\n      keyGenerateStrategy: # \u5206\u5e03\u5f0f\u5e8f\u5217\u7b56\u7565\n        column: # \u81ea\u589e\u5217\u540d\u79f0\uff0c\u7f3a\u7701\u8868\u793a\u4e0d\u4f7f\u7528\u81ea\u589e\u4e3b\u952e\u751f\u6210\u5668\n        keyGeneratorName: # \u5206\u5e03\u5f0f\u5e8f\u5217\u7b97\u6cd5\u540d\u79f0\n  autoTables: # \u81ea\u52a8\u5206\u7247\u8868\u89c4\u5219\u914d\u7f6e\n    t_order_auto: # \u903b\u8f91\u8868\u540d\u79f0\n      actualDataSources (?): # \u6570\u636e\u6e90\u540d\u79f0\n      shardingStrategy: # \u5207\u5206\u7b56\u7565\n        standard: # \u7528\u4e8e\u5355\u5206\u7247\u952e\u7684\u6807\u51c6\u5206\u7247\u573a\u666f\n          shardingColumn: # \u5206\u7247\u5217\u540d\u79f0\n          shardingAlgorithmName: # \u81ea\u52a8\u5206\u7247\u7b97\u6cd5\u540d\u79f0\n  bindingTables (+): # \u7ed1\u5b9a\u8868\u89c4\u5219\u5217\u8868\n    - &lt;logic_table_name_1, logic_table_name_2, ...&gt; \n    - &lt;logic_table_name_1, logic_table_name_2, ...&gt; \n  broadcastTables (+): # \u5e7f\u64ad\u8868\u89c4\u5219\u5217\u8868\n    - &lt;table-name&gt;\n    - &lt;table-name&gt;\n  defaultDatabaseStrategy: # \u9ed8\u8ba4\u6570\u636e\u5e93\u5206\u7247\u7b56\u7565\n  defaultTableStrategy: # \u9ed8\u8ba4\u8868\u5206\u7247\u7b56\u7565\n  defaultKeyGenerateStrategy: # \u9ed8\u8ba4\u7684\u5206\u5e03\u5f0f\u5e8f\u5217\u7b56\u7565\n\n  # \u5206\u7247\u7b97\u6cd5\u914d\u7f6e\n  shardingAlgorithms:\n    &lt;sharding-algorithm-name&gt; (+): # \u5206\u7247\u7b97\u6cd5\u540d\u79f0\n      type: # \u5206\u7247\u7b97\u6cd5\u7c7b\u578b\n      props: # \u5206\u7247\u7b97\u6cd5\u5c5e\u6027\u914d\u7f6e\n      # ...\n\n  # \u5206\u5e03\u5f0f\u5e8f\u5217\u7b97\u6cd5\u914d\u7f6e\n  keyGenerators:\n    &lt;key-generate-algorithm-name&gt; (+): # \u5206\u5e03\u5f0f\u5e8f\u5217\u7b97\u6cd5\u540d\u79f0\n      type: # \u5206\u5e03\u5f0f\u5e8f\u5217\u7b97\u6cd5\u7c7b\u578b\n      props: # \u5206\u5e03\u5f0f\u5e8f\u5217\u7b97\u6cd5\u5c5e\u6027\u914d\u7f6e\n      # ...\n\nprops:\n  # ...\n\n# \u8bfb\u5199\u5206\u79bb\ndataSources: # \u7701\u7565\u6570\u636e\u6e90\u914d\u7f6e\n\nrules:\n- !REPLICA_QUERY\n  dataSources:\n    &lt;data-source-name&gt; (+): # \u8bfb\u5199\u5206\u79bb\u903b\u8f91\u6570\u636e\u6e90\u540d\u79f0\n      primaryDataSourceName: # \u4e3b\u5e93\u6570\u636e\u6e90\u540d\u79f0\n      replicaDataSourceNames: \n        - &lt;replica-data_source-name&gt; (+) # \u4ece\u5e93\u6570\u636e\u6e90\u540d\u79f0\n      loadBalancerName: # \u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u540d\u79f0\n\n  # \u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u914d\u7f6e\n  loadBalancers:\n    &lt;load-balancer-name&gt; (+): # \u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u540d\u79f0\n      type: # \u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u7c7b\u578b\n      props: # \u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u5c5e\u6027\u914d\u7f6e\n        # ...\n\nprops:\n  # ...\n\n# \u6570\u636e\u52a0\u5bc6\ndataSource: # \u7701\u7565\u6570\u636e\u6e90\u914d\u7f6e\n\nrules:\n- !ENCRYPT\n  tables:\n    &lt;table-name&gt; (+): # \u52a0\u5bc6\u8868\u540d\u79f0\n      columns:\n        &lt;column-name&gt; (+): # \u52a0\u5bc6\u5217\u540d\u79f0\n          cipherColumn: # \u5bc6\u6587\u5217\u540d\u79f0\n          assistedQueryColumn (?):  # \u67e5\u8be2\u8f85\u52a9\u5217\u540d\u79f0\n          plainColumn (?): # \u539f\u6587\u5217\u540d\u79f0\n          encryptorName: # \u52a0\u5bc6\u7b97\u6cd5\u540d\u79f0\n\n  # \u52a0\u5bc6\u7b97\u6cd5\u914d\u7f6e\n  encryptors:\n    &lt;encrypt-algorithm-name&gt; (+): # \u52a0\u89e3\u5bc6\u7b97\u6cd5\u540d\u79f0\n      type: # \u52a0\u89e3\u5bc6\u7b97\u6cd5\u7c7b\u578b\n      props: # \u52a0\u89e3\u5bc6\u7b97\u6cd5\u5c5e\u6027\u914d\u7f6e\n        # ...\n\nprops:\n  # ...\n\n# \u5f71\u5b50\u5e93\ndataSources: #\u7701\u7565\u6570\u636e\u6e90\u914d\u7f6e\n\nrules:\n- !SHADOW\n  column: # \u5f71\u5b50\u5b57\u6bb5\u540d\n  sourceDataSourceNames: # \u5f71\u5b50\u524d\u6570\u636e\u5e93\u540d\n     # ...\n  shadowDataSourceNames: # \u5bf9\u5e94\u7684\u5f71\u5b50\u5e93\u540d\n     # ... \n\nprops:\n  # ...\n\n# \u5206\u5e03\u5f0f\u6cbb\u7406\ngovernance:  \n  name: # \u6cbb\u7406\u540d\u79f0\n  registryCenter: # \u914d\u7f6e\u4e2d\u5fc3\n    type: # \u6cbb\u7406\u6301\u4e45\u5316\u7c7b\u578b\u3002\u5982\uff1aZookeeper, etcd\n    serverLists: # \u6cbb\u7406\u670d\u52a1\u5217\u8868\u3002\u5305\u62ec IP \u5730\u5740\u548c\u7aef\u53e3\u53f7\u3002\u591a\u4e2a\u5730\u5740\u7528\u9017\u53f7\u5206\u9694\u3002\u5982: host1:2181,host2:2181 \n  additionalConfigCenter:\n    type: # \u6cbb\u7406\u6301\u4e45\u5316\u7c7b\u578b\u3002\u5982\uff1aZookeeper, etcd, Nacos, Apollo\n    serverLists: # \u6cbb\u7406\u670d\u52a1\u5217\u8868\u3002\u5305\u62ec IP \u5730\u5740\u548c\u7aef\u53e3\u53f7\u3002\u591a\u4e2a\u5730\u5740\u7528\u9017\u53f7\u5206\u9694\u3002\u5982: host1:2181,host2:2181 \n  overwrite: # \u672c\u5730\u914d\u7f6e\u662f\u5426\u8986\u76d6\u914d\u7f6e\u4e2d\u5fc3\u914d\u7f6e\u3002\u5982\u679c\u53ef\u8986\u76d6\uff0c\u6bcf\u6b21\u542f\u52a8\u90fd\u4ee5\u672c\u5730\u914d\u7f6e\u4e3a\u51c6\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_23","title":"\u89c4\u5219\u914d\u7f6e","text":"<p>ShardingSphere-JDBC \u7684 YAML \u914d\u7f6e\u6587\u4ef6 \u901a\u8fc7\u6570\u636e\u6e90\u96c6\u5408\u3001\u89c4\u5219\u96c6\u5408\u4ee5\u53ca\u5c5e\u6027\u914d\u7f6e\u7ec4\u6210\u3002 \u4ee5\u4e0b\u793a\u4f8b\u662f\u6839\u636e <code>user_id</code> \u53d6\u6a21\u5206\u5e93, \u4e14\u6839\u636e <code>order_id</code> \u53d6\u6a21\u5206\u8868\u7684 2 \u5e93 2 \u8868\u7684\u914d\u7f6e\u3002</p> <pre><code># \u914d\u7f6e\u771f\u5b9e\u6570\u636e\u6e90\ndataSources:\n  # \u914d\u7f6e\u7b2c 1 \u4e2a\u6570\u636e\u6e90\n  ds0: !!org.apache.commons.dbcp2.BasicDataSource\n    driverClassName: com.mysql.jdbc.Driver\n    url: jdbc:mysql://localhost:3306/ds0\n    username: root\n    password:\n  # \u914d\u7f6e\u7b2c 2 \u4e2a\u6570\u636e\u6e90\n  ds1: !!org.apache.commons.dbcp2.BasicDataSource\n    driverClassName: com.mysql.jdbc.Driver\n    url: jdbc:mysql://localhost:3306/ds1\n    username: root\n    password:\n\nrules:\n  # \u914d\u7f6e\u5206\u7247\u89c4\u5219\n  - !SHARDING\n    tables:\n      # \u914d\u7f6e t_order \u8868\u89c4\u5219\n      t_order:\n        actualDataNodes: ds${0..1}.t_order${0..1}\n        # \u914d\u7f6e\u5206\u5e93\u7b56\u7565\n        databaseStrategy:\n          standard:\n            shardingColumn: user_id\n            shardingAlgorithmName: database_inline\n        # \u914d\u7f6e\u5206\u8868\u7b56\u7565\n        tableStrategy:\n          standard:\n            shardingColumn: order_id\n            shardingAlgorithmName: table_inline\n      t_order_item:\n      # \u7701\u7565\u914d\u7f6e t_order_item \u8868\u89c4\u5219...\n      # ...\n\n    # \u914d\u7f6e\u5206\u7247\u7b97\u6cd5\n    shardingAlgorithms:\n      database_inline:\n        type: INLINE\n        props:\n          algorithm-expression: ds${user_id % 2}\n      table_inline:\n        type: INLINE\n        props:\n          algorithm-expression: t_order_${order_id % 2}\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_24","title":"\u5b89\u88c5","text":"<p>\u4e0b\u8f7d\u5730\u5740\uff1ahttps://archive.apache.org/dist/shardingsphere/</p> <pre><code># \u4e0b\u8f7d\nwget https://archive.apache.org/dist/shardingsphere/4.1.1/apache-shardingsphere-4.1.1-sharding-jdbc-bin.tar.gz -P /usr/local/src\n</code></pre> <p>\u901a\u8fc7 YamlGovernanceShardingSphereDataSourceFactory \u5de5\u5382\u521b\u5efa\u7684 GovernanceShardingSphereDataSource \u5b9e\u73b0\u81ea JDBC \u7684\u6807\u51c6\u63a5\u53e3 DataSource\u3002</p> <pre><code>// \u6307\u5b9a YAML \u6587\u4ef6\u8def\u5f84\nFile yamlFile= // ...\n// \u521b\u5efa ShardingSphereDataSource\n        DataSource dataSource=YamlShardingSphereDataSourceFactory.createDataSource(yamlFile);\n</code></pre> <p>\u4f7f\u7528 ShardingSphereDataSource</p> <p>\u901a\u8fc7 YamlShardingSphereDataSourceFactory \u5de5\u5382\u521b\u5efa\u7684 ShardingSphereDataSource \u5b9e\u73b0\u81ea JDBC \u7684\u6807\u51c6\u63a5\u53e3 DataSource\u3002 \u53ef\u901a\u8fc7 DataSource \u9009\u62e9\u4f7f\u7528\u539f\u751f JDBC\uff0c\u6216JPA\uff0c MyBatis \u7b49 ORM \u6846\u67b6\u3002</p> <pre><code>DataSource dataSource=YamlShardingSphereDataSourceFactory.createDataSource(yamlFile);\n        String sql=\"SELECT i.* FROM t_order o JOIN t_order_item i ON o.order_id=i.order_id WHERE o.user_id=? AND o.order_id=?\";\n        try(\n        Connection conn=dataSource.getConnection();\n        PreparedStatement ps=conn.prepareStatement(sql)){\n        ps.setInt(1,10);\n        ps.setInt(2,1000);\n        try(ResultSet rs=preparedStatement.executeQuery()){\n        while(rs.next()){\n        // ...\n        }\n        }\n        }\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#shardingsphere-proxy_1","title":"Shardingsphere-Proxy","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_25","title":"\u914d\u7f6e\u8bf4\u660e","text":"<pre><code># \u6570\u636e\u6e90\u914d\u7f6e\nschemaName: # \u903b\u8f91\u6570\u636e\u6e90\u540d\u79f0\n\ndataSources: # \u6570\u636e\u6e90\u914d\u7f6e\uff0c\u53ef\u914d\u7f6e\u591a\u4e2a &lt;data-source-name&gt;\n  &lt;data-source-name&gt;: # \u4e0e ShardingSphere-JDBC \u914d\u7f6e\u4e0d\u540c\uff0c\u65e0\u9700\u914d\u7f6e\u6570\u636e\u5e93\u8fde\u63a5\u6c60\n    url: #\u6570\u636e\u5e93 URL \u8fde\u63a5\n    username: # \u6570\u636e\u5e93\u7528\u6237\u540d\n    password: # \u6570\u636e\u5e93\u5bc6\u7801\n    connectionTimeoutMilliseconds: # \u8fde\u63a5\u8d85\u65f6\u6beb\u79d2\u6570\n    idleTimeoutMilliseconds: # \u7a7a\u95f2\u8fde\u63a5\u56de\u6536\u8d85\u65f6\u6beb\u79d2\u6570\n    maxLifetimeMilliseconds: # \u8fde\u63a5\u6700\u5927\u5b58\u6d3b\u65f6\u95f4\u6beb\u79d2\u6570\n    maxPoolSize: 50 # \u6700\u5927\u8fde\u63a5\u6570\n    minPoolSize: 1  # \u6700\u5c0f\u8fde\u63a5\u6570     \n\nrules: # \u4e0e ShardingSphere-JDBC \u914d\u7f6e\u4e00\u81f4\n  # ...\n\n# \u6743\u9650\u914d\u7f6e\nauthentication:\n  users:\n    root: # \u81ea\u5b9a\u4e49\u7528\u6237\u540d\n      password: root # \u81ea\u5b9a\u4e49\u7528\u6237\u540d\n    sharding: # \u81ea\u5b9a\u4e49\u7528\u6237\u540d\n      password: sharding # \u81ea\u5b9a\u4e49\u7528\u6237\u540d\n      authorizedSchemas: sharding_db, replica_query_db # \u8be5\u7528\u6237\u6388\u6743\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u5e93\uff0c\u591a\u4e2a\u7528\u9017\u53f7\u5206\u9694\u3002\u7f3a\u7701\u5c06\u62e5\u6709 root \u6743\u9650\uff0c\u53ef\u8bbf\u95ee\u5168\u90e8\u6570\u636e\u5e93\u3002\n\n# \u5c5e\u6027\u914d\u7f6e\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_26","title":"\u914d\u7f6e\u89c4\u5219","text":"<pre><code>schemaName: # \u903b\u8f91\u6570\u636e\u6e90\u540d\u79f0\n\ndataSources: # \u6570\u636e\u6e90\u914d\u7f6e\uff0c\u53ef\u914d\u7f6e\u591a\u4e2a &lt;data-source-name&gt;\n  &lt;data-source-name&gt;: # \u4e0e ShardingSphere-JDBC \u914d\u7f6e\u4e0d\u540c\uff0c\u65e0\u9700\u914d\u7f6e\u6570\u636e\u5e93\u8fde\u63a5\u6c60\n    url: #\u6570\u636e\u5e93 URL \u8fde\u63a5\n    username: # \u6570\u636e\u5e93\u7528\u6237\u540d\n    password: # \u6570\u636e\u5e93\u5bc6\u7801\n    connectionTimeoutMilliseconds: # \u8fde\u63a5\u8d85\u65f6\u6beb\u79d2\u6570\n    idleTimeoutMilliseconds: # \u7a7a\u95f2\u8fde\u63a5\u56de\u6536\u8d85\u65f6\u6beb\u79d2\u6570\n    maxLifetimeMilliseconds: # \u8fde\u63a5\u6700\u5927\u5b58\u6d3b\u65f6\u95f4\u6beb\u79d2\u6570\n    maxPoolSize: 50 # \u6700\u5927\u8fde\u63a5\u6570\n    minPoolSize: 1  # \u6700\u5c0f\u8fde\u63a5\u6570     \n\nrules: # \u4e0e ShardingSphere-JDBC \u914d\u7f6e\u4e00\u81f4\n# ...\n\nauthentication:\n  users:\n    root: # \u81ea\u5b9a\u4e49\u7528\u6237\u540d\n      password: root # \u81ea\u5b9a\u4e49\u7528\u6237\u540d\n    sharding: # \u81ea\u5b9a\u4e49\u7528\u6237\u540d\n      password: sharding # \u81ea\u5b9a\u4e49\u7528\u6237\u540d\n      authorizedSchemas: sharding_db, replica_query_db # \u8be5\u7528\u6237\u6388\u6743\u53ef\u8bbf\u95ee\u7684\u6570\u636e\u5e93\uff0c\u591a\u4e2a\u7528\u9017\u53f7\u5206\u9694\u3002\u7f3a\u7701\u5c06\u62e5\u6709 root \u6743\u9650\uff0c\u53ef\u8bbf\u95ee\u5168\u90e8\u6570\u636e\u5e93\u3002\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_27","title":"\u5b89\u88c5","text":"<ul> <li>\u4e8c\u8fdb\u5236\u5b89\u88c5</li> </ul> <pre><code># \u4e0b\u8f7d\nwget https://archive.apache.org/dist/shardingsphere/4.1.1/apache-shardingsphere-4.1.1-sharding-proxy-bin.tar.gz -P /usr/local/src\n# \u521b\u5efa\u914d\u7f6e\n## \u5206\u7247\nschemaName: sharding_db\n\ndataSources:\n  ds_0:\n    url: jdbc:mysql://127.0.0.1:3306/demo_ds_0?serverTimezone=UTC&amp;useSSL=false\n    username: root\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 50\n  ds_1:\n    url: jdbc:mysql://127.0.0.1:3306/demo_ds_1?serverTimezone=UTC&amp;useSSL=false\n    username: root\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 50\n\nshardingRule:\n  tables:\n    t_order:\n      actualDataNodes: ds_${0..1}.t_order_${0..1}\n      tableStrategy:\n        inline:\n          shardingColumn: order_id\n          algorithmExpression: t_order_${order_id % 2}\n      keyGenerator:\n        type: SNOWFLAKE\n        column: order_id\n    t_order_item:\n      actualDataNodes: ds_${0..1}.t_order_item_${0..1}\n      tableStrategy:\n        inline:\n          shardingColumn: order_id\n          algorithmExpression: t_order_item_${order_id % 2}\n      keyGenerator:\n        type: SNOWFLAKE\n        column: order_item_id\n  bindingTables:\n    - t_order,t_order_item\n  defaultDatabaseStrategy:\n    inline:\n      shardingColumn: user_id\n      algorithmExpression: ds_${user_id % 2}\n  defaultTableStrategy:\n    none:\n## \u4e3b\u4ece\nschemaName: master_slave_db\n\ndataSources:\n  master_ds:\n    url: jdbc:mysql://127.0.0.1:3306/demo_ds_master?serverTimezone=UTC&amp;useSSL=false\n    username: root\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 50\n  slave_ds_0:\n    url: jdbc:mysql://127.0.0.1:3306/demo_ds_slave_0?serverTimezone=UTC&amp;useSSL=false\n    username: root\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 50\n  slave_ds_1:\n    url: jdbc:mysql://127.0.0.1:3306/demo_ds_slave_1?serverTimezone=UTC&amp;useSSL=false\n    username: root\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 50\n\nmasterSlaveRule:\n  name: ms_ds\n  masterDataSourceName: master_ds\n  slaveDataSourceNames:\n    - slave_ds_0\n    - slave_ds_1\n## \u52a0\u5bc6\nschemaName: encrypt_db\n\ndataSource:\n  url: jdbc:mysql://127.0.0.1:3306/demo_ds?serverTimezone=UTC&amp;useSSL=false\n  username: root\n  password:\n  connectionTimeoutMilliseconds: 30000\n  idleTimeoutMilliseconds: 60000\n  maxLifetimeMilliseconds: 1800000\n  maxPoolSize: 50\n\nencryptRule:\n  encryptors:\n    encryptor_aes:\n      type: aes\n      props:\n        aes.key.value: 123456abc\n    encryptor_md5:\n      type: md5\n  tables:\n    t_encrypt:\n      columns:\n        user_id:\n          plainColumn: user_plain\n          cipherColumn: user_cipher\n          encryptor: encryptor_aes\n        order_id:\n          cipherColumn: order_cipher\n          encryptor: encryptor_md5\n# \u62f7\u8d1dmysql\u9a71\u52a8\u5305\nwget https://repo1.maven.org/maven2/mysql/mysql-connector-java/8.0.23/mysql-connector-java-8.0.23.jar -P /${work_dir}/ext-lib\n# \u914d\u7f6e\ncat &gt; /${work_dir}/conf/server.yaml &lt;&lt;- 'EOF'\n#orchestration:\n#  orchestration_ds:\n#    orchestrationType: registry_center,config_center,distributed_lock_manager\n#    instanceType: zookeeper\n#    serverLists: localhost:2181\n#    namespace: orchestration\n#    props:\n#      overwrite: false\n#      retryIntervalMilliseconds: 500\n#      timeToLiveSeconds: 60\n#      maxRetries: 3\n#      operationTimeoutMilliseconds: 500\n#\nauthentication:\n  users:\n    sharding:\n      password: sharding\n      authorizedSchemas: sharding_db\n\nprops:\n  max.connections.size.per.query: 1\n  acceptor.size: 16  # The default value is available processors count * 2.\n  executor.size: 16  # Infinite by default.\n  proxy.frontend.flush.threshold: 128  # The default value is 128.\n    # LOCAL: Proxy will run with LOCAL transaction.\n    # XA: Proxy will run with XA transaction.\n    # BASE: Proxy will run with B.A.S.E transaction.\n  proxy.transaction.type: LOCAL\n  proxy.opentracing.enabled: false\n  proxy.hint.enabled: false\n  query.with.cipher.column: true\n  sql.show: false\n  allow.range.query.with.inline.sharding: false\nEOF\ncat &gt; /${work_dir}/conf/config-sharding.yaml &lt;&lt;- 'EOF'\nschemaName: sharding_db\n\ndataSources:\n  ds_0:\n    url: jdbc:mysql://127.0.0.1:3306/ds_0?serverTimezone=UTC&amp;useSSL=false\n    username: root\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 50\n  ds_1:\n    url: jdbc:mysql://127.0.0.1:3306/ds_1?serverTimezone=UTC&amp;useSSL=false\n    username: root\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 50\n\nshardingRule:\n  tables:\n    t_order:\n      actualDataNodes: ds_${0..1}.tbl${0..1}\n      tableStrategy:\n        inline:\n          shardingColumn: k\n          algorithmExpression: tbl_${order_id % 2}\n      keyGenerator:\n        type: SNOWFLAKE\n        column: id\n    t_order_item:\n      actualDataNodes: ds_${0..1}.t_order_item_${0..1}\n      tableStrategy:\n        inline:\n          shardingColumn: order_id\n          algorithmExpression: t_order_item_${order_id % 2}\n      keyGenerator:\n        type: SNOWFLAKE\n        column: order_item_id\n  bindingTables:\n    - t_order,t_order_item\n  defaultDatabaseStrategy:\n    inline:\n      shardingColumn: user_id\n      algorithmExpression: ds_${user_id % 2}\n  defaultTableStrategy:\n    none:\nEOF\n# \u547d\u4ee4\u884c\u542f\u52a8\n./bin/start.sh\n# \u521b\u5efa\u8d26\u53f7\ngroupadd shardingproxy\nuseradd shardingproxy -g shardingproxy -s /sbin/nologin\n# \u914d\u7f6esystemd\u542f\u52a8\ncat &gt; /usr/lib/systemd/system/shardingproxy.service &lt;&lt;- 'EOF'\n[Unit]\nDescription=shardingproxy\nAfter=network.target\n\n[Service]\nUser=shardingproxy\nGroup=shardingproxy\nTimeoutStartSec=30\nExecStart=/usr/local/bin/start.sh\nExecStop=/bin/kill $MAINPID\nRestart=on-failure\n\n[Install]\nWantedBy=multi-user.target\nEOF\n# \u542f\u52a8shardingsphere\nsystemctl enable shardingproxy\nsystemctl enable shardingproxy\n# \u914d\u7f6e\u63a5\u5165skywalking\nskywalking_agent=\"-Dskywalking.agent.service_name=${SKYWALKING_SERVICE_NAME} \n-Dskywalking.agent.instance_name=$(ip a |grep eth0|grep inet|awk '{print $2}'|awk -F / '{print $1}') -javaagent:/opt/skywalking/agent/skywalking-agent.jar\"\nPROJECT_OPTS=\"${JAVA_OPTS} -Djava.security.egd=file:/dev/./urandom -jar\" \njava $JAVA_OPTS  $skywalking_agent $PROJECT_OPTS -jar /apps/app.jar\n</code></pre> <ul> <li>docker \u5b89\u88c5</li> </ul> <pre><code># \u62c9\u53d6\u955c\u50cf\ndocker pull apache/shardingsphere-proxy:4.1.1\n# \u624b\u52a8\u6784\u5efa\ngit clone https://github.com/apache/shardingsphere\nmvn clean install\ncd shardingsphere-distribution/shardingsphere-proxy-distribution\nmvn clean package -Prelease,docker\n# \u914d\u7f6e\ncat &gt; conf/server.yaml &lt;&lt;- 'EOF'\n#orchestration:\n#  orchestration_ds:\n#    orchestrationType: registry_center,config_center,distributed_lock_manager\n#    instanceType: zookeeper\n#    serverLists: localhost:2181\n#    namespace: orchestration\n#    props:\n#      overwrite: false\n#      retryIntervalMilliseconds: 500\n#      timeToLiveSeconds: 60\n#      maxRetries: 3\n#      operationTimeoutMilliseconds: 500\n#\nauthentication:\n  users:\n    sharding:\n      password: sharding\n      authorizedSchemas: sharding_db\n\nprops:\n  max.connections.size.per.query: 1\n  acceptor.size: 16  # The default value is available processors count * 2.\n  executor.size: 16  # Infinite by default.\n  proxy.frontend.flush.threshold: 128  # The default value is 128.\n    # LOCAL: Proxy will run with LOCAL transaction.\n    # XA: Proxy will run with XA transaction.\n    # BASE: Proxy will run with B.A.S.E transaction.\n  proxy.transaction.type: LOCAL\n  proxy.opentracing.enabled: false\n  proxy.hint.enabled: false\n  query.with.cipher.column: true\n  sql.show: false\n  allow.range.query.with.inline.sharding: false\nEOF\ncat &gt; conf/config-sharding.yaml &lt;&lt;- 'EOF'\nschemaName: sharding_db\n\ndataSources:\n  ds_0:\n    url: jdbc:mysql://127.0.0.1:3306/demo_ds_0?serverTimezone=UTC&amp;useSSL=false\n    username: root\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 50\n  ds_1:\n    url: jdbc:mysql://127.0.0.1:3306/demo_ds_1?serverTimezone=UTC&amp;useSSL=false\n    username: root\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 50\n\nshardingRule:\n  tables:\n    t_order:\n      actualDataNodes: ds_${0..1}.t_order_${0..1}\n      tableStrategy:\n        inline:\n          shardingColumn: order_id\n          algorithmExpression: t_order_${order_id % 2}\n      keyGenerator:\n        type: SNOWFLAKE\n        column: order_id\n    t_order_item:\n      actualDataNodes: ds_${0..1}.t_order_item_${0..1}\n      tableStrategy:\n        inline:\n          shardingColumn: order_id\n          algorithmExpression: t_order_item_${order_id % 2}\n      keyGenerator:\n        type: SNOWFLAKE\n        column: order_item_id\n  bindingTables:\n    - t_order,t_order_item\n  defaultDatabaseStrategy:\n    inline:\n      shardingColumn: user_id\n      algorithmExpression: ds_${user_id % 2}\n  defaultTableStrategy:\n    none:\nEOF\ncat &gt; conf/logback.xml &lt;&lt;- 'EOF'\n&lt;?xml version=\"1.0\"?&gt;\n&lt;!--\n  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n  ~ contributor license agreements.  See the NOTICE file distributed with\n  ~ this work for additional information regarding copyright ownership.\n  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n  ~ (the \"License\"); you may not use this file except in compliance with\n  ~ the License.  You may obtain a copy of the License at\n  ~\n  ~     http://www.apache.org/licenses/LICENSE-2.0\n  ~\n  ~ Unless required by applicable law or agreed to in writing, software\n  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n  ~ See the License for the specific language governing permissions and\n  ~ limitations under the License.\n  --&gt;\n\n&lt;configuration&gt;\n    &lt;appender name=\"console\" class=\"ch.qos.logback.core.ConsoleAppender\"&gt;\n        &lt;encoder&gt;\n            &lt;pattern&gt;[%-5level] %d{HH:mm:ss.SSS} [%thread] %logger{36} - %msg%n&lt;/pattern&gt;\n        &lt;/encoder&gt;\n    &lt;/appender&gt;\n    &lt;logger name=\"org.apache.shardingsphere\" level=\"info\" additivity=\"false\"&gt;\n        &lt;appender-ref ref=\"console\"/&gt;\n    &lt;/logger&gt;\n\n    &lt;root&gt;\n        &lt;level value=\"info\" /&gt;\n        &lt;appender-ref ref=\"console\" /&gt;\n    &lt;/root&gt;\n&lt;/configuration&gt;\nEOF\n# \u62f7\u8d1dmysql \u9a71\u52a8\u5305\ncp /usr/local/src/mysql-connector-java-8.0.23.jar ext-lib/\n# \u521b\u5efa\u6570\u636e\u5e93\ncreate database ds_0 default character set utf8mb4;\ncreate database ds_1 default character set utf8mb4;\n# \u521b\u5efa\u6570\u636e\u8868\nCREATE TABLE `tbl_0` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `k` int(11) NOT NULL DEFAULT 0,\n  `c` char(120) NOT NULL DEFAULT '',\n  `pad` char(60) NOT NULL DEFAULT '',\n  PRIMARY KEY (`id`)\n);\nCREATE TABLE `tbl_1` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `k` int(11) NOT NULL DEFAULT 0,\n  `c` char(120) NOT NULL DEFAULT '',\n  `pad` char(60) NOT NULL DEFAULT '',\n  PRIMARY KEY (`id`)\n);\nCREATE TABLE `t_order_0` (\n  `order_id` int NOT NULL,\n  `user_id` int NOT NULL,\n  `status` varchar(45) DEFAULT NULL,\n  PRIMARY KEY (`order_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\nCREATE TABLE `t_order_1` (\n  `order_id` int NOT NULL,\n  `user_id` int NOT NULL,\n  `status` varchar(45) DEFAULT NULL,\n  PRIMARY KEY (`order_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\nCREATE TABLE `t_item_0` (\n  `item_id` int NOT NULL,\n  `order_id` int NOT NULL,\n  `user_id` int NOT NULL,\n  `status` varchar(45) DEFAULT NULL,\n  PRIMARY KEY (`item_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\nCREATE TABLE `t_item_1` (\n  `item_id` int NOT NULL,\n  `order_id` int NOT NULL,\n  `user_id` int NOT NULL,\n  `status` varchar(45) DEFAULT NULL,\n  PRIMARY KEY (`item_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n# \u8fd0\u884cdocker\ncd ${work_dir}/scripts\ncat &gt; start.sh &lt;&lt;- 'EOF'\n#!/usr/bin/env bash\nwork_dir=`pwd`\ndocker stop sharding-proxy\ndocker rm sharding-proxy\ndocker run --name sharding-proxy \\\n    -v /${work_dir}/conf:/opt/sharding-proxy/conf \\\n    -v /${work_dir}/ext-lib:/opt/sharding-proxy/ext-lib \\\n    -e PORT=3308 \\\n    -e JWT_OPTS=\"-Djava.awt.headless=true\" \\\n    -p 13308:3308 \\\n    -d apache/sharding-proxy:4.1.1\nEOF\nsh /${work_dir}/scripts/start.sh\n</code></pre> <ul> <li>kubernetes \u5b89\u88c5</li> </ul> <pre><code># \u521b\u5efadockerfile\n# \u751f\u6210helm chart\nhelm create shardingproxy \n</code></pre> <ul> <li>\u8fde\u63a5\u4f7f\u7528</li> </ul> <pre><code>mysql  -h10.100.0.1 -P 13308 -usharding -psharding\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_28","title":"\u6027\u80fd\u6d4b\u8bd5","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_29","title":"\u6d4b\u8bd5\u573a\u666f","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_30","title":"\u5355\u8def\u7531","text":"<p>\u57281000\u6570\u636e\u91cf\u7684\u57fa\u7840\u4e0a\u5206\u5e93\u5206\u8868\uff0c\u6839\u636e<code>id</code>\u5206\u4e3a4\u4e2a\u5e93\uff0c\u90e8\u7f72\u5728\u540c\u4e00\u53f0\u673a\u5668\u4e0a\uff0c\u6839\u636e<code>k</code>\u5206\u4e3a1024\u4e2a\u8868\uff0c\u67e5\u8be2\u64cd\u4f5c\u8def\u7531\u5230\u5355\u5e93\u5355\u8868\uff1b \u4f5c\u4e3a\u5bf9\u6bd4\uff0cMySQL\u8fd0\u884c\u57281000\u6570\u636e\u91cf\u7684\u57fa\u7840\u4e0a\uff0c\u4f7f\u7528INSERT+UPDATE+DELETE\u548c\u5355\u8def\u7531\u67e5\u8be2\u8bed\u53e5\u3002</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_31","title":"\u4e3b\u4ece","text":"<p>\u57fa\u672c\u4e3b\u4ece\u573a\u666f\uff0c\u8bbe\u7f6e\u4e00\u4e3b\u5e93\u4e00\u4ece\u5e93\uff0c\u90e8\u7f72\u5728\u4e24\u53f0\u4e0d\u540c\u7684\u673a\u5668\u4e0a\uff0c\u572810000\u6570\u636e\u91cf\u7684\u57fa\u7840\u4e0a\uff0c\u89c2\u5bdf\u8bfb\u5199\u6027\u80fd\uff1b \u4f5c\u4e3a\u5bf9\u6bd4\uff0cMySQL\u8fd0\u884c\u572810000\u6570\u636e\u91cf\u7684\u57fa\u7840\u4e0a\uff0c\u4f7f\u7528INSERT+SELECT+DELETE\u8bed\u53e5\u3002</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_32","title":"\u4e3b\u4ece+\u52a0\u5bc6+\u5206\u5e93\u5206\u8868","text":"<p>\u57281000\u6570\u636e\u91cf\u7684\u57fa\u7840\u4e0a\uff0c\u6839\u636e<code>id</code>\u5206\u4e3a4\u4e2a\u5e93\uff0c\u90e8\u7f72\u5728\u56db\u53f0\u4e0d\u540c\u7684\u673a\u5668\u4e0a\uff0c\u6839\u636e<code>k</code>\u5206\u4e3a1024\u4e2a\u8868\uff0c<code>c</code>\u4f7f\u7528aes\u52a0\u5bc6\uff0c<code>pad</code>\u4f7f\u7528md5\u52a0\u5bc6\uff0c\u67e5\u8be2\u64cd\u4f5c\u8def\u7531\u5230\u5355\u5e93\u5355\u8868\uff1b \u4f5c\u4e3a\u5bf9\u6bd4\uff0cMySQL\u8fd0\u884c\u57281000\u6570\u636e\u91cf\u7684\u57fa\u7840\u4e0a\uff0c\u4f7f\u7528INSERT+UPDATE+DELETE\u548c\u5355\u8def\u7531\u67e5\u8be2\u8bed\u53e5\u3002</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_33","title":"\u5168\u8def\u7531","text":"<p>\u57281000\u6570\u636e\u91cf\u7684\u57fa\u7840\u4e0a\uff0c\u5206\u5e93\u5206\u8868\uff0c\u6839\u636e<code>id</code>\u5206\u4e3a4\u4e2a\u5e93\uff0c\u90e8\u7f72\u5728\u56db\u53f0\u4e0d\u540c\u7684\u673a\u5668\u4e0a\uff0c\u6839\u636e<code>k</code>\u5206\u4e3a1\u4e2a\u8868\uff0c\u67e5\u8be2\u64cd\u4f5c\u4f7f\u7528\u5168\u8def\u7531\u3002 \u4f5c\u4e3a\u5bf9\u6bd4\uff0cMySQL\u8fd0\u884c\u57281000\u6570\u636e\u91cf\u7684\u57fa\u7840\u4e0a\uff0c\u4f7f\u7528INSERT+UPDATE+DELETE\u548c\u5168\u8def\u7531\u67e5\u8be2\u8bed\u53e5\u3002</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_34","title":"\u6d4b\u8bd5\u73af\u5883\u642d\u5efa","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_35","title":"\u6570\u636e\u5e93\u8868\u7ed3\u6784","text":"<pre><code>CREATE TABLE `tbl`\n(\n    `id`  bigint(20) NOT NULL AUTO_INCREMENT,\n    `k`   int(11) NOT NULL DEFAULT 0,\n    `c`   char(120) NOT NULL DEFAULT '',\n    `pad` char(60)  NOT NULL DEFAULT '',\n    PRIMARY KEY (`id`)\n);\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_36","title":"\u6d4b\u8bd5\u573a\u666f\u914d\u7f6e","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_37","title":"\u5355\u8def\u7531\u914d\u7f6e","text":"<pre><code>schemaName: sharding_db\n\ndataSources:\n  ds_0:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\n  ds_1:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\n  ds_2:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\n  ds_3:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\nrules:\n  - !SHARDING\n    tables:\n      tbl:\n        actualDataNodes: ds_${0..3}.tbl${0..1023}\n        tableStrategy:\n          standard:\n            shardingColumn: k\n            shardingAlgorithmName: tbl_table_inline\n        keyGenerateStrategy:\n          column: id\n          keyGeneratorName: snowflake\n    defaultDatabaseStrategy:\n      standard:\n        shardingColumn: id\n        shardingAlgorithmName: default_db_inline\n    defaultTableStrategy:\n      none:\n    shardingAlgorithms:\n      tbl_table_inline:\n        type: INLINE\n        props:\n          algorithm-expression: tbl${k % 1024}\n      default_db_inline:\n        type: INLINE\n        props:\n          algorithm-expression: ds_${id % 4}\n    keyGenerators:\n      snowflake:\n        type: SNOWFLAKE\n        props:\n          worker-id: 123\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_38","title":"\u4e3b\u4ece\u914d\u7f6e","text":"<pre><code>schemaName: sharding_db\n\ndataSources:\n  primary_ds:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\n  replica_ds_0:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\nrules:\n- !REPLICA_QUERY\n  dataSources:\n    pr_ds:\n      name: pr_ds\n      primaryDataSourceName: primary_ds\n      replicaDataSourceNames:\n        - replica_ds_0\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_39","title":"\u4e3b\u4ece+\u52a0\u5bc6+\u5206\u5e93\u5206\u8868\u914d\u7f6e","text":"<pre><code>schemaName: sharding_db\n\ndataSources:\n  primary_ds_0:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\n  replica_ds_0:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\n  primary_ds_1:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\n  replica_ds_1:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\n  primary_ds_2:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\n  replica_ds_2:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\n  primary_ds_3:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\n  replica_ds_3:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\nrules:\n  - !SHARDING\n    tables:\n      tbl:\n        actualDataNodes: pr_ds_${0..3}.tbl${0..1023}\n        databaseStrategy:\n          standard:\n            shardingColumn: id\n            shardingAlgorithmName: tbl_database_inline\n        tableStrategy:\n          standard:\n            shardingColumn: k\n            shardingAlgorithmName: tbl_table_inline\n        keyGenerateStrategy:\n          column: id\n          keyGeneratorName: snowflake\n    bindingTables:\n      - tbl\n    defaultDataSourceName: primary_ds_1\n    defaultTableStrategy:\n      none:\n    shardingAlgorithms:\n      tbl_database_inline:\n        type: INLINE\n        props:\n          algorithm-expression: pr_ds_${id % 4}\n      tbl_table_inline:\n        type: INLINE\n        props:\n          algorithm-expression: tbl${k % 1024}\n    keyGenerators:\n      snowflake:\n        type: SNOWFLAKE\n        props:\n          worker-id: 123\n  - !REPLICA_QUERY\n    dataSources:\n      pr_ds_0:\n        primaryDataSourceName: primary_ds_0\n        replicaDataSourceNames:\n          - replica_ds_0\n        loadBalancerName: round_robin\n      pr_ds_1:\n        primaryDataSourceName: primary_ds_1\n        replicaDataSourceNames:\n          - replica_ds_1\n        loadBalancerName: round_robin\n      pr_ds_2:\n        primaryDataSourceName: primary_ds_2\n        replicaDataSourceNames:\n          - replica_ds_2\n        loadBalancerName: round_robin\n      pr_ds_3:\n        primaryDataSourceName: primary_ds_3\n        replicaDataSourceNames:\n          - replica_ds_3\n        loadBalancerName: round_robin\n    loadBalancers:\n      round_robin:\n        type: ROUND_ROBIN\n  - !ENCRYPT:\n    encryptors:\n      aes_encryptor:\n        type: AES\n        props:\n          aes-key-value: 123456abc\n      md5_encryptor:\n        type: MD5\n    tables:\n      sbtest:\n        columns:\n          c:\n            plainColumn: c_plain\n            cipherColumn: c_cipher\n            encryptorName: aes_encryptor\n          pad:\n            cipherColumn: pad_cipher\n            encryptorName: md5_encryptor\nprops:\n  query-with-cipher-column: true\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_40","title":"\u5168\u8def\u7531","text":"<pre><code>schemaName: sharding_db\n\ndataSources:\n  ds_0:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\n  ds_1:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\n  ds_2:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\n  ds_3:\n    url: jdbc:mysql://***.***.***.***:****/ds?serverTimezone=UTC&amp;useSSL=false\n    username: test\n    password:\n    connectionTimeoutMilliseconds: 30000\n    idleTimeoutMilliseconds: 60000\n    maxLifetimeMilliseconds: 1800000\n    maxPoolSize: 200\nrules:\n  - !SHARDING\n    tables:\n      tbl:\n        actualDataNodes: ds_${0..3}.tbl1\n        tableStrategy:\n          standard:\n            shardingColumn: k\n            shardingAlgorithmName: tbl_table_inline\n        keyGenerateStrategy:\n          column: id\n          keyGeneratorName: snowflake\n    defaultDatabaseStrategy:\n      standard:\n        shardingColumn: id\n        shardingAlgorithmName: default_database_inline\n    defaultTableStrategy:\n      none:\n    shardingAlgorithms:\n      default_database_inline:\n        type: INLINE\n        props:\n          algorithm-expression: ds_${id % 4}\n      tbl_table_inline:\n        type: INLINE\n        props:\n          algorithm-expression: tbl1\n    keyGenerators:\n      snowflake:\n        type: SNOWFLAKE\n        props:\n          worker-id: 123\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_41","title":"\u6d4b\u8bd5\u7ed3\u679c\u9a8c\u8bc1","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_42","title":"\u538b\u6d4b\u8bed\u53e5","text":"<pre><code>INSERT+UPDATE+DELETE\u8bed\u53e5\uff1a\nINSERT INTO tbl(k, c, pad) VALUES(1, '###-###-###', '###-###');\nUPDATE tbl SET c='####-####-####', pad='####-####' WHERE id=?;\nDELETE FROM tbl WHERE id=?\n\n\u5168\u8def\u7531\u67e5\u8be2\u8bed\u53e5\uff1a\nSELECT max(id) FROM tbl WHERE id%4=1\n\n\u5355\u8def\u7531\u67e5\u8be2\u8bed\u53e5\uff1a\nSELECT id, k FROM tbl ignore index(`PRIMARY`) WHERE id=1 AND k=1\n\nINSERT+SELECT+DELETE\u8bed\u53e5\uff1a\nINSERT INTO tbl1(k, c, pad) VALUES(1, '###-###-###', '###-###');\nSELECT count(id) FROM tbl1;\nSELECT max(id) FROM tbl1 ignore index(`PRIMARY`);\nDELETE FROM tbl1 WHERE id=?\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_43","title":"\u538b\u6d4b\u6267\u884c","text":"<pre><code># \u751f\u6210jar\u5305\ngit clone https://github.com/apache/shardingsphere-benchmark.git\ncd shardingsphere-benchmark/shardingsphere-benchmark\nmvn clean install\n# jmeter \u538b\u6d4b\ncp target/shardingsphere-benchmark-1.0-SNAPSHOT-jar-with-dependencies.jar apache-jmeter-4.0/lib/ext\njmeter \u2013n \u2013t test_plan/test.jmx\ntest.jmx\u53c2\u8003https://github.com/apache/shardingsphere-benchmark/tree/master/report/script/test_plan/test.jmx\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_44","title":"\u538b\u6d4b\u7ed3\u679c\u5904\u7406","text":"<pre><code>sh shardingsphere-benchmark/report/script/gen_report.sh\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_45","title":"\u95ee\u9898\u70b9","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_46","title":"\u6570\u636e\u5e93\u672a\u521b\u5efa\u62a5\u9519","text":"<pre><code>Caused by: java.sql.SQLSyntaxErrorException: Unknown database 'ds_0'\n# \u89e3\u51b3\u529e\u6cd5\uff0c\u521b\u5efa\u5bf9\u5e94\u7684\u6570\u636e\u5e93\ncreate database ds_0 default character set utf8mb4;\ncreate database ds_1 default character set utf8mb4;\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/ShardingSphere/ShardingSphere%E7%AE%80%E4%BB%8B%E5%8F%8A%E4%BD%BF%E7%94%A8/#_47","title":"\u9700\u8981\u624b\u52a8\u521b\u5efa\u5e93\u8868","text":"<pre><code>#\n\u521b\u5efa\u6570\u636e\u5e93\ncreate\ndatabase ds_0 default character set utf8mb4;\ncreate\ndatabase ds_1 default character set utf8mb4;\n#\n\u521b\u5efa\u6570\u636e\u8868\nCREATE TABLE `tbl_0`\n(\n    `id`  bigint(20) NOT NULL AUTO_INCREMENT,\n    `k`   int(11) NOT NULL DEFAULT 0,\n    `c`   char(120) NOT NULL DEFAULT '',\n    `pad` char(60)  NOT NULL DEFAULT '',\n    PRIMARY KEY (`id`)\n);\nCREATE TABLE `tbl_1`\n(\n    `id`  bigint(20) NOT NULL AUTO_INCREMENT,\n    `k`   int(11) NOT NULL DEFAULT 0,\n    `c`   char(120) NOT NULL DEFAULT '',\n    `pad` char(60)  NOT NULL DEFAULT '',\n    PRIMARY KEY (`id`)\n);\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/ACID%E4%B8%8E%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/","title":"ACID\u4e0e\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/ACID%E4%B8%8E%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#acid","title":"ACID\u539f\u7406","text":"<p>\uff08Atomicity\uff09\u539f\u5b50\u6027\uff0c\uff08Consistency\uff09\u4e00\u81f4\u6027\uff0c\uff08Isolation\uff09\u9694\u79bb\u6027\uff0c\uff08Durability\uff09\u6301\u4e45\u6027</p> <ul> <li>\u539f\u5b50\u6027\uff1a\u4e8b\u52a1\u662f\u4e00\u4e2a\u4e0d\u53ef\u5206\u5272\u7684\u5de5\u4f5c\u5355\u4f4d\uff0c\u4e8b\u52a1\u4e2d\u7684\u64cd\u4f5c\u8981\u4e48\u90fd\u53d1\u751f\uff0c\u8981\u4e48\u90fd\u4e0d\u53d1\u751f</li> <li>\u4e00\u81f4\u6027\uff1a\u4e8b\u52a1\u5fc5\u987b\u4f7f\u6570\u636e\u5e93\u4ece\u4e00\u4e2a\u4e00\u81f4\u6027\u72b6\u6001\u53d8\u6362\u5230\u53e6\u5916\u4e00\u4e2a\u4e00\u81f4\u6027\u72b6\u6001\u3002</li> <li>\u9694\u79bb\u6027\uff1a\u4e8b\u52a1\u7684\u9694\u79bb\u6027\u662f\u591a\u4e2a\u7528\u6237\u5e76\u53d1\u8bbf\u95ee\u6570\u636e\u5e93\u65f6\uff0c\u6570\u636e\u5e93\u4e3a\u6bcf\u4e00\u4e2a\u7528\u6237\u5f00\u542f\u7684\u4e8b\u52a1\uff0c\u4e0d\u80fd\u88ab\u5176\u4ed6\u4e8b\u52a1\u7684\u64cd\u4f5c\u6570\u636e\u6240\u5e72\u6270\uff0c\u591a\u4e2a\u5e76\u53d1\u4e8b\u52a1\u4e4b\u95f4\u8981\u76f8\u4e92\u9694\u79bb\u3002</li> <li>\u6301\u4e45\u6027\uff1a\u6301\u4e45\u6027\u662f\u6307\u4e00\u4e2a\u4e8b\u52a1\u4e00\u65e6\u88ab\u63d0\u4ea4\uff0c\u5b83\u5bf9\u6570\u636e\u5e93\u4e2d\u6570\u636e\u7684\u6539\u53d8\u5c31\u662f\u6c38\u4e45\u6027\u7684\uff0c\u63a5\u4e0b\u6765\u5373\u4f7f\u6570\u636e\u5e93\u53d1\u751f\u6545\u969c\u4e5f\u4e0d\u5e94\u8be5\u5bf9\u5176\u6709\u4efb\u4f55\u5f71\u54cd</li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/ACID%E4%B8%8E%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#_1","title":"\u4e8b\u52a1\u5e76\u53d1\u95ee\u9898","text":"<ol> <li>\u810f\u8bfb\uff1a\u4e8b\u52a1A\u8bfb\u53d6\u4e86\u4e8b\u52a1B\u66f4\u65b0\u7684\u6570\u636e\uff0c\u7136\u540eB\u56de\u6eda\u64cd\u4f5c\uff0c\u90a3A\u8bfb\u53d6\u5230\u7684\u662f\u810f\u6570\u636e</li> <li>\u4e0d\u53ef\u91cd\u590d\u8bfb\uff1a\u4e00\u4e2a\u4e8b\u52a1\u8303\u56f4\u5185\uff0c\u591a\u6b21\u67e5\u8be2\u67d0\u4e2a\u6570\u636e\uff0c\u5f97\u5230\u4e0d\u540c\u7ed3\u679c\u3002</li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/MVCC/","title":"MVCC","text":"<p>\u6982\u5ff5\uff1amulti version concurrency control\u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236 \u3002MVCC \u53ea\u5728 REPEATABLE READ\uff08\u53ef\u91cd\u590d\u8bfb\uff09 \u548c READ COMMITTED\uff08\u5df2\u8bfb\u63d0\u4ea4\uff09\u8fd9\u4fe9\u79cd\u9694\u79bb\u7ea7\u522b\u4e0b\u9002\u7528</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/MVCC/#_1","title":"\u5f53\u524d\u8bfb","text":"<p>\u7ed9\u8bfb\u64cd\u4f5c\u52a0\u4e0a\u5171\u4eab\u9501\u3001\u6392\u5b83\u9501\uff0cDML \u64cd\u4f5c\u52a0\u4e0a\u6392\u5b83\u9501\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u5c31\u662f\u5f53\u524d\u8bfb</p> <ul> <li>\u8bfb\u53d6\u7684\u6570\u636e\u8bb0\u5f55\uff0c\u90fd\u662f\u6700\u65b0\u7684\u7248\u672c\uff0c\u4f1a\u5bf9\u5f53\u524d\u8bfb\u53d6\u7684\u6570\u636e\u8fdb\u884c\u52a0\u9501\uff0c\u9632\u6b62\u5176\u4ed6\u4e8b\u52a1\u4fee\u6539\u6570\u636e\uff0c\u662f\u60b2\u89c2\u9501\u7684\u4e00\u79cd\u5b9e\u73b0</li> <li>\u5982\u4e0b\u64cd\u4f5c\u90fd\u662f\u5f53\u524d\u8bfb\uff1a<ul> <li>select lock in share mode\uff08\u5171\u4eab\u9501\uff09</li> <li>select for update\uff08\u6392\u4ed6\u9501\uff09</li> <li>update \uff08\u6392\u4ed6\u9501\uff09</li> <li>insert \uff08\u6392\u4ed6\u9501\uff09</li> <li>delete \uff08\u6392\u4ed6\u9501\uff09</li> <li>\u4e32\u884c\u5316\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b</li> </ul> </li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/MVCC/#_2","title":"\u5feb\u7167\u8bfb","text":"<p>\u666e\u901a\u7684select id name user where id = 1;\u90fd\u5c5e\u4e8e\u5feb\u7167\u8bfb</p> <ul> <li>MVCC\u5b9e\u73b0</li> <li>\u5feb\u7167\u8bfb\u8bfb\u5230\u7684\u6570\u636e\u4e0d\u4e00\u5b9a\u662f\u6700\u65b0\u7248\u672c\u7684\u6570\u636e</li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/MVCC/#_3","title":"\u76ee\u7684","text":"<ul> <li>\u63d0\u4f9b\u6570\u636e\u5e93\u8bfb\u5199\u6027\u80fd\uff0c\u5feb\u7167\u8bfb\uff0c\u975e\u5f53\u524d\u8bfb</li> <li>\u8bfb\u5199\u65f6\u65e0\u987b\u7ade\u4e89\u9501\u6765\u63d0\u9ad8\u6027\u80fd</li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/MVCC/#_4","title":"\u6570\u636e\u5e93\u4e8b\u52a1","text":"<ul> <li>\u539f\u5b50\u6027\u7531undo log\u5b9e\u73b0<ul> <li>undolog \u8bb0\u5f55\u7684\u662f\u56de\u6eda\u65e5\u5fd7\uff0c\u56de\u6eda\u6307\u9488\u6307\u5411\u4e86\u524d\u4e00\u4e2a\u662f\u6570\u636e\uff0c\u6839\u636e\u56de\u6eda\u6307\u9488\u53ef\u4ee5\u8ffd\u6eaf\u5230\u672a\u53d8\u66f4\u524d\u7684\u6240\u6709\u6570\u636e\u5f62\u6210\u4e86\u4e00\u4e2a\u7248\u672c\u94fe</li> <li></li> </ul> </li> <li>\u6301\u4e45\u6027\u662f\u7531reod log\u5b9e\u73b0(WAL\u5199\u524d\u65e5\u5fd7)</li> <li>\u9694\u79bb\u6027\u901a\u8fc7\u52a0\u7d22\u548cMVCC\u5b9e\u73b0<ul> <li>\u5199\u5199\u64cd\u4f5c\uff0c\u901a\u8fc7\u884c\u9501/\u8868\u9501\u5b9e\u73b0</li> <li>\u5199\u8bfb\u64cd\u4f5c\uff0c\u901a\u8fc7MVCC\u5b9e\u73b0</li> </ul> </li> <li>ReadView\u4ecb\u7ecd<ul> <li>\u4f5c\u7528\uff1a\u5728select\u65f6\u53ef\u4ee5\u77e5\u9053\u5728\u7248\u672c\u94fe\u4e2d\u9009\u7528\u54ea\u6761\u8bb0\u5f55</li> <li>\u6570\u636e\u7ed3\u6784\uff1a</li> <li>\u5982\u4f55\u5224\u65ad\u7248\u672c\u94fe\u4e2d\u54ea\u4e2a\u7248\u672c\u53ef\u7528\uff1f</li> </ul> </li> <li>MVCC\u5982\u4f55\u5b9e\u73b0RC(\u8bfb\u5df2\u63d0\u4ea4\uff09\u548cRR(\u53ef\u91cd\u590d\u8bfb)<ul> <li>\u8bfb\u5df2\u63d0\u4ea4\u751f\u6210ReadView\u7684\u65f6\u673a\u662f\u6bcf\u4e00\u6b21select\u8bed\u53e5\u65f6\u751f\u6210\uff0c\u6240\u4ee5\u8bbf\u95ee\u7684\u4e00\u5b9a\u662f\u6700\u65b0\u7684\u7248\u672c\u7684\uff0c\u6240\u4ee5\u4e0d\u80fd\u4fdd\u8bc1\u53ef\u91cd\u590d\u8bfb</li> <li>RR\u751f\u6210ReadView\u7684\u65f6\u673a\u662f\u4ee5\u4e00\u4e2a\u4e8b\u52a1\u4e3a\u5355\u4f4d\u7684\uff0cRR\u53ef\u91cd\u590d\u8bfb\u4f1a\u9020\u6210\u5e7b\u8bfb\uff0cinnodb\u662f\u4f7f\u7528\u95f4\u9699\u9501\u9501\u4f4f\u4e86\u533a\u95f4\uff0c\u5982\u67e5\u8be2&gt;2\u7684\u6570\u636e\uff0c\u5219&gt;2\u7684\u6570\u636e\u90fd\u4e0d\u4f1a\u518d\u63d2\u5165\u6765\u89e3\u51b3\u5e7b\u8bfb</li> </ul> </li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/MVCC/#_5","title":"\u5b9e\u4f8b","text":"<p>\u6848\u4f8b\uff1a\u9700\u8981\u652f\u4ed8\u4e00\u7b14\u94b1\uff0c\u4e24\u4e2a\u4eba\u90fd\u767b\u5f55\u8fdb\u53bb\u4e86\uff0c\u8fd9\u65f6\u5019\u95ee\u9898\u53d1\u751f\u4e86</p> <ol> <li> <p>\u60b2\u89c2\u5e76\u53d1\u63a7\u5236PCC\u60b2\u89c2\u9501\uff08\u5199\u591a\u8bfb\u5c11\u7684\u5e76\u53d1\u73af\u5883\u4e0b\u4f7f\u7528\uff09\uff1a \u5047\u8bbeA\u6b63\u5728\u8bbf\u95ee\u5e76\u4e14\u53d1\u8d77\u4e86\u652f\u4ed8\uff0c\u90a3\u4e48A\u8fd9\u6761\u6570\u636e\u662f\u5df2\u7ecf\u9501\u5b9a\u4e86\u7684\uff0c\u60b2\u89c2\u7684\u4ee5\u4e3a\u4e00\u5b9a\u4f1a\u53d1\u751f\u9501\u7ade\u4e89\uff0c\u6240\u4ee5\u76f4\u63a5\u52a0\u9501\u3002\u8fd9\u5c31\u5bfc\u81f4\u4e86B\u67e5\u8be2\u4e0d\u5230\u6b64\u6761\u6570\u636e\uff0c\u9700\u8981\u7b49\u5f85\u5230A\u8bbf\u95ee\u5b8c\u6bd5\u91ca\u653e\u9501\u3002    \u60b2\u89c2\u9501\u4fdd\u8bc1\u5728\u540c\u4e00\u65f6\u95f4\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\uff0c\u9ed8\u8ba4\u6570\u636e\u5728\u8bbf\u95ee\u7684\u65f6\u5019\u4f1a\u4ea7\u751f\u51b2\u7a81\uff0c\u7136\u540e\u5728\u6574\u4e2a\u8fc7\u7a0b\u90fd\u52a0\u4e0a\u4e86\u9501</p> </li> <li> <p>\u4e50\u89c2\u5e76\u53d1\u63a7\u5236OCC\u4e50\u89c2\u9501\uff1a \u5728A\u8bbf\u95ee\u5e76\u4e14\u652f\u4ed8\u7684\u65f6\u5019\uff0cB\u4e5f\u53ef\u4ee5\u8bbf\u95ee\u5230\u6570\u636e\u3002\u4e50\u89c2\u9501\u8ba4\u4e3a\u5728\u5e76\u53d1\u573a\u666f\u4e0b\uff0c\u4e5f\u4e0d\u4f1a\u4ea7\u751f\u51b2\u7a81\uff0c\u6240\u4ee5\u4e5f\u4e0d\u4f1a\u52a0\u9501\u3002\u800c\u662f\u5728\u6570\u636e\u63d0\u4ea4\u65f6\u68c0\u6d4b\uff0c\u5982\u679c\u6709\u51b2\u7a81\u5219\u8fd4\u56de\u51b2\u7a81\u4fe1\u606f</p> </li> </ol> <p>\u603b\u7ed3\uff1aInnodb \u7684 MVCC \u673a\u5236\u5c31\u662f\u4e50\u89c2\u9501\u7684\u4e00\u79cd\u4f53\u73b0\uff0c\u8bfb\u4e0d\u52a0\u9501\uff0c\u8bfb\u5199\u4e0d\u51b2\u7a81\uff0c\u5728\u4e0d\u52a0\u9501\u7684\u60c5\u51b5\u4e0b\u80fd\u8ba9\u591a\u4e2a\u4e8b\u52a1\u8fdb\u884c\u5e76\u53d1\u8bfb\u5199\uff0c\u5e76\u4e14\u89e3\u51b3\u8bfb\u5199\u51b2\u7a81\u95ee\u9898\uff0c\u6781\u5927\u7684\u63d0\u9ad8\u7cfb\u7edf\u7684\u5e76\u53d1\u6027\u3002</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/MVCC/#mvcc_1","title":"MVCC\u89e3\u51b3\u4e86\u4ec0\u4e48\u95ee\u9898","text":"<p>\u4e8b\u52a1\u5e76\u53d1\u60c5\u51b5\u9047\u5230\u7684\u95ee\u9898 \u70b9\u8fd9\u8be6\u89e3</p> <ul> <li>\u810f\u8bfb\uff1a\u8bfb\u53d6\u5230\u5176\u5b83\u4e8b\u52a1\u672a\u63d0\u4ea4\u7684\u6570\u636e</li> <li>\u4e0d\u53ef\u91cd\u590d\u8bfb\uff1a\u4e00\u4e2a\u4e8b\u52a1\u8bfb\u53d6\u4e00\u6761\u6570\u636e\u65f6\uff0c\u7531\u4e8e\u53e6\u4e00\u4e2a\u4e8b\u52a1\u4fee\u6539\u4e86\u8fd9\u6761\u6570\u636e\uff0c\u5bfc\u81f4\u8bfb\u53d6\u524d\u540e\u6570\u636e\u4e0d\u4e00\u81f4</li> <li>\u5e7b\u8bfb\uff1a\u4e00\u4e2a\u4e8b\u52a1\u8bfb\u53d6\u4e86\u67d0\u4e2a\u8303\u56f4\u6570\u636e\u7684\u6570\u91cf\uff0c\u53e6\u5916\u7684\u4e8b\u52a1\u65b0\u589e\u4e86\u8fd9\u4e2a\u8303\u56f4\u7684\u6570\u636e\uff0c\u518d\u6b21\u8bfb\u53d6\u53d1\u73b0\u5f97\u5230\u7ed3\u679c\u4e0d\u4e00\u81f4</li> </ul> <p>MVCC \u53ef\u4ee5\u89e3\u51b3\u810f\u8bfb\uff0c\u4e0d\u53ef\u91cd\u590d\u8bfb\uff0cMVCC \u4f7f\u7528\u5feb\u7167\u8bfb\u89e3\u51b3\u4e86\u90e8\u5206\u5e7b\u8bfb\u95ee\u9898\uff0c\u4f46\u662f\u5728\u4fee\u6539\u65f6\u8fd8\u662f\u4f7f\u7528\u7684\u5f53\u524d\u8bfb\uff0c\u6240\u4ee5\u8fd8\u662f\u5b58\u5728\u5e7b\u8bfb\u95ee\u9898\uff0c\u5e7b\u8bfb\u7684\u95ee\u9898\u6700\u7ec8\u5c31\u662f\u4f7f\u7528\u95f4\u9699\u9501\u89e3\u51b3\u3002</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/MVCC/#mvcc_2","title":"MVCC\u5b9e\u73b0\u4e09\u5927\u8981\u7d20","text":"<p>\u4e24\u4e2a\u9690\u5f0f\u5b57\u6bb5\u3001undo \u65e5\u5fd7\u3001Read view</p> <ul> <li>\u53c2\u8003Bilibili</li> <li>\u53c2\u8003\u535a\u5ba2</li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%9F%BA%E7%A1%80%E7%AF%87/","title":"Mysql\u5b9e\u6218 \u57fa\u7840\u7bc7","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%9F%BA%E7%A1%80%E7%AF%87/#mysql-","title":"Mysql\u5b9e\u6218-\u57fa\u7840\u7bc7","text":"<p>Mysql\u6838\u5fc3</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%9F%BA%E7%A1%80%E7%AF%87/#sql","title":"\u4e00\u6761sql\u8bed\u53e5\u662f\u600e\u4e48\u6267\u884c\u7684","text":"<ul> <li>mysql\u903b\u8f91\u67b6\u6784\u56fe\u5982\u56fe<ul> <li>server\u5c42\uff1a\u5305\u542b\u4e86\u8fde\u63a5\u5668\u3001\u67e5\u8be2\u7f13\u5b58\u3001\u5206\u6790\u5668\u3001\u4f18\u5316\u5668\u3001\u6267\u884c\u5668\u7b49\uff0c\u6240\u6709\u7684\u5185\u7f6e\u51fd\u6570\uff0c\u6240\u6709\u8de8\u5b58\u50a8\u5f15\u64ce\u7684\u529f\u80fd\u90fd\u5728\u8fd9\u5b9e\u73b0\uff0c\u5982\u5b58\u50a8\u8fc7\u7a0b\uff0c\u89e6\u53d1\u5668\uff0c\u89c6\u56fe\u7b49</li> <li>\u5b58\u50a8\u5f15\u64ce\u5c42\uff1a\u8d1f\u8d23\u6570\u636e\u7684\u5b58\u50a8\u548c\u63d0\u53d6\uff0c\u662f\u63d2\u4ef6\u5f0f\u7684\uff0c\u6709InnoDB,MyIsam\u7b49</li> </ul> </li> <li>\u6267\u884c\u6b65\u9aa4\uff1a<ol> <li>\u5efa\u7acb\u8fde\u63a5<ul> <li>\u8fde\u63a5\u5668\uff1amysql -h -p</li> <li>\u5efa\u7acb\u8fde\u63a5\u8fc7\u7a0b\u590d\u6742\uff0c\u5efa\u8bae\u4f7f\u7528\u957f\u94fe\u63a5\uff0c\u957f\u8fde\u63a5\u6307\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\u6210\u529f\u540e\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u6301\u7eed\u6709\u8bf7\u6c42\uff0c\u5219\u4e00\u76f4\u4f7f\u7528\u540c\u4e00\u4e2a\u8fde\u63a5</li> <li>\u5982\u679c\u5168\u90e8\u4f7f\u7528\u957f\u8fde\u63a5\uff0c\u4f1a\u5bfc\u81f4Mysql\u5360\u7528\u5185\u5b58\u975e\u5e38\u591a--\u89e3\u51b3\uff1a\u5b9a\u671f\u65ad\u5f00\u957f\u8fde\u63a5\uff1b\u53ef\u4ee5\u5728\u6bcf\u4e2a\u6267\u884c\u6bd4\u8f83\u5927\u7684\u64cd\u4f5c\u540e\uff0c\u6267\u884cmysql_reset_connection\u91cd\u7f6e\u8fde\u63a5</li> </ul> </li> <li>\u67e5\u8be2\u7f13\u5b58<ul> <li>mysql8.0\u6b64\u529f\u80fd\u5220\u9664\uff0c\u56e0\u4e3a\u67e5\u8be2\u7f13\u5b58\u529f\u80fd\u5f0a\u5927\u4e8e\u5229</li> </ul> </li> <li>\u5206\u6790\u5668<ul> <li>\u8bcd\u6cd5\u5206\u6790\uff0c\u68c0\u6d4b\u8f93\u5165\u7684sql\u8bed\u53e5\u683c\u5f0f\uff0c\u5982\u679c\u9519\u8bef\uff0c\u4f1a\u6536\u5230\u2018You have an error in your sql syntax\u2019\u7684\u63d0\u793a</li> </ul> </li> <li>\u4f18\u5316\u5668<ul> <li>\u5728\u8868\u91cc\u6709\u591a\u4e2a\u7d22\u5f15\u65f6\uff0c\u5224\u65ad\u4f7f\u7528\u54ea\u4e2a\u7d22\u5f15\uff1b\u5728\u4e00\u4e2a\u8bed\u53e5\u6709\u591a\u4e2ajoin\u8fde\u63a5\u7684\u65f6\u5019\uff0c\u5224\u65ad\u8fde\u63a5\u987a\u5e8f</li> </ul> </li> <li>\u6267\u884c\u5668<ul> <li>\u5f00\u59cb\u6267\u884c\u524d\uff0c\u4f1a\u5224\u65ad\u662f\u5426\u6709\u6267\u884c\u6b64\u8868\u7684\u6743\u9650\uff1a\u65e0\u6743\u9650\u8d23\u4efb\u63d0\u793a\u9519\u8bef\uff1b\u6709\u6743\u9650\u5219\u6839\u636e\u5f15\u64ce\u5b9a\u4e49\uff0c\u5f00\u59cb\u6267\u884c\u5f15\u64ce\u63d0\u4f9b\u7684\u63a5\u53e3</li> </ul> </li> </ol> </li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%9F%BA%E7%A1%80%E7%AF%87/#sql_1","title":"\u65e5\u5fd7\uff1a\u4e00\u6761sql\u66f4\u65b0\u8bed\u53e5\u662f\u600e\u4e48\u6267\u884c\u7684","text":"<ul> <li>\u6d41\u7a0b\uff1a\u4e00\u6837\u8d70\u4e0a\u9762\u7684\u903b\u8f91\u6d41\u7a0b\uff0c\u5206\u6790\u5668\u68c0\u6d4bsql\u8bed\u53e5\u5224\u65ad\u662f\u66f4\u65b0\u8bed\u53e5\uff0c\u4f1a\u6e05\u7a7a\u67e5\u8be2\u7f13\u5b58\u5185\u7684\u4fe1\u606f</li> <li>redo log\u91cd\u505a\u65e5\u5fd7\uff0cInnoDB\u7279\u6709\u7684\u65e5\u5fd7\uff0c\u4fdd\u8bc1\u4e86\u4e8b\u52a1\u7684\u6301\u4e45\u6027<ul> <li>WAL\uff08write-ahead-logging\uff09\u6280\u672f,\u5148\u5199\u65e5\u5fd7\uff0c\u518d\u5199\u78c1\u76d8\uff08\u533a\u522bAOF\uff0c\u5199\u540e\u65e5\u5fd7\uff0c\u4e00\u4e2a\u4e3a\u4e86\u6301\u4e45\u6027\u6570\u636e\u4e0d\u4e22\u5931\uff1b\u4e00\u4e2a\u4e3a\u4e86\u5355\u7ebf\u7a0b\u64cd\u4f5c\u4e0d\u963b\u585e\uff09<ul> <li>\u5f53\u6709\u8bb0\u5f55\u66f4\u65b0\u65f6\uff0cInnoDB\u5f15\u64ce\u4f1a\u628a\u65e5\u5fd7\u5148\u5199\u5165redo log\u91cc\uff0c\u5e76\u66f4\u65b0\u5185\u5b58\uff0c\u8fd9\u65f6\u5019\u5c31\u7b97\u66f4\u65b0\u5b8c\u6210\uff0cInnoDB\u4f1a\u5728\u9002\u5f53\u65f6\u5019\uff0c\u5c06\u8bb0\u5f55\u66f4\u65b0\u5230\u78c1\u76d8\u5185</li> <li>InnoDB\u7684redo log\u662f\u56fa\u5b9a\u5927\u5c0f\u7684</li> <li>\u5982\u56fe\u7684write pos\u5f53\u524d\u8bb0\u5f55\u7684\u4f4d\u7f6e\uff1bcheck point\u662f\u5f53\u524d\u8981\u64e6\u9664\u7684\u70b9\uff08\u5982\u679cwrite pos\u8ffd\u4e0acheck point\u8868\u793a\u56fa\u5b9a\u5927\u5c0f\u7684redo log\u6ee1\u4e86\uff09</li> </ul> </li> <li>\u6709\u4e86redo log\uff0cInnoDB\u5c31\u80fd\u4fdd\u8bc1\u6570\u636e\u5e93\u53d1\u751f\u5f02\u5e38\u91cd\u542f\u540e\u6570\u636e\u4e0d\u4e22\u5931\uff0c\u8fd9\u4e2a\u80fd\u529b\u79f0\u4e3acrash-safe</li> </ul> </li> <li>bin log\u5f52\u6863\u65e5\u5fd7\uff08server\u5c42\u5b9e\u73b0\uff09<ul> <li>\u548credo log\u533a\u522b\uff1a<ol> <li>redolog\u662fInnoDB\u7279\u6709\uff0cbin log\u662fmysql\u7684server\u5c42\u5b9e\u73b0\uff0c\u6240\u6709\u5f15\u64ce\u90fd\u53ef\u4ee5\u4f7f\u7528</li> <li>redo log\u662f\u7269\u7406\u65e5\u5fd7\uff0c\u8bb0\u5f55\u7684\u662f\u5728\u67d0\u4e2a\u6570\u636e\u9875\u4e0a\u505a\u4e86\u4ec0\u4e48\u4fee\u6539\uff0c\u800cbinlog\u662f\u903b\u8f91\u65e5\u5fd7\uff0c\u8bb0\u5f55\u7684\u662f\u8fd9\u4e2a\u5b57\u6bb5\u7684\u539f\u59cb\u903b\u8f91\uff0c\u5982\uff1a\u7ed9ID=2\u8fd9\u884c\u7684c\u5b57\u6bb5\u52a01</li> <li>redo log\u662f\u5faa\u73af\u5199\uff0c\u7a7a\u95f4\u56fa\u5b9a\u4f1a\u7528\u5b8c\uff0cbinlog\u662f\u8ffd\u52a0\u5199\u5165\uff0c\u5728\u5199\u5165\u5230\u4e00\u5b9a\u5927\u5c0f\u4f1a\u5207\u6362\u5230\u4e0b\u4e00\u4e2a\uff0c\u5e76\u4e0d\u4f1a\u8986\u76d6\u4ee5\u524d\u7684\u65e5\u5fd7</li> </ol> </li> </ul> </li> <li>\u4e24\u9636\u6bb5\u63d0\u4ea4<ul> <li>\u5982\u4e0bsql\u8bed\u53e5\u6267\u884c\u6d41\u7a0b\uff1a<code>update T set c=c+1 where ID = 2</code><ol> <li>\u6267\u884c\u5668\u5148\u627e\u5f15\u64ce\u6e20\u9053ID=2\u8fd9\u4e00\u884c\uff0cID\u662f\u4e3b\u952e\uff0c\u5f15\u64ce\u76f4\u63a5\u4f7f\u7528\u4e3b\u952e\u7d22\u5f15\u627e\u5230\u8fd9\u4e00\u884c\uff0c\u5982\u679cID=2\u8fd9\u884c\u6240\u5728\u7684\u6570\u636e\u9875\u672c\u6765\u5c31\u5728\u5185\u5b58\u4e2d\uff0c\u5c31\u76f4\u63a5\u8fd4\u56de\u7ed9\u6267\u884c\u5668\uff0c\u5426\u5219\uff0c\u9700\u8981\u5148\u4ece\u78c1\u76d8\u8bfb\u5165\u5185\u5b58\uff0c\u7136\u540e\u518d\u8fd4\u56de</li> <li>\u6267\u884c\u5668\u62ff\u5230\u5f15\u64ce\u7ed9\u7684\u884c\u6570\u636e\uff0c\u628a\u8fd9\u4e2a\u503c\u52a0\u4e0a1\uff0c\u5f97\u5230\u65b0\u7684\u4e00\u884c\u6570\u636e\uff0c\u518d\u8c03\u7528\u5f15\u64ce\u63a5\u53e3\u5199\u5165\u8fd9\u884c\u65b0\u6570\u636e</li> <li>\u5f15\u64ce\u5c06\u8fd9\u884c\u65b0\u6570\u636e\u66f4\u65b0\u5230\u5185\u5b58\u4e2d\uff0c\u540c\u65f6\u5c06\u8fd9\u4e2a\u66f4\u65b0\u64cd\u4f5c\u8bb0\u5f55\u5230redo log\u91cc\u9762\uff0c\u6b64\u65f6redo log\u5904\u4e8eprepare\u72b6\u6001\uff0c\u7136\u540e\u544a\u77e5\u6267\u884c\u5668\u6267\u884c\u5b8c\u6210\uff0c\u968f\u65f6\u53ef\u4ee5\u63d0\u4ea4\u4e8b\u52a1</li> <li>\u6267\u884c\u5668\u751f\u6210\u8fd9\u4e2a\u64cd\u4f5c\u7684bin log\uff0c\u5e76\u628abin log\u5199\u5165\u78c1\u76d8</li> <li>\u6267\u884c\u5668\u8c03\u7528\u5f15\u64ce\u7684\u63d0\u4ea4\u4e8b\u52a1\u63a5\u53e3\uff0c\u5f15\u64ce\u628a\u521a\u521a\u5199\u5165\u7684redo log\u6539\u6210\u63d0\u4ea4\u72b6\u6001\uff0c\u66f4\u65b0\u5b8c\u6210</li> </ol> </li> </ul> </li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%9F%BA%E7%A1%80%E7%AF%87/#_1","title":"\u4e8b\u52a1\u9694\u79bb\uff1a\u4e3a\u4ec0\u4e48\u66f4\u6539\u4e86\u8fd8\u770b\u4e0d\u89c1\uff1f","text":"<p>\u4fdd\u8bc1\u4e00\u7ec4\u6570\u636e\u5e93\u64cd\u4f5c\uff0c\u8981\u4e48\u90fd\u6210\u529f\uff0c\u8981\u4e48\u90fd\u5931\u8d25</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%9F%BA%E7%A1%80%E7%AF%87/#_2","title":"\u9694\u79bb\u6027\u4e0e\u9694\u79bb\u7ea7\u522b","text":"<ul> <li>\u56db\u79cd\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b<ul> <li>read uncommited\u8bfb\u672a\u63d0\u4ea4\uff0c\u4e00\u4e2a\u4e8b\u52a1\u672a\u63d0\u4ea4\u65f6\uff0c\u5b83\u7684\u6570\u636e\u5c31\u80fd\u88ab\u522b\u7684\u4e8b\u52a1\u770b\u5230\uff08\u9020\u6210\u810f\u8bfb\uff09</li> <li>read commited\u8bfb\u5df2\u63d0\u4ea4\uff0c\u4e00\u4e2a\u4e8b\u52a1\u63d0\u4ea4\u6210\u529f\u540e\uff0c\u5b83\u7684\u6570\u636e\u53d8\u66f4\u624d\u80fd\u88ab\u522b\u7684\u4e8b\u52a1\u770b\u5230\uff08\u9020\u6210\u5e7b\u8bfb\uff09</li> <li>repeatable read\u53ef\u91cd\u590d\u8bfb\uff0c\u4e00\u4e2a\u4e8b\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\u770b\u5230\u7684\u6570\u636e\uff0c\u603b\u662f\u8ddf\u8fd9\u4e2a\u4e8b\u52a1\u5728\u542f\u52a8\u65f6\u770b\u5230\u7684\u6570\u636e\u662f\u4e00\u81f4\u7684\u3002\u6b64\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u4e0b\uff0c\u672a\u63d0\u4ea4\u53d8\u66f4\u5bf9\u5176\u4ed6\u4e8b\u52a1\u4e5f\u662f\u4e0d\u53ef\u89c1\u7684\uff08mysql\u9ed8\u8ba4\u7684\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\uff09</li> <li>serializable\u4e32\u884c\u5316\uff0c\u5bf9\u4e8e\u540c\u884c\u8bb0\u5f55\uff0c\u5199\u52a0\u5199\u9501\uff0c\u8bfb\u52a0\u8bfb\u9501\u3002\u5e76\u4e14\u4e8b\u52a1\u6267\u884c\u6709\u987a\u5e8f</li> </ul> </li> <li>\u4e8b\u52a1\u9694\u79bb\u7684\u5b9e\u73b0(\u8be6\u7ec6)<ul> <li>\u6bcf\u6761\u8bb0\u5f55\u5728\u66f4\u65b0\u65f6\uff0c\u4f1a\u540c\u65f6\u8bb0\u5f55\u4e00\u6761\u56de\u6eda\u64cd\u4f5c-undo log</li> <li>\u56de\u6eda\u65e5\u5fd7\u5220\u9664\u65f6\u673a\uff1a\u7cfb\u7edf\u5185\u6ca1\u6709\u6bd4\u8fd9\u4e2a\u56de\u6eda\u65e5\u5fd7\u66f4\u65e9\u7684read-view\u7684\u65f6\u5019</li> </ul> </li> <li>\u4e8b\u52a1\u7684\u542f\u52a8\u65b9\u5f0f<ul> <li>\u663e\u793a\u542f\u52a8\uff1abegin\u6216start transaction\uff0c\u63d0\u4ea4commit\uff0c\u56de\u6edarollback</li> <li>set autocommit=0,\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u5c06\u8fd9\u4e2a\u7ebf\u7a0b\u7684\u81ea\u52a8\u63d0\u4ea4\u5173\u95ed\uff0c\u76f4\u81f3\u4e3b\u52a8\u6267\u884ccommit\u6216rollback\uff0c\u6216\u8005\u65ad\u5f00\u8fde\u63a5</li> </ul> </li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%9F%BA%E7%A1%80%E7%AF%87/#_3","title":"\u6df1\u5165\u6d45\u51fa\u7d22\u5f15","text":"<p>\u7d22\u5f15\u51fa\u73b0\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u63d0\u9ad8\u6570\u636e\u67e5\u8be2\u6548\u7387</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%9F%BA%E7%A1%80%E7%AF%87/#_4","title":"\u7d22\u5f15\u5e38\u89c1\u6a21\u578b","text":"<ol> <li>\u54c8\u5e0c\u8868<ul> <li>\u4ee5k-v\u5b58\u50a8\u6570\u636e\u7684\u7ed3\u6784</li> <li>\u503c\u653e\u5728\u6570\u7ec4\u91cc\uff0c\u7528\u4e00\u4e2a\u54c8\u5e0c\u51fd\u6570\u628akey\u6362\u7b97\u6210\u4e00\u4e2a\u786e\u5b9a\u7684\u4f4d\u7f6e\uff0c\u628avalue\u653e\u5728\u6570\u7ec4\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u51fa\u73b0\u540c\u4e00\u4e2a\u503c\u7684\u60c5\u51b5\uff1a\u62c9\u51fa\u4e00\u4e2a\u94fe\u8868</li> <li>\u7f3a\u70b9\uff1a\u65e0\u5e8f\uff0c\u54c8\u5e0c\u7d22\u5f15\u505a\u533a\u95f4\u67e5\u8be2\u901f\u5ea6\u5f88\u6162</li> <li>\u9002\u7528\u573a\u666f\uff1a\u7b49\u503c\u67e5\u8be2\uff0c\u5982Memcached\u53ca\u5176\u4ed6\u4e00\u4e9bNoSql\u5f15\u64ce</li> </ul> </li> <li>\u6709\u5e8f\u6570\u7ec4<ul> <li>\u4e8c\u5206\u67e5\u627e\uff0c\u67e5\u8be2\u901f\u5ea6\u5feb\uff0c\u65f6\u95f4\u590d\u6742\u5ea6O(log(N))</li> <li>\u7f3a\u70b9\uff1a\u5982\u679c\u5f80\u4e2d\u95f4\u63d2\u5165\u4e00\u4e2a\u8bb0\u5f55\u5c31\u5fc5\u987b\u632a\u52a8\u540e\u9762\u6240\u6709\u8bb0\u5f55\uff0c\u6210\u672c\u592a\u9ad8</li> <li>\u573a\u666f\uff1a\u9002\u7528\u4e8e\u9759\u6001\u5b58\u50a8\u5f15\u64ce</li> </ul> </li> <li>\u641c\u7d22\u6811<ul> <li>\u4e8c\u53c9\uff0c\u591a\u53c9\uff0c\u6811\u9ad8\u5ea6\u95ee\u9898\uff0c\u9ad8\u5ea6\u8d8a\u9ad8\uff0c\u6bcf\u4e2a\u6570\u636e\u5e93\u5bfb\u5740\u901f\u5ea6\u4f1a\u7d2f\u52a0</li> </ul> </li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%9F%BA%E7%A1%80%E7%AF%87/#innodb","title":"InnoDB\u7684\u7d22\u5f15\u6a21\u578b","text":"<ul> <li>InnoDB\u4e2d\uff0c\u8868\u6839\u636e\u4e3b\u952e\u987a\u5e8f\u4ee5\u7d22\u5f15\u7684\u5f62\u5f0f\u5b58\u653e\uff0c\u8fd9\u79cd\u5b58\u50a8\u65b9\u5f0f\u8868\u79f0\u4e3a\u7d22\u5f15\u7ec4\u7ec7\u8868</li> <li>\u6bcf\u4e2a\u7d22\u5f15\u5728InnoDB\u4e2d\u5bf9\u5e94\u4e00\u68f5B+\u6811</li> <li>\u5047\u8bbesql<code>mysql&gt; create table T(   id int primary key, k int not null, name varchar(16), index (k))engine=InnoDB;</code><ul> <li>\u5bf9\u5e94\u7684\u7d22\u5f15\u6811\u5982\u56fe</li> <li>\u6839\u636e\u53f6\u5b50\u8282\u70b9\u5185\u5bb9\uff0c\u7d22\u5f15\u7c7b\u578b\u5206\u4e3a\uff1a\u4e3b\u952e\u7d22\u5f15\uff08\u805a\u7c07\u7d22\u5f15\uff09\uff0c\u975e\u4e3b\u952e\u7d22\u5f15</li> <li>\u4e3b\u952e\u7d22\u5f15\u53f6\u5b50\u8282\u70b9\u5b58\u6574\u884c\u6570\u636e\uff0c\u975e\u4e3b\u952e\u7d22\u5f15\u7684\u53f6\u5b50\u8282\u70b9\u5185\u5bb9\u662f\u4e3b\u952e\u7684\u503c</li> </ul> </li> <li>\u4e3b\u952e\u7d22\u5f15\u548c\u666e\u901a\u7d22\u5f15\u533a\u522b\uff1a\u4e3b\u952e\u7d22\u5f15\u67e5\u8be2\uff0c\u53ea\u9700\u8981\u641c\u7d22ID\u8fd9\u68f5B+\u6811\uff1b\u5982\u679c\u666e\u901a\u7d22\u5f15\u67e5\u8be2\u65b9\u5f0f\uff0c\u9700\u8981\u5148\u641c\u7d22\u666e\u901a\u7d22\u5f15\u6811\uff0c\u5f97\u5230ID\u503c\uff0c\u518d\u641c\u7d22ID\u7d22\u5f15\u6811\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u79f0\u4e3a--\u56de\u8868</li> <li>\u7d22\u5f15\u7ef4\u62a4<ul> <li>\u9875\u5206\u88c2/\u9875\u5408\u5e76\uff1aB+\u6811\u4e3a\u4e86\u4fdd\u8bc1\u6709\u5e8f\u6027\uff0c\u63d2\u5165\u65b0\u503c\u65f6\u9700\u8981\u632a\u52a8\u4f4d\u7f6e\uff0c\u5982\u679c\u6570\u636e\u9875\u6ee1\u4e86\uff0c\u518d\u63d2\u5165\u5f53\u524d\u9875\u4e2d\u4e00\u4e2a\u65b0\u503c\uff0c\u5219\u9700\u8981\u5c06\u90e8\u5206\u6570\u636e\u632a\u52a8\u5230\u65b0\u7533\u8bf7\u7684\u4e00\u4e2a\u6570\u636e\u9875\u4e2d\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u79f0\u4e3a\u9875\u5206\u88c2\uff1b\u5f53\u76f8\u90bb\u9875\u7531\u4e8e\u5220\u9664\u6570\u636e\uff0c\u5229\u7528\u7387\u5f88\u4f4e\u540e\u4f1a\u505a\u9875\u5408\u5e76</li> <li>\u81ea\u589e\u4e3b\u952e\u6709\u5e8f\uff0c\u63d2\u5165\u65f6\u5411\u540e\u63d2\u5165\uff0c\u4e0d\u4f1a\u5bfc\u81f4\u9875\u5206\u88c2\u7684\u4ea7\u751f\uff0c\u6240\u4ee5\u4e00\u822c\u4f7f\u7528\u81ea\u589e\u4e3b\u952e</li> <li>\u67e5\u8be2\u7d22\u5f15\u6811\u4e0a\u5305\u542b\u7684\u503c\u65e0\u987b\u56de\u8868\u7684\u88ab\u79f0\u4f5c\u8986\u76d6\u7d22\u5f15\uff0c\u6bd4\u5982select ID from\u3002\u3002\u3002\u53ef\u4ee5\u76f4\u63a5\u67e5\u8be2\u5230\u503c</li> <li>\u6700\u5de6\u524d\u7f00\u539f\u5219\uff1a\u6700\u5de6\u4fa7\u7b2c\u4e00\u4e2a\u6570\u636e\u6709\u5e8f\uff0c\u5f53\u7b2c\u4e00\u4e2a\u6570\u636e\u76f8\u7b49\u65f6\uff0c\u5224\u65ad\u7b2c\u4e8c\u4e2a\u6570\u636e\uff0c\u7b2c\u4e8c\u4e2a\u6570\u636e\u5728\u7b2c\u4e00\u4e2a\u6570\u636e\u76f8\u7b49\u65f6\u6709\u5e8f\uff0c\u6240\u4ee5\u8054\u5408\u7d22\u5f15\u5982\uff1a\uff08a,b,c\uff09,\u67e5\u8be2\u4e3aa=1 and b=3 and c=1\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u5230\u7d22\u5f15\uff0c\u5982\u679c\u662fa &gt; 1 and   b =3 and c = 1\u5219\u4f7f\u7528\u4e0d\u5230\u7d22\u5f15</li> <li>\u7d22\u5f15\u4e0b\u63a8\uff1a\u51cf\u5c11\u56de\u8868\u6b21\u6570\uff0c\u591a\u4e2a\u67e5\u8be2\u6761\u4ef6\u65f6\uff0c\u4f1a\u4f18\u5148\u5728\u666e\u901a\u7528\u7d22\u5f15\u6811\u5185\u505a\u8fc7\u6ee4\uff0c\u518d\u53bb\u56de\u8868\u8fc7\u6ee4</li> </ul> </li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%9F%BA%E7%A1%80%E7%AF%87/#_5","title":"\u5168\u5c40\u9501\u548c\u8868\u7ea7\u884c\u9501","text":"<ul> <li>\u5168\u5c40\u9501\uff1a\u5168\u5c40\u9501\u5bf9\u6574\u4e2a\u6570\u636e\u5e93\u5b9e\u4f8b\u52a0\u9501\uff0c\u5168\u5c40\u8bfb\u9501\u65b9\u5f0f\uff1aFlush tables with read lock.\u6b64\u65f6\u6574\u4e2a\u5e93\u5904\u4e8e\u53ea\u8bfb\u72b6\u6001\uff0c\u5176\u4ed6\u7ebf\u7a0b\u4f1a\u88ab\u963b\u585e\u3002\uff08\u5168\u5e93\u903b\u8f91\u5907\u4efd\u4f7f\u7528\uff09</li> <li>\u8868\u7ea7\u9501<ul> <li>\u8868\u9501\uff1alock tables ... read/write\u4f1a\u9650\u5236\u522b\u7684\u7ebf\u7a0b\u7684\u8bfb\u5199\uff0c\u4e5f\u9650\u5b9a\u4e86\u672c\u7ebf\u7a0b\u63a5\u4e0b\u6765\u7684\u64cd\u4f5c\u5bf9\u8c61\u3002\u9664\u975e\u6267\u884cunlock tables</li> <li>\u5143\u6570\u636e\u9501\uff1a\u65e0\u987b\u663e\u793a\u4f7f\u7528\uff0c\u8bbf\u95ee\u4e00\u4e2a\u8868\u65f6\u81ea\u52a8\u52a0\u4e0a\u3002\u5bf9\u4e00\u4e2a\u8868\u64cd\u4f5c\u589e\u5220\u6539\u67e5\u64cd\u4f5c\u65f6\uff0c\u52a0\u5143\u6570\u636e\u8bfb\u9501\uff1b\u5bf9\u8868\u6570\u636e\u7ed3\u6784\u53d8\u66f4\u64cd\u4f5c\u65f6\uff0c\u52a0\u5143\u6570\u636e\u5199\u9501<ul> <li>\u8bfb\u9501\u4e4b\u95f4\u4e0d\u4e92\u65a5\uff1b\u8bfb\u5199\u9501\u4e4b\u95f4\uff0c\u5199\u9501\u4e4b\u95f4\u4e92\u65a5\uff0c\u4fdd\u8bc1\u53d8\u66f4\u8868\u7ed3\u6784\u64cd\u4f5c\u7684\u5b89\u5168\u6027\uff0c\u5982\u679c\u7531\u4e24\u4e2a\u7ebf\u7a0b\u540c\u65f6\u7ed9\u4e00\u4e2a\u8868\u52a0\u5b57\u6bb5\uff0c\u5176\u4e2d\u4e00\u4e2a\u8981\u7b49\u53e6\u4e00\u4e2a\u6267\u884c\u5b8c\u624d\u80fd\u5f00\u59cb\u6267\u884c</li> <li>\u7ed9\u4e00\u4e2a\u5c0f\u8868\u52a0\u5b57\u6bb5\uff0c\u5982</li> <li>\u5982\u4e0a\u56fe\uff0cA,B\u90fd\u53ef\u4ee5\u6b63\u5e38\u7533\u8bf7\u5230\u8bfb\u9501\uff0c\u4e0d\u4e92\u65a5\uff1b\u5f53alter\u6dfb\u52a0\u8868\u5b57\u6bb5\u65f6\u589e\u52a0\u5199\u9501\uff0cD\u7533\u8bf7\u4e0d\u5230\u8bfb\u9501\u3002\u5f53\u4e1a\u52a1\u6709\u591a\u4e2a\u91cd\u8bd5\uff0c\u8fde\u63a5\u53ef\u80fd\u5f88\u5feb\u7206\u6ee1\u5bfc\u81f4\u6302\u6389---\u89e3\u51b3\uff1aalter table   \u5185\u8bbe\u5b9a\u7b49\u5f85\u65f6\u95f4\uff0c\u62ff\u4e0d\u5230\u5148\u653e\u5f03<code>ALTER TABLE tbl_name WAIT N add column ...</code></li> </ul> </li> <li>online DDL\uff1a\u4f18\u5316\u89e3\u51b3\u4e86\u5199\u9501\u7684\u95ee\u9898<ol> <li>\u62ff\u5143\u6570\u636e\u5199\u9501</li> <li>\u964d\u7ea7\u6210\u5143\u6570\u636e\u8bfb\u9501</li> <li>\u771f\u6b63\u505aDDL</li> <li>\u5347\u7ea7\u6210\u5143\u6570\u636e\u5199\u9501</li> <li>\u5b9e\u653e\u5143\u6570\u636e\u9501</li> </ol> </li> </ul> </li> <li>\u884c\u9501\uff0c\u5f15\u64ce\u5c42\u81ea\u5df1\u5b9e\u73b0<ul> <li>\u4e24\u9636\u6bb5\u9501\u534f\u8bae\uff1a\u5728InnoDB\u4e8b\u52a1\u4e2d\uff0c\u884c\u9501\u662f\u5728\u9700\u8981\u7684\u65f6\u5019\u52a0\u4e0a\u7684\uff0c\u5e76\u4e0d\u662f\u4e0d\u9700\u8981\u4e86\u5c31\u7acb\u523b\u91ca\u653e\uff0c\u800c\u662f\u8981\u7b49\u5230\u4e8b\u52a1\u7ed3\u675f\u624d\u91ca\u653e</li> <li>\u6b7b\u9501\u548c\u6b7b\u9501\u68c0\u6d4b\uff1a\u5e76\u53d1\u7cfb\u7edf\u4e2d\u4e0d\u540c\u7ebf\u7a0b\u51fa\u73b0\u5faa\u73af\u8d44\u6e90\u4f9d\u8d56\uff0c\u6d89\u53ca\u7684\u7ebf\u7a0b\u90fd\u5728\u7b49\u522b\u7684\u7ebf\u7a0b\u91ca\u653e\u8d44\u6e90\u65f6\uff0c\u5c31\u4f1a\u5bfc\u81f4\u8fd9\u51e0\u4e2a\u7ebf\u7a0b\u90fd\u8fdb\u5165\u65e0\u9650\u7b49\u5f85\u7684\u72b6\u6001\uff0c\u79f0\u4e3a\u6b7b\u9501</li> <li>\u6b7b\u9501\u4e24\u79cd\u7b56\u7565\uff1a\u4e00\u76f4\u8fdb\u5165\u7b49\u5f85\uff0c\u76f4\u5230\u8d85\u65f6\uff0cinnodb_lock_wait_timeout\u8bbe\u7f6e\uff0c\u9ed8\u8ba450s;\u53d1\u8d77\u6b7b\u9501\u68c0\u6d4b\uff0c\u53d1\u73b0\u6b7b\u9501\u540e\uff0c\u4e3b\u52a8\u56de\u6eda\u67d0\u4e00\u4e2a\u4e8b\u52a1\uff0c\u8ba9\u5176\u4ed6\u4e8b\u52a1\u7ee7\u7eed\u6267\u884c\uff0cinnodb_deadlock_detect\u8bbe\u7f6e\u4e3aon(     \u6b7b\u9501\u68c0\u6d4b\u4f1a\u8017\u8d39\u5927\u91cfCPU\u8d44\u6e90)</li> </ul> </li> </ul> <p>\u8be6\u7ec6\u5982\u56fe </p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/","title":"Mysql\u5b9e\u8df5","text":"<p>\u5b9e\u9645\u5e94\u7528\uff0c\u5b9e\u9645\u95ee\u9898</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#_1","title":"\u666e\u901a\u7d22\u5f15\u548c\u552f\u4e00\u7d22\u5f15\uff0c\u8be5\u600e\u4e48\u9009","text":"<p>\u573a\u666f:\u5982\u4e00\u4e2a\u5e02\u6c11\u7cfb\u7edf\uff0c\u6bcf\u4e2a\u4eba\u90fd\u9700\u4e00\u4e2a\u552f\u4e00\u8eab\u4efd\u8bc1\u53f7\uff0c\u800c\u4e1a\u52a1\u4ee3\u7801\u65e0\u6cd5\u4fdd\u8bc1\u4e0d\u4f1a\u5199\u5165\u4e24\u4e2a\u91cd\u590d\u7684\u8eab\u4efd\u8bc1\u53f7</p> <p>\u5206\u6790\uff1a\u8eab\u4efd\u8bc1\u53f7\u80af\u5b9a\u4e0d\u5efa\u8bae\u505a\u4e3b\u952e\uff0c\u56e0\u4e3a\u5b57\u6bb5\u6bd4\u8f83\u5927\uff1b\u7ed9id_card\u5b57\u6bb5\u521b\u5efa\u552f\u4e00\u7d22\u5f15\uff1b\u521b\u5efa\u666e\u901a\u7d22\u5f15\u3002</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#_2","title":"\u95ee\u9898\uff1a\u4ece\u6027\u80fd\u7684\u89d2\u5ea6\u8003\u8651\uff0c\u4f60\u9009\u62e9\u552f\u4e00\u7d22\u5f15\u8fd8\u662f\u666e\u901a\u7d22\u5f15\uff1f","text":"<p>\u4f7f\u7528\u666e\u901a\u7d22\u5f15\uff0c\u56e0\u4e3a\u552f\u4e00\u7d22\u5f15\u5728\u66f4\u65b0\u8fc7\u7a0b\u4e2d\u7684\u65f6\u5019\uff0c\u5982\u679c\u8981\u66f4\u65b0\u7684\u8bb0\u5f55\u7684\u76ee\u6807\u6570\u636e\u9875\u4e0d\u5728\u5185\u5b58\u4e2d\uff0c\u9700\u8981\u5c06\u6570\u636e\u9875\u8bfb\u5165\u5185\u5b58\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u4f1a\u589e\u52a0\u4f7f\u7528\u6210\u672c</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#_3","title":"\u67e5\u8be2\u8fc7\u7a0b","text":"<p>\u5047\u8bbe\uff1aselect id from T where k=5\uff08k\u6709\u4e00\u68f5\u4e3b\u952e\u7d22\u5f15\u6811\uff0c\u53f6\u5b50\u8282\u70b9\u5b58\u50a8\u7684\u662f\u4e3b\u952eid\uff09</p> <p>\u901a\u8fc7B+\u6811\u6811\u6839\u5f00\u59cb\uff0c\u6309\u5c42\u641c\u7d22\u5230\u53f6\u5b50\u8282\u70b9\uff0c\u5c06\u6570\u636e\u9875\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u5f00\u59cb\u67e5\u627e</p> <ul> <li>\u666e\u901a\u7d22\u5f15\uff1a\u67e5\u627e\u5230\u6ee1\u8db3\u6761\u4ef6\u7684\u7b2c\u4e00\u4e2a\u8bb0\u5f55\uff085\uff0c500\uff09\u540e\uff0c\u7ee7\u7eed\u627e\u4e0b\u4e2a\u8bb0\u5f55\uff0c\u76f4\u5230\u78b0\u5230\u7b2c\u4e00\u4e2a\u4e0d\u6ee1\u8db3k=5\u6761\u4ef6\u7684\u8bb0\u5f55</li> <li>\u552f\u4e00\u7d22\u5f15\uff0c\u7531\u4e8e\u7d22\u5f15\u5b9a\u4e49\u4e86\u552f\u4e00\u6027\uff0c\u627e\u5230\u7b2c\u4e00\u4e2a\u6ee1\u8db3\u6761\u4ef6\u7684\u8bb0\u5f55\u540e\uff0c\u4f1a\u505c\u6b62\u7ee7\u7eed\u68c0\u7d22</li> </ul> <p>\u6027\u80fd\u5dee\u8ddd\uff0c\u5fae\u4e4e\u5176\u5fae</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#_4","title":"\u66f4\u65b0\u8fc7\u7a0b","text":"<ul> <li>\u8981\u63d2\u5165\u7684\u8bb0\u5f55\u7684\u76ee\u6807\u4e5f\u5728\u5185\u5b58\u4e2d<ul> <li>InnoDB\u5bf9\u4e8e\u552f\u4e00\u7d22\u5f15\u6765\u8bf4\uff0c\u627e\u5230\u4f4d\u7f6e\uff0c\u5224\u65ad\u6ca1\u6709\u51b2\u7a81\uff0c\u63d2\u5165\u8fd9\u4e2a\u503c\uff0c\u8bed\u53e5\u6267\u884c\u7ed3\u675f</li> <li>\u5bf9\u4e8e\u666e\u901a\u7d22\u5f15\u6765\u8bf4\uff0c\u627e\u5230\u4f4d\u7f6e\uff0c\u63d2\u5165\u8fd9\u4e2a\u503c\uff0c\u8bed\u53e5\u6267\u884c\u7ed3\u675f</li> </ul> </li> <li>\u8981\u63d2\u5165\u7684\u8bb0\u5f55\u7684\u76ee\u6807\u9875\u4e0d\u5728\u5185\u5b58\u4e2d<ul> <li>\u552f\u4e00\u7d22\u5f15\uff0c\u9700\u8981\u5c06\u6570\u636e\u9875\u8bfb\u5165\u5185\u5b58\uff0c\u5224\u65ad\u6ca1\u6709\u51b2\u7a81\uff0c\u63d2\u5165\u503c\uff0c\u8bed\u53e5\u6267\u884c\u7ed3\u675f</li> <li>\u666e\u901a\u7d22\u5f15\uff0c\u5c06\u66f4\u65b0\u8bb0\u5f55\u5728change buffer\u91cc\uff0c\u8bed\u53e5\u6267\u884c\u7ed3\u675f</li> </ul> </li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#change-buffer","title":"change buffer","text":"<p>\u5f53\u9700\u8981\u66f4\u65b0\u4e00\u4e2a\u6570\u636e\u9875\u65f6\uff0c\u5982\u679c\u6570\u636e\u9875\u5728\u5185\u5b58\u4e2d\u76f4\u63a5\u66f4\u65b0\uff0c\u5982\u679c\u4e0d\u518d\u5185\u5b58\u4e2d\uff0c\u4e0d\u5f71\u54cd\u6570\u636e\u4e00\u81f4\u6027\u7684\u524d\u63d0\u4e0b\uff0cInnoDB\u5c06\u8fd9\u4e9b\u66f4\u65b0\u64cd\u4f5c\u7f13\u5b58\u5728channge buffer\u4e2d\uff0c\u5728\u4e0b\u6b21\u67e5\u8be2\u9700\u8981\u8bbf\u95ee\u8fd9\u4e2a\u6570\u636e\u9875\u7684\u65f6\u5019\uff0c\u5c06\u6570\u636e\u9875\u8bfb\u5165\u5185\u5b58\uff0c\u7136\u540e\u6267\u884cchange buffer\u4e2d\u4e0e\u8fd9\u4e2a\u9875\u6709\u5173\u7684\u64cd\u4f5c</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#change-buffermerge","title":"\u5c06change buffer\u4e2d\u7684\u64cd\u4f5c\u5e94\u7528\u5230\u6570\u636e\u9875\uff0c\u5f97\u5230\u6700\u65b0\u7ed3\u679c\u7684\u8fc7\u7a0b\u79f0\u4e3amerge","text":"<ol> <li>\u8bbf\u95ee\u8fd9\u4e2a\u6570\u636e\u9875\u4f1a\u89e6\u53d1merge</li> <li>\u7cfb\u7edf\u6709\u540e\u53f0\u7ebf\u7a0b\u4f1a\u5b9a\u671fmerge</li> <li>\u6570\u636e\u5e93\u6b63\u5e38\u5173\u95ed\u8fc7\u7a0b\u4e2d\uff0c\u4e5f\u4f1amerge</li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#_5","title":"\u4ec0\u4e48\u6761\u4ef6\u4e0b\u4f7f\u7528","text":"<ul> <li>\u666e\u901a\u7d22\u5f15\uff1amerge\u65f6\u771f\u6b63\u8fdb\u884c\u66f4\u65b0\u7684\u65f6\u523b\uff0c\u6240\u4ee5merge\u4e4b\u524d\uff0cchange buffer\u8bb0\u5f55\u7684\u53d8\u66f4\u8d8a\u591a\uff0c\u6536\u76ca\u5c31\u8d8a\u5927\uff1b\u56e0\u6b64\u5199\u591a\u8bfb\u5c11\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u4f7f\u7528\u6548\u679c\u6700\u597d\uff08\u8d26\u5355\uff0c\u65e5\u5fd7\u7c7b\uff09</li> <li>\u552f\u4e00\u7d22\u5f15\u4e0d\u80fd\u4f7f\u7528\u7684\u539f\u56e0\u662f\uff0c\u6240\u6709\u66f4\u65b0\u64cd\u4f5c\u90fd\u8981\u5148\u5224\u65ad\u662f\u5426\u8fdd\u53cd\u552f\u4e00\u6027\u7ea6\u675f\uff0c\u5224\u65ad\u65b9\u5f0f\u662f\u9700\u8981\u5c06\u6570\u636e\u9875\u8bfb\u5165\u5185\u5b58\u5224\u65ad\u3002\u6570\u636e\u9875\u5df2\u8fdb\u5165\u5185\u5b58\uff0c\u5c31\u6ca1\u5fc5\u8981\u4f7f\u7528change buffer\u4e86</li> </ul> <p>\u6ce8\u610f</p> <p>change buffer\u4f7f\u7528\u7684\u662fbuffer pool\u91cc\u7684\u5185\u5b58\uff0c\u4e0d\u80fd\u65e0\u9650\u589e\u5927\u3002\u8bbe\u7f6einnodb_change_buffer_max_size\u52a8\u6001\u8bbe\u7f6e</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#change-bufferredo-log","title":"change buffer\u548credo log","text":"<ol> <li>\u793a\u4f8b\uff1a\u5047\u8bbe\u8981\u6267\u884c\u5982\u4e0b\u63d2\u5165\u8bed\u53e5\uff1ainsert into t(id,k) values(id1,k1),(id2,k2);<ol> <li>\u5047\u8bbe\u5f53\u524dk\u7d22\u5f15\u6811\u7684\u72b6\u6001\uff0c\u67e5\u5230\u4f4d\u7f6e\u540e\uff0ck1\u6240\u5728\u7684\u6570\u636e\u9875\u5728\u5185\u5b58\uff08InnoDB buffer pool\uff09\u4e2d\uff0ck2\u7684\u6570\u636e\u9875\u4e0d\u5728\u5185\u5b58\u4e2d</li> <li>\u5206\u6790\uff0c\u6d89\u53ca\u56db\u4e2a\u90e8\u5206\uff08\u5185\u5b58\uff0credo log,\u7cfb\u7edf\u8868\u7a7a\u95f4-t.ibd\uff0c\u7cfb\u7edf\u8868\u7a7a\u95f4-ibdata1\uff09<ul> <li>Page1\u5728\u5185\u5b58\u4e2d\uff0c\u76f4\u63a5\u66f4\u65b0\u5185\u5b58</li> <li>Page2\u4e0d\u5728\u5185\u5b58\u4e2d\uff0c\u5c31\u5728\u5185\u5b58\u7684change buffer\u533a\u57df\uff0c\u8bb0\u5f55\u4e0b\u201c\u6211\u8981\u5f80Page2\u63d2\u5165\u4e00\u884c\u201d\u8fd9\u4e2a\u4fe1\u606f</li> <li>\u5c06\u4e0a\u8ff0\u4e24\u4e2a\u52a8\u4f5c\u8bb0\u5165redo log</li> </ul> </li> <li>\u6267\u884c\u8fd9\u6761\u66f4\u65b0\u8bed\u53e5\uff1a\u5199\u4e86\u4e24\u5904\u5185\u5b58\uff0c\u5199\u4e86\u4e00\u5904\u78c1\u76d8\uff0c\u987a\u5e8f\u5199\u7684</li> </ol> </li> <li>\u4e4b\u540e\u7684\u8bfb\u8bf7\u6c42\uff0c\u5982\uff1aselect * from where k in (k1,k2)<ol> <li>\u5982\u679c\u53d1\u751f\u5728\u66f4\u65b0\u8bed\u53e5\u540e\u4e0d\u4e45\uff0c\u5185\u5b58\u4e2d\u6570\u636e\u5728\uff0c\u6b64\u65f6\u8bfb\u64cd\u4f5c\u5c31\u4e0e\u7cfb\u7edf\u8868\u7a7a\u95f4(ibdata1)\u548credo log\u65e0\u5173<ol> <li>\u8bfbPage1\u65f6\uff0c\u76f4\u63a5\u4ece\u5185\u5b58\u8fd4\u56de</li> <li>\u8bfbPage2\u65f6\uff0c\u8981\u4ece\u78c1\u76d8\u8bfb\u5165\u5185\u5b58\uff0c\u7136\u540e\u5e94\u7528change buffer\u91cc\u7684\u64cd\u4f5c\u65e5\u5fd7\uff0c\u751f\u6210\u4e00\u4e2a\u6b63\u786e\u7684\u7248\u672c\u5e76\u8fd4\u56de\u7ed3\u679c</li> </ol> </li> </ol> </li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#_6","title":"\u7ed9\u5b57\u7b26\u4e32\u5b57\u6bb5\u52a0\u7d22\u5f15","text":"<p>\u573a\u666f\uff1a\u4e00\u4e2a\u652f\u6301\u90ae\u7bb1\u767b\u5f55\u7684\u7cfb\u7edf\uff0c\u7528\u6237\u8868\u5b9a\u4e49\uff1a</p> <pre><code>mysql\n&gt;\ncreate table SUser\n(\n    ID    bigint unsigned primary key,\n    email varchar(64), .\n    .\n    .\n)engine=innodb; \n</code></pre> <p>email\u5b57\u6bb5\u4e24\u79cd\u7d22\u5f15\u65b9\u5f0f</p> <ul> <li>alter table SUser add index index1(email); \u6574\u4e2a\u5b57\u7b26\u4e32\u5efa\u7d22\u5f15   </li> <li>alter table SUser add index index2(email(6)); \u524d\u7f00\u7d22\u5f15\uff0c\u53ea\u53d6\u524d6\u4e2a\u5b57\u8282</li> <li></li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#_7","title":"\u4f7f\u7528\u67e5\u8be2\u8bed\u53e5\uff0c\u5728\u4e24\u79cd\u7d22\u5f15\u7ed3\u6784\u5185\u5206\u522b\u65f6\u600e\u4e48\u6267\u884c\u7684\uff1f","text":"<p>select id,name,email from SUser where email='zhangssxyz@xxx.com'</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#email","title":"\u5982\u679c\u4f7f\u7528\u7684\u662femail\u6574\u4e2a\u5b57\u7b26\u4e32\u7684\u7d22\u5f15\u7ed3\u6784\uff0c\u6267\u884c\u987a\u5e8f\u5982\uff1a","text":"<ol> <li>\u4eceindex1\u7d22\u5f15\u6811\u627e\u5230\u6ee1\u8db3\u7d22\u5f15\u503c\u7b26\u5408\u6761\u4ef6\u7684\u8fd9\u6761\u8bb0\u5f55\uff0c\u53d6\u5f97ID2\u7684\u503c</li> <li>\u5230\u4e3b\u952e\u7d22\u5f15\u4e0a\u67e5\u5230\u4e3b\u952e\u503c\u662fID2\u7684\u884c\uff0c\u5224\u65ademail\u503c\u662f\u5426\u6b63\u786e\uff0c\u5c06\u8fd9\u884c\u8bb0\u5f55\u52a0\u5165\u7ed3\u679c\u96c6</li> <li>\u53d6index1\u7d22\u5f15\u6811\u4e0a\u521a\u521a\u67e5\u5230\u7684\u4f4d\u7f6e\u7684\u4e0b\u4e00\u6761\u8bb0\u5f55\uff0c\u53d1\u73b0\u4e0d\u6ee1\u8db3\uff0c\u5faa\u73af\u7ed3\u675f</li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#email6","title":"\u5982\u679c\u4f7f\u7528\u7684\u662femail(6)\u7d22\u5f15\u7ed3\u6784\uff0c\u6267\u884c\u987a\u5e8f\u5982\uff1a","text":"<ol> <li>\u4eceindex2\u7d22\u5f15\u6811\u627e\u5230\u6ee1\u8db3\u6761\u4ef6\u7684\u8bb0\u5f55\uff0c\u627e\u5230\u7b2c\u4e00\u4e2a\u662fID1</li> <li>\u5230\u4e3b\u952e\u4e0a\u67e5\u5230\u4e3b\u952e\u503c\u662fID1\u7684\u884c\uff0c\u5224\u65ad\u51faemail\u7684\u503c\u4e0d\u662f\u5b8c\u6574\u5339\u914d\u7684email\u6570\u636e\uff0c\u8fd9\u884c\u8bb0\u5f55\u4e22\u5f03</li> <li>\u5728index2\u4e0a\u53d6\u4e0b\u4e00\u6761\u7b26\u5408\u6761\u4ef6\u7684\u8bb0\u5f55\uff0c\u53d6\u51faID2\uff0c\u518d\u5230\u4e3b\u952e\u7d22\u5f15\u6811\u4e0a\u53d6\u503c\u5224\u65ad\uff0c\u8fd9\u6b21\u5bf9\uff0c\u5c06\u8fd9\u884c\u8bb0\u5f55\u52a0\u5165\u7ed3\u679c\u96c6</li> <li>\u91cd\u590d\u4e0a\u4e00\u90e8\uff0c\u76f4\u5230\u5728index2\u4e0a\u53d6\u5230\u7684\u503c\u4e0d\u662f\u2018zhangs\u2019\u65f6\uff0c\u5faa\u73af\u7ed3\u675f</li> </ol> <p>\u5bf9\u6bd4\uff1a\u5982\u679c\u4f7f\u7528\u524d\u7f00\u7d22\u5f15\uff0c\u5b9a\u4e49\u597d\u957f\u5ea6\uff0c\u5c31\u53ef\u4ee5\u505a\u5230\u65e2\u8282\u7701\u7a7a\u95f4\uff0c\u53c8\u4e0d\u7528\u989d\u5916\u589e\u52a0\u592a\u591a\u7684\u67e5\u8be2\u6210\u672c\uff1b\u4f7f\u7528\u524d\u7f00\u7d22\u5f15\u7528\u4e0d\u4e0a\u8986\u76d6\u7d22\u5f15\u5bf9\u67e5\u8be2\u6027\u80fd\u7684\u4f18\u5316\u3002</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#_8","title":"\u4e3a\u4ec0\u4e48\u6570\u636e\u5e93\u4f1a\u201c\u6296\u201d\u4e00\u4e0b","text":"<p>flush\u5237\u65b0\u810f\u9875\u6570\u636e\u8fc7\u7a0b\u4f1a\u5bfc\u81f4\u201c\u201d\u6296</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#_9","title":"\u810f\u9875","text":"<p>InnoDb\u5728\u5904\u7406\u66f4\u65b0\u8bed\u53e5\u65f6\uff0c\u53ea\u505a\u4e86\u5199\u65e5\u5fd7redo log\u8fd9\u4e00\u6b65\u64cd\u4f5c\uff0c\u66f4\u65b0\u5185\u5b58\u5199\u5b8credolog\u540e\uff0c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002\u6b64\u65f6\uff0c\u5f53\u5185\u5b58\u6570\u636e\u9875\u8ddf\u78c1\u76d8\u6570\u636e\u9875\u5185\u5bb9\u4e0d\u4e00\u81f4\u65f6\uff0c\u8fd9\u4e2a\u5185\u5b58\u9875\u4e3a\u201c\u810f\u9875\u201d</p> <ul> <li>redo log \u5199\u6ee1\u4e86\uff0c\u8981flush\u810f\u9875\uff08\u5e94\u8be5\u5c3d\u91cf\u907f\u514d\uff0c\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\uff0c\u6574\u4e2a\u7cfb\u7edf\u4e0d\u80fd\u518d\u63a5\u53d7\u66f4\u65b0\uff0c\u6240\u6709\u66f4\u65b0\u5835\u4f4f\uff09</li> <li>\u5185\u5b58\u4e0d\u591f\u7528\uff0c\u9700\u8981\u5148\u5c06\u810f\u9875\u5199\u5230\u78c1\u76d8\uff08\u5e38\u6001\uff0cInnoDB\u7528\u7f13\u51b2\u6c60\u7ba1\u7406\u5185\u5b58\uff09</li> <li>\u7a7a\u95f2\u65f6\u64cd\u4f5c\uff0c\u7cfb\u7edf\u65e0\u538b\u529b</li> <li>\u6b63\u5e38\u5173\u95edmysql\u65f6\uff0c\u4f1a\u628a\u5185\u5b58\u7684\u810f\u9875\u90fdflush\u5230\u78c1\u76d8\u4e0a</li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#innodb","title":"InnoDb\u5237\u810f\u9875\u7684\u63a7\u5236\u7b56\u7565","text":"<ol> <li> <p>innodb_io_capacity\u53c2\u6570\uff0c\u8ba9InnoDb\u76f4\u5230\u78c1\u76d8\u80fd\u529b\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e3aIOPS</p> </li> <li> <p>\u591a\u5173\u6ce8\u810f\u9875\u6bd4\u4f8b\uff0c\u4e0d\u8981\u8ba9\u5b83\u7ecf\u5e38\u63a5\u8fd175%</p> </li> <li> <p>innodb_flush_neighbors\u53c2\u65701\u4e3a\u8fde\u5750\u673a\u5236\uff0c\u6bd4\u5982\u5237\u4e00\u4e2a\u810f\u9875\u65f6\u4f1a\u5c06\u65c1\u8fb9\u7684\u4e00\u8d77\u5237\u6389\uff0c\u5e76\u4e14\u4f1a\u4e00\u76f4\u8513\u5ef6\uff08mysql8.0\u9ed8\u8ba4\u503c\u4e3a0--\u53ea\u5237\u81ea\u5df1\u7684\uff09</p> </li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#_10","title":"\u8868\u6570\u636e\u5220\u6389\u4e00\u534a\uff0c\u8868\u6587\u4ef6\u5927\u5c0f\u4e0d\u53d8\uff1f","text":"<p>drop table\u547d\u4ee4\u56de\u6536\u8868\u7a7a\u95f4\uff0c\u5927\u5c0f\u4f1a\u53d8\u5316</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#_11","title":"\u5220\u9664\u8868\u4e2d\u6570\u636e\u65f6\u7684\u6d41\u7a0b","text":"<p>InnoDb\u5f15\u64ce\uff1a\u7d22\u5f15\u7ed3\u6784\u5982\u56fe\uff0c\u5220\u9664R4\u7684\u6570\u636e\u65f6\uff0c\u5f15\u64ce\u53ea\u4f1a\u628aR4\u8fd9\u4e2a\u8bb0\u5f55\u6807\u8bb0\u4e3a\u5220\u9664\uff0c\u5982\u679c\u4e4b\u540e\u518d\u63d2\u5165\u4e00\u4e2aID\u5728300-600\u4e4b\u95f4\u7684\u8bb0\u5f55\uff0c\u53ef\u80fd\u4f1a\u590d\u7528\u8fd9\u4e2a\u4f4d\u7f6e</p> <p></p> <p>\u5982\u679c\u6574\u4e2a\u6570\u636e\u9875\u7684\u6570\u636e\u88ab\u5220\u9664\u5462\uff1f</p> <ul> <li>\u6570\u636e\u9875\u53ef\u4ee5\u88ab\u590d\u7528\uff1aPageA\u4f1a\u88ab\u6807\u8bb0\u4e3a\u53ef\u590d\u7528\uff0c\u5982\u679c\u8981\u63d2\u5165\u4e00\u6761ID=50\u7684\u8bb0\u5f55\u9700\u8981\u4f7f\u7528\u65b0\u9875\u7684\u65f6\u5019\uff0cPageA\u53ef\u4ee5\u88ab\u590d\u7528</li> <li>\u5982\u679c\u76f8\u90bb\u7684\u4e24\u4e2a\u6570\u636e\u9875\u5229\u7528\u7387\u5f88\u5c0f\uff0c\u7cfb\u7edf\u4f1a\u628a\u4e24\u4e2a\u9875\u4e0a\u6570\u636e\u5408\u5230\u4e00\u4e2a\u9875\u4e0a\uff0c\u53e6\u4e00\u4e2a\u6570\u636e\u9875\u88ab\u6807\u8bb0\u4e3a\u53ef\u590d\u7528</li> </ul> <p>\u89e3\u7b54\u95ee\u9898\uff1a\u5982\u679c\u7528delete\u547d\u4ee4\u5c06\u6574\u4e2a\u8868\u6570\u636e\u5220\u9664\uff0c\u6240\u6709\u7684\u6570\u636e\u9875\u90fd\u4f1a\u88ab\u6807\u8bb0\u4e3a\u53ef\u590d\u7528\uff0c\u78c1\u76d8\u4e0a\uff0c\u6587\u4ef6\u4e0d\u4f1a\u53d8\u5c0f</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#_12","title":"\u9875\u7a7a\u6d1e","text":"<ol> <li>delete\u5220\u9664\u6570\u636e\uff0c\u9875\u88ab\u6807\u8bb0\u4e3a\u53ef\u590d\u7528\uff0c\u6ca1\u6709\u88ab\u4f7f\u7528\u7684\u7a7a\u95f4\uff0c\u5c31\u662f\u9875\u7a7a\u6d1e</li> <li>\u63d2\u5165\u6570\u636e\u4e5f\u4f1a\uff0c\u5982\uff1a\u6309\u7167\u7d22\u5f15\u987a\u5e8f\u63d2\u5165\uff0c\u7d22\u5f15\u7d27\u51d1\uff1b\u5982\u679c\u662f\u968f\u673a\u63d2\u5165\uff0c\u53ef\u80fd\u9020\u6210\u7d22\u5f15\u7684\u6570\u636e\u9875\u5206\u88c2</li> <li>\u66f4\u65b0\u7d22\u5f15\u4e0a\u7684\u503c\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u5220\u9664\u4e00\u4e2a\u65e7\u503c\uff0c\u518d\u63d2\u5165\u4e00\u4e2a\u65b0\u503c\uff0c\u4e5f\u4f1a\u9020\u6210\u7a7a\u6d1e</li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#_13","title":"\u7ecf\u8fc7\u5927\u91cf\u589e\u5220\u6539\u7684\u8868\uff0c\u90fd\u53ef\u80fd\u5b58\u5728\u7a7a\u6d1e\uff0c\u5982\u679c\u53bb\u6389\u7a7a\u6d1e\uff0c\u53ef\u4ee5\u8fbe\u5230\u6536\u7f29\u8868\u7a7a\u95f4\u7684\u76ee\u7684","text":"<p>\u91cd\u5efa\u8868\uff08\u63a8\u8350\u4f7f\u7528gh-ost\uff09</p> <ol> <li>alter table A engine = InnoDB\u547d\u4ee4\uff08mysql\u4f1a\u81ea\u52a8\u5b8c\u6210\u8f6c\u5b58\u6570\u636e\u3001\u4ea4\u6362\u8868\u540d\u3001\u5220\u9664\u65e7\u8868\u7684\u64cd\u4f5c\uff09\u9501\u8868\uff0c\u4e0d\u80fd\u6709\u522b\u7684\u64cd\u4f5c<ul> <li>\u601d\u8def\uff1a\u65b0\u5efa\u4e00\u4e2a\u4e0e\u8868A\u7ed3\u6784\u76f8\u540c\u7684\u8868B,\u7136\u540e\u6309\u4e3b\u952eID\u9012\u589e\u987a\u5e8f\uff0c\u5c06\u6570\u636e\u4e00\u884c\u884c\u4ece\u8868A\u8bfb\u51fa\u63d2\u5165\u5230\u8868B</li> </ul> </li> <li>online DDL\uff08\u5f00\u59cb\u590d\u5236\u4e34\u65f6\u6570\u636e\u65f6\uff0c\u4f1a\u5c06\u5143\u6570\u636e\u5199\u9501\u964d\u7ea7\u4e3a\u8bfb\u9501\uff09<ol> <li>\u5efa\u7acb\u4e34\u65f6\u6587\u4ef6\uff0c\u626b\u63cfA\u4e3b\u952e\u6240\u6709\u6570\u636e\u9875</li> <li>\u7528\u6570\u636e\u9875\u4e2dA\u7684\u8bb0\u5f55\u751f\u6210B+\u6811\uff0c\u5b58\u50a8\u5230\u4e34\u65f6\u6587\u4ef6</li> <li>\u751f\u6210\u4e34\u65f6\u6587\u4ef6\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5c06\u6240\u6709\u5bf9A\u7684\u64cd\u4f5c\u8bb0\u5f55\u5728\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\uff08row log\uff09\u4e2d</li> <li>\u4e34\u65f6\u6587\u4ef6\u751f\u6210\u540e\uff0c\u5c06\u65e5\u5fd7\u6587\u4ef6\u7684\u64cd\u4f5c\u5e94\u7528\u5230\u4e34\u65f6\u6587\u4ef6\uff0c\u5f97\u5230\u4e00\u4e2a\u903b\u8f91\u6570\u636e\u4e0a\u4e0e\u8868A\u76f8\u540c\u7684\u6570\u636e\u6587\u4ef6</li> <li>\u7528\u4e34\u65f6\u6587\u4ef6\u66ff\u6362\u8868A\u7684\u6570\u636e\u6587\u4ef6</li> </ol> </li> <li>mysql5.5\u7248\u672c\u4e4b\u540e\uff0c\u52a0\u5168\u6587\u7d22\u5f15\u5e76\u4e0d\u662fonline</li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#ididid","title":"\u5206\u5e03\u5f0fID\uff08\u96ea\u82b1\u7b97\u6cd5\u751f\u6210\uff0cID\u8d8a\u6765\u8d8a\u5927\uff0c\u4f46\u4e0d\u662f\u9012\u589e\uff09\u751f\u6210\u7684\u7d22\u5f15\u4f1a\u6bd4\u81ea\u589e\u957f\u7684ID\u6027\u80fd\u4f4e\u5417\uff1f","text":"<p>\u6027\u80fd\u4e00\u6837\uff0c\u6ca1\u6709\u4e00\u5b9a\u8981\u8fde\u7eed\uff0c\u53ea\u8981\u662f\u9012\u589e</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#count","title":"count(*)\u8fd9\u4e48\u6162","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#_14","title":"\u5b9e\u73b0","text":"<ul> <li>MyISAM\u5f15\u64ce\uff1a\u4e00\u4e2a\u8868\u7684\u603b\u884c\u6570\u5b58\u5728\u4e86\u78c1\u76d8\u4e0a\uff0c\u6267\u884ccount(*)\u65f6\u4f1a\u76f4\u63a5\u8fd4\u56de\u8fd9\u4e2a\u6570\uff0c\u6548\u7387\u5f88\u9ad8</li> <li>InnoDB\u5f15\u64ce\uff1a\u6267\u884ccount(*)\uff0c\u9700\u8981\u5c06\u6570\u636e\u4e00\u884c\u884c\u4ece\u5f15\u64ce\u91cc\u8bfb\u53d6\u51fa\u6765\uff0c\u7d2f\u79ef\u8ba1\u6570</li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#innodb_1","title":"\u4e3a\u4ec0\u4e48InnoDB\u4e0d\u80fd\u5c06\u6570\u91cf\u5b58\u50a8\uff1f","text":"<p>\u56e0\u4e3a\u5373\u4f7f\u540c\u4e00\u4e2a\u65f6\u523b\u7684\u591a\u4e2a\u67e5\u8be2\uff0c\u7531\u4e8eMVCC\u7684\u539f\u56e0\uff0c\u8fd4\u56de\u591a\u5c11\u884c\u4e5f\u662f\u4e0d\u786e\u5b9a\u7684\uff08\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u6709\u5173\uff09</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#innodbcount","title":"InnoDB\u5728count(*)\u4e0a\u505a\u4e86\u4ec0\u4e48\u4f18\u5316\uff1f","text":"<ul> <li>\u4fdd\u8bc1\u903b\u8f91\u6b63\u786e\u7684\u524d\u63d0\u4e0b\uff0c\u5c3d\u91cf\u51cf\u5c11\u626b\u63cf\u7684\u6570\u636e\u91cf\uff0c\u6570\u636e\u5e93\u7cfb\u7edf\u6d89\u53ca\u7684\u901a\u7528\u6cd5\u5219\u4e4b\u4e00 \uff08\u4e3b\u952e\u7d22\u5f15\u6811\u6bd4\u666e\u901a\u7d22\u5f15\u6811\u5927\u5f88\u591a\uff09</li> <li>show table status\u547d\u4ee4\u67e5\u8be2\u5230\u7684TABLE_ROWS\u4e5f\u662f\u91c7\u6837\u4f30\u7b97\u7684\uff0c\u8bef\u5dee\u53ef\u80fd\u8fbe\u523040%-50%</li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql%E5%AE%9E%E6%88%98-%E5%AE%9E%E8%B7%B5%E7%AF%87/#countserver","title":"count\u662f\u51fd\u6570\u64cd\u4f5c\uff0c\u4f5c\u7528\u5728server\u5c42","text":"<ol> <li>\u9488\u5bf9\u8fd4\u56de\u7684\u7ed3\u679c\u96c6\uff0c\u4e00\u884c\u884c\u5224\u65ad\uff0ccount\u7684\u5b57\u6bb5\u503c\u4e0d\u662fnull,\u7d2f\u8ba1\u503c+1</li> <li>count(\u5b57\u6bb5)\u6807\u8bc6\u8fd4\u56de\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u636e\u884c\u91cc\u9762\uff0c\u4e0d\u4e3aNULL\u7684\u603b\u4e2a\u6570</li> <li>\u6309\u7167\u6548\u7387\u6392\u5e8f\uff1acount(\u5b57\u6bb5)&lt;count(\u4e3b\u952eid)&lt;count(1)\u7ea6\u7b49\u4e8ecount(*)<ol> <li>\u56e0\u4e3acount(*)\u4e0d\u4f1a\u628a\u6240\u6709\u5b57\u6bb5\u53d6\u51fa\u6765\uff0c\u76f4\u63a5\u6309\u884c\u7d2f\u52a0\uff1b\u522b\u7684\u5b57\u6bb5\u7684\uff0c\u9700\u8981\u5148\u53d6\u51fa\u6765\uff0c\u62f7\u8d1d\u5b57\u6bb5\uff0c\u518d\u5224\u65ad\u4e0d\u4e3a\u7a7a\uff0c\u518d\u7d2f\u52a0</li> </ol> </li> </ol> <p>\u8be6\u7ec6\u5982\u56fe </p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E5%B8%B8%E7%94%A8SQL%E8%81%9A%E5%90%88/","title":"SQL","text":""},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E5%B8%B8%E7%94%A8SQL%E8%81%9A%E5%90%88/#_1","title":"\u67e5\u8be2","text":"<ol> <li>\u7edf\u8ba1\u8868\u4e2d\u662f\u5426\u6709\u91cd\u590d\u6570\u636e</li> </ol> <p><code>sql     select user_id, contract_code, count(contract_code)     from vts_finance.deposit_contract_summary     group by contract_code     having count(contract_code) &gt; 1;</code> 2. \u6570\u636e\u8868\u5b57\u6bb5\u4e2d\u5b58\u5728json\u5b57\u6bb5\u5982\u4f55\u7edf\u8ba1json\u5185\u7684\u6570\u636e</p> <pre><code>SELECT\n    JSON_EXTRACT(t.request_json, '$.description') AS req,\n    COUNT(1) AS con\nFROM\n    vts_finance.api_request_record t\nWHERE\n    1 = 1\n    AND t.api_code = 'open.api.eternalAsial.callBack'\n    AND t.business_number LIKE 'JY2408%'\n    -- AND JSON_EXTRACT(t.request_json, '$.data.description') IS NOT NULL\n    AND JSON_LENGTH(JSON_EXTRACT(t.request_json, '$.description')) &gt; 0\nGROUP BY\n    req\nORDER BY\n    con DESC;\n</code></pre> <ol> <li></li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/","title":"Mysql","text":"<p>\u6570\u636e\u5e93\uff08\u7c97\u7c92\u5ea6\u5b66\u4e60\uff09</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#_1","title":"\u7d22\u5f15\u7b80\u4ecb","text":"<p>\u5b9a\u4e49\uff1a\u7d22\u5f15\u662f\u5e2e\u52a9mysql\u9ad8\u6548\u83b7\u53d6\u6570\u636e\u7684--\u6570\u636e\u7ed3\u6784\uff08\u81ea\u5df1\u7406\u89e3\uff1a\u6392\u597d\u5e8f\u7684\u5feb\u901f\u67e5\u627e\u7684\u6570\u636e\u7ed3\u6784\uff09 \u7d22\u5f15\u5e76\u975e\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\uff0c\u4e00\u822c\u4ee5\u6587\u4ef6\u5f62\u5f0f\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#_2","title":"\u4e3a\u4ec0\u4e48\u7ef4\u62a4\u903b\u8f91\u5220\u9664\u5b57\u6bb5","text":"<ol> <li>\u4e3a\u4e86\u6570\u636e\u5206\u6790</li> <li>\u4e3a\u4e86\u7d22\u5f15\u6811\uff0c\u7ecf\u5e38\u7269\u7406\u5220\u9664\u6570\u636e\u5bb9\u6613\u9020\u6210\u9875\u5206\u88c2</li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#_3","title":"\u7d22\u5f15\u5206\u7c7b","text":"<ul> <li>\u5355\u503c\u7d22\u5f15:\u4e00\u4e2a\u7d22\u5f15\u5305\u542b\u5355\u4e2a\u5217</li> <li>\u552f\u4e00\u7d22\u5f15:\u7d22\u5f15\u5217\u7684\u503c\u5fc5\u987b\u552f\u4e00\uff0c\u5141\u8bb8\u6709\u7a7a\u503c</li> <li>\u590d\u5408\u7d22\u5f15:\u4e00\u4e2a\u7d22\u5f15\u5305\u542b\u591a\u5217</li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#_4","title":"\u4ec0\u4e48\u65f6\u5019\u9700\u8981\u521b\u5efa\u7d22\u5f15","text":"<ul> <li>\u9700\u8981\u521b\u5efa<ol> <li>\u4e3b\u952e\u81ea\u52a8\u521b\u5efa\u552f\u4e00\u7d22\u5f15</li> <li>\u9891\u7e41\u4f5c\u4e3a\u67e5\u8be2\u6761\u4ef6\u7684\u5b57\u6bb5</li> <li>\u6392\u5e8f\u5b57\u6bb5</li> <li>\u67e5\u8be2\u4e2d\u7edf\u8ba1\u6216\u5206\u7ec4\u5b57\u6bb5</li> </ol> </li> <li>\u65e0\u987b\u521b\u5efa<ol> <li>\u8868\u8bb0\u5f55\u592a\u5c11</li> <li>\u7ecf\u5e38\u589e\u5220\u6539\u7684\u8868</li> <li>\u6570\u636e\u91cd\u590d\u4e14\u5206\u5e03\u5e73\u5747\u7684\u5b57\u6bb5\uff0c\u6bd4\u5982\u7c7b\u522b\u3001\u6027\u683c\u65e0\u987b\u521b\u5efa</li> </ol> </li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#_5","title":"\u7d22\u5f15\u4f18/\u52a3\u52bf","text":"<ul> <li>\u4f18\u52bf<ul> <li>\u63d0\u9ad8\u6570\u636e\u68c0\u7d22\u6548\u7387\uff0c\u964d\u4f4e\u6570\u636e\u5e93\u7684IO</li> <li>\u901a\u8fc7\u6240\u4ee5\u5217\u5bf9\u6570\u636e\u8fdb\u884c\u6392\u5e8f\uff0c\u964d\u4f4e\u6570\u636e\u6392\u5e8f\u6210\u672c\uff0c\u964d\u4f4eCPU\u6d88\u8017</li> </ul> </li> <li>\u52a3\u52bf<ul> <li>\u5f71\u54cd\u63d2\u5165/\u4fee\u6539/\u5220\u9664\u6027\u80fd</li> <li>\u7d22\u5f15\u5217\u8981\u5360\u7528\u7a7a\u95f4</li> </ul> </li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#explain","title":"\u6027\u80fd\u5206\u6790Explain","text":"<p>mysql\u5e38\u89c1\u74f6\u9888</p> <ol> <li>CPU\u8d1f\u62c5\u91cd\uff0c\u6570\u636e\u5728\u88c5\u5165\u5185\u5b58\u6216\u8005\u4ece\u78c1\u76d8\u8bfb\u53d6\u6570\u636e\u65f6</li> <li>IO\u8d1f\u62c5\u91cd\uff0c\u88c5\u5165\u6570\u636e\u8fdc\u5927\u4e8e\u5185\u5b58\u5bb9\u91cf\u65f6</li> <li>\u670d\u52a1\u5668\u786c\u4ef6\u6027\u80fd\u74f6\u9888</li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#explain_1","title":"Explain","text":"<p>\u67e5\u8be2\u6267\u884c\u8ba1\u5212\uff0c\u518d\u6267\u884csql\u4e4b\u524d\u589e\u52a0explain</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#id","title":"id","text":"<p>select\u67e5\u8be2\u7684\u5e8f\u5217\u53f7\uff0c\u8868\u793a\u67e5\u8be2\u4e2d\u6267\u884cselect\u5b50\u53e5\u6216\u64cd\u4f5c\u8868\u7684\u987a\u5e8f</p> <p>\u503c\u4e09\u79cd\u60c5\u51b5</p> <ol> <li>\u76f8\u540c\uff0c\u6267\u884c\u987a\u5e8f\u7531\u4e0a\u81f3\u4e0b</li> <li>id\u4e0d\u540c\uff0c\u5982\u679c\u662f\u81ea\u67e5\u8be2\uff0cid\u5e8f\u53f7\u9012\u589e\uff0cid\u503c\u8d8a\u5927\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0c\u8d8a\u5148\u88ab\u6267\u884c</li> <li>id\u76f8\u540c\u4e0d\u540c\uff0cid\u503c\u8d8a\u5927\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0c\u8d8a\u5148\u6267\u884c\uff1b\u76f8\u540c\uff0c\u4ece\u4e0a\u5f80\u4e0b\u987a\u5e8f\u6267\u884c</li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#select_type","title":"select_type","text":"<p>\u67e5\u8be2\u7c7b\u578b\uff0c\u5982\u666e\u901a\u67e5\u8be2\uff0c\u5b50\u67e5\u8be2\uff0c\u8054\u5408\u67e5\u8be2\u7b49\u7b49</p> <ol> <li>SIMPLE</li> <li>PRIMARY \u4e3b\u952e\u67e5\u8be2</li> <li>SUBQUERY</li> <li>DERIVED(\u4e34\u65f6\u8868\uff0c\u884d\u751f\u8868)</li> <li>UNION \u8054\u5408\u67e5\u8be2</li> <li>UNION RESULT</li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#type","title":"type(\u5173\u952e\u53c2\u6570)","text":"<p>\u8bbf\u95ee\u7c7b\u578b,\u73b0\u5b9e\u67e5\u8be2\u4f7f\u7528\u4e86\u4f55\u79cd\u7c7b\u578b\uff0c\u4ece\u6700\u597d\u5230\u6700\u5dee\u6392\u5e8f\u4e3a\uff1asystem&gt;const&gt;eq_ref&gt;ref&gt;range&gt;index&gt;ALL.\uff08\u4f18\u5316\u81f3\u5c11\u8fbe\u5230range\u7ea7\u522b\uff0c\u6700\u597d\u80fd\u8fbe\u5230ref.\uff09</p> <ol> <li>system\uff1a\u8868\u53ea\u6709\u4e00\u884c\u8bb0\u5f55\uff0c\u7b49\u4e8e\u7cfb\u7edf\u8868\uff0cconst\u7c7b\u578b\u7684\u7279\u4f8b</li> <li>const\uff1a\u901a\u8fc7\u7d22\u5f15\u4e00\u6b21\u5c31\u627e\u5230\u3002\u4f1a\u8f6c\u6362\u4e3a\u5e38\u91cf</li> <li>eq_ref\uff1a\u552f\u4e00\u6027\u7d22\u5f15\u626b\u63cf\uff0c\u6bcf\u4e2a\u7d22\u5f15\u952e\uff0c\u8868\u4e2d\u53ea\u6709\u4e00\u6761\u8bb0\u5f55\u4e0e\u4e4b\u5339\u914d\uff1b\u4e3b\u952e\u7d22\u5f15</li> <li>ref\uff1a\u975e\u552f\u4e00\u6027\u7d22\u5f15\u626b\u63cf\uff0c\u5339\u914d\u67d0\u4e2a\u5355\u72ec\u503c\u7684\u6240\u6709\u884c\u3002</li> <li>range\uff1a\u53ea\u68c0\u7d22\u7ed9\u5b9a\u8303\u56f4\u7684\u884c\uff0c\u4f7f\u7528\u4e00\u4e2a\u7d22\u5f15\u6765\u9009\u62e9\u884c\uff0c\u4e00\u822c\u662fwhere\u8bed\u53e5\u4e2d\u51fa\u73b0\u4e86between,&lt;,&gt;,in\u7b49\u67e5\u8be2</li> <li>index\uff1afull index scan,index\u4e0eall\u533a\u522b\u4e3aindex\u7c7b\u578b\u53ea\u904d\u5386\u7d22\u5f15\u6811\uff0cindex\u4e5f\u662f\u8bfb\u5168\u8868\uff0c\u4f46\u662f\u8bfb\u7684\u662f\u7d22\u5f15\u6811\uff0c\u800cAll\u662f\u4ece\u786c\u76d8\u4e2d\u8bfb\u5168\u8868</li> <li>ALL\uff1a\u4ece\u786c\u76d8\u4e2d\u8bfb\u5168\u8868</li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#possible_keys","title":"possible_keys","text":"<p>\u663e\u793a\u53ef\u80fd\u5e94\u7528\u5728\u8fd9\u5f20\u8868\u4e2d\u7684\u7d22\u5f15\uff0c\u4e00\u4e2a\u6216\u591a\u4e2a\uff0c\u67e5\u8be2\u6d89\u53ca\u5230\u7684\u5b57\u6bb5\u4e0a\u82e5\u5b58\u5728\u7d22\u5f15\uff0c\u5219\u8be5\u7d22\u5f15\u88ab\u5217\u51fa\uff0c\u4e0d\u4e00\u5b9a\u88ab\u67e5\u8be2\u5b9e\u9645\u4f7f\u7528</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#key","title":"key","text":"<ol> <li>\u5b9e\u9645\u4f7f\u7528\u5230\u7684\u7d22\u5f15\uff0c\u5982\u679c\u4e3aNULL,\u5219\u6ca1\u6709\u4f7f\u7528\u7d22\u5f15</li> <li>\u82e5\u67e5\u8be2\u4e2d\u4f7f\u7528\u4e86\u8986\u76d6\u7d22\u5f15\uff0c\u5219\u8be5\u7d22\u5f15\u4ec5\u51fa\u73b0\u5728key\u5217\u8868\u4e2d</li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#key_len","title":"key_len","text":"<ol> <li>\u8868\u793a\u7d22\u5f15\u4e2d\u4f7f\u7528\u7684\u5b57\u8282\u6570\uff0c\u901a\u8fc7\u8be5\u5217\u8ba1\u7b97\u67e5\u8be2\u4e2d\u4f7f\u7528\u7684\u7d22\u5f15\u7684\u957f\u5ea6\uff0c\u4e0d\u635f\u5931\u7cbe\u5ea6\u6027\u7684\u60c5\u51b5\u4e0b\uff0c\u957f\u5ea6\u8d8a\u77ed\u8d8a\u597d</li> <li>\u503c\u4e3a\u7d22\u5f15\u5b57\u6bb5\u7684\u6700\u5927\u53ef\u80fd\u957f\u5ea6\uff0c\u5e76\u975e\u5b9e\u9645\u4f7f\u7528\u957f\u5ea6\uff0c\u6839\u636e\u8868\u5b9a\u4e49\u8ba1\u7b97\u800c\u5f97\uff0c\u4e0d\u662f\u901a\u8fc7\u8868\u5185\u68c0\u7d22\u51fa</li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#ref","title":"ref","text":"<p>\u663e\u793a\u7d22\u5f15\u7684\u54ea\u4e00\u5217\u88ab\u4f7f\u7528\u3002\u54ea\u4e9b\u5217\u6216\u5e38\u91cf\u88ab\u7528\u4e8e\u67e5\u627e\u7d22\u5f15\u5217\u4e0a\u7684\u503c</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#rows","title":"rows","text":"<p>\u6839\u636e\u8868\u7edf\u8ba1\u4fe1\u606f\u53ca\u7d22\u5f15\u9009\u7528\u60c5\u51b5\uff0c\u5927\u81f4\u4f30\u7b97\u51fa\u627e\u5230\u6240\u9700\u8bb0\u5f55\u9700\u8981\u8bfb\u53d6\u7684\u884c\u6570</p>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#extra","title":"extra","text":"<p>\u5305\u542b\u4e0d\u518d\u5176\u4ed6\u5217\u4e2d\uff0c\u4f46\u5341\u5206\u91cd\u8981\u7684\u989d\u5916\u4fe1\u606f</p> <ol> <li>using filesort\uff1amysql\u4f1a\u5bf9\u6570\u636e\u4f7f\u7528\u4e00\u4e2a\u5916\u90e8\u7684\u7d22\u5f15\u6392\u5e8f\uff0c\u65e0\u6cd5\u5229\u7528\u7d22\u5f15\u5b8c\u6210\u7684\u6392\u5e8f\u64cd\u4f5c\u79f0\u4e3a\u201c\u6587\u4ef6\u6392\u5e8f\u201d\u3002\u6027\u80fd\u6781\u5dee</li> <li>using temporary\uff1a\u9700\u8981\u5efa\u7acb\u4e34\u65f6\u8868\u6765\u6682\u5b58\u4e2d\u95f4\u7ed3\u679c\uff0c\u6027\u80fd\u4e5f\u8f83\u5dee</li> <li>using index\uff1asql\u6240\u9700\u8981\u7684\u6570\u636e\u5747\u5728\u4e00\u68f5\u7d22\u5f15\u6811\u4e0a\uff0c\u65e0\u9700\u8bbf\u95ee\u5b9e\u9645\u7684\u884c\u8bb0\u5f55\u3002\u6b64\u7c7bsql\u5f80\u5f80\u67e5\u8be2\u6027\u80fd\u8f83\u597d</li> <li>using where\uff1asql\u4f7f\u7528\u4e86where\u6761\u4ef6\u8fc7\u6ee4\u6570\u636e</li> <li>using join buffer\uff1a\u9700\u8981\u8fdb\u884c\u5d4c\u5957\u5faa\u73af\u8ba1\u7b97\uff0c\u4e5f\u5f80\u5f80\u8f83\u5dee\uff0c\u9700\u8981\u4f18\u5316</li> <li>impossible where</li> <li>select tables optimized away</li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#_6","title":"\u7d22\u5f15\u4f18\u5316","text":"<p>\u7d22\u5f15\u5931\u6548\u573a\u666f</p> <ol> <li>\u5168\u503c\u5339\u914d</li> <li>\u672a\u9075\u5faa\u6700\u4f73\u5de6\u524d\u7f00\u539f\u5219</li> <li>\u4e0d\u518d\u7d22\u5f15\u4e0a\u6709\u51fd\u6570\u64cd\u4f5c</li> <li>\u5b58\u50a8\u5f15\u64ce\u4e0d\u80fd\u4f7f\u7528\u7d22\u5f15\u4e2d\u8303\u56f4\u6761\u4ef6\uff08&gt;,&lt;\uff09\u53f3\u8fb9\u7684\u5217</li> <li>\u51cf\u5c11select *,\u6309\u9700\u53d6\u6570\u636e</li> <li>\u4f7f\u7528\u4e0d\u7b49\u4e8e\uff08!=\u6216\u8005&gt;&lt;\uff09\u7684\u65f6\u5019\u65e0\u6cd5\u4f7f\u7528\u7d22\u5f15\u4f1a\u5bfc\u81f4\u5168\u6807\u626b\u63cf</li> <li>is null,is not null\u4e5f\u65e0\u6cd5\u4f7f\u7528\u7d22\u5f15</li> <li>like\u901a\u914d\u7b26\u5f00\u5934\uff08%abc...\uff09\u4f1a\u5bfc\u81f4\u7d22\u5f15\u5931\u6548\uff1b\uff08\u4f7f\u7528\u8986\u76d6\u7d22\u5f15\u53ef\u4ee5\u89e3\u51b3\u6b64\u95ee\u9898\uff0c\u5982age\u52a0\u7d22\u5f15\uff0cselect age from table where name like '%qwe%'\u53ef\u4ee5\u4f7f\u7528\u7d22\u5f15\uff09</li> <li>\u5b57\u7b26\u4e32\u4e0d\u52a0\u5f15\u53f7\u5bfc\u81f4\u7d22\u5f15\u5931\u6548\uff08mysql\u505a\u7c7b\u578b\u8f6c\u6362\uff0c\u5982int\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\uff09</li> <li>\u5c11\u7528or,\u7528or\u8fde\u63a5\u4e5f\u4f1a\u5bfc\u81f4\u7d22\u5f15\u5931\u6548</li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0Mysql/#_7","title":"\u9501\u673a\u5236","text":"<ul> <li>\u4ece\u6570\u636e\u64cd\u4f5c\u7684\u7c7b\u578b\u5206\u7c7b\uff08\u8bfb/\u5199\uff09<ol> <li>\u8bfb\u9501\uff1a\u5171\u4eab\u9501\uff0c\u9488\u5bf9\u540c\u4e00\u4efd\u6570\u636e\uff0c\u591a\u4e2a\u8bfb\u64cd\u4f5c\u53ef\u4ee5\u540c\u65f6\u8fdb\u884c\u800c\u4e0d\u4f1a\u76f8\u4e92\u5f71\u54cd</li> <li>\u5199\u9501\uff1a\u6392\u4ed6\u9501\uff0c\u5f53\u524d\u5199\u9501\u6ca1\u6709\u5b8c\u6210\u524d\uff0c\u5b83\u4f1a\u963b\u585e\u5176\u4ed6\u5199\u9501\u548c\u8bfb\u9501</li> </ol> </li> <li>\u4ece\u5bf9\u6570\u636e\u64cd\u4f5c\u7684\u7c92\u5ea6\u5206\u7c7b\uff08\u8868\u9501\uff0c\u884c\u9501\uff09<ol> <li>\u8868\u9501\uff1a\u504f\u8bfb\uff0c\u504f\u5411MyISAM\u5b58\u50a8\u5f15\u64ce\uff0c\u5f00\u9500\u5c0f\uff0c\u52a0\u9501\u5feb\uff0c\u65e0\u6b7b\u9501</li> <li>\u884c\u9501\uff1a\u504f\u5199</li> <li>\u9875\u9501</li> </ol> </li> </ul> <p>\u66f4\u8be6\u7ec6\u53ef\u4ee5\u67e5\u770b</p> <ul> <li>Mysql\u57fa\u7840\u7bc7</li> <li>Mysql\u5b9e\u8df5\u7bc7</li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/","title":"\u6570\u636e\u7ed3\u6784","text":"<p>\u8def\u6f2b\u6f2b\u5176\u4fee\u8fdc\u516e</p> <ul> <li>\u6570\u7ec4</li> <li>\u94fe\u8868</li> <li>\u6808</li> <li>\u961f\u5217</li> <li>\u6563\u5217\u8868</li> <li>\u4e8c\u53c9\u6811</li> <li>\u5806</li> <li>\u8df3\u8868</li> <li>\u56fe</li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8/","title":"\u7ebf\u6027\u8868","text":""},{"location":"%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8/#_1","title":"\u7ebf\u6027\u5b58\u50a8\u7ed3\u6784\uff08\u7ebf\u6027\u8868\uff09","text":"<p>\u7279\u6027\uff1a\u4f7f\u7528\u7ebf\u6027\u8868\u5b58\u50a8\u7684\u6570\u636e\uff0c\u5982\u540c\u5411\u6570\u7ec4\u4e2d\u5b58\u50a8\u6570\u636e\u90a3\u6837\uff0c\u8981\u6c42\u6570\u636e\u7c7b\u578b\u5fc5\u987b\u4e00\u81f4\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u7ebf\u6027\u8868\u5b58\u50a8\u7684\u6570\u636e\uff0c\u8981\u4e48\u5168\u90e8\u90fd\u662f\u6574\u5f62\uff0c\u8981\u4e48\u5168\u90e8\u90fd\u662f\u5b57\u7b26\u4e32\u3002\u4e00\u534a\u662f\u6574\u5f62\uff0c\u53e6\u4e00\u534a\u662f\u5b57\u7b26\u4e32\u7684\u4e00\u7ec4\u6570\u636e\u65e0\u6cd5\u4f7f\u7528\u7ebf\u6027\u8868\u5b58\u50a8</p>"},{"location":"%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8/#_2","title":"\u987a\u5e8f\u5b58\u50a8\u7ed3\u6784","text":"<p>\u5c06\u6570\u636e\u4f9d\u6b21\u5b58\u50a8\u5728\u8fde\u7eed\u7684\u6574\u5757\u7269\u7406\u7a7a\u95f4\u4e2d\uff0c\u8fd9\u79cd\u5b58\u50a8\u7ed3\u6784\u79f0\u4e3a\u987a\u5e8f\u5b58\u50a8\u7ed3\u6784\uff08\u7b80\u79f0\u987a\u5e8f\u8868\uff09 - \u6570\u7ec4\u662f\u4e00\u79cd\u5927\u5c0f\u56fa\u5b9a\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5bf9\u7ebf\u6027\u8868\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u53ef\u4ee5\u901a\u8fc7\u6570\u7ec4\u6765\u5b9e\u73b0\u3002\u867d\u7136\u6570\u7ec4\u4e00\u65e6\u521b\u5efa\u4e4b\u540e\uff0c\u5b83\u7684\u5927\u5c0f\u5c31\u65e0\u6cd5\u6539\u53d8\u4e86\uff0c\u4f46\u662f\u5f53\u6570\u7ec4\u4e0d\u80fd\u518d\u5b58\u50a8\u7ebf\u6027\u8868\u4e2d\u7684\u65b0\u5143\u7d20\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5927\u7684\u6570\u7ec4\u6765\u66ff\u6362\u5f53\u524d\u6570\u7ec4\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f7f\u7528\u6570\u7ec4\u5b9e\u73b0\u52a8\u6001\u7684\u6570\u636e\u7ed3\u6784\u3002</p>"},{"location":"%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8/#_3","title":"\u94fe\u5f0f\u5b58\u50a8\u7ed3\u6784","text":"<p>\u6570\u636e\u5206\u6563\u7684\u5b58\u50a8\u5728\u7269\u7406\u7a7a\u95f4\u4e2d\uff0c\u901a\u8fc7\u4e00\u6839\u7ebf\u4fdd\u5b58\u7740\u5b83\u4eec\u4e4b\u95f4\u7684\u903b\u8f91\u5173\u7cfb\uff0c\u8fd9\u79cd\u5b58\u50a8\u7ed3\u6784\u79f0\u4e3a\u94fe\u5f0f\u5b58\u50a8\u7ed3\u6784\uff08\u7b80\u79f0\u94fe\u8868\uff09</p>"},{"location":"%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95/","title":"\u7b97\u6cd5","text":"<p>\uff08\u8def\u6f2b\u6f2b\u5176\u4fee\u8fdc\u516e\uff09</p> <ul> <li>Algorithm \u662f\u6307\u89e3\u9898\u65b9\u6848\u7684\u51c6\u786e\u800c\u5b8c\u6574\u7684\u63cf\u8ff0\uff0c\u662f\u4e00\u7cfb\u5217\u89e3\u51b3\u95ee\u9898\u7684\u6e05\u6670\u6307\u4ee4\uff0c\u7b97\u6cd5\u4ee3\u8868\u7740\u7528\u7cfb\u7edf\u7684\u65b9\u6cd5\u63cf\u8ff0\u89e3\u51b3\u95ee\u9898\u7684\u7b56\u7565\u673a\u5236</li> </ul>"},{"location":"%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95/#_2","title":"\u7b97\u6cd5\u7b80\u7ec3","text":"<ol> <li>\u9012\u5f52</li> <li>\u6392\u5e8f</li> <li>\u4e8c\u5206\u67e5\u627e</li> <li>\u641c\u7d22</li> <li>\u54c8\u5e0c\u7b97\u6cd5</li> <li>\u8d2a\u5fc3\u7b97\u6cd5</li> <li>\u5206\u6cbb\u7b97\u6cd5</li> <li>\u56de\u6eaf\u7b97\u6cd5</li> <li>\u52a8\u6001\u89c4\u5212</li> <li>\u5b57\u7b26\u4e32\u5339\u914d\u7b97\u6cd5</li> <li>\u9650\u6d41\u7b97\u6cd5:\u8ba1\u6570\u5668\u3001\u6f0f\u6876\u3001\u4ee4\u724c\u6876</li> <li>LRU\u7f13\u5b58\u6dd8\u6c70\u7b97\u6cd5</li> <li>GC\u5783\u573e\u56de\u6536\u5206\u4ee3\u5e74\u9f84\u7b97\u6cd5</li> </ol>"},{"location":"%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95/%E9%99%90%E6%B5%81%E7%AE%97%E6%B3%95/","title":"\u9650\u6d41\u7b97\u6cd5","text":"<p>\u901a\u8fc7\u5bf9\u5e76\u53d1\u8bbf\u95ee\u8bf7\u6c42\u8fdb\u884c\u9650\u901f\uff0c\u5bf9\u4e00\u4e2a\u65f6\u95f4\u7a97\u53e3\u5185\u7684\u8bf7\u6c42\u8fdb\u884c\u9650\u901f\u6765\u4fdd\u62a4\u7cfb\u7edf\uff0c\u4e00\u65e6\u8fbe\u5230\u9650\u5236\u901f\u7387\u53ef\u4ee5\u62d2\u7edd\u670d\u52a1\u3001\u6392\u961f\u6216\u7b49\u5f85\u3001\u964d\u7ea7\u5904\u7406</p> <ol> <li>\u8ba1\u6570\u5668</li> </ol> <p>\u63a7\u5236\u5355\u4f4d\u65f6\u95f4\u5185\u7684\u8bf7\u6c42\u6570\u91cf\u3002</p> <p>\u52a3\u52bf\uff1a\u8bbe\u6bcf\u5206\u949f\u8bf7\u6c42\u6570\u91cf60\u4e2a\uff0c\u6bcf\u79d2\u5904\u74061\u4e2a\u8bf7\u6c42\uff0c\u7528\u6237\u5728 00:59 \u53d1\u9001 60 \u4e2a\u8bf7\u6c42\uff0c\u5728 01:00 \u53d1\u9001 60 \u4e2a\u8bf7\u6c42 \u6b64\u65f6 2 \u79d2\u949f\u6709 120 \u4e2a\u8bf7\u6c42( \u6bcf\u79d2 60 \u4e2a\u8bf7\u6c42)\uff0c\u8fdc\u8fdc\u5927\u4e8e\u4e86\u6bcf\u79d2\u949f\u5904\u7406\u6570\u91cf\u7684\u9608\u503c\u3002\uff08\u7a81\u523a\u73b0\u8c61\uff09</p> <pre><code>import java.util.concurrent.atomic.AtomicInteger;\n\npublic class Counter {\n\n    /**\n     * \u6700\u5927\u8bbf\u95ee\u6570\u91cf\n     */\n    private final int limit = 10;\n\n    /**\n     * \u8bbf\u95ee\u65f6\u95f4\u5dee\n     */\n    private final long timeout = 1000;\n\n    /**\n     * \u8bf7\u6c42\u65f6\u95f4\n     */\n    private long time;\n\n    /**\n     * \u5f53\u524d\u8ba1\u6570\u5668\n     */\n    private AtomicInteger reqCount = new AtomicInteger(0);\n\n    public boolean limit() {\n        long now = System.currentTimeMillis();\n        if (now &lt; time + timeout) {\n            //\u5355\u4f4d\u65f6\u95f4\u5185\n            reqCount.addAndGet(1);\n            return reqCount.get() &lt;= limit;\n        } else {\n            //\u8d85\u51fa\u5355\u4f4d\u65f6\u95f4\n            time = now;\n            reqCount = new AtomicInteger(0);\n            return true;\n        }\n    }\n\n}\n</code></pre> <ol> <li>\u6ed1\u52a8\u7a97\u53e3</li> </ol> <p>\u5bf9\u8ba1\u6570\u5668\u7684\u4e00\u4e2a\u6539\u8fdb\uff0c\u589e\u52a0\u4e00\u4e2a\u65f6\u95f4\u7c92\u5ea6\u7684\u5ea6\u91cf\u5355\u4f4d\uff0c\u4e00\u5206\u949f\u5206\u4e3a\u82e5\u5e72\u4efd\uff08\u59826\u4efd\uff0c\u6ca110\u79d2\u4e00\u4efd\uff09\uff0c\u5728\u6bcf\u4efd\u4e0a\u8bbe\u7f6e\u72ec\u7acb\u8ba1\u6570\u5668\uff0c</p> <ol> <li>leaky bucket\u6f0f\u6876</li> </ol> <p>\u89c4\u5b9a\u56fa\u5b9a\u5bb9\u91cf\u7684\u6876\uff0c\u8fdb\u5165\u7684\u6c34\u65e0\u6cd5\u7ba1\u63a7\u6570\u91cf\u3001\u901f\u5ea6\uff0c\u4f46\u662f\u5bf9\u4e8e\u6d41\u51fa\u7684\u6c34\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u901f\u5ea6</p> <p>\u52a3\u52bf\uff1a\u65e0\u6cd5\u5e94\u5bf9\u77ed\u65f6\u95f4\u7a81\u53d1\u6d41\u91cf\uff08\u6876\u6ee1\u4e86\u5c31\u4e22\u5f03\uff09</p> <pre><code>public class LeakBucket {\n\n    /**\n     * \u65f6\u95f4\n     */\n    private long time;\n\n    /**\n     * \u603b\u91cf\n     */\n    private Double total;\n\n    /**\n     * \u6c34\u6d41\u51fa\u901f\u5ea6\n     */\n    private Double rate;\n\n    /**\n     * \u5f53\u524d\u603b\u91cf\n     */\n    private Double nowSize;\n\n    public boolean limit() {\n        long now = System.currentTimeMillis();\n\n        nowSize = Math.max(0, (nowSize - (now - time) * rate));\n        time = now;\n\n        if ((nowSize + 1) &lt; total) {\n            nowSize++;\n            return true;\n        } else {\n            return false;\n        }\n\n    }\n}\n</code></pre> <ol> <li>Token Bucket\u4ee4\u724c\u6876</li> </ol> <p>\u89c4\u5b9a\u56fa\u5b9a\u5bb9\u91cf\u7684\u6876\uff0ctoken \u4ee5\u56fa\u5b9a\u901f\u5ea6\u5f80\u6876\u5185\u586b\u5145\uff0c \u5f53\u6876\u6ee1\u65f6 token \u4e0d\u4f1a\u88ab\u7ee7\u7eed\u653e\u5165\uff0c \u6bcf\u8fc7\u6765\u4e00\u4e2a\u8bf7\u6c42\u628a token \u4ece\u6876\u4e2d\u79fb\u9664\uff0c \u5982\u679c\u6876\u4e2d\u6ca1\u6709 token \u4e0d\u80fd\u8bf7\u6c42\u3002 \u53ef\u4ee5\u51c6\u5907\u4e00\u4e2a\u961f\u5217\uff0c\u7528\u6765\u4fdd\u5b58\u4ee4\u724c\uff0c\u53e6\u5916\u901a\u8fc7\u4e00\u4e2a\u7ebf\u7a0b\u6c60\u5b9a\u671f\u751f\u6210\u4ee4\u724c\u653e\u5230\u961f\u5217\u4e2d\uff0c\u6bcf\u6765\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5c31\u4ece\u961f\u5217\u4e2d\u83b7\u53d6\u4e00\u4e2a\u4ee4\u724c\uff0c\u5e76\u7ee7\u7eed\u6267\u884c\u3002 </p> <pre><code>public class TokenBucket {\n\n    /**\n     * \u65f6\u95f4\n     */\n    private long time;\n\n    /**\n     * \u603b\u91cf\n     */\n    private Double total;\n\n    /**\n     * \u6c34\u6d41\u51fa\u901f\u5ea6\n     */\n    private Double rate;\n\n    /**\n     * \u5f53\u524d\u603b\u91cf\n     */\n    private Double nowSize;\n\n\n    public boolean limit() {\n\n        long now = System.currentTimeMillis();\n\n        nowSize = Math.min(total, (nowSize + (now - time) * rate));\n        time = now;\n\n        if (nowSize &lt; 1) {\n            //\u6876\u91cc\u6ca1\u6709token\n            return false;\n        } else {\n            //\u5b58\u5728token\n            nowSize -= 1;\n            return true;\n        }\n    }\n\n}\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E9%A2%98/%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/","title":"\u4e24\u6570\u4e4b\u548c","text":""},{"location":"%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E9%A2%98/%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/#_1","title":"\u4e24\u6570\u4e4b\u548c","text":"<p>\u603b\u7ed3\uff1a\u54c8\u5e0c\u8868\u53ef\u4ee5\u66f4\u5feb\uff0c\u6700\u63a8\u8350</p> <p>\u9898\u76ee\uff1a</p> <pre><code>\u7ed9\u5b9a\u4e00\u4e2a\u6574\u6570\u6570\u7ec4 nums \u548c\u4e00\u4e2a\u6574\u6570\u76ee\u6807\u503c target\uff0c\u8bf7\u4f60\u5728\u8be5\u6570\u7ec4\u4e2d\u627e\u51fa \u548c\u4e3a\u76ee\u6807\u503c target \u7684\u90a3 \u4e24\u4e2a \u6574\u6570\uff0c\u5e76\u8fd4\u56de\u5b83\u4eec\u7684\u6570\u7ec4\u4e0b\u6807\u3002\n\n\u4f60\u53ef\u4ee5\u5047\u8bbe\u6bcf\u79cd\u8f93\u5165\u53ea\u4f1a\u5bf9\u5e94\u4e00\u4e2a\u7b54\u6848\u3002\u4f46\u662f\uff0c\u6570\u7ec4\u4e2d\u540c\u4e00\u4e2a\u5143\u7d20\u5728\u7b54\u6848\u91cc\u4e0d\u80fd\u91cd\u590d\u51fa\u73b0\u3002\n\n\u4f60\u53ef\u4ee5\u6309\u4efb\u610f\u987a\u5e8f\u8fd4\u56de\u7b54\u6848\u3002\n\n\u793a\u4f8b 1\uff1a\n\n\u8f93\u5165\uff1anums = [2,7,11,15], target = 9\n\u8f93\u51fa\uff1a[0,1]\n\u89e3\u91ca\uff1a\u56e0\u4e3a nums[0] + nums[1] == 9 \uff0c\u8fd4\u56de [0, 1] \u3002\n\u793a\u4f8b 2\uff1a\n\n\u8f93\u5165\uff1anums = [3,2,4], target = 6\n\u8f93\u51fa\uff1a[1,2]\n\u793a\u4f8b 3\uff1a\n\n\u8f93\u5165\uff1anums = [3,3], target = 6\n\u8f93\u51fa\uff1a[0,1]\n\u63d0\u793a\uff1a\n\n2 &lt;= nums.length &lt;= 104\n-109 &lt;= nums[i] &lt;= 109\n-109 &lt;= target &lt;= 109\n\u53ea\u4f1a\u5b58\u5728\u4e00\u4e2a\u6709\u6548\u7b54\u6848\n\u8fdb\u9636\uff1a\u4f60\u53ef\u4ee5\u60f3\u51fa\u4e00\u4e2a\u65f6\u95f4\u590d\u6742\u5ea6\u5c0f\u4e8e O(n2) \u7684\u7b97\u6cd5\u5417\uff1f\n\nRelated Topics\n\u6570\u7ec4\n\u54c8\u5e0c\u8868\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E9%A2%98/%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/#_2","title":"\u89e3\u7b54\uff1a","text":"<p>\u65b9\u6848\u4e00\uff1a\u66b4\u529b\u5faa\u73af</p> <pre><code>class Solution {\n    public int[] twoSum(int[] nums, int target) {\n        if (nums == null || nums.length &lt; 2 || nums.length &gt; 100000) {\n            return null;\n        }\n\n        for (int i = 0; i &lt; nums.length; i++) {\n            if (nums[i] &lt; -1000000000 || nums[i] &gt; 1000000000) {\n                continue;\n            }\n            for (int j = 0; j &lt; nums.length; j++) {\n                if (j == i) {\n                    continue;\n                }\n                if (nums[i] + nums[j] == target) {\n                    return new int[]{i, j};\n                }\n            }\n        }\n        return null;\n    }\n}\n</code></pre> <p>\u65b9\u6848\u4e8c\uff1a\u54c8\u5e0c\u8868(\u63a8\u8350-\u66f4\u4f18)\uff0c\u603b\u590d\u6742\u5ea6\u964d\u4f4e\u81f3\u7ebf\u6027 O(n)</p> <pre><code>class Solution {\n    public int[] twoSum(int[] nums, int target) {\n        if (nums == null || nums.length &lt; 2 || nums.length &gt; 100000) {\n            return null;\n        }\n\n        Map&lt;Integer, Integer&gt; map = new HashMap&lt;&gt;(nums.length);\n\n        for (int i = 0; i &lt; nums.length; i++) {\n            if (nums[i] &lt; -1000000000 || nums[i] &gt; 1000000000) {\n                continue;\n            }\n            int findValue = target - nums[i];\n            if (map.containsKey(findValue)) {\n                return new int[]{map.get(findValue), i};\n            }\n            map.put(nums[i], i);\n        }\n        return null;\n    }\n}\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E9%A2%98/%E4%B8%A4%E6%95%B0%E7%9B%B8%E5%8A%A0/","title":"\u4e24\u6570\u76f8\u52a0","text":""},{"location":"%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E9%A2%98/%E4%B8%A4%E6%95%B0%E7%9B%B8%E5%8A%A0/#_1","title":"\u4e24\u6570\u76f8\u52a0","text":"<p>\u603b\u7ed3\uff1a</p> <p>\u9898\u76ee\uff1a</p> <pre><code>\u8f93\u5165\uff1al1 = [2,4,3], l2 = [5,6,4]\n\u8f93\u51fa\uff1a[7,0,8]\n\u89e3\u91ca\uff1a342 + 465 = 807.\n\u793a\u4f8b 2\uff1a\n\n\u8f93\u5165\uff1al1 = [0], l2 = [0]\n\u8f93\u51fa\uff1a[0]\n\u793a\u4f8b 3\uff1a\n\n\u8f93\u5165\uff1al1 = [9,9,9,9,9,9,9], l2 = [9,9,9,9]\n\u8f93\u51fa\uff1a[8,9,9,9,0,0,0,1]\n\u63d0\u793a\uff1a\n\n\u6bcf\u4e2a\u94fe\u8868\u4e2d\u7684\u8282\u70b9\u6570\u5728\u8303\u56f4 [1, 100] \u5185\n0 &lt;= Node.val &lt;= 9\n\u9898\u76ee\u6570\u636e\u4fdd\u8bc1\u5217\u8868\u8868\u793a\u7684\u6570\u5b57\u4e0d\u542b\u524d\u5bfc\u96f6\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E9%A2%98/%E4%B8%A4%E6%95%B0%E7%9B%B8%E5%8A%A0/#_2","title":"\u89e3\u7b54","text":""},{"location":"%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E9%A2%98/%E4%B8%A4%E6%95%B0%E7%9B%B8%E5%8A%A0/#_3","title":"\u65b9\u6848\u4e00\uff0c\u6700\u4f18\uff08\u63a8\u8350\uff09","text":"<p>\u603b\u7ed3\uff1a</p> <ol> <li>\u539f\u5730\u6a21\u62df\u7ad6\u5f0f\u52a0\u6cd5</li> <li>\u76f4\u63a5\u904d\u5386\u4e24\u4e2a\u94fe\u8868\uff0c\u9010\u4f4d\u76f8\u52a0\uff0c\u5904\u7406\u8fdb\u4f4d\uff08Carry\uff09\uff0c\u76f4\u63a5\u6784\u5efa\u7ed3\u679c\u94fe\u8868\u3002\u8fd9\u80fd\u5c06\u65f6\u95f4\u590d\u6742\u5ea6\u538b\u7f29\u5230\u6781\u81f4\uff0c\u4e14\u4e0d\u9700\u8981\u7533\u8bf7\u989d\u5916\u7684\u5b57\u7b26\u4e32\u7a7a\u95f4\u3002</li> <li>\u8fdb\u4f4d\u903b\u8f91 \uff1a\u5728\u5faa\u73af\u6761\u4ef6\u4e2d\u52a0\u5165 <code>|| carry != 0</code> \u662f\u5173\u952e\uff0c\u5b83\u786e\u4fdd\u4e86\u5f53\u4e24\u4e2a\u94fe\u8868\u90fd\u904d\u5386\u5b8c\uff0c\u4f46\u6700\u540e\u4e00\u6b21\u76f8\u52a0\u4ecd\u6709\u8fdb\u4f4d\u65f6\uff0c\u80fd\u6b63\u786e\u4ea7\u751f\u4e00\u4e2a\u65b0\u8282\u70b9</li> </ol> <pre><code>class Solution {\n    public ListNode addTwoNumbers(ListNode l1, ListNode l2) {\n        ListNode dummy = new ListNode(0); // \u54e8\u5175\u8282\u70b9\uff0c\u7528\u4e8e\u8fd4\u56de\u5934\u7ed3\u70b9\n        ListNode current = dummy;\n        int carry = 0; // \u8fdb\u4f4d\u6807\u8bc6\n\n        // \u540c\u6b65\u904d\u5386\u4e24\u4e2a\u94fe\u8868\n        while (l1 != null || l2 != null || carry != 0) {\n            int val1 = (l1 != null) ? l1.val : 0;\n            int val2 = (l2 != null) ? l2.val : 0;\n\n            int sum = val1 + val2 + carry;\n            carry = sum / 10; // \u66f4\u65b0\u8fdb\u4f4d\n\n            // \u521b\u5efa\u65b0\u8282\u70b9\u5e76\u8fde\u63a5\n            current.next = new ListNode(sum % 10);\n            current = current.next;\n\n            // \u6307\u9488\u540e\u79fb\n            if (l1 != null) l1 = l1.next;\n            if (l2 != null) l2 = l2.next;\n        }\n\n        return dummy.next;\n    }\n\n}\n</code></pre>"},{"location":"%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95/%E7%AE%97%E6%B3%95%E9%A2%98/%E4%B8%A4%E6%95%B0%E7%9B%B8%E5%8A%A0/#_4","title":"\u65b9\u6848\u4e8c\uff0c\u66b4\u529b\u64cd\u4f5c\uff0c\u6027\u80fd\u4e0d\u4f73","text":"<p>\u603b\u7ed3\uff1a</p> <ol> <li>\u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684\u7b97\u6cd5\u8bbe\u8ba1\u9519\u8bef\u3002\u4f60\u76ee\u524d\u7684\u4ee3\u7801\u901a\u8fc7\u201c\u94fe\u8868 -&gt; \u5b57\u7b26\u4e32 -&gt; BigInteger -&gt; \u5b57\u7b26\u4e32 -&gt; \u94fe\u8868\u201d\u8fdb\u884c\u5468\u8f6c\uff0c\u8fd9\u5728\u6027\u80fd\u5f00\u9500\u548c\u7a7a\u95f4\u5229\u7528\u7387\u4e0a\u90fd\u662f\u6781\u5927\u7684\u6d6a\u8d39\uff0c\u5b8c\u5168\u8fdd\u80cc\u4e86\u94fe\u8868\u5904\u7406\u7684\u57fa\u672c\u67b6\u6784\u539f\u5219\u3002</li> <li>\u6027\u80fd\u635f\u8017\uff1a<code>BigInteger</code> \u4f1a\u8fdb\u884c\u6602\u8d35\u7684\u5b57\u7b26\u4e32\u89e3\u6790\u4e0e\u5185\u90e8\u4e8c\u8fdb\u5236\u8f6c\u6362\uff0c\u4e14\u9891\u7e41\u7684\u5b57\u7b26\u4e32\u5bf9\u8c61\u521b\u5efa\u4f1a\u89e6\u53d1\u4e25\u91cd\u7684 GC\u3002</li> </ol> <pre><code>import java.math.BigInteger;\n\nclass Solution {\n    public ListNode addTwoNumbers(ListNode l1, ListNode l2) {\n        if (l1 == null || l2 == null) {\n            throw new IllegalArgumentException(\"\u8f93\u5165\u94fe\u8868\u4e0d\u80fd\u4e3a\u7a7a\");\n        }\n\n        // \u5c06\u94fe\u8868\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u5e76\u6821\u9a8c\u957f\u5ea6\n        String num1 = linkedListToString(l1);\n        String num2 = linkedListToString(l2);\n        if (num1.isEmpty() || num2.isEmpty() || num1.length() &gt; 100 || num2.length() &gt; 100) {\n            throw new IllegalArgumentException(\"\u8f93\u5165\u94fe\u8868\u957f\u5ea6\u8d85\u51fa\u8303\u56f4\uff08\u6700\u5927\u652f\u6301100\u4f4d\uff09\");\n        }\n\n        // \u4f7f\u7528 BigInteger \u907f\u514d\u6574\u6570\u6ea2\u51fa\n        BigInteger bigNum1 = new BigInteger(num1);\n        BigInteger bigNum2 = new BigInteger(num2);\n        BigInteger sum = bigNum1.add(bigNum2);\n\n        // \u76f4\u63a5\u6784\u9020\u9006\u5e8f\u94fe\u8868\uff0c\u907f\u514d\u53cd\u8f6c\u64cd\u4f5c\n        return bigIntegerToReverseLinkedList(sum);\n    }\n\n\n    /**\n     * \u5c06 BigInteger \u8f6c\u6362\u4e3a\u9006\u5e8f\u94fe\u8868\n     */\n    private static ListNode bigIntegerToReverseLinkedList(BigInteger num) {\n        String numStr = num.toString();\n        ListNode sentinel = new ListNode(0); // \u54e8\u5175\u8282\u70b9\n        ListNode current = sentinel;\n\n        // \u9006\u5e8f\u904d\u5386\u5b57\u7b26\u4e32\uff0c\u6784\u9020\u94fe\u8868\n        for (int i = numStr.length() - 1; i &gt;= 0; i--) {\n            int digit = numStr.charAt(i) - '0';\n            if (digit &lt; 0 || digit &gt; 9) {\n                throw new IllegalArgumentException(\"\u975e\u6cd5\u5b57\u7b26\uff1a\" + numStr.charAt(i));\n            }\n            current.next = new ListNode(digit);\n            current = current.next;\n        }\n        return sentinel.next;\n    }\n\n    public static String linkedListToString(ListNode head) {\n        if (head == null) {\n            return \"\";\n        }\n\n        StringBuilder sb = new StringBuilder();\n        ListNode current = head;\n\n        while (current != null) {\n            if (current.val &lt; 0 || current.val &gt; 9) {\n                throw new IllegalArgumentException(\"\u94fe\u8868\u5143\u7d20\u8d85\u51fa\u8303\u56f4\uff080~9\uff09\");\n            }\n            sb.append(current.val);\n            current = current.next;\n        }\n\n        // \u8fd4\u56de\u53cd\u8f6c\u540e\u7684\u5b57\u7b26\u4e32\n        return sb.reverse().toString();\n    }\n}\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/","title":"\u4f01\u4e1a\u7ea7\u9879\u76ee\u6846\u67b6","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/#spring","title":"\u6838\u5fc3Spring","text":"<p>JavaEE\u4f01\u4e1a\u7ea7\u6838\u5fc3\u6846\u67b6</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/#springboot","title":"SpringBoot","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/#springcloud","title":"SpringCloud","text":"<p>\u5fae\u670d\u52a1\u67b6\u6784</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/#dubbo","title":"Dubbo","text":"<p>\u5206\u5e03\u5f0f\u67b6\u6784</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/DDD%E9%A2%86%E5%9F%9F/%E6%97%A5%E5%B8%B8%E4%BD%BF%E7%94%A8%E9%81%87%E5%88%B0%E7%9A%84/","title":"DDD","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/DDD%E9%A2%86%E5%9F%9F/%E6%97%A5%E5%B8%B8%E4%BD%BF%E7%94%A8%E9%81%87%E5%88%B0%E7%9A%84/#_1","title":"\u5145\u8840\u6a21\u578b\u4e0e\u8d2b\u8840\u6a21\u578b","text":"<ol> <li>\u5145\u8840\u6a21\u578b\u5bf9\u8c61\u5982\u4f55\u83b7\u53d6\u7c7b\u4e2d\u7684\u65b9\u6cd5\uff1f</li> </ol> <p>\u7b54\uff1a \u5728DDD\u9886\u57df\u9a71\u52a8\u4e2d\uff0c\u5145\u8840\u6a21\u578b\u662f\u4e00\u79cd\u8f6f\u4ef6\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u5b83\u5f3a\u8c03\u5b9e\u4f53\u5bf9\u8c61\u5e94\u8be5\u5177\u6709\u884c\u4e3a\uff0c\u800c\u4e0d\u662f\u53ea\u5305\u542b\u6570\u636e\u3002\u5728\u5145\u8840\u6a21\u578b\u4e2d\uff0c\u5b9e\u4f53\u5bf9\u8c61\u5e94\u8be5\u80fd\u591f\u901a\u8fc7\u65b9\u6cd5\u6765\u8bbf\u95ee\u548c\u4fee\u6539\u5176\u5185\u90e8\u7684\u6570\u636e\u3002\u5728DDD\u9886\u57df\u9a71\u52a8\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u83b7\u53d6\u5b9e\u4f53\u5bf9\u8c61\u7684\u884c\u4e3a\u65b9\u6cd5\uff1a     1. \u4f9d\u8d56\u6ce8\u5165\uff1a\u5c06\u5b9e\u4f53\u5bf9\u8c61\u6ce8\u5165\u5230\u5176\u4ed6\u5bf9\u8c61\u4e2d\uff0c\u901a\u8fc7\u4f9d\u8d56\u6ce8\u5165\u6765\u83b7\u53d6\u5b9e\u4f53\u5bf9\u8c61\u7684\u884c\u4e3a\u65b9\u6cd5\u3002\u4f8b\u5982\uff0c\u5728Spring\u6846\u67b6\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528@Autowired\u6ce8\u89e3\u5c06\u5b9e\u4f53\u5bf9\u8c61\u6ce8\u5165\u5230\u5176\u4ed6\u5bf9\u8c61\u4e2d\uff0c\u7136\u540e\u901a\u8fc7\u5b9e\u4f53\u5bf9\u8c61\u7684\u65b9\u6cd5\u6765\u8bbf\u95ee\u548c\u4fee\u6539\u5176\u5185\u90e8\u7684\u6570\u636e\u3002     2. \u5de5\u5382\u65b9\u6cd5\uff1a\u4f7f\u7528\u5de5\u5382\u65b9\u6cd5\u6765\u521b\u5efa\u5b9e\u4f53\u5bf9\u8c61\uff0c\u5e76\u8fd4\u56de\u5b9e\u4f53\u5bf9\u8c61\u7684\u884c\u4e3a\u65b9\u6cd5\u3002\u4f8b\u5982\uff0c\u5728Spring\u6846\u67b6\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528BeanFactory\u6216ApplicationContext\u63a5\u53e3\u6765\u521b\u5efa\u5b9e\u4f53\u5bf9\u8c61\uff0c\u5e76\u901a\u8fc7\u5b9e\u4f53\u5bf9\u8c61\u7684\u65b9\u6cd5\u6765\u8bbf\u95ee\u548c\u4fee\u6539\u5176\u5185\u90e8\u7684\u6570\u636e\u3002     3. \u4ed3\u50a8\u6a21\u5f0f\uff1a\u4f7f\u7528\u4ed3\u50a8\u6a21\u5f0f\u6765\u7ba1\u7406\u5b9e\u4f53\u5bf9\u8c61\uff0c\u5e76\u8fd4\u56de\u5b9e\u4f53\u5bf9\u8c61\u7684\u884c\u4e3a\u65b9\u6cd5\u3002\u4f8b\u5982\uff0c\u5728Spring Data\u6846\u67b6\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528Repository\u63a5\u53e3\u6765\u7ba1\u7406\u5b9e\u4f53\u5bf9\u8c61\uff0c\u5e76\u901a\u8fc7\u5b9e\u4f53\u5bf9\u8c61\u7684\u65b9\u6cd5\u6765\u8bbf\u95ee\u548c\u4fee\u6539\u5176\u5185\u90e8\u7684\u6570\u636e\u3002     4. \u4e8b\u4ef6\u9a71\u52a8\uff1a\u4f7f\u7528\u4e8b\u4ef6\u9a71\u52a8\u6765\u901a\u77e5\u5b9e\u4f53\u5bf9\u8c61\u5176\u5185\u90e8\u7684\u6570\u636e\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u5e76\u8fd4\u56de\u5b9e\u4f53\u5bf9\u8c61\u7684\u884c\u4e3a\u65b9\u6cd5\u3002\u4f8b\u5982\uff0c\u5728Spring\u6846\u67b6\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e8b\u4ef6\u76d1\u542c\u5668\u6765\u76d1\u542c\u5b9e\u4f53\u5bf9\u8c61\u7684\u4e8b\u4ef6\uff0c\u5e76\u901a\u8fc7\u5b9e\u4f53\u5bf9\u8c61\u7684\u65b9\u6cd5\u6765\u8bbf\u95ee\u548c\u4fee\u6539\u5176\u5185\u90e8\u7684\u6570\u636e\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728DDD\u9886\u57df\u9a71\u52a8\u4e2d\uff0c\u5e94\u8be5\u5c06\u5b9e\u4f53\u5bf9\u8c61\u548c\u5176\u884c\u4e3a\u65b9\u6cd5\u5206\u79bb\u5f00\u6765\uff0c\u4ee5\u4fbf\u66f4\u597d\u5730\u5c01\u88c5\u548c\u7ba1\u7406\u5b9e\u4f53\u5bf9\u8c61\u3002\u540c\u65f6\uff0c\u5e94\u8be5\u9075\u5faa\u5355\u4e00\u804c\u8d23\u539f\u5219\u548c\u5f00\u95ed\u539f\u5219\uff0c\u4ee5\u4fbf\u66f4\u597d\u5730\u6269\u5c55\u548c\u7ef4\u62a4\u5b9e\u4f53\u5bf9\u8c61\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/ORM%E6%A1%86%E6%9E%B6/","title":"ORM\u6846\u67b6","text":"<p>Mybatis</p> <p></p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/ORM%E6%A1%86%E6%9E%B6/#_1","title":"\u63a5\u53e3\u5c42","text":"<p>MyBatis \u548c\u6570\u636e\u5e93\u7684\u4ea4\u4e92\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <ol> <li>\u4f7f\u7528\u4f20\u7edf\u7684 MyBatis \u63d0\u4f9b\u7684 API</li> <li>\u4f7f\u7528 Mapper \u63a5\u53e3</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/ORM%E6%A1%86%E6%9E%B6/#_2","title":"\u6570\u636e\u5904\u7406\u5c42\uff1a","text":"<ol> <li>\u901a\u8fc7\u4f20\u5165\u53c2\u6570\u6784\u5efa\u52a8\u6001 SQL \u8bed\u53e5\uff1b\uff08MyBatis \u901a\u8fc7\u4f20\u5165\u7684\u53c2\u6570\u503c\uff0c\u4f7f \u7528 Ognl \u6765\u52a8\u6001\u5730\u6784\u9020 SQL \u8bed\u53e5\uff0c\u4f7f\u5f97 MyBatis \u6709\u5f88\u5f3a\u7684\u7075\u6d3b\u6027\u548c\u6269\u5c55\u6027\uff09</li> <li>SQL \u8bed\u53e5\u7684\u6267\u884c\u4ee5\u53ca\u5c01\u88c5\u67e5\u8be2\u7ed3\u679c\u96c6\u6210 List"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/ORM%E6%A1%86%E6%9E%B6/#_3","title":"\u6846\u67b6\u652f\u6491\u5c42\uff1a","text":"<p>\u4e8b\u52a1\u7ba1\u7406\uff1b\u8fde\u63a5\u6c60\u7ba1\u7406\uff1b\u7f13\u5b58\u7b49</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/ORM%E6%A1%86%E6%9E%B6/#mybatis","title":"mybatis\u6838\u5fc3\u90e8\u4ef6","text":"<ul> <li>SqlSession \u4f5c\u4e3a MyBatis \u5de5\u4f5c\u7684\u4e3b\u8981\u9876\u5c42 API\uff0c\u8868\u793a\u548c\u6570\u636e\u5e93\u4ea4\u4e92\u7684\u4f1a\u8bdd\uff0c\u5b8c\u6210 \u5fc5\u8981\u6570\u636e\u5e93\u589e\u5220\u6539\u67e5\u529f\u80fd</li> <li>Executor MyBatis \u6267\u884c\u5668\uff0c\u662f MyBatis \u8c03\u5ea6\u7684\u6838\u5fc3\uff0c\u8d1f\u8d23 SQL \u8bed\u53e5\u7684\u751f\u6210\u548c \u67e5\u8be2\u7f13\u5b58\u7684\u7ef4\u62a4</li> <li>StatementHandler \u5c01\u88c5\u4e86 JDBC Statement \u64cd\u4f5c\uff0c\u8d1f\u8d23\u5bf9 JDBC statement \u7684\u64cd\u4f5c\uff0c\u5982\u8bbe\u7f6e\u53c2\u6570\u3001\u5c06 Statement \u7ed3\u679c\u96c6\u8f6c\u6362\u6210 List \u96c6\u5408\u3002</li> <li>ParameterHandler \u8d1f\u8d23\u5bf9\u7528\u6237\u4f20\u9012\u7684\u53c2\u6570\u8f6c\u6362\u6210 JDBC Statement \u6240\u9700\u8981\u7684\u53c2\u6570\uff0c</li> <li>ResultSetHandler \u8d1f\u8d23\u5c06 JDBC \u8fd4\u56de\u7684 ResultSet \u7ed3\u679c\u96c6\u5bf9\u8c61\u8f6c\u6362\u6210 List \u7c7b\u578b\u7684\u96c6\u5408\uff1b</li> <li>TypeHandler \u8d1f\u8d23 java \u6570\u636e\u7c7b\u578b\u548c jdbc \u6570\u636e\u7c7b\u578b\u4e4b\u95f4\u7684\u6620\u5c04\u548c\u8f6c\u6362</li> <li>MappedStatement MappedStatement \u7ef4\u62a4\u4e86\u4e00\u6761\u8282\u70b9\u7684\u5c01\u88c5\uff0c <li>SqlSource \u8d1f\u8d23\u6839\u636e\u7528\u6237\u4f20\u9012\u7684 parameterObject\uff0c\u52a8\u6001\u5730\u751f\u6210 SQL \u8bed\u53e5\uff0c\u5c06\u4fe1 \u606f\u5c01\u88c5\u5230 BoundSql \u5bf9\u8c61\u4e2d\uff0c\u5e76\u8fd4\u56de</li> <li>BoundSql \u8868\u793a\u52a8\u6001\u751f\u6210\u7684 SQL \u8bed\u53e5\u4ee5\u53ca\u76f8\u5e94\u7684\u53c2\u6570\u4fe1\u606f</li> <li>Configuration MyBatis \u6240\u6709\u7684\u914d\u7f6e\u4fe1\u606f\u90fd\u7ef4\u6301\u5728 Configuration \u5bf9\u8c61\u4e4b\u4e2d\u3002</li>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/ORM%E6%A1%86%E6%9E%B6/Mybatis%E8%AF%A6%E8%A7%A3/","title":"Mybatis\u8be6\u89e3","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/ORM%E6%A1%86%E6%9E%B6/Mybatis%E8%AF%A6%E8%A7%A3/#_1","title":"\u521d\u59cb\u5316\u8fc7\u7a0b","text":"<p>\u521b\u5efa Configuration \u5bf9\u8c61\u7684\u8fc7\u7a0b</p> <ul> <li>\u57fa\u4e8eXML\u914d\u7f6e\u6587\u4ef6\uff1aMyBatis \u52a0\u8f7d XML \u914d\u7f6e\u6587\u4ef6\uff0c\u5c06\u914d\u7f6e\u6587\u4fe1\u606f\u7ec4\u88c5\u6210\u5185\u90e8\u7684 Configuration \u5bf9\u8c61</li> <li>\u57fa\u4e8e Java API\uff1a\u5728java\u4ee3\u7801\u4e2d\uff0c\u624b\u52a8\u521b\u5efa Configuration \u5bf9\u8c61\uff0c\u7136\u540e\u5c06\u914d\u7f6e\u53c2\u6570 set \u8fdb\u5165 Configuration \u5bf9\u8c61\u4e2d\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/ORM%E6%A1%86%E6%9E%B6/Mybatis%E8%AF%A6%E8%A7%A3/#sqlsessionfactory","title":"SQLSessionFactory","text":"<p>mybatis \u521d\u59cb\u5316 --&gt;\u521b\u5efa SqlSession --&gt;\u6267\u884c SQL \u8bed\u53e5</p> <p>SqlSessionFactoryBuilder \u6839\u636e\u4f20\u5165\u7684\u6570\u636e\u6d41\u751f\u6210 Configuration \u5bf9\u8c61\uff0c\u7136\u540e\u6839\u636e Configuration \u5bf9\u8c61\u521b\u5efa\u9ed8\u8ba4\u7684 SqlSessionFactory \u5b9e\u4f8b</p> <ol> <li>\u8c03\u7528 SqlSessionFactoryBuilder \u5bf9\u8c61\u7684 build(inputStream)\u65b9\u6cd5\uff1b</li> <li>SqlSessionFactoryBuilder \u4f1a\u6839\u636e\u8f93\u5165\u6d41 inputStream \u7b49\u4fe1\u606f\u521b\u5efa XMLConfigBuilder \u5bf9\u8c61;</li> <li>SqlSessionFactoryBuilder \u8c03\u7528 XMLConfigBuilder \u5bf9\u8c61\u7684 parse()\u65b9\u6cd5\uff1b</li> <li>XMLConfigBuilder \u5bf9\u8c61\u8fd4\u56de Configuration \u5bf9\u8c61\uff1b</li> <li>SqlSessionFactoryBuilder \u6839\u636e Configuration \u5bf9\u8c61\u521b\u5efa\u4e00\u4e2a DefaultSessionFactory \u5bf9\u8c61\uff1b</li> <li>SqlSessionFactoryBuilder \u8fd4\u56de DefaultSessionFactory \u5bf9\u8c61\u7ed9 Client\uff0c\u4f9b Client \u4f7f\u7528\u3002</li> </ol> <p>\u6e90\u7801\u89e3\u6790</p> <pre><code> public SqlSessionFactory build(InputStream inputStream,String environment,Properties properties){\n        SqlSessionFactory var5;\n        try{\n        //\u6839\u636e\u8f93\u5165\u6d41\u521b\u5efaXMLConfigBuilder\u5bf9\u8c61\n        XMLConfigBuilder parser=new XMLConfigBuilder(inputStream,environment,properties);\n        var5=this.build(parser.parse());\n        }catch(Exception var14){\n        throw ExceptionFactory.wrapException(\"Error building SqlSession.\",var14);\n        }finally{\n        ErrorContext.instance().reset();\n\n        try{\n        inputStream.close();\n        }catch(IOException var13){\n        }\n\n        }\n\n        return var5;\n        }\n//\u6839\u636e Configuration \u5bf9\u8c61\u521b\u5efa\u4e00\u4e2a DefaultSessionFactory \u5bf9\u8c61\npublic SqlSessionFactory build(Configuration config){return new DefaultSqlSessionFactory(config);}\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/ORM%E6%A1%86%E6%9E%B6/Mybatis%E8%AF%A6%E8%A7%A3/#_2","title":"\u6570\u636e\u6e90\u4e0e\u8fde\u63a5\u6c60","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/ORM%E6%A1%86%E6%9E%B6/Mybatis%E8%AF%A6%E8%A7%A3/#datasource","title":"DataSource\u521b\u5efa","text":"<p>MyBatis \u628a\u6570\u636e\u6e90 DataSource \u5206\u4e3a\u4e09\u79cd\uff1a UNPOOLED \u4e0d\u4f7f\u7528\u8fde\u63a5\u6c60\u7684\u6570\u636e\u6e90 ; POOLED \u4f7f\u7528\u8fde\u63a5\u6c60\u7684\u6570\u636e\u6e90 ; JNDI \u4f7f\u7528 JNDI \u5b9e\u73b0\u7684\u6570\u636e\u6e90</p> <p>\u6709\u6e90\u7801\u53ef\u4ee5\u770b\u51fa\u4f7f\u7528\u4e86\u5de5\u5382\u6a21\u5f0f </p> <p>MyBatis \u662f\u901a\u8fc7\u5de5\u5382\u6a21\u5f0f\u6765\u521b\u5efa\u6570\u636e\u6e90 DataSource \u5bf9\u8c61\u7684\uff0cMyBatis \u5b9a\u4e49\u4e86\u62bd\u8c61\u7684\u5de5\u5382\u63a5\u53e3,\u901a\u8fc7\u5176 getDataSource()\u65b9\u6cd5\u8fd4\u56de\u6570\u636e\u6e90 DataSource\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/ORM%E6%A1%86%E6%9E%B6/Mybatis%E8%AF%A6%E8%A7%A3/#connection","title":"Connection\u521b\u5efa","text":"<p>\u5f53\u9700\u8981\u521b\u5efa SqlSession \u5bf9\u8c61\u5e76\u9700\u8981\u6267\u884c SQL \u8bed\u53e5\u65f6\uff0c\u8fd9\u65f6\u5019 MyBatis \u624d\u4f1a\u53bb\u8c03\u7528 dataSource \u5bf9\u8c61\u6765\u521b\u5efa java.sql.Connection \u5bf9\u8c61</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/","title":"Spring\u6982\u89c8","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/#_1","title":"\u6709\u54ea\u4e9b\u6a21\u5757","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/#_2","title":"\u6846\u67b6\u4e2d\u7528\u4e86\u54ea\u4e9b\u8bbe\u8ba1\u6a21\u5f0f","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/#springiocaop","title":"SpringIOC/AOP","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/#spring_1","title":"Spring\u5982\u4f55\u5904\u7406\u7ebf\u7a0b\u5e76\u53d1\u95ee\u9898","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/#spring_2","title":"Spring\u5982\u4f55\u89e3\u51b3\u5faa\u73af\u4f9d\u8d56","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/InitillizingBean/","title":"\u7b80\u4ecb","text":"<p>InitializingBean\u662fspring\u4e3abean\u7684\u521d\u59cb\u5316\u63d0\u4f9b\u4e86\u4e00\u79cd\u65b0\u7684\u65b9\u5f0f\uff0c\u91cc\u9762\u53ea\u6709\u4e00\u4e2a\u65b9\u6cd5afterPropertiesSet\uff0c\u4f5c\u7528\u5c31\u662f\u5b9e\u73b0\u8fd9\u4e2a\u63a5\u53e3\u6216\u8005\u5b9e\u73b0\u4e86\u7ee7\u627fInitializingBean\u7684\u65b9\u6cd5\u7684bean\u90fd\u8981\u6267\u884c\u8fd9\u4e2a\u65b9\u6cd5\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/InitillizingBean/#_2","title":"\u6269\u5c55","text":"<p>\u6784\u9020\u65b9\u6cd5\u3001\u6ce8\u89e3postConstruct\uff0c\u5b9e\u73b0InitializingBean\u65b9\u6cd5afterPropertiesSet\uff0cbean\u521d\u59cb\u5316init\u65b9\u6cd5\u6267\u884c\u987a\u5e8f\u3002</p> <pre><code>@Component\npublic class MyInitializingBean implements InitializingBean {\n\n    public MyInitializingBean() {\n        System.out.println(\"\u6211\u662fMyInitializingBean\u6784\u9020\u65b9\u6cd5\u6267\u884c...\");\n    }\n\n    @Override\n    public void afterPropertiesSet() throws Exception {\n        System.out.println(\"\u6211\u662fafterPropertiesSet\u65b9\u6cd5\u6267\u884c...\");\n    }\n\n    @PostConstruct\n    public void postConstruct() {\n        System.out.println(\"\u6211\u662fpostConstruct\u65b9\u6cd5\u6267\u884c...\");\n    }\n\n    public void init() {\n        System.out.println(\"\u6211\u662finit\u65b9\u6cd5\u6267\u884c...\");\n    }\n\n    @Bean(initMethod = \"init\")\n    public MyInitializingBean test() {\n        return new MyInitializingBean();\n    }\n}\n</code></pre> <p>\u6267\u884c\u987a\u5e8f\u4f18\u5148\u7ea7\uff1a\u6784\u9020\u65b9\u6cd5&gt;postConstruct&gt;afterPropertiesSet&gt;init\u65b9\u6cd5</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/InitillizingBean/#_3","title":"\u6e90\u7801\u89e3\u8bfb","text":"<ul> <li>Spring\u52a0\u8f7dbean\u7684\u6e90\u7801\u7c7bAbstractAutowiredCapableBeanFactory\u53ef\u4ee5\u770b\u51fa\u5176\u4e2d\u7684\u5965\u5999\uff0cAbstractAutowiredCapableBeanFactory\u7c7b\u4e2d\u7684invokeInitMethods</li> </ul> <pre><code>protected void invokeInitMethods(String beanName,final Object bean,RootBeanDefinition mbd)throws Throwable{\n        //\u5224\u65ad\u8be5bean\u662f\u5426\u5b9e\u73b0\u4e86\u5b9e\u73b0\u4e86InitializingBean\u63a5\u53e3\uff0c\u5982\u679c\u5b9e\u73b0\u4e86InitializingBean\u63a5\u53e3\uff0c\u5219\u53ea\u6389\u8c03\u7528bean\u7684afterPropertiesSet\u65b9\u6cd5\n        boolean isInitializingBean=(bean instanceof InitializingBean);\n        if(isInitializingBean&amp;&amp;(mbd==null||!mbd.isExternallyManagedInitMethod(\"afterPropertiesSet\"))){\n        if(logger.isDebugEnabled()){\n        logger.debug(\"Invoking afterPropertiesSet() on bean with name '\"+beanName+\"'\");\n        }\n\n        if(System.getSecurityManager()!=null){\n        try{\n        AccessController.doPrivileged(new PrivilegedExceptionAction&lt;Object&gt;(){\npublic Object run()throws Exception{\n        //\u76f4\u63a5\u8c03\u7528afterPropertiesSet\n        ((InitializingBean)bean).afterPropertiesSet();\n        return null;\n        }\n        },getAccessControlContext());\n        }catch(PrivilegedActionException pae){\n        throw pae.getException();\n        }\n        }\n        else{\n        //\u76f4\u63a5\u8c03\u7528afterPropertiesSet\n        ((InitializingBean)bean).afterPropertiesSet();\n        }\n        }\n        if(mbd!=null){\n        String initMethodName=mbd.getInitMethodName();\n        //\u5224\u65ad\u662f\u5426\u6307\u5b9a\u4e86init-method\u65b9\u6cd5\uff0c\u5982\u679c\u6307\u5b9a\u4e86init-method\u65b9\u6cd5\uff0c\u5219\u518d\u8c03\u7528\u5236\u5b9a\u7684init-method\n        if(initMethodName!=null&amp;&amp;!(isInitializingBean&amp;&amp;\"afterPropertiesSet\".equals(initMethodName))&amp;&amp;\n        !mbd.isExternallyManagedInitMethod(initMethodName)){\n        //\u8fdb\u4e00\u6b65\u67e5\u770b\u8be5\u65b9\u6cd5\u7684\u6e90\u7801\uff0c\u53ef\u4ee5\u53d1\u73b0init-method\u65b9\u6cd5\u4e2d\u6307\u5b9a\u7684\u65b9\u6cd5\u662f\u901a\u8fc7\u53cd\u5c04\u5b9e\u73b0\n        invokeCustomInitMethod(beanName,bean,mbd);\n        }\n        }\n        }\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/InitillizingBean/#jdkcglib","title":"JDK\u52a8\u6001\u4ee3\u7406\u4e0eCGLIB","text":"<ul> <li>JDK \u52a8\u6001\u4ee3\u7406\uff1a \u5176\u4ee3\u7406\u5bf9\u8c61\u5fc5\u987b\u662f\u67d0\u4e2a\u63a5\u53e3\u7684\u5b9e\u73b0\uff0c\u5b83\u662f\u901a\u8fc7\u5728\u8fd0\u884c\u65f6\u521b\u5efa\u4e00\u4e2a\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u6765\u5b8c\u6210\u5bf9\u76ee\u6807\u5bf9\u8c61\u7684\u4ee3\u7406</li> <li>CGLIB \u4ee3\u7406\uff1a\u5728\u8fd0\u884c\u65f6\u751f\u6210\u7684\u4ee3\u7406\u5bf9\u8c61\u662f\u9488\u5bf9\u76ee\u6807\u7c7b\u6269\u5c55\u7684\u5b50\u7c7b\u3002 CGLIB \u662f\u9ad8\u6548\u7684\u4ee3\u7801\u751f\u4ea7\u5305\uff0c\u5e95\u5c42\u662f\u4f9d\u9760 ASM \u64cd\u4f5c\u5b57\u8282\u7801\u5b9e\u73b0\u7684\uff0c\u6027\u80fd\u6bd4JDK\u5f3a\u3002\u76f8\u5173\u6807\u7b7e      true \u8868\u793a\u4f7f\u7528 CGLIB \u4ee3\u7406"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/SpringAOP/","title":"SpringAOP\u9762\u5411\u5207\u9762\u7f16\u7a0b","text":"<ol> <li>SpringAOP\u4e2aAspect4J\u7684\u5173\u7cfb</li> <li>Spring\u6846\u67b6\u5982\u4f55\u5b9e\u73b0AOP\u7684\uff0c\u4ee3\u7406\u6280\u672f\uff1f\u9759\u6001\u4ee3\u7406\uff0c\u52a8\u6001\u4ee3\u7406</li> <li>https://pdai.tech/md/spring/spring-x-framework-aop.html</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/SpringAOP/#aop","title":"AOP\u6982\u8ff0","text":"<p>\u9762\u5411\u5207\u9762\uff0c\u66f4\u52a0\u89e3\u8026\uff0c\u5c06\u5206\u6563\u518d\u5404\u4e2a\u4e1a\u52a1\u6a21\u5757\u91cd\u590d\u7684\u4ee3\u7801\u63d0\u53d6\u6a2a\u5411\u5207\u5272\u51fa\u6765</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/SpringAOP/#aspectj","title":"AspectJ\u662f\u4ec0\u4e48","text":"<p>java\u5b9e\u73b0\u7684AOP\u6846\u67b6\uff0c\u80fd\u591f\u5bf9java\u4ee3\u7801\u8fdb\u884cAOP\u7f16\u8bd1\uff0c\u662f\u76ee\u524d\u5b9e\u73b0AOP\u6846\u67b6\u4e2d\u6700\u6210\u719f\uff0c\u529f\u80fd\u6700\u4e30\u5bcc\u7684\u6846\u67b6\u3002 AspectJ\u5e94\u7528\u5230java\u4ee3\u7801\u7684\u8fc7\u7a0b\uff08\u8fd9\u4e2a\u8fc7\u7a0b\u79f0\u4e3a\u7ec7\u5165\uff09\uff0c\u5bf9\u4e8e\u7ec7\u5165\u8fd9\u4e2a\u6982\u5ff5\uff0c\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3aaspect(\u5207\u9762)\u5e94\u7528\u5230\u76ee\u6807\u51fd\u6570( \u7c7b)\u7684\u8fc7\u7a0b\u3002</p> <ol> <li>\u52a8\u6001\u7ec7\u5165\u7684\u65b9\u5f0f\u662f\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u5c06\u8981\u589e\u5f3a\u7684\u4ee3\u7801\u7ec7\u5165\u5230\u76ee\u6807\u7c7b\u4e2d\uff0c\u8fd9\u6837\u5f80\u5f80\u662f\u901a\u8fc7\u52a8\u6001\u4ee3\u7406\u6280\u672f\u5b8c\u6210\u7684\uff0c\u5982Java JDK\u7684\u52a8\u6001\u4ee3\u7406(Proxy\uff0c\u5e95\u5c42\u901a\u8fc7\u53cd\u5c04\u5b9e\u73b0)\u6216\u8005CGLIB\u7684\u52a8\u6001\u4ee3\u7406(\u5e95\u5c42\u901a\u8fc7\u7ee7\u627f\u5b9e\u73b0)\uff0cSpring    AOP\u91c7\u7528\u7684\u5c31\u662f\u57fa\u4e8e\u8fd0\u884c\u65f6\u589e\u5f3a\u7684\u4ee3\u7406\u6280\u672f</li> <li>ApectJ\u91c7\u7528\u7684\u5c31\u662f\u9759\u6001\u7ec7\u5165\u7684\u65b9\u5f0f\u3002ApectJ\u4e3b\u8981\u91c7\u7528\u7684\u662f\u7f16\u8bd1\u671f\u7ec7\u5165\uff0c\u5728\u8fd9\u4e2a\u671f\u95f4\u4f7f\u7528AspectJ\u7684acj\u7f16\u8bd1\u5668(\u7c7b\u4f3cjavac)    \u628aaspect\u7c7b\u7f16\u8bd1\u6210class\u5b57\u8282\u7801\u540e\uff0c\u5728java\u76ee\u6807\u7c7b\u7f16\u8bd1\u65f6\u7ec7\u5165\uff0c\u5373\u5148\u7f16\u8bd1aspect\u7c7b\u518d\u7f16\u8bd1\u76ee\u6807\u7c7b\u3002</li> </ol> SpringAOP AspectJ \u5728\u7eaf Java \u4e2d\u5b9e\u73b0 \u4f7f\u7528 Java \u7f16\u7a0b\u8bed\u8a00\u7684\u6269\u5c55\u5b9e\u73b0 \u4e0d\u9700\u8981\u5355\u72ec\u7684\u7f16\u8bd1\u8fc7\u7a0b \u9664\u975e\u8bbe\u7f6e LTW\uff0c\u5426\u5219\u9700\u8981 AspectJ \u7f16\u8bd1\u5668 (ajc) \u53ea\u80fd\u4f7f\u7528\u8fd0\u884c\u65f6\u7ec7\u5165 \u8fd0\u884c\u65f6\u7ec7\u5165\u4e0d\u53ef\u7528\u3002\u652f\u6301\u7f16\u8bd1\u65f6\u3001\u7f16\u8bd1\u540e\u548c\u52a0\u8f7d\u65f6\u7ec7\u5165 \u529f\u80fd\u4e0d\u5f3a-\u4ec5\u652f\u6301\u65b9\u6cd5\u7ea7\u7f16\u7ec7 \u66f4\u5f3a\u5927 - \u53ef\u4ee5\u7f16\u7ec7\u5b57\u6bb5\u3001\u65b9\u6cd5\u3001\u6784\u9020\u51fd\u6570\u3001\u9759\u6001\u521d\u59cb\u503c\u8bbe\u5b9a\u9879\u3001\u6700\u7ec8\u7c7b/\u65b9\u6cd5\u7b49. \u53ea\u80fd\u5728\u7531 Spring \u5bb9\u5668\u7ba1\u7406\u7684 bean \u4e0a\u5b9e\u73b0 \u53ef\u4ee5\u5728\u6240\u6709\u57df\u5bf9\u8c61\u4e0a\u5b9e\u73b0 \u4ec5\u652f\u6301\u65b9\u6cd5\u6267\u884c\u5207\u5165\u70b9 \u652f\u6301\u6240\u6709\u5207\u5165\u70b9 \u4ee3\u7406\u662f\u7531\u76ee\u6807\u5bf9\u8c61\u521b\u5efa\u7684, \u5e76\u4e14\u5207\u9762\u5e94\u7528\u5728\u8fd9\u4e9b\u4ee3\u7406\u4e0a \u5728\u6267\u884c\u5e94\u7528\u7a0b\u5e8f\u4e4b\u524d (\u5728\u8fd0\u884c\u65f6) \u524d, \u5404\u65b9\u9762\u76f4\u63a5\u5728\u4ee3\u7801\u4e2d\u8fdb\u884c\u7ec7\u5165 \u6bd4 AspectJ \u6162 \u66f4\u597d\u7684\u6027\u80fd"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/Spring%E4%BA%8B%E5%8A%A1/","title":"Spring @Transactional","text":"<p>\u6982\u5ff5\uff1a\u7528\u6237\u7684\u4e00\u7cfb\u5217\u6570\u636e\u5e93\u64cd\u4f5c\uff0c\u589e\u5220\u6539\u67e5\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u53ef\u89c6\u4e3a\u4e00\u4e2a\u5b8c\u6574\u7684\u903b\u8f91\u5904\u7406\u5de5\u4f5c\u5355\u5143\uff0c\u8981\u4e48\u5168\u90e8\u6267\u884c\uff0c\u8981\u4e48\u5168\u90e8\u4e0d\u6267\u884c\uff0c\u662f\u4e0d\u53ef\u5206\u5272\u7684\u5de5\u4f5c\u5355\u5143\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/Spring%E4%BA%8B%E5%8A%A1/#spring","title":"Spring\u4e8b\u52a1","text":"<ul> <li>\u7f16\u7a0b\u5f0f\u4e8b\u52a1\uff1a\u7c7b\u4f3c\u4e8eJDBC\u7f16\u7a0b\u5b9e\u73b0\u4e8b\u52a1\u7ba1\u7406\u3002\u7ba1\u7406\u4f7f\u7528TransactionTemplate\u6216\u8005\u76f4\u63a5\u4f7f\u7528\u5e95\u5c42\u7684PlatformTransactionManager\u3002\u5bf9\u4e8e\u7f16\u7a0b\u5f0f\u4e8b\u52a1\u7ba1\u7406\uff0cSpring\u63a8\u8350\u4f7f\u7528TransactionTemplate</li> <li>\u58f0\u660e\u5f0f\u4e8b\u52a1\uff1a\u7ba1\u7406\u5efa\u7acb\u5728 AOP \u4e4b\u4e0a\u7684\u3002\u5176\u672c\u8d28\u662f\u5bf9\u65b9\u6cd5\u524d\u540e\u8fdb\u884c\u62e6\u622a\uff0c\u7136\u540e\u5728\u76ee\u6807\u65b9\u6cd5\u5f00\u59cb\u4e4b\u524d\u521b\u5efa\u6216\u8005\u52a0\u5165\u4e00\u4e2a\u4e8b\u52a1\uff0c\u5728\u6267\u884c\u5b8c\u76ee\u6807\u65b9\u6cd5\u4e4b\u540e\u6839\u636e\u6267\u884c\u60c5\u51b5\u63d0\u4ea4\u6216\u8005\u56de\u6eda\u4e8b\u52a1</li> <li>@Transactional\u6ce8\u89e3\uff1a\u53ea\u80fd\u6807\u6ce8\u5171\u6709\u65b9\u6cd5\uff0c\u53ef\u4ee5\u52a0\u5728\u65b9\u6cd5\u4ee5\u53ca\u7c7b\u4e0a\uff0c\u7c7b\u4e0a\u589e\u52a0\u7684\u6574\u4e2a\u7c7b\u7684\u6240\u6709\u516c\u5171\u65b9\u6cd5\u90fd\u4f1a\u652f\u6301\u4e8b\u52a1\u3002</li> <li>rollbackFor\uff0c\u9047\u5230\u5f02\u5e38\u5373\u56de\u6eda</li> <li>noRollbackFor\uff0c\u9047\u5230\u6307\u5b9a\u5f02\u5e38\u4e0d\u56de\u6eda</li> <li>timeout\u5355\u4f4d\u4e3a\u79d2\uff0c\u8d85\u65f6\u5c5e\u6027\uff0c\u4e8b\u52a1\u5728\u5f3a\u5236\u56de\u6eda\u4e4b\u524d\u53ef\u4ee5\u4fdd\u6301\u591a\u4e45\uff0c\u53ef\u4ee5\u9632\u6b62\u957f\u671f\u8fd0\u884c\u7684\u4e8b\u52a1\u5360\u7528\u8d44\u6e90</li> <li>readOnly\uff0c\u53ea\u8bfb\u5c5e\u6027\uff0c\u8868\u793a\u8fd9\u4e2a\u4e8b\u52a1\u53ea\u8bfb\u53d6\u6570\u636e\u4f46\u4e0d\u66f4\u65b0\u6570\u636e\uff0c\u8fd9\u6837\u53ef\u4ee5\u5e2e\u52a9\u6570\u636e\u5e93\u5f15\u64ce\u4f18\u5316\u4e8b\u52a1</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/Spring%E4%BA%8B%E5%8A%A1/#spring_1","title":"Spring\u4e8b\u52a1\u9700\u8981\u89e3\u51b3\u7684\u95ee\u9898","text":"<ul> <li>serviceA\u65b9\u6cd5\u8c03\u7528\u4e86serviceB\u65b9\u6cd5\uff0c\u4e24\u4e2a\u65b9\u6cd5\u90fd\u6709\u4e8b\u52a1\uff0c\u8fd9\u4e2a\u65f6\u5019serviceB\u65b9\u6cd5\u5f02\u5e38\uff0c\u662fserviceB\u65b9\u6cd5\u63d0\u4ea4\uff0c\u8fd8\u662f\u4e24\u4e2a\u4e00\u8d77\u56de\u6eda</li> <li>serviceA\u65b9\u6cd5\u8c03\u7528\u4e86serviceB\u65b9\u6cd5\uff0c\u4f46\u662f\u53ea\u6709serviceA\u65b9\u6cd5\u6709\u4e8b\u52a1\uff0c\u662f\u5426\u628aserviceB\u4e5f\u52a0\u5165serviceA\u7684\u4e8b\u52a1\uff0c\u5982\u679cserviceB\u5f02\u5e38\uff0c\u662f\u5426\u56de\u6edaserviceA</li> <li>serviceA\u65b9\u6cd5\u8c03\u7528\u4e86serviceB\u65b9\u6cd5\uff0c\u4e24\u8005\u90fd\u6709\u4e8b\u52a1\uff0cserviceB\u65b9\u6cd5\u5df2\u7ecf\u6b63\u5e38\u6267\u884c\u5b8c\uff0c\u4f46serviceA\u5f02\u5e38\uff0c\u662f\u5426\u9700\u8981\u56de\u6edaserviceB</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/Spring%E4%BA%8B%E5%8A%A1/#-7","title":"\u4f20\u64ad\u673a\u5236--7\u79cd\u4e8b\u52a1\u4f20\u64ad\u673a\u5236","text":"<p>spring\u662f\u7528AOP\u6765\u4ee3\u7406\u4e8b\u52a1\u63a7\u5236\uff0c\u662f\u9488\u5bf9\u63a5\u53e3\u6216\u7c7b\u7684\uff0c\u6240\u4ee5\u540c\u4e00\u4e2aservice\u7c7b\u4e2d\u4e24\u4e2a\u65b9\u6cd5\u7684\u8c03\u7528\uff0c\u4f20\u64ad\u673a\u5236\u662f\u4e0d\u751f\u6548\u7684\u3002 \u539f\u56e0\uff1a\u5728spring\u4e2d\uff0c\u5f53\u4e00\u4e2a\u65b9\u6cd5\u5f00\u542f\u4e8b\u52a1\u65f6\uff0cspring\u521b\u5efa\u8fd9\u4e2a\u65b9\u6cd5\u7684\u7c7b\u7684bean\u5bf9\u8c61\uff0c\u5219\u521b\u5efa\u8be5\u5bf9\u8c61\u7684\u4ee3\u7406\u5bf9\u8c61\u3002spring\u4e2d\u8c03\u7528bean\u5bf9\u8c61\u7684\u65b9\u6cd5\u624d\u4f1a\u53bb\u5224\u65ad\u65b9\u6cd5\u4e0a\u7684\u6ce8\u89e3\u3002\u5728\u4ee3\u7406bean\u5bf9\u8c61\u4e2d\uff0c\u4e00\u4e2a\u65b9\u6cd5\u8c03\u7528\u672c\u8eab\u7684\u53e6\u4e00\u4e2a\u65b9\u6cd5\uff0c\u5b9e\u5219\u8c03\u7528\u7684\u4ee3\u7406\u5bf9\u8c61\u7684\u539f\u59cb\u5bf9\u8c61\uff08\u4e0d\u5c5e\u4e8e spring bean\uff09\u7684\u65b9\u6cd5\uff0c\u8c03\u7528\u65b9\u6cd5\u65f6\u4e0d\u4f1a\u53bb\u5224\u65ad\u65b9\u6cd5\u4e0a\u7684\u6ce8\u89e3\u3002\u8fd9\u5c31\u662f\u4f20\u64ad\u673a\u5236\u4e0d\u751f\u6548\u7684\u539f\u56e0 \u89e3\u51b3\uff1a\u83b7\u53d6\u5230\u5f53\u524dservice\u7684\u4ee3\u7406\u7c7b\u5373\u53ef\u5b9e\u73b0\u8c03\u7528\u81ea\u5df1\u7c7b\u7684\u65b9\u6cd5\uff1a\u81ea\u8eab\u7c7b\u6ce8\u5165\u81ea\u5df1\uff1bAopContext.currentProxy\u6765\u83b7\u53d6\uff0c\u4f46\u662f\u6b64\u65b9\u6cd5\u9700\u8981\u518d\u542f\u52a8\u7c7b\u5f00\u542fexposeProxy\u6ce8\u91ca\uff08@EnableAspectJAutoProxy( exposeProxy = true)\uff09</p> <ul> <li>PROPAGATION_REQUIRED<ul> <li>spring\u7684\u9ed8\u8ba4\u4e8b\u52a1\u4f20\u64ad\u7c7b\u578brequired:\u5982\u679c\u5f53\u524d\u6ca1\u6709\u4e8b\u52a1\uff0c\u5219\u65b0\u5efa\u4e8b\u52a1\uff1b</li> <li>\u5982\u679c\u5df2\u7ecf\u5b58\u5728\u4e8b\u52a1\uff0c\u5219\u52a0\u5165\u5f53\u524d\u4e8b\u52a1\uff0c\u5408\u5e76\u6210\u4e00\u4e2a\u4e8b\u52a1</li> </ul> </li> <li>REQUIRES_NEW<ul> <li>\u65b0\u5efa\u4e8b\u52a1\uff0c\u5982\u679c\u5b58\u5728\u5f53\u524d\u4e8b\u52a1\uff0c\u5219\u628a\u5f53\u524d\u4e8b\u52a1\u6302\u8d77\uff1b</li> <li>\u8fd9\u4e2a\u65b9\u6cd5\u72ec\u7acb\u4e8b\u52a1\uff0c\u4e0d\u53d7\u8c03\u7528\u8005\u5f71\u54cd\uff0c\u8c03\u7528\u8005\u5f02\u5e38\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u5f53\u524d\u4e8b\u52a1\u63d0\u4ea4</li> </ul> </li> <li>NESTED<ul> <li>\u5f53\u524d\u6ca1\u6709\u4e8b\u52a1\uff0c\u4f1a\u65b0\u5efa\u4e8b\u52a1</li> <li>\u6709\u4e8b\u52a1\uff0c\u4f1a\u4f5c\u4e3a\u7236\u7ea7\u4e8b\u52a1\u7684\u4e00\u4e2a\u5b50\u4e8b\u52a1\uff0c\u65b9\u6cd5\u7ed3\u675f\u540e\u5e76\u6ca1\u6709\u63d0\u4ea4\uff0c\u7b49\u7236\u4e8b\u52a1\u63d0\u4ea4\u5b83\u624d\u63d0\u4ea4</li> <li>\u5982\u679c\u5b83\u5f02\u5e38\uff0c\u7236\u7ea7\u53ef\u4ee5\u6355\u83b7\u5b83\u7684\u5f02\u5e38\u800c\u4e0d\u8fdb\u884c\u56de\u6eda\uff0c\u6b63\u5e38\u63d0\u4ea4</li> <li>\u5982\u679c\u7236\u7ea7\u5f02\u5e38\uff0c\u5b83\u5fc5\u7136\u56de\u6eda</li> </ul> </li> <li>SUPPORTS<ul> <li>\u5982\u679c\u5f53\u524d\u5b58\u5728\u4e8b\u52a1\uff0c\u5c31\u52a0\u5165\u5f53\u524d\u4e8b\u52a1</li> <li>\u5982\u679c\u4e0d\u5b58\u5728\u4e8b\u52a1\uff0c\u5219\u5df2\u65e0\u4e8b\u52a1\u65b9\u5f0f\u8fd0\u884c\uff0c\u548c\u4e0d\u5199\u6ca1\u533a\u522b</li> </ul> </li> <li>NOT_SUPPORTED<ul> <li>\u975e\u4e8b\u52a1\u8fd0\u884c</li> <li>\u5982\u679c\u5f53\u524d\u5b58\u5728\u4e8b\u52a1\uff0c\u5c06\u5f53\u524d\u4e8b\u52a1\u6302\u8d77</li> </ul> </li> <li>MANDATORY<ul> <li>\u5982\u679c\u5f53\u524d\u6709\u4e8b\u52a1\uff0c\u5219\u8fd0\u884c\u5728\u5f53\u524d\u4e8b\u52a1\u4e2d</li> <li>\u5982\u679c\u5f53\u524d\u6ca1\u6709\u4e8b\u52a1\uff0c\u5219\u629b\u51fa\u5f02\u5e38\uff0c\u5373\u7236\u65b9\u6cd5\u5fc5\u987b\u6709\u4e8b\u52a1</li> </ul> </li> <li>NEVER<ul> <li>\u4ee5\u975e\u4e8b\u52a1\u65b9\u6cd5\u8fd0\u884c\uff0c\u5982\u679c\u5f53\u524d\u6709\u4e8b\u52a1\u5373\u629b\u5f02\u5e38\uff1b\u4e0d\u5141\u8bb8\u7236\u65b9\u6cd5\u6709\u4e8b\u52a1</li> </ul> </li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/Spring%E4%BA%8B%E5%8A%A1/#spring11","title":"Spring\u4e8b\u52a1\u5931\u6548\u768411\u79cd\u573a\u666f","text":"<ol> <li>\u8bbf\u95ee\u6743\u9650\u95ee\u9898\uff0cspring\u8981\u6c42\u88ab\u4ee3\u7406\u65b9\u6cd5\u5fc5\u987b\u662fpublic\u7684\u3002spring\u6e90\u7801\u79cd\uff0c\u5982\u679c\u76ee\u6807\u65b9\u6cd5\u4e0d\u662fpublic\uff0c\u5219TransactionAttribute\u8fd4\u56denull\uff0c\u4e0d\u652f\u6301\u4e8b\u52a1</li> <li>\u65b9\u6cd5\u7528final\u4fee\u9970\uff0c\u4e5f\u4f1a\u5bfc\u81f4\u5931\u6548\uff0c\u56e0\u4e3aspring\u4e8b\u52a1\u5e95\u5c42\u662faop\uff0c\u7528\u4e86jdk\u7684\u52a8\u6001\u4ee3\u7406\u6216\u8005cglib\u7684\u52a8\u6001\u4ee3\u7406\uff0c\u4f1a\u751f\u6210\u4ee3\u7406\u7c7b\uff0c\u5728\u4ee3\u7406\u7c7b\u4e2d\u5b9e\u73b0\u4e8b\u52a1\u529f\u80fd\uff08static\u4fee\u9970\u540c\u6837\u5931\u6548\uff09</li> <li>\u76f4\u63a5\u8c03\u7528\u5185\u90e8\u65b9\u6cd5\uff0c\u89e3\u51b3\u65b9\u6848\u5e94\u8be5\u6ce8\u5165\u81ea\u5df1\u8c03\u7528\u6216\u8005\u4f7f\u7528AopContext.currentProxy\u6765\u83b7\u53d6</li> <li>\u672a\u88abSpring\u7ba1\u7406\uff0c\u5f53\u7136\u65e0\u6cd5\u4f7f\u7528spring\u4e8b\u52a1</li> <li>\u591a\u7ebf\u7a0b\u8c03\u7528\uff0c\u91cd\u65b0new\u4e00\u4e2a\u7ebf\u7a0b\u8c03\u7528\u5e26\u4e8b\u52a1\u7684\u65b9\u6cd5\uff0c\u56e0\u4e3a\u7ebf\u7a0b\u4e0d\u540c\uff0c\u83b7\u53d6\u5230\u6570\u636e\u5e93\u8fde\u63a5\u4e0d\u4e00\u6837\uff0c\u4ece\u800c\u662f\u4e24\u4e2a\u4e0d\u540c\u7684\u4e8b\u52a1\u3002spring\u4e8b\u52a1\u65f6\u901a\u8fc7\u6570\u636e\u5e93\u8fde\u63a5\u5b9e\u73b0\u7684\uff0c\u5f53\u524d\u7ebf\u7a0b\u4fdd\u5b58\u4e86\u4e00\u4e2amap,key\u662f\u6570\u636e\u6e90\uff0cvalue\u662f\u6570\u636e\u5e93\u8fde\u63a5</li> <li>\u8868\u4e0d\u652f\u6301\u4e8b\u52a1\uff0c\u5982myisam\u5f15\u64ce</li> <li>\u4e8b\u52a1\u6ca1\u6709\u5f00\u542f\uff0c\u5982\u679cspringboot\u9879\u76ee\uff0c\u4e8b\u52a1\u9ed8\u8ba4\u662f\u5f00\u542f\u7684\uff0c\u4f46spring\u9879\u76ee\uff0c\u9700\u8981xml\u914d\u7f6e</li> <li>\u4e8b\u52a1\u4f20\u64ad\u7279\u6027\uff0c\u53ea\u6709PROPAGATION_REQUIRED\u3001REQUIRES_NEW\u3001NESTED\u8fd9\u4e09\u79cd\u624d\u4f1a\u521b\u5efa\u65b0\u4e8b\u52a1</li> <li>try...catch\u81ea\u5df1\u6355\u83b7\u4e86\u5f02\u5e38\uff0c\u5bfc\u81f4\u4e8b\u52a1\u4e0d\u56de\u6eda</li> <li>\u624b\u52a8\u629b\u4e86spring\u4e8b\u52a1\u4e0d\u652f\u6301\u7684\u5f02\u5e38\uff0c\u4e5f\u4e0d\u4f1a\u56de\u6eda\u3002spring\u4e8b\u52a1\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53ea\u56de\u6edaRuntimeException\u8fd0\u884c\u65f6\u5f02\u5e38\u548cError\u9519\u8bef\uff0c\u5bf9\u4e8e\u666e\u901a\u7684\u975e\u8fd0\u884c\u65f6\u5f02\u5e38\uff0c\u4e0d\u4f1a\u56de\u6eda</li> <li>\u6307\u5b9a\u4e86rollbackFor\u5f02\u5e38\u56de\u6eda\uff0c\u4f46\u662f\u5e76\u4e0d\u662f\u62a5\u7684\u6b64\u7c7b\u5f02\u5e38\uff0c\u4e5f\u4e0d\u4f1a\u6355\u83b7\u56de\u6eda</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/TransactionSynchronizationManager/","title":"TransactionSynchronizationManager","text":"<ul> <li>spring\u4e8b\u52a1\u63d0\u4f9b\u7684\u6ce8\u518c\u56de\u8c03\u63a5\u53e3\u7684\u65b9\u6cd5</li> <li>\u4ee3\u7801\u793a\u4f8b\uff1a</li> </ul> <pre><code>TransactionSynchronizationManager.registerSynchronization(new TransactionSynchronizationAdapter() {\n                @Override\n                public void afterCommit() {\n                    AService.invoke();\n                }\n            });\n</code></pre> <ul> <li>\u6e90\u7801\uff1aTransactionSynchronizationAdapter.java</li> </ul> <pre><code>public interface TransactionSynchronization extends Flushable {\n    /** \u4e8b\u52a1\u63d0\u4ea4\u72b6\u6001 **/\n    int STATUS_COMMITTED = 0;\n    /** \u4e8b\u52a1\u56de\u6eda\u72b6\u6001 **/\n    int STATUS_ROLLED_BACK = 1;\n    /** \u4e8b\u52a1\u72b6\u6001\u672a\u77e5 **/\n    int STATUS_UNKNOWN = 2;\n\n    /** \u4e8b\u52a1\u6302\u8d77 **/\n    void suspend();\n\n    /** \u4e8b\u52a1\u6062\u590d **/\n    void resume();\n\n    /** \u5c06\u57fa\u7840\u4f1a\u8bdd\u5237\u65b0\u5230\u6570\u636e\u5b58\u50a8\u533a\uff08\u5982Hibernate JPA\u7684session\uff09 **/\n    void flush();\n\n    /** \u5728\u4e8b\u52a1\u63d0\u4ea4\u524d\u89e6\u53d1\uff0c\u5982\u679c\u6b64\u5904\u53d1\u751f\u5f02\u5e38\uff0c\u4f1a\u5bfc\u81f4\u56de\u6eda **/\n    void beforeCommit(boolean var1);\n\n    /** \u5728beforeCommit\u4e4b\u540e\uff0cCommit/RoolBack\u4e4b\u524d\uff0c\u5373\u4f7f\u53d1\u751f\u5f02\u5e38\uff0c\u4e5f\u4e0d\u4f1a\u56de\u6eda **/\n    void beforeCompletion();\n\n    /** \u4e8b\u52a1\u63d0\u4ea4\u540e\u6267\u884c **/\n    void afterCommit();\n\n    /** \u4e8b\u52a1\u63d0\u4ea4/\u56de\u6eda\u6267\u884c **/\n    void afterCompletion(int var1);\n}\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/%E5%A4%A7%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86%E4%BC%98%E5%8C%96/","title":"\u5927\u4e8b\u52a1","text":"<p>\u8017\u65f6\u6bd4\u8f83\u4e45\u7684\u4e8b\u52a1</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/%E5%A4%A7%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86%E4%BC%98%E5%8C%96/#_2","title":"\u4ea7\u751f\u539f\u56e0","text":"<ul> <li>\u64cd\u4f5c\u6570\u636e\u591a</li> <li>\u8c03\u7528rpc\u8d85\u65f6</li> <li>\u6709\u5176\u4ed6\u8017\u65f6\u64cd\u4f5c</li> <li>\u9501\u7ade\u4e89</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/%E5%A4%A7%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86%E4%BC%98%E5%8C%96/#_3","title":"\u5f71\u54cd","text":"<ul> <li>\u5e76\u53d1\u60c5\u51b5\uff0c\u8fde\u63a5\u6c60\u5bb9\u6613\u7206</li> <li>\u9501\u5b9a\u6570\u636e\u591a\uff0c\u5927\u91cf\u963b\u585e\u548c\u9501\u8d85\u65f6</li> <li>\u6267\u884c\u65f6\u95f4\u957f\uff0c\u5bb9\u6613\u9020\u6210\u4e3b\u4ece\u5ef6\u8fdf</li> <li>undo log \u65e5\u5fd7\u81a8\u80c0\uff0c\u589e\u52a0\u4e86\u5b58\u50a8\uff0c\u964d\u4f4e\u67e5\u8be2\u6027\u80fd</li> <li>\u5982\u679c\u6709\u5f02\u5e38\uff0c\u4e8b\u52a1\u56de\u6eda\u8017\u65f6</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/%E5%A4%A7%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86%E4%BC%98%E5%8C%96/#_4","title":"\u4f18\u5316\u65b9\u6848","text":"<ol> <li>@Transactional\u662f\u58f0\u660e\u5f0f\u4e8b\u52a1\uff0c\u64cd\u4f5c\u4e0d\u719f\u7ec3\uff0c\u5bb9\u6613\u53d1\u751f\u4e8b\u52a1\u5931\u6548\uff0c\u95ee\u9898\u4e0d\u597d\u6392\u67e5\u3002</li> <li>\u58f0\u660e\u5f0f\u4e8b\u52a1\u589e\u52a0\u518d\u65b9\u6cd5\u5c1a\uff0c\u7c92\u5ea6\u8f83\u7c97\uff0c\u5d4c\u5957\u4e1a\u52a1\u6bd4\u8f83\u591a\uff0c\u4e0d\u597d\u63a7\u5236\u4e8b\u52a1\u8303\u56f4</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/%E5%A4%A7%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86%E4%BC%98%E5%8C%96/#_5","title":"\u7f16\u7a0b\u5f0f\u4e8b\u52a1","text":"<p>TransactionTemplate</p> <pre><code>@Resource\nprivate TransactionTemplate transactionTemplate;\n\n        //\u51cf\u5c11\u4e8b\u52a1\u9897\u7c92\u5ea6\n        transactionTemplate.execute((status)-&gt;{\n        insertBatch(costItemInfos);\n        //\u63d2\u5165\u8bb0\u5f55\u8868\u5185\u5bb9\n        insertCostItemChanged();\n        return Boolean.TRUE;\n        });\n</code></pre> <p>\u51cf\u5c11\u4e8b\u52a1\u9897\u7c92\u5ea6\uff0c\u53ef\u63a7</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/%E5%A4%A7%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86%E4%BC%98%E5%8C%96/#select","title":"\u5c06\u67e5\u8be2\uff08select\uff09\u653e\u5230\u4e8b\u52a1\u5916","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/%E5%BE%88%E8%80%81%E7%9A%84%E4%B8%9C%E8%A5%BF/","title":"\u4e00\u4e9b\u5b58\u5728\u5f88\u8001\u7684\u4e1c\u897f\uff0c\u8fd8\u6709\u5728\u5e94\u7528\u7684\u5e94\u8be5\u6ca1\u6709\u4e86","text":"<p>Spring\u548cSpringMVC\u76f8\u5173</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96/","title":"\u5faa\u73af\u4f9d\u8d56","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96/#_2","title":"\u6e90\u7801\u89e3\u8bfb","text":"<ul> <li>\u7c7b\uff1aDefaultSingletonBeanRegistry</li> <li>\u6838\u5fc3\u96c6\u5408\uff1asingletonObjects\u3001singletonFactories\u3001earlySingletonObjects\u3001registeredSingletons</li> </ul> <pre><code>/** Cache of singleton objects: bean name to bean instance. */\nprivate final Map&lt;String, Object&gt; singletonObjects=new ConcurrentHashMap&lt;&gt;(256);\n\n/** Cache of singleton factories: bean name to ObjectFactory. */\nprivate final Map&lt;String, ObjectFactory&lt;?&gt;&gt;singletonFactories=new HashMap&lt;&gt;(16);\n\n/** Cache of early singleton objects: bean name to bean instance. */\nprivate final Map&lt;String, Object&gt; earlySingletonObjects=new ConcurrentHashMap&lt;&gt;(16);\n\n/** Names of beans that are currently in creation. */\nprivate final Set&lt;String&gt; singletonsCurrentlyInCreation=\n        Collections.newSetFromMap(new ConcurrentHashMap&lt;&gt;(16));\n</code></pre> <ul> <li>\u6d41\u7a0b\uff1a<ul> <li>\u68c0\u6d4b\u5f53\u524d bean \u662f\u5426\u5728 singletonObjects \u4e2d\uff0c\u5728\u5219\u76f4\u63a5\u8fd4\u56de\u7f13\u5b58\u597d\u7684 bean\uff1b\u4e0d\u5728\u5219\u68c0\u6d4b \u662f\u5426\u5728 singletonFactories \u4e2d\uff0c\u5728\uff0c\u5219\u8c03\u7528\u5176 getObject \u65b9\u6cd5\uff0c\u8fd4\u56de\uff0c\u5e76\u4ece   singletonFactories \u4e2d\u79fb\u9664\uff0c\u52a0\u5165\u5230 earlySingletonObjects \u4e2d\u3002</li> <li>\u6b63\u5e38\u521b\u5efa\uff0cbeforeSingletonCreation:\u68c0\u6d4b\u5f53\u524d bean \u662f\u5426\u5728 singletonsCurrentlyInCreation\uff0c \u5982\u679c\u5b58\u5728\uff0c\u629b\u51fa\u5f02\u5e38\u3002\u8868\u793a\u5b58\u5728\u6784\u9020\u5668\u5faa\u73af\u4f9d\u8d56\u3002\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5219\u5c06\u5f53\u524d bean   \u52a0\u5165\u3002</li> <li>bean \u521d\u59cb\u5316\uff0c\u5206\u4e3a\u6784\u9020\u65b9\u6cd5\u521d\u59cb\u5316\u3001\u5de5\u5382\u65b9\u6cd5\u521d\u59cb\u5316\u548c\u7b80\u5355\u521d\u59cb\u5316\u3002\u5982\u679c\u662f\u6784\u9020\u65b9\u6cd5\u521d \u59cb\u5316\uff0c\u90a3\u4e48\u9012\u5f52\u5730\u83b7\u53d6\u53c2\u6570 bean\u3002\u5176\u4ed6\u60c5\u51b5\u4e0d\u4f1a\u9012\u5f52\u83b7\u53d6 bean\u3002</li> <li>addSingletonFactory:\u5982\u679c\u5f53\u524d bean \u4e0d\u5728 singletonObjects \u4e2d\uff0c\u5219\u5c06\u5f53\u524d bean \u52a0\u5165\u5230 singletonFactories \u4e2d\uff0c\u5e76\u4ece earlySingletonObjects   \u4e2d\u79fb\u9664\u3002</li> <li>\u8c03\u7528\u7528\u6237\u521d\u59cb\u5316\u65b9\u6cd5\uff0c\u6bd4\u5982 BeanPostProcesser\u3001InitializingBean\u3001init-method\uff0c\u6709\u53ef\u80fd \u8fd4\u56de\u4ee3\u7406\u540e\u7684 bean\u3002</li> <li>\u68c0\u6d4b\u5faa\u73af\u4f9d\u8d56\uff0c\u5982\u679c\u5f53\u524d bean \u5728 singletonObjects \u4e2d\uff0c\u5219\u5224\u65ad\u5f53\u524d bean(current bean)   \u4e0e singletonObjects \u4e2d\u7684 bean(cached bean)\u662f\u5426\u662f\u540c\u4e00\u4e2a\uff0c\u5982\u679c\u4e0d\u662f\uff0c\u90a3\u4e48\u8bf4\u660e\u5f53\u524d bean \u662f\u88ab\u4ee3\u7406\u8fc7\u7684\uff0c\u7531\u4e8e\u4f9d\u8d56\u5f53\u524d bean \u7684 bean \u6301\u6709\u7684\u662f\u5bf9 cached bean   \u7684\u5f15\u7528\uff0c\u8fd9\u662f\u4e0d\u88ab\u5141\u8bb8\u7684\uff0c\u6240\u4ee5\u4f1a\u629b\u51fa BeanCurrentlyInCreationException \u5f02\u5e38\u3002</li> <li>afterSingletonCreation:\u5c06\u5f53\u524d bean \u4ece singletonsCurrentlyInCreation \u4e2d\u5220\u9664</li> <li>addSingleton: \u5c06\u5f53\u524dbean\u52a0\u5165\u5230 singletonObjects\uff0c\u7136\u540e\u4ecesingletonFactories, earlySingletonObjects\u4e2d\u79fb\u9664\uff0c\u7ed3\u675f</li> </ul> </li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/Spring/%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96/#beancurrentlyincreationexception","title":"\u901a\u8fc7\u6784\u9020\u5668\u6ce8\u5165\u6784\u6210\u7684\u5faa\u73af\u4f9d\u8d56\uff0c\u65e0\u6cd5\u89e3\u51b3\uff0c\u53ea\u80fd\u629b\u51fa\u5f02\u5e38\uff1aBeanCurrentlyInCreationException","text":"<ol> <li>Spring \u5bb9\u5668\u521b\u5efa\u5355\u4f8b\u201cA\u201d Bean\uff0c\u9996\u5148\u68c0\u6d4b singletonFactories \u662f\u5426\u5305\u542b A\uff0c\u53d1\u73b0\u6ca1\u6709\uff0c\u4e8e\u662f\u6b63\u5e38\u521b\u5efa\uff0c\u7136\u540e\u68c0\u6d4b A \u662f\u5426\u5305\u542b\u5728 singletonsCurrentlyInCreation\u4e2d\uff0c\u6ca1\u6709\uff0c\u5219\u5c06 A    \u653e\u5165\u3002 \u6784\u9020\u65b9\u6cd5\u521d\u59cb\u5316\u65f6\u9700\u8981 B \u5b9e\u4f8b\uff08A \u5c1a\u672a\u653e\u5165\u5230 singletonFactories \u4e2d\uff09\uff0c\u4e8e\u662f\u8c03\u7528\u4e86 getBean(B)    \u65b9\u6cd5\u3001</li> <li>Spring \u5bb9\u5668\u521b\u5efa\u5355\u4f8b\u201cB\u201d Bean\uff0c\u9996\u5148\u68c0\u6d4b singletonFactories \u662f\u5426\u5305\u542b B\uff0c\u53d1\u73b0\u6ca1\u6709\uff0c\u4e8e\u662f\u6b63\u5e38\u521b\u5efa\uff0c\u7136\u540e\u68c0\u6d4b B \u662f\u5426\u5305\u542b\u5728 singletonsCurrentlyInCreation\u4e2d\uff0c\u6ca1\u6709\uff0c\u5219\u5c06 B    \u653e\u5165\u3002 \u6784\u9020\u65b9\u6cd5\u521d\u59cb\u5316\u65f6\u9700\u8981 C \u5b9e\u4f8b\uff08B \u5c1a\u672a\u653e\u5165\u5230 singletonFactories \u4e2d\uff09\uff0c\u4e8e\u662f\u8c03\u7528\u4e86 getBean(C)    \u65b9\u6cd5\u3001</li> <li>Spring \u5bb9\u5668\u521b\u5efa\u5355\u4f8b\u201cC\u201d Bean\uff0c\u9996\u5148\u68c0\u6d4b singletonFactories \u662f\u5426\u5305\u542b C\uff0c\u53d1\u73b0\u6ca1\u6709\uff0c\u4e8e\u662f\u6b63\u5e38\u521b\u5efa\uff0c\u7136\u540e\u68c0\u6d4b C \u662f\u5426\u5305\u542b\u5728 singletonsCurrentlyInCreation\u4e2d\uff0c\u6ca1\u6709\uff0c\u5219\u5c06 C    \u653e\u5165\u3002 \u6784\u9020\u65b9\u6cd5\u521d\u59cb\u5316\u65f6\u9700\u8981 A \u5b9e\u4f8b\uff08C \u5c1a\u672a\u653e\u5165\u5230 singletonFactories \u4e2d\uff09\uff0c\u4e8e\u662f\u8c03\u7528\u4e86 getBean(A)    \u65b9\u6cd5\u3001</li> <li>Spring \u5bb9\u5668\u521b\u5efa\u5355\u4f8b\u201cA\u201d Bean\uff0c\u9996\u5148\u68c0\u6d4b singletonFactories \u662f\u5426\u5305\u542b A\uff0c\u53d1\u73b0\u6ca1\u6709\u4e8e\u662f\u6b63\u5e38\u521b\u5efa \uff0c\u7136\u540e\u68c0\u6d4bA\u662f\u5426\u5305\u542b\u5728 singletonsCurrentlyInCreation \u4e2d \uff0c \u6709 \uff0c \u629b \u51fa    BeanCurrentlyInCreationException \u5f02\u5e38\u3002</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringBoot/SpringApplication%E8%A7%A3%E6%9E%90/","title":"SpringApplication","text":"<p>SpringBoot\u542f\u52a8\u6d41\u7a0b\u53ca\u5404\u7ec4\u4ef6\u76f8\u4e92\u8c03\u7528\u5173\u7cfb\u5982\u56fe </p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringBoot/SpringApplication%E8%A7%A3%E6%9E%90/#_1","title":"\u8be6\u89e3","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringBoot/SpringApplication%E8%A7%A3%E6%9E%90/#initialize","title":"\u65e0\u53c2\u6784\u9020\u65b9\u6cd5\u8c03\u7528initialize()\u65b9\u6cd5\u505a\u521d\u59cb\u5316\u52a8\u4f5c","text":"<pre><code>/**\n * Create a new SpringApplication instance. The application context will load beans from the specified sources (see class-level documentation for details. The instance can be customized before calling run(String...).\n Params:\n sources \u2013 the bean sources\n See Also:\n run(Object, String[]), SpringApplication(ResourceLoader, Object...)\n */\n@SuppressWarnings({\"unchecked\", \"rawtypes\"})\nprivate void initialize(Object[]sources){\n        if(sources!=null&amp;&amp;sources.length&gt;0){\n        this.sources.addAll(Arrays.asList(sources));\n        }\n        //\u63a8\u65ad\u5f53\u524d\u7a0b\u5e8f\u7c7b\u578b\n        this.webEnvironment=deduceWebEnvironment();\n        //\u4f7f\u7528SpringFactoriesLoader \u5b9e\u4f8b\u5316\u6240\u6709\u53ef\u7528\u7684\u521d\u59cb\u5668\n        setInitializers((Collection)getSpringFactoriesInstances(ApplicationContextInitializer.class));\n        //\u4f7f\u7528SpringFactoriesLoader \u5b9e\u4f8b\u5316\u6240\u6709\u53ef\u7528\u7684\u76d1\u542c\u5668\n        setListeners((Collection)getSpringFactoriesInstances(ApplicationListener.class));\n        //\u914d\u7f6e\u5e94\u7528\u4e3b\u65b9\u6cd5\u6240\u5728\u7c7b\n        this.mainApplicationClass=deduceMainApplicationClass();\n        }\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringBoot/SpringApplication%E8%A7%A3%E6%9E%90/#run","title":"\u542f\u52a8\u65b9\u6cd5run()","text":"<p>run\u65b9\u6cd5\u5b8c\u6210\u4e86spring\u6574\u4e2a\u542f\u52a8\u8fc7\u7a0b</p> <pre><code>    /**\n     * Run the Spring application, creating and refreshing a new\n     * {@link ApplicationContext}.\n     * @param args the application arguments (usually passed from a Java main method)\n     * @return a running {@link ApplicationContext}\n     */\n    public ConfigurableApplicationContext run(String... args) {\n        //\u5f00\u542f\u65f6\u949f\u8ba1\u65f6\n        StopWatch stopWatch = new StopWatch();\n        stopWatch.start();\n        ConfigurableApplicationContext context = null;\n        FailureAnalyzers analyzers = null;\n        //\u5f00\u542f\u8bbe\u7f6e\uff0c\u8ba9\u7cfb\u7edf\u6a21\u62df\u4e0d\u5b58\u5728io\u8bbe\u5907\n        configureHeadlessProperty();\n        //\u521d\u59cb\u5316SpringApplicationRunListener \u76d1\u542c\u5668\uff0c\u5e76\u8fdb\u884c\u5c01\u88c5\n        SpringApplicationRunListeners listeners = getRunListeners(args);\n        listeners.starting();\n        try {\n            ApplicationArguments applicationArguments = new DefaultApplicationArguments(\n                    args);\n            //\u73af\u5883\u51c6\u5907\n            ConfigurableEnvironment environment = prepareEnvironment(listeners,\n                    applicationArguments);\n            //\u6253\u5370banner\n            Banner printedBanner = printBanner(environment);\n            context = createApplicationContext();\n            analyzers = new FailureAnalyzers(context);\n            //\u5bb9\u5668\u521d\u59cb\u5316\n            prepareContext(context, environment, listeners, applicationArguments,\n                    printedBanner);\n            //\u5237\u65b0\u4e0a\u4e0b\u6587\u5bb9\u5668\n            refreshContext(context);\n            afterRefresh(context, applicationArguments);\n            listeners.finished(context, null);\n            stopWatch.stop();\n            if (this.logStartupInfo) {\n                new StartupInfoLogger(this.mainApplicationClass)\n                        .logStarted(getApplicationLog(), stopWatch);\n            }\n            return context;\n        }\n        catch (Throwable ex) {\n            handleRunFailure(context, listeners, analyzers, ex);\n            throw new IllegalStateException(ex);\n        }\n    }\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringBoot/SpringApplication%E8%A7%A3%E6%9E%90/#springapplicationrunlisteners","title":"SpringApplicationRunListeners \u4f7f\u7528","text":"<p>\u901a\u8fc7getSpringFactoriesInstances \u83b7\u53d6\u5230\u6240\u6709\u5b9e\u73b0SpringApplicationRunListener  \u63a5\u53e3\u7684\u5b9e\u4f8b\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u8be5\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u53ea\u6709 EventPublishingRunListener  \u4ed6\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u4f5c\u4e3aspringboot \u7684\u4e00\u4e2a\u5e7f\u64ad\u5668</p> <pre><code>private SpringApplicationRunListeners getRunListeners(String[] args) {\n        Class&lt;?&gt;[] types = new Class&lt;?&gt;[] { SpringApplication.class, String[].class };\n        return new SpringApplicationRunListeners(logger, getSpringFactoriesInstances(\n                SpringApplicationRunListener.class, types, this, args));\n    }\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringBoot/SpringBoot-Arthas/","title":"SpringBoot Arthas","text":"<pre><code>\u5728\u9879\u76ee\u4e2d\u901a\u8fc7\u5f15\u5165 [arthas-spring-boot-starter](https://search.maven.org/search?q=arthas-spring-boot-starter)  \u8fdb\u884cJava\u8bca\u65ad\n</code></pre> <p>\u4f7f\u7528\u6b65\u9aa4 1. \u5728\u9879\u76ee\u7684pom.xml\u5f15\u5165</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.taobao.arthas&lt;/groupId&gt;\n    &lt;artifactId&gt;arthas-spring-boot-starter&lt;/artifactId&gt;\n    &lt;version&gt;${arthas.version}&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <ol> <li>\u914d\u7f6e\u8fde\u63a5\u4fe1\u606f 2.1 \u914d\u7f6earthas tunnel server\u5b9e\u73b0\u8fdc\u7a0b\u7ba1\u7406     \u901a\u8fc7Arthas Tunnel Server/Client \u6765\u8fdc\u7a0b\u7ba1\u7406/\u8fde\u63a5\u591a\u4e2aAgent\uff0c\u56e0\u6b64\u6211\u4eec\u9996\u5148\u8981\u5148\u5b89\u88c5Arthas Tunnel Server/Client\u3002     a\u3001\u4e0b\u8f7d\u90e8\u7f72arthas tunnel server      b\u3001\u542f\u52a8arthas-tunnel-server</li> </ol> <p><pre><code>java -jar  arthas-tunnel-server-3.5.4-fatjar.jar\n</code></pre>         c\u3001\u5728\u9879\u76ee\u7684yml\u505a\u5982\u4e0b\u914d\u7f6e</p> <p><pre><code>arthas:\n  agent-id: ${ARTHAS_AGENT_ID:hsehdfsfghhwertyfad}\n  app-name: ${spring.application.name}\n  tunnel-server: ${ARTHAS_TUNNEL_SERVER:ws://localhost:7777/ws}\n</code></pre> PS\uff1aagentId\u8981\u4fdd\u6301\u552f\u4e00\uff0c\u5426\u5219\u4f1a\u5728tunnel server\u4e0a\u51b2\u7a81\uff0c\u4e0d\u80fd\u6b63\u5e38\u5de5\u4f5c d\u3001\u6548\u679c\u6f14\u793a </p> <p>2.2 \u5728spring\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u914d\u7f6e</p> <p><pre><code>arthas:\n # \u901a\u8fc7http\u8bbf\u95ee\u7684\u7aef\u53e3\n  http-port: 8563\n  # \u901a\u8fc7telnet\u8bbf\u95ee\u7684\u7aef\u53e3\n  telnet-port: 3658\n  session-timeout: 1800\n  # \u7ed1\u5b9a\u7684ip\n  ip: 0.0.0.0\n</code></pre> PS\uff1a \u5982\u679c\u914d\u7f6e arthas.telnetPort\u4e3a -1 \uff0c\u5219\u4e0d\u76d1\u542c telnet\u7aef\u53e3\uff0c\u5982\u679c\u914d\u7f6e arthas.telnetPort\u4e3a 0 \uff0c\u5219\u968f\u673atelnet\u7aef\u53e3\u3002arthas.httpPort\u4e5f\u540c\u7406\u3002 \u6548\u679c\u6f14\u793a\uff1a  3. \u547d\u4ee4\u6587\u6863 </p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/Eureka/","title":"Eureka","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/Eureka/#eureka","title":"Eureka","text":"<p>\u5fae\u670d\u52a1\u6ce8\u518c\u53d1\u73b0\u4e2d\u5fc3</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/Eureka/#eureka_1","title":"Eureka\u6982\u5ff5","text":"<ul> <li>\u5fae\u670d\u52a1\u7cfb\u7edf\u4e2d\u7684\u5176\u4ed6\u670d\u52a1\u4f7f\u7528Eureka\u5ba2\u6237\u7aef\u5c06\u5176\u8fde\u63a5\u5230Eureka Service\u4e2d\uff0c\u5e76\u4e14\u7ef4\u6301\u5fc3\u8df3\uff0c\u53ef\u4ee5\u901a\u8fc7Eureka Service\u6765\u76d1\u63a7\u5404\u4e2a\u5fae\u670d\u52a1\u662f\u5426\u8fd0\u884c\u6b63\u5e38</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/Eureka/#eureka_2","title":"Eureka\u600e\u4e48\u5b9e\u73b0\u9ad8\u53ef\u7528","text":"<ul> <li>\u96c6\u7fa4\u90e8\u7f72\uff0c\u6ce8\u518c\u591a\u53f0\u4e92\u76f8\u6ce8\u518c</li> <li>\u96c6\u7fa4\u90e8\u7f72\u65f6\uff0c\u6ce8\u518c\u4e2d\u5fc3\u6536\u5230\u6ce8\u518c\u4fe1\u606f\u4f1a\u5224\u65ad\u662f\u5426\u662f\u5176\u4ed6\u6ce8\u518c\u4e2d\u5fc3\u540c\u6b65\u7684\u4fe1\u606f\uff0c\u5982\u679c\u662f\u5ba2\u6237\u7aef\u6ce8\u518c\uff0c\u90a3\u4e48\u4ed6\u5c06\u4f1a\u8be5\u5ba2\u6237\u7aef\u4fe1\u606f\u540c\u6b65\u5230\u5176\u4ed6\u6ce8\u518c\u4e2d\u5fc3\u53bb\uff0c\u5426\u5219\u6536\u5230\u4fe1\u606f\u4e0d\u4f5c\u4efb\u4f55\u64cd\u4f5c\uff08\u907f\u514d\u96c6\u7fa4\u4e2d\u4fe1\u606f\u540c\u6b65\u7684\u6b7b\u5faa\u73af\uff09</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/Eureka/#eureka_3","title":"Eureka\u6ce8\u518c\u6d41\u7a0b","text":"<ul> <li>\u5ba2\u6237\u7aef\u542f\u52a8\u540e\uff0c\u5b9a\u65f6\u5411Eureka\u670d\u52a1\u7aef\u6ce8\u518c\u81ea\u5df1\u7684\u670d\u52a1\u4fe1\u606f(\u670d\u52a1\u540d\u3001IP\u3001\u7aef\u53e3\u7b49)</li> <li>\u5ba2\u6237\u7aef\u542f\u52a8\u65f6\uff0c\u9996\u5148\u521b\u5efa\u4e00\u4e2a\u5fc3\u8df3\u7684\u5b9a\u65f6\u4efb\u52a1\uff0c\u5b9a\u65f6\u5411\u670d\u52a1\u7aef\u53d1\u9001\u5fc3\u8df3\u4fe1\u606f\uff0c\u670d\u52a1\u7aef\u5bf9\u5ba2\u6237\u7aef\u5fc3\u8df3\u4f5c\u51fa\u54cd\u5e94\uff0c\u5982\u679c\u54cd\u5e94\u72b6\u6001\u4e3a404\uff0c\u8868\u793a\u670d\u52a1\u7aef\u6ca1\u6709\u8be5\u5ba2\u6237\u7aef\u7684\u670d\u52a1\u4fe1\u606f\uff0c\u6b64\u65f6\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u53d1\u9001\u6ce8\u518c\u8bf7\u6c42</li> <li>\u670d\u52a1\u7aef\u4fdd\u5b58\u5ba2\u6237\u7aef\u4fe1\u606f\uff1a\u5ba2\u6237\u7aef\u901a\u8fc7Jersey\u6846\u67b6\uff08http\u6846\u67b6\uff09\u5c06\u670d\u52a1\u5b9e\u4f8b\u4fe1\u606f\u53d1\u9001\u5230\u670d\u52a1\u7aef\uff0c\u670d\u52a1\u7aef\u5c06\u5ba2\u6237\u7aef\u4fe1\u606f\u653e\u5728\u4e00\u4e2aConcurrentHashMap\u5bf9\u8c61\u4e2d</li> <li>\u5ba2\u6237\u7aef\u542f\u52a8\u540e\uff0c\u5b9a\u65f6\u62c9\u53bb\u670d\u52a1\u7aef\u5df2\u4fdd\u5b58\u7684\u670d\u52a1\u6ce8\u518c\u4fe1\u606f</li> <li>\u5ba2\u6237\u7aef\u62c9\u53d6\u670d\u52a1\u7aef\u670d\u52a1\u4fe1\u606f\u662f\u901a\u8fc7\u4e00\u4e2a\u5b9a\u65f6\u4efb\u52a1\u5b9a\u65f6\u62c9\u53d6\uff0c\u6bcf\u6b21\u62c9\u53d6\u540e\u5237\u65b0\u672c\u5730\u5df2\u4fdd\u5b58\u7684\u4fe1\u606f\uff0c\u9700\u8981\u65f6\u76f4\u63a5\u4ece\u672c\u5730\u83b7\u53d6</li> <li>\u62c9\u53d6\u670d\u52a1\u7aef\u4fdd\u5b58\u7684\u670d\u52a1\u6ce8\u518c\u4fe1\u606f\u540e\uff0c\u5c31\u53ef\u4ee5\u8c03\u7528\u6d88\u8d39\u5176\u4ed6\u670d\u52a1\u63d0\u4f9b\u8005\u63d0\u4f9b\u7684\u670d\u52a1</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/Eureka/#eureka_4","title":"Eureka\u5fc3\u8df3\u673a\u5236","text":"<p>\u5fc3\u8df3\u673a\u5236\uff1a <pre><code>\u5ba2\u6237\u7aef\u542f\u52a8\u540e\uff0c\u4f1a\u542f\u52a8\u4e00\u4e2a\u5b9a\u65f6\u4efb\u52a1\uff0c\u5b9a\u65f6\u5411\u670d\u52a1\u7aef\u53d1\u9001\u5fc3\u8df3\u6570\u636e\uff0c\u544a\u77e5\u670d\u52a1\u7aef\u81ea\u5df1\u8fd8\u5b58\u6d3b\uff0c\u9ed8\u8ba4\u5fc3\u8df3\u65f6\u95f4\u95f4\u9694\u662f30\u79d2\n</code></pre> \u670d\u52a1\u5254\u9664\u673a\u5236\uff1a <pre><code>1. \u5982\u679c\u5f00\u542f\u4e86\u81ea\u6211\u4fdd\u62a4\u673a\u5236\uff0c\u90a3\u4e48\u6240\u6709\u670d\u52a1\uff0c\u5305\u62ec\u5df2\u8fc7\u671f\u7684\u670d\u52a1\u90fd\u4e0d\u4f1a\u88ab\u5254\u9664\n2. \u5982\u679c\u672a\u5f00\u542f\u81ea\u6211\u4fdd\u62a4\u673a\u5236\uff0c\u90a3\u4e48\u5c06\u5224\u65ad\u6700\u540e\u4e00\u5206\u949f\u6536\u5230\u7684\u5fc3\u8df3\u6570\u4e0e\u4e00\u5206\u949f\u6536\u5230\u5fc3\u8df3\u6570\u4e34\u754c\u503c\u6bd4\u8f83\n3. \u4e00\u65e6\u670d\u52a1\u5254\u9664\u673a\u5236\u5f00\u542f\uff0c\u5219eureka\u670d\u52a1\u7aef\u4e0d\u56de\u76f4\u63a5\u5254\u9664\u6240\u6709\u5df2\u8fc7\u671f\u7684\u670d\u52a1\uff0c\u800c\u662f\u901a\u8fc7\u968f\u673a\u6570\u7684\u65b9\u5f0f\u8fdb\u884c\u5254\u9664\uff0c\u907f\u514d\u81ea\u6211\u4fdd\u62a4\u5f00\u542f\u4e4b\u524d\u5c06\u6240\u6709\u7684\u670d\u52a1\u7ed9\u5254\u9664\n</code></pre></p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/Eureka/#eurekazk","title":"Eureka\u548czk\u533a\u522b","text":"<ul> <li>zk\u8282\u70b9\u670d\u52a1\u6302\u4e86\u8981\u9009\u4e3e\uff0c\u9009\u4e3e\u671f\u95f4\u6ce8\u518c\u670d\u52a1\u762b\u75ea\u4e0d\u53ef\u7528\uff0c\u56e0\u4e3azk\u96c6\u7fa4\u5fc5\u987b\u6709\u4e00\u53f0\u4e3b\u5176\u4ed6\u90fd\u662f\u4ece</li> <li>eureka\u5404\u4e2a\u8282\u70b9\u5e73\u7b49\uff0c\u53ea\u8981\u6709\u4e00\u53f0eureka\u53ef\u7528\u5c31\u53ef\u4fdd\u8bc1\u670d\u52a1\u53ef\u7528\uff0c\u6570\u636e\u90fd\u662f\u6700\u65b0\u7684</li> <li>eureka\u672c\u8d28\u662f\u4e00\u4e2a\u5de5\u7a0b\uff0c\u800czk\u53ea\u662f\u4e00\u4e2a\u8fdb\u7a0b</li> <li>zk\u4fdd\u8bc1\u7684\u662fCP\uff08\u4e00\u81f4\u6027\u4e0e\u5206\u533a\u5bb9\u9519\u6027\uff09\uff0ceureka\u4fdd\u8bc1\u7684\u662fAP\uff08\u53ef\u7528\u6027\u4ee5\u53ca\u5206\u533a\u5bb9\u9519\u6027\uff09</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/Feign/","title":"Feign","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/Feign/#feign","title":"Feign","text":"<p>FeignClient</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/Feign/#feign_1","title":"\u4ec0\u4e48\u662fFeign","text":"<p>\u4e00\u4e2a\u58f0\u660e\u5f0f\u7684Web\u670d\u52a1\u5ba2\u6237\u7aef\uff0c\u7f16\u5199Web\u670d\u52a1\u5ba2\u6237\u7aef\u53ea\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u63a5\u53e3\uff0c\u7136\u540e\u6dfb\u52a0\u6ce8\u89e3\u5373\u53ef</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/Feign/#feign_2","title":"Feign\u7ec4\u4ef6\u8be6\u89e3","text":"<p>\u5982\u56fe\uff1a 1. contract\u5951\u7ea6\u7ec4\u4ef6    - feign\u4e2d\u901a\u8fc7\u5b9a\u4e49API\u63a5\u53e3\u65b9\u5f0f\u8c03\u7528\u8fdc\u7a0b\u7684Http API\uff0c\u8c03\u7528Client\u65f6\u5019\u589e\u52a0\u4e00\u4e9b\u6ce8\u89e3\u63cf\u8ff0\u8fd9\u4e2a\u8c03\u7528API\u7684\u57fa\u672c\u4fe1\u606f\uff0c\u5982\u8bf7\u6c42\u662fGET/POST 2. Encoder\u7f16\u7801\u7ec4\u4ef6    - \u5c06\u8bf7\u6c42\u4fe1\u606f\u91c7\u7528\u6307\u5b9a\u7684\u7f16\u7801\u65b9\u5f0f\u8fdb\u884c\u7f16\u7801\u540e\u4f20\u8f93 3. Decoder\u89e3\u7801\u7ec4\u4ef6    - \u5c06\u54cd\u5e94\u6570\u636e\u89e3\u7801\u6210\u5bf9\u8c61 4. Logger\u65e5\u5fd7\u8bb0\u5f55    - feign\u4e2d\u8bb0\u5f55\u65e5\u5fd7\uff0c\u53ef\u4ee5\u6307\u5b9aLogger\u7ea7\u522b\u4ee5\u53ca\u81ea\u5b9a\u4e49\u65e5\u5fd7\u8f93\u51fa 5. Client\u8bf7\u6c42\u6267\u884c\u7ec4\u4ef6    - \u8d1f\u8d23Http\u8bf7\u6c42\u6267\u884c\u7684\u7ec4\u4ef6\uff0c\u9ed8\u8ba4Client\u662f\u901a\u8fc7JDK\u7684HttpURLConnection\u53d1\u9001\u8bf7\u6c42\uff0c\u6bcf\u6b21\u53d1\u9001\u8bf7\u6c42\u90fd\u4f1a\u521b\u5efa\u65b0\u7684HttpURLConnection\uff0c\u6240\u4ee5feign\u7684\u6027\u80fd\u4f1a\u5f88\u5dee\u3002\u6240\u4ee5\u53ef\u4ee5\u6269\u5c55\u4f7f\u7528Apache HttpClient\u57fa\u4e8e\u8fde\u63a5\u6c60\u7684\u9ad8\u6027\u80fdHTTP\u5ba2\u6237\u7aef 6. Retryer\u91cd\u8bd5\u7ec4\u4ef6    - \u5185\u7f6e\u91cd\u8bd5\u5668\uff0cHTTP\u8bf7\u6c42\u51fa\u73b0IO\u5f02\u5e38\uff0c\u4f1a\u9650\u5b9a\u4e00\u4e2a\u6700\u5927\u91cd\u8bd5\u6b21\u6570\u6765\u8fdb\u884c\u91cd\u8bd5\u64cd\u4f5c 7. InvocationHandlerFactory\u4ee3\u7406    - \u91c7\u7528JDK\u7684\u52a8\u6001\u4ee3\u7406\u751f\u6210\u4ee3\u7406\u5bf9\u8c61 8. RequestInterceptor\u8bf7\u6c42\u62e6\u622a\u5668    - \u53ef\u4ee5\u4e3aFeign\u6dfb\u52a0\u591a\u4e2a\u62e6\u622a\u5668\uff0c\u8bf7\u6c42\u6267\u884c\u524d\u8bbe\u7f6e\u4e00\u4e9b\u6269\u5c55\u7684\u53c2\u6570\u4fe1\u606f 9. QueryMapEncoder\u53c2\u6570\u67e5\u8be2    - \u9488\u5bf9\u5b9e\u4f53\u7c7b\u53c2\u6570\u67e5\u8be2\u7684\u7f16\u7801\u5668 </p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/Hystrix/","title":"Hystrix","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/Hystrix/#hystrix","title":"Hystrix","text":"<p>\u65ad\u8def\u5668</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/Hystrix/#hystrix_1","title":"\u4ec0\u4e48\u662fHystrix","text":"<ul> <li>\u9632\u96ea\u5d29\u5229\u5668\uff0c\u5177\u6709\u670d\u52a1\u964d\u7ea7\u3001\u670d\u52a1\u7194\u65ad\u3001\u670d\u52a1\u9694\u79bb\u3001\u76d1\u63a7\u7b49\u4e00\u4e9b\u9632\u96ea\u5d29\u7684\u6280\u672f</li> <li>\u9632\u96ea\u5d29\u65b9\u5f0f</li> <li>\u670d\u52a1\u964d\u7ea7\uff1a\u63a5\u53e3\u8c03\u7528\u5931\u8d25\u5c31\u8c03\u7528\u672c\u5730\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u7a7a</li> <li>\u670d\u52a1\u7194\u65ad\uff1a\u63a5\u53e3\u8c03\u7528\u5931\u8d25\u8fdb\u5165\u8c03\u7528\u63a5\u53e3\u63d0\u524d\u5b9a\u4e49\u597d\u7684\u4e00\u4e2a\u7194\u65ad\u65b9\u6cd5\uff0c\u8fd4\u56de\u9519\u8bef\u4fe1\u606f</li> <li>\u670d\u52a1\u9694\u79bb\uff1a\u9694\u79bb\u670d\u52a1\u4e4b\u95f4\u76f8\u4e92\u5f71\u54cd</li> <li>\u670d\u52a1\u76d1\u63a7\uff1a\u670d\u52a1\u53d1\u751f\u8c03\u7528\u65f6\uff0c\u5c06\u6bcf\u79d2\u8bf7\u6c42\u6570\u3001\u6210\u529f\u8bf7\u6c42\u6570\u7b49\u8fd0\u884c\u6307\u6807\u8bb0\u5f55</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/Hystrix/#_1","title":"\u5982\u4f55\u9650\u6d41","text":"<ul> <li>\u9650\u6d41\u7b97\u6cd5\uff1a</li> <li>\u8ba1\u6570\u5668\uff1a\u63a7\u5236\u5355\u4f4d\u65f6\u95f4\u5185\u7684\u8bf7\u6c42\u6570\u91cf<ul> <li>\u52a3\u52bf\uff1a\u8bbe\u6bcf\u5206\u949f\u8bf7\u6c42\u6570\u91cf60\u4e2a\uff0c\u6bcf\u79d2\u5904\u74061\u4e2a\u8bf7\u6c42\uff0c\u7528\u6237\u5728 00:59 \u53d1\u9001 60 \u4e2a\u8bf7\u6c42\uff0c\u5728 01:00 \u53d1\u9001 60 \u4e2a\u8bf7\u6c42 \u6b64\u65f6 2 \u79d2\u949f\u6709 120 \u4e2a\u8bf7\u6c42(\u6bcf\u79d2 60 \u4e2a\u8bf7\u6c42)\uff0c\u8fdc\u8fdc\u5927\u4e8e\u4e86\u6bcf\u79d2\u949f\u5904\u7406\u6570\u91cf\u7684\u9608\u503c\u3002\uff08\u7a81\u523a\u73b0\u8c61\uff09</li> </ul> </li> <li>leaky bucket\uff08\u6f0f\u6876\uff09\uff1a\u89c4\u5b9a\u56fa\u5b9a\u5bb9\u91cf\u7684\u6876\uff0c\u8fdb\u5165\u7684\u6c34\u65e0\u6cd5\u7ba1\u63a7\u6570\u91cf\u3001\u901f\u5ea6\uff0c\u4f46\u662f\u5bf9\u4e8e\u6d41\u51fa\u7684\u6c34\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u901f\u5ea6<ul> <li>\u52a3\u52bf\uff1a\u65e0\u6cd5\u5e94\u5bf9\u77ed\u65f6\u95f4\u7a81\u53d1\u6d41\u91cf\uff08\u6876\u6ee1\u4e86\u5c31\u4e22\u5f03\uff09</li> </ul> </li> <li>Token bucket\u4ee4\u724c\u6876\uff1a\u53ef\u4ee5\u51c6\u5907\u4e00\u4e2a\u961f\u5217\uff0c\u7528\u6765\u4fdd\u5b58\u4ee4\u724c\uff0c\u53e6\u5916\u901a\u8fc7\u4e00\u4e2a\u7ebf\u7a0b\u6c60\u5b9a\u671f\u751f\u6210\u4ee4\u724c\u653e\u5230\u961f\u5217\u4e2d\uff0c\u6bcf\u6765\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5c31\u4ece\u961f\u5217\u4e2d\u83b7\u53d6\u4e00\u4e2a\u4ee4\u724c\uff0c\u5e76\u7ee7\u7eed\u6267\u884c\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/%E5%BE%AE%E6%9C%8D%E5%8A%A1SpringCloud/","title":"\u5fae\u670d\u52a1SpringCloud","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/%E5%BE%AE%E6%9C%8D%E5%8A%A1SpringCloud/#springcloud","title":"SpringCloud","text":"<p>\u5fae\u670d\u52a1\u67b6\u6784</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/%E5%BE%AE%E6%9C%8D%E5%8A%A1SpringCloud/#springcloud_1","title":"SpringCloud\u662f\u4ec0\u4e48\uff1f","text":"<ul> <li>\u6982\u5ff5\uff1a\u4e00\u7cfb\u5217\u6846\u67b6\u7684\u6709\u5e8f\u96c6\u5408\uff0c\u5229\u7528SpringBoot\u811a\u624b\u67b6\u7b80\u5316\u4e86\u5206\u5e03\u5f0f\u7cfb\u7edf\u57fa\u7840\u8bbe\u65bd\u7684\u5f00\u53d1\uff0c\u5982\uff1a\u670d\u52a1\u53d1\u73b0\u6ce8\u518c\u4e2d\u5fc3\u3001\u914d\u7f6e\u4e2d\u5fc3\u3001\u6d88\u606f\u603b\u7ebf\u3001\u8d1f\u8f7d\u5747\u8861\u3001\u6570\u636e\u76d1\u63a7\u7b49</li> <li>\u5c06\u6bd4\u8f83\u6210\u719f\u7684\u670d\u52a1\u6846\u67b6\u7ec4\u5408\uff0c\u901a\u8fc7SpringBoot\u98ce\u683c\u518d\u5c01\u88c5\u7b80\u5316\u914d\u7f6e\u548c\u5b9e\u73b0\u539f\u7406</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/%E5%BE%AE%E6%9C%8D%E5%8A%A1SpringCloud/#springcloud_2","title":"SpringCloud\u4f18\u7f3a\u70b9","text":"<p>\u4f18\u70b9\uff1a <pre><code>1. \u8026\u5408\u5ea6\u4f4e\n2. \u5e76\u884c\u5f00\u53d1\uff0c\u4e92\u4e0d\u5f71\u54cd\n3. \u914d\u7f6e\u7b80\u5355\u5316\uff0c\u6ce8\u89e3\u652f\u6301\n4. \u8de8\u5e73\u53f0\uff0c\u53ef\u4ee5\u4e0d\u540c\u6a21\u5757\u4f7f\u7528\u4e0d\u540c\u5f00\u53d1\u8bed\u8a00\n5. \u6570\u636e\u5e93\u72ec\u7acb\n6. \u524d\u540e\u7aef\u5206\u79bb\uff0c\u901a\u8fc7\u7ec4\u4ef6\u8fdb\u884c\u670d\u52a1\u901a\u4fe1\n7. \u652f\u6301\u5355\u6a21\u5757\u6a2a\u5411\u6269\u5bb9\uff0c\u9488\u5bf9\u6027\u63d0\u5347\u8bbf\u95ee\u6548\u7387\u4e0e\u8282\u7701\u6ca1\u5fc5\u8981\u7684\u8d44\u6e90\u6d6a\u8d39\n</code></pre> \u7f3a\u70b9\uff1a <pre><code>1. \u90e8\u7f72\u9ebb\u70e6\uff0c\u6a21\u5757\u591a\n2. \u9488\u5bf9\u6570\u636e\u7ba1\u7406\u9ebb\u70e6\uff0c\u56e0\u4e3a\u6570\u636e\u5e93\u8fdb\u884c\u62c6\u5206\u4e86\n3. \u6027\u80fd\u76d1\u63a7\u9ebb\u70e6\n</code></pre></p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/%E5%BE%AE%E6%9C%8D%E5%8A%A1SpringCloud/#spingcloudspringboot","title":"SpingCloud\u4e0eSpringBoot\u5bf9\u5e94\u5173\u7cfb","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/%E5%BE%AE%E6%9C%8D%E5%8A%A1SpringCloud/#springcloud_3","title":"SpringCloud\u90fd\u6709\u54ea\u4e9b\u7ec4\u4ef6","text":"<ul> <li>\u5f88\u591a\uff0c\u5e38\u7528\u7684<ul> <li>Eureka:\u670d\u52a1\u6ce8\u518c\u53d1\u73b0</li> <li>zuul:\u7f51\u5173</li> <li>feign\uff1aweb\u670d\u52a1\u5ba2\u6237\u7aef\uff0c\u8c03\u7528\u4f7f\u7528http</li> <li>hystrix:\u65ad\u8def\u5668\uff0c\u6709\u9650\u6d41\u7b97\u6cd5\uff08\u8ba1\u6570\u5668\u3001\u6f0f\u6876\u3001\u4ee4\u724c\u6876\uff09</li> <li>config:\u5206\u5e03\u5f0f\u7edf\u4e00\u914d\u7f6e\u7ba1\u7406</li> </ul> </li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/%E5%BE%AE%E6%9C%8D%E5%8A%A1SpringCloud/#springcloud_4","title":"SpringCloud\u4e0e\u4e00\u4e9b\u6846\u67b6\u7684\u533a\u522b","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/%E5%BE%AE%E6%9C%8D%E5%8A%A1SpringCloud/#springcloudspringboot","title":"SpringCloud\u548cSpringBoot\u533a\u522b","text":"<ul> <li>SpringBoot\u76f8\u5f53\u4e8e\u4e2a\u811a\u624b\u67b6\uff0cSpringCloud\u662f\u4f7f\u7528SpringBoot\u811a\u624b\u67b6\u5f00\u53d1\u7684\u591a\u4e2a\u7ec4\u4ef6\u7684\u670d\u52a1\u6846\u67b6</li> <li>SpringCloud\u5173\u6ce8\u5168\u5c40\u5fae\u670d\u52a1\u534f\u8c03\u6574\u7406\u6cbb\u7406\uff0c\u5c06SpringBoot\u5f00\u53d1\u7684\u4e00\u4e2a\u4e2a\u5355\u4f53\u670d\u52a1\u5408\u5e76\u7ba1\u7406</li> <li>SpringCloud\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u7ec4\u4ef6\uff0c\u5982\u670d\u52a1\u53d1\u73b0\u6ce8\u518c\u3001\u914d\u7f6e\u4e2d\u5fc3\u3001\u8def\u7531\u7f51\u5173\u3001\u6570\u636e\u76d1\u63a7\u7b49</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringCloud/%E5%BE%AE%E6%9C%8D%E5%8A%A1SpringCloud/#springclouddubbo","title":"SpringCloud\u548cDubbo\u533a\u522b","text":"<ul> <li>\u670d\u52a1\u8c03\u7528\u65b9\u5f0f\uff1aDuubo\u662fRPC\u8c03\u7528\uff0cSpringCloud\u662fRest api</li> <li>\u6ce8\u518c\u4e2d\u5fc3\uff1adubbo\u662fzookeeper\uff08\u4fdd\u8bc1CP\uff09\uff0cSpringCloud\u662feureka\uff08\u4fdd\u8bc1AP\uff09,\u4e5f\u53ef\u4ee5\u662fzk</li> <li>\u7f51\u5173\uff1adubbo\u672c\u8eab\u662f\u4e00\u4e2arpc\u6846\u67b6\uff0c\u5e76\u6ca1\u6709\u7f51\u5173\uff0cspringcloud\u6709zuul</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringFramework/","title":"SpringFramework","text":"<p>v5.2.5-REALEASE</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringFramework/#_1","title":"\u9605\u8bfb\u987a\u5e8f","text":"<ol> <li>\u6e90\u7801\u89e3\u6790\u4e4bApplicationContext,\u4ecb\u7ecdSpring\u4e0a\u4e0b\u6587\u521d\u59cb\u5316\u4e00\u4e9b\u91cd\u8981\u6b65\u9aa4</li> <li>\u6e90\u7801\u89e3\u6790\u4e4b@Component\u6ce8\u89e3\u7684\u626b\u63cf\uff0c\u5185\u5bb9\u662f@Component\u3001@Service\u7b49\u6ce8\u89e3\u7684\u626b\u63cf\u8fc7\u7a0b</li> <li>\u6e90\u7801\u89e3\u6790\u4e4b@Configuration\u6ce8\u89e3\u89e3\u6790\uff0c@Configuration\u3001@Bean\u3001@Scope\u3001@ComponentScan\u3001@Import</li> <li>\u6e90\u7801\u89e3\u6790\u4e4bbean\u7684\u521b\u5efa/\u9500\u6bc1\uff0c\u4ecb\u7ecdbean\u7684\u521b\u5efa\u8fc7\u7a0b\u548cbean\u7684\u751f\u547d\u5468\u671f\uff0cBeanPostProcessor\u3001Aware\u3001InitalizingBean\u8c03\u7528\u8fc7\u7a0b</li> <li>SpringAOP\u6e90\u7801\u89e3\u6790aop:aspectj-autoproxy\u6807\u7b7e\u89e3\u6790</li> <li>SpringAOP\u4ee3\u7406\u521b\u5efa\uff0cCGLIB/JDK\u52a8\u6001\u4ee3\u7406\u5206\u522b\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528</li> <li>Spring\u4e8b\u52a1\u6e90\u7801\u89e3\u6790\uff0c@Transactional\u6ce8\u89e3\u7684\u89e3\u6790\uff0c\u5982\u4f55\u5339\u914d\u5e94\u8be5\u6dfb\u52a0\u4e8b\u52a1\u7684\u63a5\u53e3\u548c\u65b9\u6cd5</li> <li>Spring\u4e8b\u52a1\u6267\u884c\u3001\u63d0\u4ea4\u3001\u56de\u6eda\u8fc7\u7a0b\u5206\u6790</li> <li>\u6e90\u7801\u89e3\u6790\u4e4b\u6574\u5408Mybatis</li> <li>SpringBoot\u542f\u52a8\u6d41\u7a0b\u89e3\u6790</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringFramework/%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E4%B9%8BApplicationContext/","title":"\u6e90\u7801\u89e3\u6790\u4e4bApplicationContext","text":"<p>\u4e3b\u5165\u53e3\uff1aApplicationContext applicationContext = new ClassPathXmlApplicationContext(\"spring-config.xml\");</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/SpringFramework/%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E4%B9%8BApplicationContext/#classpathxmlapplicationcontext","title":"ClassPathXmlApplicationContext","text":"<p>ClassPathXmlApplicationContext</p> <pre><code>public ClassPathXmlApplicationContext(String[] paths, Class&lt;?&gt; clazz, @Nullable ApplicationContext parent)\n            throws BeansException {\n\n        super(parent);\n        Assert.notNull(paths, \"Path array must not be null\");\n        Assert.notNull(clazz, \"Class argument must not be null\");\n        this.configResources = new Resource[paths.length];\n        for (int i = 0; i &lt; paths.length; i++) {\n            //\u8bbe\u7f6e\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\n            this.configResources[i] = new ClassPathResource(paths[i], clazz);\n        }\n        /**\n         * \u5237\u65b0\u73af\u5883\n         * \u91cd\u70b9,\u5fc5\u770b\n         */\n        refresh();\n    }\n</code></pre> <p>\u5237\u65b0\u73af\u5883\u65b9\u6cd5refresh</p> <pre><code>\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/","title":"Index","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/#dubbo","title":"DUBBO","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/Dubbo/","title":"\u5206\u5e03\u5f0f\u670d\u52a1\u6846\u67b6","text":"<p>dubbo\u5b98\u7f51</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/Dubbo/#dubbo","title":"dubbo\u7684\u539f\u7406","text":"<ol> <li> <p>\u5de5\u4f5c\u539f\u7406</p> </li> <li> <p>service\u5c42\uff1a\u63a5\u53e3\u5c42\uff0c\u7ed9\u670d\u52a1\u63d0\u4f9b\u8005\u548c\u6d88\u8d39\u8005\u6765\u5b9e\u73b0</p> </li> <li>config\u5c42\uff1a\u914d\u7f6e\u5c42\uff0c\u4e3b\u8981\u5bf9Dubbo\u8fdb\u884c\u5404\u79cd\u914d\u7f6e</li> <li>proxy\u5c42\uff1a\u670d\u52a1\u4ee3\u7406\u5c42\uff0cconsumer\uff0cprovider,dubbo\u90fd\u4f1a\u751f\u6210\u4ee3\u7406\uff0c\u4ee3\u7406\u4e4b\u95f4\u8fdb\u884c\u7f51\u7edc\u901a\u4fe1</li> <li>registry\u5c42\uff1a\u6ce8\u518c\u5c42\uff0c\u8d1f\u8d23\u670d\u52a1\u7684\u6ce8\u518c\u4e0e\u53d1\u73b0</li> <li>cluster\u5c42\uff1b\u96c6\u7fa4\u5c42\uff0c\u5c01\u88c5\u591a\u4e2a\u670d\u52a1\u63d0\u4f9b\u8005\u7684\u8def\u7531\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\uff0c\u591a\u4e2a\u5b9e\u4f8b\u7ec4\u5408\u6210\u4e00\u4e2a\u670d\u52a1</li> <li>monitor\u5c42\uff1a\u76d1\u63a7\u5c42\uff0c\u5bf9RPC\u63a5\u53e3\u7684\u8c03\u7528\u6b21\u6570\u548c\u8c03\u7528\u65f6\u95f4\u8fdb\u884c\u76d1\u63a7</li> <li>protocal\u5c42\uff1a\u8fdc\u7a0b\u8c03\u7528\u5c42\uff0c\u75af\u8f6cRPC\u8c03\u7528</li> <li>exchange\u5c42\uff1a\u4fe1\u606f\u4ea4\u6362\u5c42\uff0c\u5c01\u88c5\u8bf7\u6c42\u54cd\u5e94\u6a21\u5f0f\uff0c\u540c\u6b65\u8f6c\u5f02\u6b65</li> <li>transport\u5c42\uff1a\u7f51\u7edc\u4f20\u8f93\u5c42\uff0c\u5c01\u88c5mina\u548cnetty\u4e3a\u7edf\u4e00\u63a5\u53e3</li> <li> <p>serialize\u5c42\uff1a\u6570\u636e\u5e8f\u5217\u5316\u5c42</p> </li> <li> <p>\u5de5\u4f5c\u6d41\u7a0b</p> </li> <li> <p>provider\u5411\u6ce8\u518c\u4e2d\u5fc3\u53bb\u6ce8\u518c</p> </li> <li>consumer\u4ece\u6ce8\u518c\u4e2d\u5fc3\u8ba2\u9605\u670d\u52a1\uff0c\u6ce8\u518c\u4e2d\u5fc3\u901a\u77e5consumer\u6ce8\u518c\u597d\u7684\u670d\u52a1</li> <li>consumer\u8c03\u7528provider</li> <li> <p>consumer\u548cprovide\u90fd\u5f02\u6b65\u901a\u77e5\u76d1\u63a7\u4e2d\u5fc3</p> </li> <li> <p>\u6ce8\u518c\u4e2d\u5fc3\u6302\u4e86\u53ef\u4ee5\u7ee7\u7eed\u901a\u4fe1\u5417\uff1f</p> </li> </ol> <p>\u53ef\u4ee5\uff0c\u521d\u59cb\u5316\u65f6\uff0c\u6d88\u8d39\u8005\u4f1a\u5c06provide\u63d0\u4f9b\u7684\u5730\u5740\u7b49\u4fe1\u606f\u62c9\u53d6\u5230\u672c\u5730\uff0c\u6240\u4ee5\u6ce8\u518c\u4e2d\u5fc3\u6302\u4e86\u4ecd\u7136\u53ef\u4ee5\u7ee7\u7eed\u901a\u4fe1</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/","title":"\u5206\u5e03\u5f0f\u670d\u52a1\u6846\u67b6Dubbo","text":""},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#dubbo_1","title":"Dubbo\u539f\u7406","text":"<p>\u5206\u5e03\u5f0f\u670d\u52a1\u6846\u67b6</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#dubbo_2","title":"Dubbo\u652f\u6301\u54ea\u4e9b\u5e8f\u5217\u5316\u534f\u8bae","text":"<ol> <li>Dubbo\u652f\u6301\u54ea\u4e9b\u901a\u4fe1\u534f\u8bae<ul> <li>dubbo://\u534f\u8bae<ul> <li>\u9ed8\u8ba4\u534f\u8bae\uff0c\u5355\u4e00\u957f\u8fde\u63a5\uff0c\u8fdb\u884c\u7684NIO\u5f02\u6b65\u901a\u4fe1\uff0c\u57fa\u4e8ehessian\u4f5c\u4e3a\u5e8f\u5217\u5316\u534f\u8bae</li> <li>\u7279\u6027\uff0c\u4f20\u8f93\u6570\u636e\u91cf\u5c0f(\u6bcf\u6b21100k\u4ee5\u4e0b)\uff1b\u5e76\u53d1\u91cf\u9ad8\uff0c\u9002\u7528\u591a\u4e2a\u6d88\u8d39\u8005\u7684\u60c5\u51b5</li> </ul> </li> <li>rmi://\u534f\u8bae<ul> <li>\u91c7\u7528JDK\u6807\u51c6\u7684Java.rmi.*\u5b9e\u73b0</li> <li>\u7279\u6027\uff0c\u591a\u4e2a\u77ed\u94fe\u63a5\uff0c\u9002\u5408\u6d88\u8d39\u8005\u548c\u63d0\u4f9b\u8005\u5dee\u4e0d\u591a\u7684\u60c5\u51b5\uff0c\u9002\u7528\u6587\u4ef6\u4f20\u8f93</li> </ul> </li> <li>hessian://\u534f\u8bae<ul> <li>http\u901a\u4fe1\uff0c\u91c7\u7528servlet\u66b4\u9732\u670d\u52a1\uff0c\u57fa\u4e8ehessian\u5e8f\u5217\u5316\u534f\u8bae</li> <li>\u591a\u4e2a\u77ed\u94fe\u63a5\uff0c\u9002\u7528\u4e8e\u63d0\u4f9b\u8005\u6570\u91cf\u591a\u7684\u60c5\u51b5\uff0c\u9002\u7528\u6587\u4ef6\u4f20\u8f93</li> </ul> </li> <li>http://\u534f\u8bae<ul> <li>\u57fa\u4e8ehttp\u8868\u5355\u7684\u8fdc\u7a0b\u901a\u7528\u534f\u8bae\uff0c\u8d70\u5355\u8868\u5e8f\u5217\u5316</li> </ul> </li> <li>thrift://\u534f\u8bae<ul> <li>\u5728\u539f\u751f\u534f\u8bae\u7684\u57fa\u7840\u4e0a\u6dfb\u52a0\u4e86\u4e00\u4e9b\u989d\u5916\u7684\u5934\u4fe1\u606f\uff0c\u5982service name\uff0cmagic number\u7b49</li> </ul> </li> <li>webservice://\u534f\u8bae<ul> <li>\u57fa\u4e8eapache cxf\u7684fronted-simple\u548ctransports-http\u5b9e\u73b0\uff0cSOA\u6587\u672c\u5e8f\u5217\u5316</li> </ul> </li> <li>memcached://\u534f\u8bae<ul> <li>RPC\u534f\u8bae</li> </ul> </li> <li>redis://\u534f\u8bae<ul> <li>RPC\u534f\u8bae</li> </ul> </li> <li>rest://\u534f\u8bae<ul> <li>\u5b9e\u73b0REST\u8c03\u7528\u652f\u6301</li> </ul> </li> <li>grpc://\u534f\u8bae<ul> <li>\u9002\u7528HTTP/2\u901a\u4fe1\uff0c\u60f3\u5229\u7528Stream\u3001\u53cd\u538b\u3001Reactive\u53d8\u6210\u80fd\u529b\u7684\u5f00\u53d1\u8005\u9002\u7528</li> </ul> </li> </ul> </li> <li>\u652f\u6301\u7684\u5e8f\u5217\u5316\u534f\u8bae</li> </ol> <p>\u652f\u6301hessian\uff0cjava\u4e8c\u8fdb\u5236\u5e8f\u5217\u5316\uff0cSOAP\u6587\u672c\u5e8f\u5217\u5316\uff0cjson\u591a\u79cd\u5e8f\u5217\u5316\u534f\u8bae</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#dubbo_3","title":"Dubbo\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u548c\u96c6\u7fa4\u5bb9\u9519\u7b56\u7565","text":"<p>4\u4e2d\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c6\u79cd\u96c6\u7fa4\u5bb9\u9519\u7b56\u7565</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#dubbo_4","title":"Dubbo\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565","text":"<ol> <li>RandomLoadBalance\uff0c\u9ed8\u8ba4\u7b56\u7565\uff0c\u968f\u673a\u8c03\u7528\uff1b\u53ef\u4ee5\u5bf9provider\u8bbe\u7f6e\u4e0d\u540c\u7684\u6743\u91cd\uff0c\u6309\u7167\u6743\u91cd\u6765\u8d1f\u8f7d\u5747\u8861\u3002</li> </ol> <p>\u7b97\u6cd5\u601d\u60f3\uff1a\u5047\u8bbe\u6709\u4e00\u7ec4\u670d\u52a1\u5668servers=[A,B,C],\u5bf9\u5e94\u6743\u91cd\u4e3aweights=[5,3,2],\u603b\u548c\u4e3a10.\u628a\u6743\u91cd\u5e73\u94fa\u5728\u4e00\u7eac\u5750\u6807\u503c\u4e0a\uff0c\u5219[0,5]\u670d\u52a1\u5668A,[5,8]\u670d\u52a1\u5668B,[8,10]    \u5c5e\u4e8e\u670d\u52a1\u5668C.\u968f\u673a\u6570\u751f\u6210\u5668\u751f\u6210\u4e00\u4e2a\u8303\u56f4\u5728[0,10]\u4e4b\u95f4\u7684\u968f\u673a\u6570\uff0c\u7136\u540e\u8ba1\u7b97\u4f1a\u843d\u5728\u54ea\u4e2a\u533a\u95f4\u7684\u670d\u52a1\u5668\uff0c\u5750\u6807\u8f74\u4e0a\u533a\u95f4\u8303\u56f4\u5927\u7684\uff0c\u968f\u673a\u6570\u751f\u6210\u7684\u6570\u5b57\u5c31\u6709\u66f4\u5927\u6982\u7387\u843d\u5230\u6b64\u533a\u95f4</p> <ol> <li>RoundRobinLoadBalance\uff0c\u5747\u5300\u5206\u53d1</li> </ol> <p>\u7b97\u6cd5\u601d\u60f3\uff1a\u5747\u5300\u5730\u5c06\u6d41\u91cf\u6253\u5230\u5404\u4e2a\u673a\u5668\u4e0a\uff0c\u4f46\u662f\u5982\u679c\u5404\u4e2a\u673a\u5668\u6027\u80fd\u4e0d\u540c\uff0c\u5bb9\u6613\u5bfc\u81f4\u6027\u80fd\u5dee\u7684\u673a\u5668\u8d1f\u8f7d\u8fc7\u9ad8\u3002\u6240\u4ee5\u9700\u8981\u8c03\u6574\u6743\u91cd\uff0c\u8ba9\u6027\u80fd\u5dee\u7684\u673a\u5668\u627f\u8f7d\u6743\u91cd\u5c0f\u4e00\u4e9b\uff0c\u6d41\u91cf\u5c11\u4e00\u4e9b 3. LeastActiveLoadBalance\uff0c\u6700\u5c0f\u6d3b\u8dc3\u6570\u8d1f\u8f7d\u5747\u8861\uff0c\u6d3b\u8dc3\u8c03\u7528\u6570\u8d8a\u5c0f\uff0c\u8868\u660e\u8be5\u670d\u52a1\u63d0\u4f9b\u8005\u6548\u7387\u8d8a\u9ad8\uff0c\u5355\u4f4d\u65f6\u95f4\u5185\u53ef\u5904\u7406\u66f4\u591a\u8bf7\u6c42\uff0c\u6b64\u65f6\u8bf7\u6c42\u4f1a\u4f18\u5148\u5206\u914d\u7ed9\u8be5\u670d\u52a1\u63d0\u4f9b\u8005</p> <p>\u7b97\u6cd5\u601d\u60f3\uff1a\u6bcf\u4e2aprovider\u5bf9\u5e94\u4e00\u4e2a\u6d3b\u8dc3\u6570active\u3002\u521d\u8bc6\u60c5\u51b5\uff0cprovider\u7684active\u5747\u4e3a0.\u6bcf\u6536\u5230\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5bf9\u5e94\u7684provider\u7684active\u4f1a\u52a01\uff0c\u5904\u7406\u5b8c\u8bf7\u6c42\u540e\uff0cactive\u4f1a\u51cf1.\u6240\u4ee5\uff0c\u5982\u679cprovider\u6027\u80fd\u597d\uff0c\u5904\u7406\u8bf7\u6c42\u7684\u6548\u7387\u5c31\u8d8a\u9ad8\uff0cactive\u4e0b\u964d\u7684\u8d8a\u5feb\u3002\u4e5f\u5f15\u5165\u4e86\u6743\u91cd\u503c\uff0c\u6240\u4ee5\u6b64\u7b97\u6cd5\u662f\u57fa\u4e8e\u52a0\u6743\u6700\u5c0f\u6d3b\u8dc3\u6570\u7b97\u6cd5\u5b9e\u73b0 4. ConsistenHashLoadBalance\uff0c\u4e00\u81f4\u6027hash</p> <p>\u7b97\u6cd5\u601d\u60f3\uff1a\u4e00\u81f4\u6027Hash\u7b97\u6cd5\uff0c\u76f8\u540c\u53c2\u6570\u8bf7\u6c42\u4e00\u5b9a\u5206\u53d1\u5230\u4e00\u4e2aprovider\u53bb\u3002\u5982\u679c\u9700\u8981\u7684\u4e0d\u662f\u968f\u673a\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c\u8981\u4e00\u7c7b\u8bf7\u6c42\u90fd\u5230\u4e00\u4e2a\u8282\u70b9\uff0c\u90a3\u5c31\u8d70\u4e00\u81f4\u6027Hash\u7b56\u7565</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#_1","title":"\u96c6\u7fa4\u5bb9\u9519\u7b56\u7565","text":"<ol> <li>Failover Cluster\u6a21\u5f0f\uff0c\u9ed8\u8ba4\u8fd9\u4e2a\uff0c\u5931\u8d25\u81ea\u52a8\u5207\u6362\uff0c\u81ea\u52a8\u91cd\u8bd5\u5176\u5b83\u673a\u5668\uff0c\u5e38\u89c1\u4e8e\u8bfb\u64cd\u4f5c</li> <li>Failfast Cluster\u6a21\u5f0f\uff0c\u4e00\u6b21\u8c03\u7528\u5931\u8d25\u5c31\u7acb\u5373\u5931\u8d25\uff0c\u5e38\u89c1\u5e42\u7b49\u6027\u7684\u5199\u64cd\u4f5c\uff0c\u5982\u65b0\u589e\u4e00\u6761\u8bb0\u5f55</li> <li>Failsafe Cluster\u6a21\u5f0f\uff0c\u51fa\u73b0\u5f02\u5e38\u65f6\u5ffd\u7565\uff0c\u7528\u4e8e\u4e0d\u91cd\u8981\u7684\u63a5\u53e3\u8c03\u7528\uff0c\u5982\u8bb0\u5f55\u65e5\u5fd7</li> <li>Failback Cluster\u6a21\u5f0f\uff0c\u5931\u8d25\u4e86\u540e\u53f0\u81ea\u52a8\u8bb0\u5f55\u8bf7\u6c42\uff0c\u7136\u540e\u5b9a\u65f6\u91cd\u53d1\uff0c\u9002\u5408\u5199\u6d88\u606f\u961f\u5217\u5931\u8d25</li> <li>Forking Cluster\u6a21\u5f0f\uff0c\u5e76\u884c\u8c03\u7528\u591a\u4e2aprovider\uff0c\u53ea\u8981\u4e00\u4e2a\u6210\u529f\u5c31\u7acb\u5373\u8fd4\u56de\u3002\u7528\u4e8e\u5b9e\u65f6\u6027\u8981\u6c42\u8f83\u9ad8\u7684\u8bfb\u64cd\u4f5c\uff0c\u4f46\u662f\u4f1a\u6d6a\u8d39\u66f4\u591a\u670d\u52a1\u8d44\u6e90</li> <li>Broadcast Cluster\u6a21\u5f0f\uff0c\u9010\u4e2a\u8c03\u7528\u6240\u6709\u7684provider,\u4efb\u4f55\u4e00\u4e2a\u51fa\u9519\u5219\u62a5\u9519\u3002\u7528\u4e8e\u901a\u77e5\u6240\u6709\u63d0\u4f9b\u8005\u66f4\u65b0\u7f13\u5b58\u6216\u65e5\u5fd7\u7b49\u672c\u5730\u8d44\u6e90\u4fe1\u606f</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#dubbospi","title":"Dubbo\u7684SPI\u601d\u60f3","text":"<p>service provider interface</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#spi","title":"spi\u6982\u5ff5","text":"<p>\u4e00\u4e2a\u63a5\u53e3\uff0c\u6709\u4e09\u4e2a\u5b9e\u73b0\u7c7b\uff0c\u5728\u7cfb\u7edf\u8fd0\u884c\u65f6\u8fd9\u4e2a\u63a5\u53e3\u8be5\u9009\u62e9\u54ea\u4e2a\u5b9e\u73b0\u7c7b\uff1f\u5c31\u9700\u8981\u6839\u636e\u6307\u5b9a\u7684\u914d\u7f6e\u6216\u8005\u662f\u9ed8\u8ba4\u7684\u914d\u7f6e\uff0c\u627e\u5bf9\u5e94\u7684\u5b9e\u73b0\u7c7b\u52a0\u8f7d\u8fdb\u6765\uff0c\u7528\u8fd9\u4e2a\u5b9e\u73b0\u7c7b\u7684\u5b9e\u4f8b\u5bf9\u8c61\u3002\u63d2\u4ef6\u6269\u5c55\u7684\u573a\u666f</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#java-spi","title":"java spi\u601d\u60f3\u7684\u4f53\u73b0","text":"<p>\u7ecf\u5178\u601d\u60f3JDBC\u3002java\u5b9a\u4e49\u4e86\u4e00\u5957jdbc\u7684\u63a5\u53e3\uff0c\u5e76\u6ca1\u6709\u63d0\u4f9bjdbc\u7684\u5b9e\u73b0\u7c7b\uff0c\u6240\u4ee5\u53ef\u4ee5\u4f7f\u7528mysql-jdbc-connector.jar\u5f15\u5165\u6216\u8005oracle-jdbc-connector.jar</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#dubbospi_1","title":"dubbo\u7684spi\u601d\u60f3","text":"<p>Protocol \u63a5\u53e3\uff0c\u5728\u7cfb\u7edf\u8fd0\u884c\u7684\u65f6\u5019\uff0c\uff0cdubbo \u4f1a\u5224\u65ad\u4e00\u4e0b\u5e94\u8be5\u9009\u7528\u8fd9\u4e2a Protocol \u63a5\u53e3\u7684\u54ea\u4e2a\u5b9e\u73b0\u7c7b\u6765\u5b9e\u4f8b\u5316\u5bf9\u8c61\u6765\u4f7f\u7528\uff0c\u5b83\u4f1a\u53bb\u627e\u4e00\u4e2a\u4f60\u914d\u7f6e\u7684 Protocol\uff0c\u5c06\u4f60\u914d\u7f6e\u7684 Protocol \u5b9e\u73b0\u7c7b\uff0c\u52a0\u8f7d\u5230 jvm \u4e2d\u6765\uff0c\u7136\u540e\u5b9e\u4f8b\u5316\u5bf9\u8c61\uff0c\u5c31\u7528\u4f60\u7684\u90a3\u4e2a Protocol \u5b9e\u73b0\u7c7b\u5c31\u53ef\u4ee5\u4e86</p> <pre><code>Protocol protocol=ExtensionLoader.getExtensionLoader(Protocol.class).getAdaptiveExtension();\n</code></pre> <p>dubbo=com.alibaba.dubbo.rpc.protocol.dubbo.DubboProtocol http=com.alibaba.dubbo.rpc.protocol.http.HttpProtocol hessian=com.alibaba.dubbo.rpc.protocol.hessian.HessianProtocol</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#dubbo_5","title":"\u57fa\u4e8eDubbo\u7684\u670d\u52a1\u6cbb\u7406","text":"<p>\u670d\u52a1\u6cbb\u7406\uff1a\u8c03\u7528\u94fe\u8def\u81ea\u52a8\u751f\u6210\uff1b\u670d\u52a1\u8bbf\u95ee\u538b\u529b\u4ee5\u53ca\u65f6\u957f\u7edf\u8ba1</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#_2","title":"\u670d\u52a1\u964d\u7ea7","text":"<p>\u63a5\u53e3+Mock\u540e\u7f00\uff0c\u5982\uff1a</p> <pre><code>&lt;dubbo:service interface=\"com.zhss.service.HelloService\" ref=\"helloServiceImpl\" timeout=\"10000\"/&gt;&lt;bean\nid=\"helloServiceImpl\" class=\"com.zhss.service.HelloServiceImpl\"/&gt;\n</code></pre> <p>\u964d\u7ea7\u903b\u8f91 public class HelloServiceMock implements HelloService { public void sayHello() { // \u964d\u7ea7\u903b\u8f91 }}</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#_3","title":"\u5931\u8d25\u91cd\u8bd5/\u8d85\u65f6\u91cd\u8bd5","text":"<pre><code>&lt;dubbo:reference id=\"xxxx\" interface=\"xx\" check=\"true\" async=\"false\" retries=\"3\" timeout=\"2000\"/&gt;\n</code></pre> <p>timeOut:\u4e00\u822c\u8bbe\u7f6e\u4e3a200ms\uff0cretries:\u8bbe\u7f6e\u91cd\u8bd5\u6b21\u6570</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#_4","title":"\u5206\u5e03\u5f0f\u670d\u52a1\u7684\u5e42\u7b49\u6027\u5982\u4f55\u8bbe\u8ba1","text":"<p>\u573a\u666f\uff1a\u5047\u5982\u6709\u4e2a\u670d\u52a1\u90e8\u7f72\u57285\u53f0\u673a\u5668\u4e0a\uff0c\u6709\u4e2a\u63a5\u53e3\u662f\u4ed8\u6b3e\u63a5\u53e3\uff0c\u7528\u6237\u5728\u524d\u7aef\u64cd\u4f5c\uff0c\u4e00\u4e2a\u8ba2\u5355\u4e0d\u5c0f\u5fc3\u53d1\u8d77\u4e86\u4e24\u6b21\u652f\u4ed8\u8bf7\u6c42\uff0c\u7136\u540e\u5206\u6563\u5728\u4e86\u8fd9\u4e2a\u670d\u52a1\u90e8\u7f72\u7684\u4e0d\u540c\u673a\u5668\u4e0a</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#_5","title":"\u5982\u4f55\u4fdd\u8bc1\u5e42\u7b49\u6027\uff1f","text":"<ul> <li>\u5bf9\u4e8e\u6bcf\u4e2a\u8bf7\u6c42\u5fc5\u987b\u6709\u4e00\u4e2a\u552f\u4e00\u7684\u6807\u8bc6\uff0c\u5982\uff1a\u8ba2\u5355\u652f\u4ed8\u8bf7\u6c42\uff0c\u8ba2\u5355id\u9700\u8981\u552f\u4e00</li> <li>\u6bcf\u6b21\u5904\u7406\u5b8c\u8bf7\u6c42\u540e\uff0c\u5fc5\u987b\u6709\u4e00\u4e2a\u8bb0\u5f55\u6807\u8bc6\u8fd9\u4e2a\u8bf7\u6c42\u5904\u7406\u8fc7\u4e86\uff0c\u5982\u5728mysql\u4e2d\u8bb0\u5f55\u4e2a\u72b6\u6001</li> <li>\u6bcf\u6b21\u63a5\u6536\u8bf7\u6c42\u9700\u8981\u8fdb\u884c\u5224\u65ad\uff0c\u5224\u65ad\u4e4b\u524d\u662f\u5426\u5904\u7406\u8fc7\u3002\u552f\u4e00\u952e\u7ea6\u675f</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#_6","title":"\u5206\u5e03\u5f0f\u670d\u52a1\u63a5\u53e3\u8bf7\u6c42\u987a\u5e8f\u5982\u4f55\u4fdd\u8bc1","text":"<p>\u573a\u666f\uff1a\u670d\u52a1A\u8c03\u7528\u670d\u52a1B\uff0c\u5148\u63d2\u5165\u518d\u5220\u9664\u3002\u7ed3\u679c\u4fe9\u8bf7\u6c42\u8fc7\u53bb\uff0c\u843d\u5728\u4e0d\u540c\u673a\u5668\u4e0a\uff0c\u53ef\u80fd\u56e0\u4e3a\u63d2\u5165\u8bf7\u6c42\u56e0\u4e3a\u67d0\u4e9b\u539f\u56e0\u6267\u884c\u6162\u4e86\uff0c\u5bfc\u81f4\u5220\u9664\u8bf7\u6c42\u5148\u6267\u884c\u4e86</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#_7","title":"\u5982\u4f55\u4fdd\u8bc1\u987a\u5e8f","text":"<ul> <li>\u5c3d\u91cf\u5408\u5e76\u6210\u4e00\u4e2a\u64cd\u4f5c\uff0c\u907f\u514d\u6b64\u95ee\u9898\u4ea7\u751f</li> <li>\u53ef\u4ee5\u4f7f\u7528Dubbo\u7684\u4e00\u81f4\u6027hash\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c\u5c06\u6bd4\u5982\u67d0\u4e00\u4e2a\u8ba2\u5355id\u5bf9\u5e94\u7684\u8bf7\u6c42\u90fd\u5206\u53d1\u5230\u67d0\u4e2a\u673a\u5668\u4e0a\uff0c\u7136\u540e\u53ef\u4ee5\u5c06\u67d0\u4e2a\u8ba2\u5355id\u5bf9\u5e94\u7684\u8bf7\u6c42\u653e\u5230\u4e00\u4e2a\u5185\u5b58\u961f\u5217\u4e2d\uff0c\u5f3a\u5236\u6392\u961f\uff0c\u6765\u786e\u4fdd\u987a\u5e8f\u6027</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#dubborpc","title":"\u81ea\u5df1\u8bbe\u8ba1\u4e00\u4e2a\u7c7b\u4f3cDubbo\u7684RPC\u6846\u67b6","text":"<ol> <li>\u6ce8\u518c\u4e2d\u5fc3\u670d\u52a1\u6ce8\u518c\uff0c\u53ef\u4ee5\u7528zk</li> <li>\u6d88\u8d39\u8005\u9700\u8981\u53bb\u6ce8\u518c\u4e2d\u5fc3\u62ff\u5bf9\u5e94\u670d\u52a1\u4fe1\u606f\uff0c\u800c\u4e14\u6bcf\u4e2a\u670d\u52a1\u53ef\u80fd\u5b58\u5728\u4e8e\u591a\u53f0\u673a\u5668\u4e0a</li> <li>\u53d1\u8d77\u4e00\u6b21\u8bf7\u6c42\uff0c\u57fa\u4e8e\u52a8\u6001\u4ee3\u7406\uff0c\u9762\u5411\u63a5\u53e3\u83b7\u53d6\u5230\u4e00\u4e2a\u52a8\u6001\u4ee3\u7406\uff0c\u7136\u540e\u8fd9\u4e2a\u4ee3\u7406\u627e\u5230\u670d\u52a1\u5bf9\u5e94\u7684\u673a\u5668\u5730\u5740</li> <li>\u4f7f\u7528\u7b80\u5355\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u786e\u5b9a\u5411\u54ea\u4e2a\u673a\u5668\u53d1\u9001\u8bf7\u6c42</li> <li>\u4f7f\u7528netty,nio\u65b9\u5f0f\uff0c\u4f7f\u7528hessian\u5e8f\u5217\u5316\u534f\u8bae</li> <li>\u670d\u52a1\u5668\u4fa7\uff0c\u9488\u5bf9\u81ea\u5df1\u7684\u670d\u52a1\u751f\u6210\u4e00\u4e2a\u52a8\u6001\u4ee3\u7406\uff0c\u76d1\u542c\u67d0\u4e2a\u7f51\u7edc\u7aef\u53e3</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#cap","title":"CAP\u7406\u8bba","text":"<p>CAP\uff0cConsistency\u4e00\u81f4\u6027\uff0cAvailability\u53ef\u7528\u6027\uff0cPartition tolerance\u5206\u533a\u5bb9\u9519\u6027</p> <ul> <li>C:\u6240\u6709\u8282\u70b9\u8bbf\u95ee\u540c\u4e00\u4efd\u6700\u65b0\u7684\u6570\u636e\u526f\u672c</li> <li>A:\u6bcf\u6b21\u8bf7\u6c42\u90fd\u80fd\u83b7\u53d6\u5230\u6b63\u5e38\u54cd\u5e94\uff0c\u4e0d\u4fdd\u8bc1\u83b7\u53d6\u7684\u6570\u636e\u4e3a\u6700\u65b0\u6570\u636e</li> <li>P:\u5206\u533a\u76f8\u5f53\u4e8e\u5bf9\u901a\u4fe1\u7684\u65f6\u9650\u8981\u6c42\u3002\u7cfb\u7edf\u4e0d\u80fd\u5728\u65f6\u9650\u5185\u8fbe\u6210\u6570\u636e\u4e00\u81f4\u6027\uff0c\u5c31\u610f\u5473\u7740\u53d1\u751f\u4e86\u5206\u533a\u7684\u60c5\u51b5\uff0c\u5fc5\u987b\u5c31\u5f53\u524d\u64cd\u4f5c\u5728C\u548cA\u4e4b\u95f4\u505a\u51fa\u9009\u62e9</li> </ul> <p>\u5e38\u7528\u7684CAP\u6846\u67b6</p> <ol> <li>eureka(AP)\uff1a\u4fdd\u8bc1\u53ef\u7528\uff0c\u5b9e\u73b0\u6700\u7ec8\u4e00\u81f4\u6027\u3002\u4f7f\u7528\u5185\u7f6e\u8f6e\u8be2\u8d1f\u8f7d\u5747\u8861\u5668\u53bb\u6ce8\u518c\uff0c\u6709\u4e00\u4e2a\u68c0\u6d4b\u95f4\u9694\u65f6\u95f4\uff0c\u5982\u679c\u5728\u4e00\u5b9a\u65f6\u95f4\u6ca1\u6709\u6536\u5230\u5fc3\u8df3\uff0c\u624d\u4f1a\u79fb\u9664\u8be5\u8282\u70b9\u6ce8\u518c\u4fe1\u606f\u3002eurekaAP\u7684\u7279\u6027\u548c\u8bf7\u6c42\u95f4\u9694\u540c\u6b65\u673a\u5236</li> <li>zookeeper(CP)\uff1a\u5f3a\u4e00\u81f4\u6027\u3002\u5728\u9009\u4e3eleader\u65f6\u4f1a\u505c\u6b62\u670d\u52a1\uff0c\u53ea\u6709\u6210\u529f\u9009\u4e3e\u540e\u624d\u80fd\u63d0\u4f9b\u670d\u52a1</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#_8","title":"\u5206\u5e03\u5f0f\u4e8b\u52a1","text":"<p>\u8fd9\u91cc\u5217\u4e3e\u4e94\u79cd\u4e8b\u52a1\u65b9\u6848\uff0c\u5177\u4f53\u5f97\u770b\u672c\u8eab\u4e1a\u52a1</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#xa","title":"\u4e24\u9636\u6bb5\u63d0\u4ea4\u65b9\u6848/XA\u65b9\u6848","text":"<p>\u6709\u4e00\u4e2a\u4e8b\u52a1\u7ba1\u7406\u5668\uff0c\u8d1f\u8d23\u534f\u8c03\u591a\u4e2a\u6570\u636e\u5e93\u7684\u4e8b\u52a1\uff0c\u4e8b\u52a1\u7ba1\u7406\u5668\u5148\u95ee\u5404\u4e2a\u6570\u636e\u5e93\u4f60\u51c6\u5907\u597d\u4e86\u5417\uff1f\u5982\u679c\u90fd\u56de\u590dok\uff0c\u5c31\u6b63\u5f0f\u63d0\u4ea4\u4e8b\u52a1\uff0c\u5728\u5404\u4e2a\u6570\u636e\u5e93\u4e0a\u6267\u884c\u64cd\u4f5c\uff1b\u5982\u679c\u4efb\u4f55\u5176\u4e2d\u4e00\u4e2a\u6570\u636e\u5e93\u56de\u7b54\u4e0dok\uff0c\u90a3\u4e48\u5c31\u56de\u6eda </p> <ul> <li>\u573a\u666f\u5e94\u7528\uff1a\u5e38\u89c1\u5355\u5e94\u7528\u5b9e\u4f8b\u5185\u8de8\u591a\u4e2a\u5e93\u7684\u5206\u5e03\u5f0f\u573a\u666f</li> </ul> <p>\uff08\u7f3a\u70b9\u662f\u4e25\u91cd\u4f9d\u8d56\u6570\u636e\u5e93\u5c42\u9762\u6765\u641e\u5b9a\u590d\u6742\u7684\u4e8b\u52a1\uff0c\u6548\u7387\u5f88\u4f4e\uff0c\u4e0d\u9002\u5408\u9ad8\u5e76\u53d1\u573a\u666f\uff09</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#tcctryconfirmcancel","title":"TCC\u65b9\u6848,try,confirm,cancel\uff08\u91d1\u878d\u573a\u666f\u9009\u62e9\u65b9\u6848\uff09","text":"<ul> <li>try\u9636\u6bb5\uff0c\u5404\u4e2a\u670d\u52a1\u7684\u8d44\u6e90\u505a\u68c0\u6d4b\u4ee5\u53ca\u5bf9\u8d44\u6e90\u8fdb\u884c\u9501\u5b9a\u6216\u8005\u9884\u7559</li> <li>confirm\u9636\u6bb5\uff0c\u5728\u5404\u4e2a\u670d\u52a1\u4e2d\u6267\u884c\u5b9e\u9645\u7684\u64cd\u4f5c</li> <li>cancel\u9636\u6bb5\uff1a\u5982\u679c\u4efb\u4f55\u4e00\u4e2a\u670d\u52a1\u7684\u4e1a\u52a1\u65b9\u6cd5\u6267\u884c\u51fa\u9519\uff0c\u90a3\u4e48\u8fd9\u91cc\u5c31\u9700\u8981\u8fdb\u884c\u8865\u507f\uff0c\u5df2\u7ecf\u6267\u884c\u6210\u529f\u7684\u4e1a\u52a1\u903b\u8f91\u56de\u6eda</li> </ul> <p>\u5bf9\u4e8e\u4e00\u81f4\u6027\u8981\u6c42\u9ad8\u3001\u77ed\u6d41\u7a0b\u3001\u5e76\u53d1\u9ad8\u7684\u573a\u666f\uff0c\u4f1a\u8003\u8651TCC\u65b9\u6848</p> <p></p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#saga","title":"saga\u65b9\u6848\uff08\u957f\u4e8b\u52a1\uff09","text":"<p>\u4e1a\u52a1\u6d41\u7a0b\u4e2d\u6bcf\u4e2a\u53c2\u4e0e\u8005\u90fd\u63d0\u4ea4\u672c\u5730\u4e8b\u52a1\uff0c\u82e5\u67d0\u4e00\u4e2a\u53c2\u4e0e\u8005\u5931\u8d25\uff0c\u5219\u8865\u507f\u524d\u9762\u5df2\u7ecf\u6210\u529f\u7684\u53c2\u4e0e\u8005</p> <p></p> <ul> <li>\u9002\u7528\u573a\u666f\uff1a\u4e1a\u52a1\u6d41\u7a0b\u957f\u3001\u4e1a\u52a1\u6d41\u7a0b\u591a\uff1b\u53c2\u4e0e\u8005\u5305\u542b\u5176\u5b83\u516c\u53f8\u6216\u9057\u7559\u7cfb\u7edf\u670d\u52a1\uff0c\u65e0\u6cd5\u63d0\u4f9bTCC\u6a21\u5f0f\u8981\u6c42\u7684\u4e09\u4e2a\u63a5\u53e3</li> <li>\u4f18\u52bf\uff1a<ul> <li>\u4e00\u9636\u6bb5\u63d0\u4ea4\u672c\u5730\u4e8b\u52a1\uff0c\u65e0\u9501\u9ad8\u6027\u80fd</li> <li>\u53c2\u4e0e\u8005\u53ef\u5f02\u6b65\uff0c\u9ad8\u541e\u5410</li> <li>\u8865\u507f\u670d\u52a1\u6613\u4e8e\u5b9e\u73b0\uff0c\u56e0\u4e3a\u4e00\u4e2a\u66f4\u65b0\u64cd\u4f5c\u7684\u53cd\u5411\u64cd\u4f5c\u6613\u4e8e\u7406\u89e3</li> </ul> </li> <li>\u7f3a\u70b9\uff1a\u4e0d\u4fdd\u8bc1\u4e8b\u52a1\u7684\u9694\u79bb\u6027</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#_9","title":"\u53ef\u9760\u6d88\u606f\u6700\u7ec8\u4e00\u81f4\u6027\u65b9\u6848","text":"<p>\u76f4\u63a5\u4f7f\u7528MQ\u6765\u5b9e\u73b0\u4e8b\u52a1\uff0c\u5982\u963f\u91cc\u7684RocketMQ\u652f\u6301\u4e8b\u52a1</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#_10","title":"\u6700\u5927\u52aa\u529b\u901a\u77e5\u65b9\u6848","text":"<ol> <li>A\u672c\u5730\u4e8b\u52a1\u6267\u884c\u5b8c\u6210\u540e\uff0c\u53d1\u9001\u6d88\u606f\u5230MQ</li> <li>\u6709\u4e13\u95e8\u6d88\u8d39MQ\u7684\u6700\u5927\u52aa\u529b\u901a\u77e5\u670d\u52a1\uff0c\u8fd9\u4e2a\u670d\u52a1\u6d88\u8d39MQ\u7136\u540e\u5199\u5165\u6570\u636e\u5e93\u4e2d\u8bb0\u5f55\uff0c\u6216\u8005\u653e\u5165\u5185\u5b58\u961f\u5217\uff0c\u63a5\u7740\u8c03\u7528\u7cfb\u7edfB\u63a5\u53e3</li> <li>B\u6267\u884c\u6210\u529f\u5c31ok\uff0c\u8981\u662f\u6267\u884c\u5931\u8d25\uff0c\u6700\u5927\u52aa\u529b\u901a\u77e5\u670d\u52a1\u5c31\u5b9a\u65f6\u5c1d\u8bd5\u91cd\u65b0\u8c03\u7528\u7cfb\u7edfB\uff0c\u53cd\u590dN\u6b21\uff0c\u6700\u540e\u8fd8\u662f\u4e0d\u884c\u5c31\u653e\u5f03</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#_11","title":"\u672c\u5730\u6d88\u606f\u8868","text":"<p>\u4e25\u91cd\u4f9d\u8d56\u6570\u636e\u5e93\u7684\u6d88\u606f\u6765\u7ba1\u7406\u4e8b\u52a1\uff0c\u9ad8\u5e76\u53d1\u573a\u666f\u5e76\u4e0d\u9002\u5408</p> <ol> <li>A\u7cfb\u7edf\u5728\u81ea\u5df1\u672c\u5730\u4e00\u4e2a\u4e8b\u52a1\u91cc\u64cd\u4f5c\u540c\u65f6\uff0c\u63d2\u5165\u4e00\u6761\u6570\u636e\u5230\u6d88\u606f\u8868</li> <li>A\u7cfb\u7edf\u5c06\u8fd9\u4e2a\u6d88\u606f\u53d1\u9001\u5230MQ</li> <li>B\u7cfb\u7edf\u6536\u5230\u6d88\u606f\u540e\uff0c\u5728\u4e00\u4e2a\u4e8b\u52a1\u91cc\uff0c\u5f80\u81ea\u5df1\u7684\u672c\u5730\u6d88\u606f\u8868\u63d2\u5165\u4e00\u6761\u6570\u636e\uff0c\u540c\u65f6\u6267\u884c\u5176\u5b83\u4e1a\u52a1\u64cd\u4f5c\uff0c\u5982\u679c\u6d88\u606f\u88ab\u5904\u7406\u8fc7\u4e86\uff0c\u90a3\u6b64\u65f6\u8fd9\u4e2a\u4e8b\u52a1\u56de\u6eda\uff0c\u4fdd\u8bc1\u4e0d\u4f1a\u91cd\u590d\u5904\u7406\u6d88\u606f</li> <li>B\u7cfb\u7edf\u6267\u884c\u6210\u529f\u540e\uff0c\u66f4\u65b0\u81ea\u5df1\u672c\u5730\u6d88\u606f\u8868\u72b6\u6001\u4ee5\u53caA\u7cfb\u7edf\u6d88\u606f\u8868\u72b6\u6001</li> <li>B\u5982\u679c\u5904\u7406\u5931\u8d25\uff0c\u90a3\u4e0d\u66f4\u65b0\u6d88\u606f\u8868\u72b6\u6001\uff0c\u6b64\u65f6A\u7cfb\u7edf\u5b9a\u65f6\u626b\u63cf\u81ea\u5df1\u7684\u6d88\u606f\u8868\uff0c\u5982\u679c\u6709\u672a\u5904\u7406\u6d88\u606f\uff0c\u518d\u6b21\u53d1\u9001\u5230MQ\uff0c\u8ba9B\u518d\u6b21\u5904\u7406</li> <li>\u4fdd\u8bc1\u4e86\u6700\u7ec8\u4e00\u81f4\u6027\uff0cB\u5931\u8d25\uff0cA\u4f1a\u4e0d\u65ad\u53d1\u6d88\u606f\uff0c\u76f4\u81f3B\u6210\u529f</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#_12","title":"\u4e3a\u4ec0\u4e48\u8981\u62c6\u5206\u5206\u5e03\u5f0f\u7cfb\u7edf","text":"<ol> <li>\u62c6\u5206\u670d\u52a1\uff0c\u51cf\u5c11\u4ee3\u7801\u6539\u52a8\u51b2\u7a81\uff0c\u5f71\u54cd\u8303\u56f4\u53d8\u5c0f\uff0c\u5f00\u53d1\u6548\u7387\u9ad8</li> <li>\u51cf\u5c11\u670d\u52a1\u53d1\u5e03\u5f71\u54cd\u8303\u56f4\uff0c\u51cf\u5c11\u4ee3\u7801\u6d4b\u8bd5\u8303\u56f4</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#_13","title":"\u5982\u4f55\u8fdb\u884c\u62c6\u5206","text":"<p>\u591a\u8f6e\u62c6\u5206\uff0c\u6839\u636e\u4e1a\u52a1\u6027\u8d28\u62c6\u5206\uff0c\u5982\u8ba2\u5355\u7cfb\u7edf\uff0c\u5546\u54c1\u7cfb\u7edf\u7b49\u7b49</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#dubbo_6","title":"dubbo\u548c\u670d\u52a1\u62c6\u5206\u6709\u4ec0\u4e48\u5173\u7cfb","text":"<p>\u53ef\u4ee5\u4e0d\u7528dubbo,\u7eafhttp\u901a\u4fe1\uff0c\u4f46\u662f\u5c31\u8981\u8003\u8651\u8d1f\u8f7d\u7b49\u95ee\u9898\uff0c\u6240\u4ee5dubbo\u5176\u5b9e\u5c31\u662f\u4e00\u4e2arpc\u6846\u67b6\uff0c\u672c\u5730\u8c03\u7528\u63a5\u53e3\uff0cdubbo\u4f1a\u4ee3\u7406\u8fd9\u4e2a\u8c03\u7528\u8bf7\u6c42\uff0c\u8ddf\u8fdc\u7a0b\u673a\u5668\u7f51\u7edc\u901a\u4fe1\uff0c\u5904\u7406\u6389\u8d1f\u8f7d\u5747\u8861\u3001\u670d\u52a1\u5b9e\u4f8b\u4e0a\u4e0b\u7ebf\u81ea\u52a8\u611f\u77e5\u3001\u8d85\u65f6\u91cd\u8bd5\u7b49</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#zk","title":"zk\u7684\u4e00\u4e9b\u573a\u666f","text":"<ol> <li>\u5206\u5e03\u5f0f\u534f\u8c03\uff0cA\u7cfb\u7edf\u53d1\u9001\u4e86\u4e2a\u6d88\u606f\u5230mq\u91cc\u53bb\uff0c\u7136\u540eB\u7cfb\u7edf\u6d88\u8d39\u5904\u7406\uff0c\u90a3B\u7cfb\u7edf\u6d88\u8d39\u5904\u7406\u540eA\u5982\u4f55\u77e5\u9053\u7ed3\u679c\uff1f</li> </ol> <p>\u89e3\u51b3\uff1a\u7528ZK\u5b9e\u73b0\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e4b\u95f4\u7684\u534f\u8c03 A\u7cfb\u7edf\u53d1\u9001\u540e\u5728Zk\u4e0a\u5bf9\u67d0\u4e2a\u8282\u70b9\u7684\u503c\u6ce8\u518c\u4e2a\u76d1\u542c\u5668\uff0c\u4e00\u65e6B\u5904\u7406\u5b8c\u5c31\u4fee\u6539ZK\u90a3\u4e2a\u8282\u70b9\u7684\u503c\uff0cA\u7cfb\u7edf\u7acb\u9a6c\u5c31\u53ef\u4ee5\u6536\u5230\u901a\u77e5</p> <ol> <li>\u5206\u5e03\u5f0f\u9501</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#hystrix","title":"\u57fa\u4e8eHystrix\u5b9e\u73b0\u9ad8\u53ef\u7528","text":"<p>Hystrix\u8ba9\u6211\u4eec\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u5bf9\u670d\u52a1\u95f4\u8c03\u7528\u8fdb\u884c\u63a7\u5236\uff0c\u52a0\u5165\u8c03\u7528\u5ef6\u8fdf\u6216\u8005\u4f9d\u8d56\u6545\u969c\u7684\u5bb9\u9519\u673a\u5236\uff1b\u8fd8\u63d0\u4f9b\u6545\u969c\u65f6\u7684fallback\u964d\u7ea7\u673a\u5236</p>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#_14","title":"\u6709\u54ea\u4e9b\u9650\u6d41\u7b97\u6cd5","text":"<ol> <li>\u8ba1\u6570\u5668</li> </ol> <p>\u63a7\u5236\u5355\u4f4d\u65f6\u95f4\u5185\u7684\u8bf7\u6c42\u6570\u91cf\u3002</p> <p>\u52a3\u52bf\uff1a\u8bbe\u6bcf\u5206\u949f\u8bf7\u6c42\u6570\u91cf60\u4e2a\uff0c\u6bcf\u79d2\u5904\u74061\u4e2a\u8bf7\u6c42\uff0c\u7528\u6237\u5728 00:59 \u53d1\u9001 60 \u4e2a\u8bf7\u6c42\uff0c\u5728 01:00 \u53d1\u9001 60 \u4e2a\u8bf7\u6c42 \u6b64\u65f6 2 \u79d2\u949f\u6709 120 \u4e2a\u8bf7\u6c42(\u6bcf\u79d2 60 \u4e2a\u8bf7\u6c42)\uff0c\u8fdc\u8fdc\u5927\u4e8e\u4e86\u6bcf\u79d2\u949f\u5904\u7406\u6570\u91cf\u7684\u9608\u503c\u3002\uff08\u7a81\u523a\u73b0\u8c61\uff09</p> <pre><code>import java.util.concurrent.atomic.AtomicInteger;\n\npublic class Counter {\n\n    /**\n     * \u6700\u5927\u8bbf\u95ee\u6570\u91cf\n     */\n    private final int limit = 10;\n\n    /**\n     * \u8bbf\u95ee\u65f6\u95f4\u5dee\n     */\n    private final long timeout = 1000;\n\n    /**\n     * \u8bf7\u6c42\u65f6\u95f4\n     */\n    private long time;\n\n    /**\n     * \u5f53\u524d\u8ba1\u6570\u5668\n     */\n    private AtomicInteger reqCount = new AtomicInteger(0);\n\n    public boolean limit() {\n        long now = System.currentTimeMillis();\n        if (now &lt; time + timeout) {\n            //\u5355\u4f4d\u65f6\u95f4\u5185\n            reqCount.addAndGet(1);\n            return reqCount.get() &lt;= limit;\n        } else {\n            //\u8d85\u51fa\u5355\u4f4d\u65f6\u95f4\n            time = now;\n            reqCount = new AtomicInteger(0);\n            return true;\n        }\n    }\n\n}\n</code></pre> <ol> <li>\u6ed1\u52a8\u7a97\u53e3</li> </ol> <p>\u5bf9\u8ba1\u6570\u5668\u7684\u4e00\u4e2a\u6539\u8fdb\uff0c\u589e\u52a0\u4e00\u4e2a\u65f6\u95f4\u7c92\u5ea6\u7684\u5ea6\u91cf\u5355\u4f4d\uff0c\u4e00\u5206\u949f\u5206\u4e3a\u82e5\u5e72\u4efd\uff08\u59826\u4efd\uff0c\u6ca110\u79d2\u4e00\u4efd\uff09\uff0c\u5728\u6bcf\u4efd\u4e0a\u8bbe\u7f6e\u72ec\u7acb\u8ba1\u6570\u5668\uff0c</p> <ol> <li>leaky bucket\u6f0f\u6876</li> </ol> <p>\u89c4\u5b9a\u56fa\u5b9a\u5bb9\u91cf\u7684\u6876\uff0c\u8fdb\u5165\u7684\u6c34\u65e0\u6cd5\u7ba1\u63a7\u6570\u91cf\u3001\u901f\u5ea6\uff0c\u4f46\u662f\u5bf9\u4e8e\u6d41\u51fa\u7684\u6c34\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u901f\u5ea6</p> <p>\u52a3\u52bf\uff1a\u65e0\u6cd5\u5e94\u5bf9\u77ed\u65f6\u95f4\u7a81\u53d1\u6d41\u91cf\uff08\u6876\u6ee1\u4e86\u5c31\u4e22\u5f03\uff09</p> <pre><code>public class LeakBucket {\n\n    /**\n     * \u65f6\u95f4\n     */\n    private long time;\n\n    /**\n     * \u603b\u91cf\n     */\n    private Double total;\n\n    /**\n     * \u6c34\u6d41\u51fa\u901f\u5ea6\n     */\n    private Double rate;\n\n    /**\n     * \u5f53\u524d\u603b\u91cf\n     */\n    private Double nowSize;\n\n    public boolean limit() {\n        long now = System.currentTimeMillis();\n\n        nowSize = Math.max(0, (nowSize - (now - time) * rate));\n        time = now;\n\n        if ((nowSize + 1) &lt; total) {\n            nowSize++;\n            return true;\n        } else {\n            return false;\n        }\n\n    }\n}\n</code></pre> <ol> <li>Token Bucket\u4ee4\u724c\u6876</li> </ol> <p>\u89c4\u5b9a\u56fa\u5b9a\u5bb9\u91cf\u7684\u6876\uff0ctoken \u4ee5\u56fa\u5b9a\u901f\u5ea6\u5f80\u6876\u5185\u586b\u5145\uff0c \u5f53\u6876\u6ee1\u65f6 token \u4e0d\u4f1a\u88ab\u7ee7\u7eed\u653e\u5165\uff0c \u6bcf\u8fc7\u6765\u4e00\u4e2a\u8bf7\u6c42\u628a token \u4ece\u6876\u4e2d\u79fb\u9664\uff0c \u5982\u679c\u6876\u4e2d\u6ca1\u6709 token \u4e0d\u80fd\u8bf7\u6c42\u3002 \u53ef\u4ee5\u51c6\u5907\u4e00\u4e2a\u961f\u5217\uff0c\u7528\u6765\u4fdd\u5b58\u4ee4\u724c\uff0c\u53e6\u5916\u901a\u8fc7\u4e00\u4e2a\u7ebf\u7a0b\u6c60\u5b9a\u671f\u751f\u6210\u4ee4\u724c\u653e\u5230\u961f\u5217\u4e2d\uff0c\u6bcf\u6765\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5c31\u4ece\u961f\u5217\u4e2d\u83b7\u53d6\u4e00\u4e2a\u4ee4\u724c\uff0c\u5e76\u7ee7\u7eed\u6267\u884c\u3002 </p> <pre><code>public class TokenBucket {\n\n    /**\n     * \u65f6\u95f4\n     */\n    private long time;\n\n    /**\n     * \u603b\u91cf\n     */\n    private Double total;\n\n    /**\n     * \u6c34\u6d41\u51fa\u901f\u5ea6\n     */\n    private Double rate;\n\n    /**\n     * \u5f53\u524d\u603b\u91cf\n     */\n    private Double nowSize;\n\n\n    public boolean limit() {\n\n        long now = System.currentTimeMillis();\n\n        nowSize = Math.min(total, (nowSize + (now - time) * rate));\n        time = now;\n\n        if (nowSize &lt; 1) {\n            //\u6876\u91cc\u6ca1\u6709token\n            return false;\n        } else {\n            //\u5b58\u5728token\n            nowSize -= 1;\n            return true;\n        }\n    }\n\n}\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E4%BC%81%E4%B8%9A%E9%A1%B9%E7%9B%AE%E6%A1%86%E6%9E%B6/dubbo/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/#dubborpc_1","title":"Dubbo\u5982\u4f55\u5728RPC\u8c03\u7528\u65f6\u5f02\u6b65\u8f6c\u540c\u6b65\uff1f","text":"<p>TCP\u534f\u8bae\u672c\u8eab\u5f02\u6b65\uff0c\u53d1\u9001\u5b8cRPC\u8bf7\u6c42\u540e\uff0c\u7ebf\u7a0b\u4e0d\u4f1a\u7b49\u5f85RPC\u7684\u54cd\u5e94\u7ed3\u679c</p> <p>\u7b49\u5f85-\u901a\u77e5\u673a\u5236\uff0c\u5728dubbo\u4e4b\u95f4RPC\u53d1\u8d77\u8c03\u7528\u65f6\uff0c\u7ebf\u7a0b\u8fdb\u5165Timed_WAITING\u72b6\u6001\uff0c\u963b\u585e\u8c03\u7528\u7ebf\u7a0b\uff1b\u5f53rpc\u8fd4\u56de\u7ed3\u679c\u540e\uff0c\u5524\u9192\u7b49\u5f85\u7ebf\u7a0b</p> <pre><code>// \u521b\u5efa\u9501\u4e0e\u6761\u4ef6\u53d8\u91cf\nprivate final Lock lock=new ReentrantLock();\nprivate final Condition done=lock.newCondition();\n// \u8c03\u7528\u65b9\u901a\u8fc7\u8be5\u65b9\u6cd5\u7b49\u5f85\u7ed3\u679c\n        Object get(int timeout){\n        long start=System.nanoTime();\n        lock.lock();\n        try{\n        while(!isDone()){\n        done.await(timeout);\n        long cur=System.nanoTime();\n        if(isDone()||\n        cur-start&gt;timeout){\n        break;\n        }\n        }\n        }finally{\n        lock.unlock();\n        }\n        if(!isDone()){\n        throw new TimeoutException();\n        }\n        return returnFromResponse();\n        }\n\n        // RPC\u7ed3\u679c\u662f\u5426\u5df2\u7ecf\u8fd4\u56de\n        boolean isDone(){\n        return response!=null;\n        }\n\n// RPC\u7ed3\u679c\u8fd4\u56de\u65f6\u8c03\u7528\u8be5\u65b9\u6cd5   \nprivate void doReceived(Response res){\n        lock.lock();\n        try{\n        response=res;\n        if(done!=null){\n        done.signal();\n        }\n        }finally{\n        lock.unlock();\n        }\n        }\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E5%81%8F%E9%97%A8%E4%BD%86%E7%A0%94%E7%A9%B6%E8%BF%87%E7%9A%84%E4%B8%9C%E8%A5%BF/Apache%20CXF/","title":"Apache cxf\u66b4\u9732\u63a5\u53e3\u4ee5\u53ca\u5ba2\u6237\u7aef\u8c03\u7528\u4e4bWebService","text":"<p>\u4e2a\u4eba\u94fe\u63a5</p> <p>\u5728\u6211\u4eec\u771f\u5b9e\u7684\u9879\u76ee\u4e2d\uff0c\u7ecf\u5e38\u4f1a\u8c03\u7528\u522b\u4eba\u63d0\u4f9b\u7ed9\u6211\u4eec\u7684\u63a5\u53e3\uff0c\u6216\u8005\u5728\u81ea\u5df1\u7684\u56e2\u961f\u4e2d\uff0c</p> <p>restful\u98ce\u683c\u7684\u524d\u540e\u7aef\u5206\u79bb\u4e5f\u7ecf\u5e38\u4f1a\u63d0\u4f9b\u4e00\u4e2a\u540e\u7aef\u63a5\u53e3\u66b4\u9732\u51fa\u53bb\u4f9bapp\uff0c\u6216\u8005.net/C/C++\u7a0b\u5e8f\u5458\u53bb\u8c03\u7528\uff0c\u6b64\u65f6\u5c31\u9700\u8981\u4f7f\u7528\u5230\u4e00\u4e2a\u5de5\u5177\u6216\u8005\u4e00\u5957\u7a0b\u5e8f\u6765\u8c03\u7528\u66b4\u9732\u7684\u63a5\u53e3\u3002</p> <p>\u800c\u4eca\u5929\u6211\u8981\u8bf4\u7684\u5c31\u662f\u5176\u4e2d\u7684\u4e00\u4e2a\u65b9\u5f0f\uff0c\u4f7f\u7528apache\u7684cxf\u8c03\u7528\u4ee5\u53ca\u66b4\u9732\u63a5\u53e3\uff0c\u8ba9\u6211\u4eec\u76f4\u63a5\u5f00\u59cb\u4ee3\u7801</p> <ol> <li>\u9996\u5148\u6211\u4eec\u9700\u8981\u53bb\u4e0b\u8f7dcxf\uff0ccxf\u662fapache\u7684\u4e00\u4e2a\u4ea7\u54c1\uff0c\u4e0b\u8f7d\u94fe\u63a5\u9644\u4e0a\uff1ahttp://www.apache.org/dyn/closer.lua/cxf/3.2.5/apache-cxf-3.2.5.zip</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E5%81%8F%E9%97%A8%E4%BD%86%E7%A0%94%E7%A9%B6%E8%BF%87%E7%9A%84%E4%B8%9C%E8%A5%BF/SpringSecurity/","title":"SpringSecurity","text":"<p>\u4e2a\u4eba\u603b\u7ed3</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/","title":"Index","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/#_1","title":"\u89e3\u51b3\u65b9\u6848","text":"<p>\u5404\u4e1a\u52a1\u573a\u666f\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u5982\u5ef6\u8fdf\u961f\u5217\u8bbe\u8ba1\uff1fmysql\u5206\u5e93\u5206\u8868\uff1fappleId\u7b2c\u4e09\u65b9\u6388\u6743\u767b\u5f55</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/7%E5%8D%83%E4%B8%87%2B%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/","title":"\u516c\u53f8\u9700\u8981\u5b58\u50a87000\u4e07+\u4f1a\u5458\u6570\u636e","text":"<p>\u80cc\u666f</p> <ul> <li>\u8d77\u521d\u4f1a\u5458\u6570\u636e\u7531\u6570\u636e\u4fa7\u5b58\u50a8\uff0c\u56e0\u4e3a\u4e1a\u52a1\u7684\u53d1\u5c55\uff0c\u9700\u8981\u5c06\u4f1a\u5458\u6570\u636e\u5b58\u653e\u81f3\u4e1a\u52a1\u4fa7\uff0c\u6240\u4ee5\u9700\u8981\u5e94\u7528\u6280\u672f\u65b9\u6848\u6765\u5b9e\u73b0\u4f1a\u5458\u6570\u636e\u7684\u589e\u5220\u6539\u67e5</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/7%E5%8D%83%E4%B8%87%2B%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#_1","title":"\u65b9\u6848\u8bbe\u8ba1\u9636\u6bb5","text":"<p>\u91c7\u7528\u6570\u636e\u5e93\u8bfb\u5199\u5206\u79bb\uff0c\u5199\u5e93\u64cd\u4f5c\u5728\u4e3b\u5e93\uff0c\u8bfb\u5e93\u64cd\u4f5c\u5728\u4ece\u5e93\uff08\u5f53\u6709\u5927\u91cf\u7684\u5199\u64cd\u4f5c\uff09\uff0c\u52a0\u4e00\u4e2aMaster\u4e0d\u80fd\u89e3\u51b3\u95ee\u9898\uff0c\u56e0\u4e3a\u6570\u636e\u8981\u4e00\u81f4\u6027\uff0c\u5199\u64cd\u4f5c\u9700\u89812\u4e2a\u751a\u81f3\u591a\u4e2aMaster\u4e4b\u95f4\u540c\u6b65\uff0c\u76f8\u5f53\u4e8e\u91cd\u590d \u8003\u91cf\u6570\u636e\u5e93\u5206\u5e93\u5206\u8868\u65b9\u6848\uff08sharding\uff09\uff0c\u5bf9\u5199\u64cd\u4f5c\u8fdb\u884c\u5207\u5206 \u7b80\u5355\u7684\u8bfb\u5199\u5206\u79bb mysql\u7684\u4e3b\u4ece\u590d\u5236\uff0c\u7ed3\u5c40\u4e86\u6570\u636e\u5e93\u7684\u8bfb\u5199\u5206\u79bb\uff0c\u63d0\u5347\u4e86\u8bfb\u7684\u6027\u80fd</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/7%E5%8D%83%E4%B8%87%2B%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#_2","title":"\u8bfb\u5199\u5206\u79bb\u9020\u6210\u7684\u6027\u80fd\u74f6\u9888","text":"<ul> <li>\u5199\u5165\u65e0\u6cd5\u6269\u5c55\uff0c\u9700\u8981\u6269\u5c55master</li> <li>\u5199\u5165\u65e0\u6cd5\u7f13\u5b58</li> <li>\u9501\u8868\u7387\u4e0a\u5347</li> <li>\u8868\u53d8\u5927\uff0c\u7f13\u5b58\u7387\u4e0b\u964d</li> <li>\u5206\u5e93\u5206\u8868</li> <li>\u5355\u5e93\u592a\u5927</li> <li>\u5355\u4e2a\u6570\u636e\u5e93\u5904\u7406\u80fd\u529b\u6709\u9650\uff1b\u5355\u5e93\u6240\u5728\u670d\u52a1\u5668\u4e0a\u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3\uff1b\u5355\u5e93\u4e0a\u64cd\u4f5c\u7684IO\u74f6\u9888 \u89e3\u51b3\u65b9\u6cd5\uff1a\u5207\u5206\u6210\u66f4\u591a\u66f4\u5c0f\u7684\u5e93</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/7%E5%8D%83%E4%B8%87%2B%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#_3","title":"\u5355\u8868\u592a\u5927","text":"<p>CRUD\u90fd\u6210\u95ee\u9898\uff1b\u7d22\u5f15\u81a8\u80c0\uff0c\u67e5\u8be2\u8d85\u65f6 \u89e3\u51b3\u65b9\u6cd5\uff1a\u5207\u5206\u6210\u591a\u4e2a\u6570\u636e\u96c6\u66f4\u5c0f\u7684\u8868\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/7%E5%8D%83%E4%B8%87%2B%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#_4","title":"\u5206\u5e93\u5206\u8868\u65b9\u5f0f","text":"<p>\u5206\u5e93\u5206\u8868\u7684\u987a\u5e8f\u5e94\u8be5\u662f\u5148\u5782\u76f4\u5206\uff0c\u540e\u6c34\u5e73\u5206</p> <ul> <li> <p>\u5782\u76f4\u62c6\u5206</p> <ul> <li> <p>\u5782\u76f4\u5206\u8868</p> <ol> <li>\u5927\u8868\u62c6\u5c0f\u8868\uff0c\u57fa\u4e8e\u5217\u5b57\u6bb5\uff0c\u5c06\u4e0d\u5e38\u7528\u7684\uff0c\u6570\u636e\u8f83\u5927\uff0c\u957f\u5ea6\u8f83\u957f\u7684\u5b57\u6bb5\u62c6\u5206\u5230\u6269\u5c55\u8868\uff0c\u4e00\u822c\u9488\u5bf9\u51e0\u767e\u5217\u7684\u5927\u8868\u3002</li> </ol> </li> <li> <p>\u5782\u76f4\u5206\u5e93</p> </li> <li>\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u4e0d\u540c\u4e1a\u52a1\u8fdb\u884c\u62c6\u5206\uff0c\u6bd4\u5982user\u5e93\uff0cproduct\u5e93\uff0corder\u5e93\uff0c\u5207\u5206\u653e\u5728\u591a\u4e2a\u670d\u52a1\u5668\u4e0a\uff0c\u800c\u4e0d\u662f\u540c\u4e00\u4e2a\u670d\u52a1\u5668\u3002\u5355\u6570\u636e\u670d\u52a1\u5668\u4e0a\u7684\u6027\u80fd\u74f6\u9888\u4f1a\u5c06\u7528\u6237\u8ba2\u5355\u7684crud\u4f1a\u8ba9\u5f53\u4e2a\u670d\u52a1\u5668\u7684\u78c1\u76d8\u7a7a\u95f4\uff0c\u5185\u5b58\uff0ctps\u7b49\u8d44\u6e90\u4e0d\u8db3\u3002\u9ad8\u5e76\u53d1\u573a\u666f\u4e0b\uff0c\u5782\u76f4\u5206\u5e93\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u80fd\u591f\u7a81\u7834IO,\u8fde\u63a5\u6570\u53ca\u5355\u673a\u786c\u4ef6\u8d44\u6e90\u7684\u74f6\u9888</li> </ul> </li> <li> <p>\u6c34\u5e73\u62c6\u5206</p> <ul> <li>\u6c34\u5e73\u5206\u8868<ul> <li>\u9488\u5bf9\u6570\u636e\u91cf\u5de8\u5927\u7684\u5355\u5f20\u8868\uff0c\u6309\u7167\u67d0\u79cd\u89c4\u5219\uff08hash\uff0crange\u7b49\uff09\uff0c\u5207\u5206\u5230\u591a\u5f20\u8868\uff0c\u4f46\u662f\u8868\u4ecd\u7136\u5728\u540c\u4e00\u4e2a\u5e93\uff0c\u6240\u4ee5\u5e93\u7ea7\u522b\u7684\u64cd\u4f5c\u8fd8\u662fIO\u74f6\u9888</li> </ul> </li> <li>\u6c34\u5e73\u5206\u5e93\u5206\u8868<ul> <li>\u5c06\u5355\u5f20\u8868\u6570\u636e\u5207\u5206\u5230\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\uff0c\u6bcf\u4e2a\u670d\u52a1\u5668\u6709\u76f8\u5e94\u7684\u5e93\u8868\uff0c\u80fd\u591f\u6709\u6548\u7f13\u89e3\u5355\u673a\u548c\u5355\u5e93\u7684\u6027\u80fd\u74f6\u9888\u548c\u538b\u529b</li> </ul> </li> <li>\u6c34\u5e73\u5206\u5e93\u5206\u8868\u5207\u5206\u89c4\u5219<ul> <li>range:\u4ece0-10000\u4e00\u4e2a\u8868\uff0c10001-20000\u4e00\u4e2a\u8868</li> <li>Hash\u53d6\u6a21\uff1a\u5c06\u7528\u6237\uff0c\u8ba2\u5355\u4f5c\u4e3a\u4e3b\u8868\uff0c\u7136\u540e\u5c06\u548c\u5b83\u4eec\u76f8\u5173\u7684\u4f5c\u4e3a\u9644\u8868\uff0c\u8fd9\u6837\u4e0d\u4f1a\u9020\u6210\u8de8\u5e93\u4e8b\u52a1\u4e4b\u7c7b\u7684\u95ee\u9898\u3002\u53d6\u7528\u6237id\uff0c\u7136\u540ehash\u53d6\u6a21\uff0c\u5206\u914d\u5230\u4e0d\u540c\u7684\u6570\u636e\u5e93\u4e0a</li> <li>\u5730\u7406\u533a\u57df\uff1a\u6309\u7167\u534e\u4e1c\u3001\u534e\u5357\u3001\u534e\u5317\u8fd9\u6837\u6765\u533a\u5206</li> <li>\u65f6\u95f4\uff1a\u6309\u7167\u65f6\u95f4\u5207\u5206\uff0c\u4e00\u5e74\u524d\u6570\u636e\u5207\u5206\u653e\u5230\u53e6\u5916\u7684\u8868\uff0c\u51b7\u70ed\u6570\u636e\u5206\u79bb</li> </ul> </li> </ul> </li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/7%E5%8D%83%E4%B8%87%2B%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#_5","title":"\u5206\u5e93\u5206\u8868\u4ea7\u751f\u7684\u95ee\u9898","text":"<ol> <li>\u7ef4\u5ea6\u95ee\u9898    \u5047\u5982\u7528\u6237\u8d2d\u4e70\u5546\u54c1A,\u9700\u8981\u4fdd\u5b58\u4ea4\u6613\u8bb0\u5f55\uff0c\u5982\u679c\u6309\u7167\u7528\u6237\u7ef4\u5ea6\u62c6\u5206\uff0c\u5219\u6bcf\u4e2a\u7528\u6237\u4ea4\u6613\u8bb0\u5f55\u90fd\u5728\u540c\u4e00\u4e2a\u8868\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f88\u5feb\u67e5\u8be2\u67d0\u4e2a\u7528\u6237\u7ef4\u5ea6\u7684\u4ea4\u6613\u8bb0\u5f55\uff1b\u4f46\u662f\u8981\u67e5\u67d0\u4ef6\u5546\u54c1\u7684\u88ab\u8d2d\u4e70\u60c5\u51b5\uff0c\u5219\u6bd4\u8f83\u9ebb\u70e6\u3002\u5e38\u89c1\u89e3\u51b3\u65b9\u6848\uff1a1.\u8bb0\u5f55\u4e24\u4efd\u6570\u636e\uff0c\u4e00\u4efd\u6309\u7528\u6237\u7ef4\u5ea6\uff0c\u4e00\u4efd\u6309\u5546\u54c1\u7ef4\u5ea6\u3002</li> <li>\u641c\u7d22\u5f15\u64ce \u8054\u5408\u67e5\u8be2\u95ee\u9898 \u57fa\u672c\u4e0d\u53ef\u80fd\uff0c\u56e0\u4e3a\u5173\u8054\u8868\u53ef\u80fd\u4e0d\u5728\u540c\u4e00\u4e2a\u5e93</li> <li>\u907f\u514d\u8de8\u5e93\u4e8b\u52a1\uff0c\u907f\u514d\u5728\u4fee\u6539db1\u7684\u65f6\u5019\u540c\u6b65\u4fee\u6539db2\u7684\u64cd\u4f5c\uff0c\u6548\u7387\u4f1a\u6709\u5f71\u54cd</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/7%E5%8D%83%E4%B8%87%2B%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#_6","title":"\u5206\u5e93\u5206\u8868\u591a\u5c11\u5408\u9002","text":"<p>\u5355\u88681000\u4e07\u6761\u8bb0\u5f55\u4e00\u4e0b,\u5199\u5165\u8bfb\u53d6\u6027\u80fd\u662f\u6bd4\u8f83\u597d\u7684.\u8fd9\u6837\u5728\u7559\u70b9buffer,\u90a3\u4e48\u5355\u8868\u5168\u662f\u6570\u636e\u5b57\u578b\u7684\u4fdd\u6301\u5728800\u4e07\u6761\u8bb0\u5f55\u4ee5\u4e0b, \u6709\u5b57\u7b26\u578b\u7684\u5355\u8868\u4fdd\u6301\u5728500\u4e07\u4ee5\u4e0b\u3002 \u5982\u679c\u6309 100\u5e93100\u8868\u6765\u89c4\u5212,\u5982\u7528\u6237\u4e1a\u52a1:500\u4e07100100 = 50000000\u4e07 = 5000\u4ebf\u8bb0\u5f55</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/AppleId%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E6%B5%81%E7%A8%8B%E8%B0%83%E7%A0%94/","title":"AppleId\u7b2c\u4e09\u65b9\u6388\u6743\u767b\u5f55\u6d41\u7a0b\u8c03\u7814","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/AppleId%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E6%B5%81%E7%A8%8B%E8%B0%83%E7%A0%94/#apple-id","title":"apple id\u767b\u5f55\u4e3b\u8981\u6d41\u7a0b\u5982\u56fe(\u53cc\u91cd\u8ba4\u8bc1)\u9644\u4ef6\u56fe","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/AppleId%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E6%B5%81%E7%A8%8B%E8%B0%83%E7%A0%94/#_1","title":"\u5f00\u53d1\u524d\u51c6\u5907\u4ee5\u53ca\u6ce8\u610f\u70b9","text":"<ul> <li>\u9700\u8981\u82f9\u679c\u5f00\u53d1\u8005\u8d26\u6237(https://developer.apple.com/account/#/welcome)</li> <li>\u52a0\u5165\u5f00\u53d1\u8005\u8ba1\u5212\u4ed8\u8d39</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/AppleId%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E6%B5%81%E7%A8%8B%E8%B0%83%E7%A0%94/#_2","title":"\u901a\u4fe1\u6d41\u7a0b","text":"<ul> <li>\u5ba2\u6237\u7aef\u4e0e\u82f9\u679c\u670d\u52a1\u5668\u901a\u4fe1\u83b7\u5f97identitytoken\uff0c\u7136\u540e\u628aidentitytoken\u4ea4\u7ed9\u4e1a\u52a1\u540e\u53f0\u9a8c\u8bc1\uff0c\u9a8c\u8bc1\u901a\u8fc7\u5c31\u53ef\u4ee5\u4e86\u3002\u5176\u4e2dappServer\u6d89\u53ca\u5230\u7684\u9a8c\u8bc1\uff0c\u5c31\u662fidentitytoken\uff0c\u5176\u5b9eidentitytoken\u5c31\u662f\u4e00\u4e2ajws\u3002\uff08jws\u662fjson web signature\uff09,\u9a8c\u8bc1jws\u7684\u7b7e\u540d\uff0c\u4fdd\u8bc1\u6570\u636e\u6ca1\u6709\u88ab\u7be1\u6539\u4e4b\u540e\uff0c\u8fd8\u8981\u6821\u9a8c\u4eceidentitytokendecode\u51fa\u6765\u7684nonce,iss,aud,exp\uff0c\u4e3b\u8981\u662fiss\u548cexp\u8fd9\u4e24\u4e2a</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/AppleId%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E6%B5%81%E7%A8%8B%E8%B0%83%E7%A0%94/#token","title":"\u83b7\u53d6/\u5237\u65b0token","text":"<ul> <li>\u9996\u5148\u83b7\u53d6code:GET https://appleid.apple.com/auth/authorize?response_type=code&amp;client_id=&amp;redirect_uri=&amp;state=1234</li> <li>\u6839\u636ecode\u83b7\u53d6token:POST https://appleid.apple.com/auth/token?grant_type=authorization_code&amp;code=code&amp;redirect_uri=url&amp;client_id=id&amp;client_secret=secret  \u83b7\u53d6\u4ee4\u724c\u6240\u9700\u53c2\u6570\uff1a</li> <li>grant_type:'authorization_code'\u4e3a\u83b7\u53d6\u4ee4\u724c</li> <li>client_id\uff1aclient_id</li> <li>redirect_uri\uff1aredirect_uri</li> <li>code\uff1a\u4e0a\u4e00\u6b65\u83b7\u53d6\u5230\u7684\u6388\u6743\u7801</li> <li>codeclient_secret\uff1asecret\uff08\u4e00\u4e2a\u81ea\u5df1\u751f\u6210\u7684jwt https://developer.apple.com/documentation/signinwithapplerestapi/generate_and_validate_tokens\uff09 \u8fd4\u56de\u503c\u793a\u4f8b <pre><code>{\n\"access_token\":\"a0996b16cfb674c0eb0d29194c880455b.0.nsww.5fi5MVC-i3AVNhddrNg7Qw\",\n\"token_type\":\"Bearer\",\n\"expires_in\":3600,\n\"refresh_token\":\"r9ee922f1c8b048208037f78cd7dfc91a.0.nsww.KlV2TeFlTr7YDdZ0KtvEQQ\",\n\"id_token\":\"eyJraWQiOiJBSURPUEsxIiwiYWxnIjoiUlMyNTYifQ.eyJpc3MiOiJodHRwczovL2FwcGxlaWQuYXBwbGUuY29tIiwiYXVkIjoiY29tLnNreW1pbmcuYXBwbGVsb2dpbmRlbW8iLCJleHAiOjE1NjU2NjU1OTQsImlhdCI6MTU2NTY2NDk5NCwic3ViIjoiMDAwMjY2LmRiZTg2NWIwYWE3MjRlMWM4ODM5MDIwOWI5YzdkNjk1LjAyNTYiLCJhdF9oYXNoIjoiR0ZmODhlX1ptc0pqQ2VkZzJXem85ZyIsImF1dGhfdGltZSI6MTU2NTY2NDk2M30.J6XFWmbr0a1hkJszAKM2wevJF57yZt-MoyZNI9QF76dHfJvAmFO9_RP9-tz4pN4ua3BuSJpUbwzT2xFD_rBjsNWkU-ZhuSAONdAnCtK2Vbc2AYEH9n7lB2PnOE1mX5HwY-dI9dqS9AdU4S_CjzTGnvFqC9H5pt6LVoCF4N9dFfQnh2w7jQrjTic_JvbgJT5m7vLzRx-eRnlxQIifEsHDbudzi3yg7XC9OL9QBiTyHdCQvRdsyRLrewJT6QZmi6kEWrV9E21WPC6qJMsaIfGik44UgPOnNnjdxKPzxUAa-Lo1HAzvHcAX5i047T01ltqvHbtsJEZxAB6okmwco78JQA\"\n}\n</code></pre> \u5237\u65b0\u4ee4\u724c\u6240\u9700\u53c2\u6570\uff1a</li> <li>grant_type:'refresh_token'\u4e3a\u5237\u65b0\u4ee4\u724c</li> <li>client_id\uff1aclient_id</li> <li>client_secret\uff1aclient_secret</li> <li>refresh_token\uff1a\u4e0a\u4e00\u6b65\u83b7\u53d6\u5230\u7684id_token</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/AppleId%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E6%B5%81%E7%A8%8B%E8%B0%83%E7%A0%94/#id_token","title":"\u5bf9id_token\u89e3\u5bc6","text":"<ul> <li>\u901a\u8fc7 GET:https://appleid.apple.com/auth/keys \u63a5\u53e3\u83b7\u53d6\u516c\u94a5 <pre><code>{\n    \"keys\": [\n        {\n            \"kty\": \"RSA\",\n            \"kid\": \"86D88Kf\",\n            \"use\": \"sig\",\n            \"alg\": \"RS256\",\n            \"n\": \"iGaLqP6y-SJCCBq5Hv6pGDbG_SQ11MNjH7rWHcCFYz4hGwHC4lcSurTlV8u3avoVNM8jXevG1Iu1SY11qInqUvjJur--hghr1b56OPJu6H1iKulSxGjEIyDP6c5BdE1uwprYyr4IO9th8fOwCPygjLFrh44XEGbDIFeImwvBAGOhmMB2AD1n1KviyNsH0bEB7phQtiLk-ILjv1bORSRl8AK677-1T8isGfHKXGZ_ZGtStDe7Lu0Ihp8zoUt59kx2o9uWpROkzF56ypresiIl4WprClRCjz8x6cPZXU2qNWhu71TQvUFwvIvbkE1oYaJMb0jcOTmBRZA2QuYw-zHLwQ\",\n            \"e\": \"AQAB\"\n        },\n        {\n            \"kty\": \"RSA\",\n            \"kid\": \"eXaunmL\",\n            \"use\": \"sig\",\n            \"alg\": \"RS256\",\n            \"n\": \"4dGQ7bQK8LgILOdLsYzfZjkEAoQeVC_aqyc8GC6RX7dq_KvRAQAWPvkam8VQv4GK5T4ogklEKEvj5ISBamdDNq1n52TpxQwI2EqxSk7I9fKPKhRt4F8-2yETlYvye-2s6NeWJim0KBtOVrk0gWvEDgd6WOqJl_yt5WBISvILNyVg1qAAM8JeX6dRPosahRVDjA52G2X-Tip84wqwyRpUlq2ybzcLh3zyhCitBOebiRWDQfG26EH9lTlJhll-p_Dg8vAXxJLIJ4SNLcqgFeZe4OfHLgdzMvxXZJnPp_VgmkcpUdRotazKZumj6dBPcXI_XID4Z4Z3OM1KrZPJNdUhxw\",\n            \"e\": \"AQAB\"\n        }\n    ]\n}\n</code></pre></li> <li>\u7136\u540e\u6211\u4eec\u7528jwt.verify\u901a\u8fc7\u516c\u94a5\u89e3\u5bc6id_token</li> <li>\u89e3\u5bc6\u540e\u5f97\u5230\u7684verify.sub\u5c31\u662f\u7528\u6237apple\u8d26\u53f7\u767b\u5f55\u5728\u8be5\u7a0b\u5e8f\u4e2d\u7684\u552f\u4e00\u6807\u8bc6\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u5b58\u5230\u7a0b\u5e8f\u7684\u6570\u636e\u5e93\u4e2d\u4e0e\u7528\u6237\u4fe1\u606f\u505a\u6620\u5c04\uff0c\u7528\u4e8e\u6807\u8bc6\u7528\u6237\u8eab\u4efd      </li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/Idea%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95%E7%9B%91%E6%8E%A7%E7%AB%AF%E5%8F%A3/","title":"IDEA\u8fdc\u7a0b\u8c03\u8bd5","text":"<p>\u5927\u5bb6\u77e5\u9053\uff0c\u7ebf\u4e0a\u73af\u5883\u5b9a\u4f4d\u95ee\u9898\u4e0d\u662f\u90a3\u4e48\u7b80\u5355\u7684\uff0c\u5982\u679c\u6709\u975e\u5e38\u5b8c\u5584\u7684\u65e5\u5fd7\u4ee5\u53ca\u76d1\u63a7\u7cfb\u7edf\u662f\u4e0d\u5fc5\u62c5\u5fc3\u7684\uff0c\u4f46\u662f\u5e94\u5bf9\u8fd9\u4e9b\u5e76\u4e0d\u5b8c\u5584\u7684\u573a\u666f\u4e0b\uff0cIDEA\u63d0\u4f9b\u4e86\u4e00\u79cd\u8fdc\u7a0b\u8c03\u8bd5\u7684\u529f\u80fd\uff0cremote\u96c6\u6210\u4e86\u53ef\u4ee5\u8fdc\u7a0b\u8c03\u8bd5\u7684\u529f\u80fd\uff0c\u53ea\u9700\u8981\u5728\u4f60\u7684\u751f\u4ea7\u73af\u5883\u5f00\u653e\u67d0\u4e2a\u7aef\u53e3\u4f9b\u5916\u90e8\u8fdc\u7a0b\u8bbf\u95ee\u5373\u53ef\uff0c\u4e0b\u9762\u8bb2\u89e3\u4e00\u4e0b\u6559\u7a0b\uff1a</p> <p>\u9996\u5148\u662fIDEA\u914d\u7f6eRemote, </p> <ol> <li> <p>\u5982\u4e0a\u56fe\uff0c\u53ea\u9700\u8981\u6dfb\u52a0\u8981\u76d1\u63a7\u7684\u670d\u52a1\u5668\uff0c\u4ee5\u53ca\u5f00\u542f\u76d1\u63a7\u7684\u7aef\u53e3\u5373\u53ef\u3002</p> </li> <li> <p>IDEA\u914d\u7f6e\u597d\u76d1\u63a7\u4e4b\u540e\uff0c\u9700\u8981\u5728\u670d\u52a1\u5668\u4e0a\u5f00\u653e\u5bf9\u5e94\u7684\u7aef\u53e3\u4f9b\u5916\u90e8\u76d1\u63a7\uff0c\u6211\u7684\u542f\u7528\u65b9\u5f0f\u662f\u5728\u542f\u52a8jar\u5305\u7684\u65f6\u5019\u6307\u5b9a\uff0c\u5982\u4e0b\u547d\u4ee4\uff1a</p> </li> </ol> <pre><code>nohup java -Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_socket,address=5005,server=y,suspend=n -jar jardemo.jar --spring.profiles.active=prod &amp;\n</code></pre> <ol> <li>\u542f\u52a8\u4e4b\u540e\u542f\u52a8IDEA\u914d\u7f6e\u7684remote\uff0c\u770b\u5230\u5982\u4e0b\u56fe\uff0c\u5373\u5df2\u7ecf\u5f00\u542f\u76d1\u63a7\uff0c\u8fd9\u65f6\u5019\u6253\u65ad\u70b9debug\u5c31\u53ef\u4ee5\u8fdc\u7a0b\u8c03\u8bd5\u4e86</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/Java%E8%8E%B7%E5%8F%96%E7%9C%9F%E5%AE%9Eip%E5%9C%B0%E5%9D%80/","title":"\u83b7\u53d6\u672c\u5730ip","text":"<p>\u5728\u5b9e\u9645\u9879\u76ee\u4e2d\uff0c\u6709\u8c03\u7528\u5fae\u4fe1\u652f\u4ed8\u5b8c\u6210\u652f\u4ed8\u529f\u80fd\uff0c\u5728\u5fae\u4fe1\u652f\u4ed8\u7684\u8bf7\u6c42\u53c2\u6570\u4e2d\u9700\u8981\u4f20\u9012\u4e00\u4e2a\u672c\u673a\u7684ip\u5730\u5740\uff0cjava\u4ee3\u7801\u8fd0\u884c\u73af\u5883\u76ee\u524d\u4e3awindows10\u4ee5\u53cacentos7</p> <pre><code>package com.dq.schooldomain.utils;\n\nimport java.net.InetAddress;\nimport java.net.NetworkInterface;\nimport java.net.UnknownHostException;\nimport java.util.Enumeration;\n\n/**\n * @Author Allen.Lv\n * @Description //TODO\n * @Date 9:50 2019/4/11\n * @Desc: Coding Happy!\n **/\npublic class IpAddress {\n    public static InetAddress getLocalHostLANAddress() throws UnknownHostException {\n        try {\n            InetAddress candidateAddress = null;\n            // \u904d\u5386\u6240\u6709\u7684\u7f51\u7edc\u63a5\u53e3\n            for (Enumeration ifaces = NetworkInterface.getNetworkInterfaces(); ifaces.hasMoreElements(); ) {\n                NetworkInterface iface = (NetworkInterface) ifaces.nextElement();\n                // \u5728\u6240\u6709\u7684\u63a5\u53e3\u4e0b\u518d\u904d\u5386IP\n                for (Enumeration inetAddrs = iface.getInetAddresses(); inetAddrs.hasMoreElements(); ) {\n                    InetAddress inetAddr = (InetAddress) inetAddrs.nextElement();\n                    if (!inetAddr.isLoopbackAddress()) {// \u6392\u9664loopback\u7c7b\u578b\u5730\u5740\n                        if (inetAddr.isSiteLocalAddress()) {\n                            // \u5982\u679c\u662fsite-local\u5730\u5740\uff0c\u5c31\u662f\u5b83\u4e86\n                            return inetAddr;\n                        } else if (candidateAddress == null) {\n                            // site-local\u7c7b\u578b\u7684\u5730\u5740\u672a\u88ab\u53d1\u73b0\uff0c\u5148\u8bb0\u5f55\u5019\u9009\u5730\u5740\n                            candidateAddress = inetAddr;\n                        }\n                    }\n                }\n            }\n            if (candidateAddress != null) {\n                return candidateAddress;\n            }\n            // \u5982\u679c\u6ca1\u6709\u53d1\u73b0 non-loopback\u5730\u5740.\u53ea\u80fd\u7528\u6700\u6b21\u9009\u7684\u65b9\u6848\n            InetAddress jdkSuppliedAddress = InetAddress.getLocalHost();\n            if (jdkSuppliedAddress == null) {\n                throw new UnknownHostException(\"The JDK InetAddress.getLocalHost() method unexpectedly returned null.\");\n            }\n            return jdkSuppliedAddress;\n        } catch (Exception e) {\n            UnknownHostException unknownHostException = new UnknownHostException(\n                    \"Failed to determine LAN address: \" + e);\n            unknownHostException.initCause(e);\n            throw unknownHostException;\n        }\n    }\n}\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/Jenkins%E8%84%9A%E6%9C%AC%E5%AE%9E%E4%BE%8B/","title":"Jenkins\u811a\u672c\u793a\u4f8b","text":"<p>sehll\u811a\u672c</p> <pre><code>#!/bin/bash\n#\u8fd9\u91cc\u53ef\u66ff\u6362\u4e3a\u4f60\u81ea\u5df1\u7684\u6267\u884c\u7a0b\u5e8f\uff0c\u5176\u4ed6\u4ee3\u7801\u65e0\u9700\u66f4\u6539\nexport JAVA_HOME=/usr/src/java/jdk1.8.0_201\nAPP_NAME=school-rest-1.0.0-SNAPSHOT.jar\nFULL_PATH=/usr/data/school-rest/school-rest-1.0.0-SNAPSHOT.jar\n#\u542f\u52a8\u65b9\u6cd5\nstart(){\n    pid=`ps -ef|grep $APP_NAME|grep -v grep|awk '{print $2}'`\n          if [ \"$pid\" ]; then\n        echo \"$APP_NAME is already running. pid=$pid .\"\n    else\n        nohup $JAVA_HOME/bin/java -jar $FULL_PATH --spring.profiles.active=dev &gt;&gt; catalina.out 2&gt;&amp;1 &amp;\n                echo $!\n        echo \"$APP_NAME now is running\"\n    fi\n}\n#\u505c\u6b62\u65b9\u6cd5\nstop(){\n    pid=`ps -ef|grep $APP_NAME|grep -v grep|awk '{print $2}'`\n    if [ \"$pid\" ]; then\n        kill -9 $pid\n        echo \"Pid:$pid stopped\"\n    else\n        echo \"$APP_NAME is not running\"\n    fi\n}\n#\u8f93\u51fa\u8fd0\u884c\u72b6\u6001\nstatus(){\n    pid=`ps -ef|grep $APP_NAME|grep -v grep|awk '{print $2}'`\n    if [ \"$pid\" ]; then\n        echo \"$APP_NAME is running. Pid is ${pid}\"\n    else\n        echo \"$APP_NAME is NOT running.\"\n    fi\n}\n#\u6839\u636e\u8f93\u5165\u53c2\u6570\uff0c\u9009\u62e9\u6267\u884c\u5bf9\u5e94\u65b9\u6cd5\uff0c\u4e0d\u8f93\u5165\u5219\u6267\u884c\u4f7f\u7528\u8bf4\u660e\ncase \"$1\" in\n    start)\n        start\n        ;;\n    stop)\n        stop\n        ;;\n    status)\n        status\n        ;;\n    restart)\n        stop\n        sleep 5\n        start\n        ;;\n    *)\n        echo \"Usage:{start|stop|status|restart}\"\n        ;;\nesac\nexit 0\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/MybatisPlus%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90/","title":"MybatisPlus\u591a\u6570\u636e\u6e90","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/MybatisPlus%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90/#mybatis-plus","title":"mybatis-plus\u914d\u7f6e\u591a\u6570\u636e","text":"<ul> <li>mybatis-plus+druid\u4e3a\u4e00\u79cd\u914d\u7f6e\u65b9\u5f0f</li> <li>mybatis-plus\u5b98\u65b9\u63d0\u4f9b\u4e00\u79cd\u914d\u7f6e\u65b9\u5f0f</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/MybatisPlus%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90/#mybatis-plus_1","title":"mybatis-plus\u5b98\u65b9\u63d0\u4f9b\u7684\u591a\u6570\u636e\u6e90\u914d\u7f6e\u65b9\u5f0f","text":"<p>dynamic-datasource-spring-boot-starter \u662f\u4e00\u4e2a\u57fa\u4e8espringboot\u7684\u5feb\u901f\u96c6\u6210\u591a\u6570\u636e\u6e90\u7684\u542f\u52a8\u5668\u3002\u5176\u652f\u6301 Jdk 1.7+, SpringBoot 1.4.x 1.5.x 2.x.x\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/MybatisPlus%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90/#_1","title":"\u4f7f\u7528\u65b9\u6cd5","text":"<ol> <li>\u5f15\u5165dynamic-datasource-spring-boot-starter <pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;com.baomidou&lt;/groupId&gt;\n  &lt;artifactId&gt;dynamic-datasource-spring-boot-starter&lt;/artifactId&gt;\n  &lt;version&gt;${version}&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre></li> <li>\u914d\u7f6e\u6570\u636e\u6e90 <pre><code>spring:\n  datasource:\n    dynamic:\n      primary: master #\u8bbe\u7f6e\u9ed8\u8ba4\u7684\u6570\u636e\u6e90\u6216\u8005\u6570\u636e\u6e90\u7ec4,\u9ed8\u8ba4\u503c\u5373\u4e3amaster\n      strict: false #\u8bbe\u7f6e\u4e25\u683c\u6a21\u5f0f,\u9ed8\u8ba4false\u4e0d\u542f\u52a8. \u542f\u52a8\u540e\u5728\u672a\u5339\u914d\u5230\u6307\u5b9a\u6570\u636e\u6e90\u65f6\u5019\u4f1a\u629b\u51fa\u5f02\u5e38,\u4e0d\u542f\u52a8\u5219\u4f7f\u7528\u9ed8\u8ba4\u6570\u636e\u6e90.\n      datasource:\n        master:\n          url: jdbc:mysql://xx.xx.xx.xx:3306/dynamic\n          username: root\n          password: 123456\n          driver-class-name: com.mysql.jdbc.Driver # 3.2.0\u5f00\u59cb\u652f\u6301SPI\u53ef\u7701\u7565\u6b64\u914d\u7f6e\n        slave_1:\n          url: jdbc:mysql://xx.xx.xx.xx:3307/dynamic\n          username: root\n          password: 123456\n          driver-class-name: com.mysql.jdbc.Driver\n        slave_2:\n          url: ENC(xxxxx) # \u5185\u7f6e\u52a0\u5bc6,\u4f7f\u7528\u8bf7\u67e5\u770b\u8be6\u7ec6\u6587\u6863\n          username: ENC(xxxxx)\n          password: ENC(xxxxx)\n          driver-class-name: com.mysql.jdbc.Driver\n          schema: db/schema.sql # \u914d\u7f6e\u5219\u751f\u6548,\u81ea\u52a8\u521d\u59cb\u5316\u8868\u7ed3\u6784\n          data: db/data.sql # \u914d\u7f6e\u5219\u751f\u6548,\u81ea\u52a8\u521d\u59cb\u5316\u6570\u636e\n          continue-on-error: true # \u9ed8\u8ba4true,\u521d\u59cb\u5316\u5931\u8d25\u662f\u5426\u7ee7\u7eed\n          separator: \";\" # sql\u9ed8\u8ba4\u5206\u53f7\u5206\u9694\u7b26\n\n       #......\u7701\u7565\n       #\u4ee5\u4e0a\u4f1a\u914d\u7f6e\u4e00\u4e2a\u9ed8\u8ba4\u5e93master\uff0c\u4e00\u4e2a\u7ec4slave\u4e0b\u6709\u4e24\u4e2a\u5b50\u5e93slave_1,slave_2\n</code></pre></li> </ol> <pre><code># \u591a\u4e3b\u591a\u4ece                      \u7eaf\u7cb9\u591a\u5e93\uff08\u8bb0\u5f97\u8bbe\u7f6eprimary\uff09                   \u6df7\u5408\u914d\u7f6e\nspring:                               spring:                               spring:\n  datasource:                           datasource:                           datasource:\n    dynamic:                              dynamic:                              dynamic:\n      datasource:                           datasource:                           datasource:\n        master_1:                             mysql:                                master:\n        master_2:                             oracle:                               slave_1:\n        slave_1:                              sqlserver:                            slave_2:\n        slave_2:                              postgresql:                           oracle_1:\n        slave_3:                              h2:                                   oracle_2:\n</code></pre> <ol> <li>\u4f7f\u7528 @DS \u5207\u6362\u6570\u636e\u6e90 @DS \u53ef\u4ee5\u6ce8\u89e3\u5728\u65b9\u6cd5\u4e0a\u6216\u7c7b\u4e0a\uff0c\u540c\u65f6\u5b58\u5728\u5c31\u8fd1\u539f\u5219 \u65b9\u6cd5\u4e0a\u6ce8\u89e3 \u4f18\u5148\u4e8e \u7c7b\u4e0a\u6ce8\u89e3\u3002 \u6ca1\u6709\u4f7f\u7528@DS\uff0c\u4f7f\u7528\u9ed8\u8ba4\u6570\u636e\u6e90\uff1b@DS\u53ef\u4ee5\u76f4\u63a5\u6307\u5b9a\u5e93\u540d\u3002 <pre><code>@Service\n@DS(\"slave\")\npublic class UserServiceImpl implements UserService {\n\n  @Autowired\n  private JdbcTemplate jdbcTemplate;\n\n  public List selectAll() {\n    return  jdbcTemplate.queryForList(\"select * from user\");\n  }\n\n  @Override\n  @DS(\"slave_1\")\n  public List selectByCondition() {\n    return  jdbcTemplate.queryForList(\"select * from user where age &gt;10\");\n  }\n}\n</code></pre></li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/MybatisPlus%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90/#mybatis-plusdruid","title":"mybatis-plus+druid\u914d\u7f6e","text":"<p>\u4f7f\u7528druid\u6ce8\u5165\u591a\u6570\u636e\u6e90 1. yml\u4e2d\u914d\u7f6e\u591a\u6570\u636e\u6e90\u4fe1\u606f <pre><code>spring:\n  datasource:\n    druid:\n      datasource1:\n        url: jdbc:mysql://127.0.0.1:3306/db1?serverTimezone=CTT&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=true\n        username: root\n        password: 123456\n        driver-class-name: com.mysql.cj.jdbc.Driver\n      datasource2:\n        url: jdbc:mysql://127.0.0.1:3306/db2?serverTimezone=CTT&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=true\n        username: root\n        password: 123456\n        driver-class-name: com.mysql.cj.jdbc.Driver\n      datasource3:\n        url: jdbc:mysql://127.0.0.1:3306/db3?serverTimezone=CTT&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=true\n        username: root\n        password: 123456\n        driver-class-name: com.mysql.cj.jdbc.Driver\n</code></pre></p> <ol> <li>\u65b0\u589e<code>MybatisPlusConfig.java</code>\u6587\u4ef6</li> </ol> <p><pre><code>@EnableTransactionManagement\n@Configuration\n@MapperScan(\"com.dadi01.scrm.service.member.provider.mapper.db*.*\")\npublic class MybatisPlusConfig {\n\n    /**\n     * \u5206\u9875\n     */\n    @Bean\n    public PaginationInterceptor paginationInterceptor() {\n        return new PaginationInterceptor();\n    }\n\n    @Bean(name = \"db1\")\n    @ConfigurationProperties(prefix = \"spring.datasource.druid.datasource1\")\n    public DataSource db1() {\n        return DruidDataSourceBuilder.create().build();\n    }\n\n    @Bean(name = \"db2\")\n    @ConfigurationProperties(prefix = \"spring.datasource.druid.datasource2\")\n    public DataSource db2() {\n        return DruidDataSourceBuilder.create().build();\n    }\n\n    @Bean(name = \"db3\")\n    @ConfigurationProperties(prefix = \"spring.datasource.druid.datasource3\")\n    public DataSource db3() {\n        return DruidDataSourceBuilder.create().build();\n    }\n\n    /**\n     * \u52a8\u6001\u6570\u636e\u6e90\u914d\u7f6e\n     *\n     * @return\n     */\n    @Bean\n    @Primary\n    public DataSource multipleDataSource(@Qualifier(\"db1\") DataSource db1,\n                                         @Qualifier(\"db2\") DataSource db2,\n                                         @Qualifier(\"db3\") DataSource db3) {\n        DynamicDataSource dynamicDataSource = new DynamicDataSource();\n        Map&lt;Object, Object&gt; targetDataSources = new HashMap&lt;&gt;();\n        targetDataSources.put(DBTypeEnum.db1.getValue(), db1);\n        targetDataSources.put(DBTypeEnum.db2.getValue(), db2);\n        targetDataSources.put(DBTypeEnum.db3.getValue(), db3);\n        dynamicDataSource.setTargetDataSources(targetDataSources);\n        dynamicDataSource.setDefaultTargetDataSource(db2);\n        return dynamicDataSource;\n    }\n\n    @Bean(\"sqlSessionFactory\")\n    public SqlSessionFactory sqlSessionFactory() throws Exception {\n        MybatisSqlSessionFactoryBean sqlSessionFactory = new MybatisSqlSessionFactoryBean();\n        sqlSessionFactory.setDataSource(multipleDataSource(db1(), db2(), db3()));\n        MybatisConfiguration configuration = new MybatisConfiguration();\n        configuration.setJdbcTypeForNull(JdbcType.NULL);\n        configuration.setMapUnderscoreToCamelCase(true);\n        configuration.setCacheEnabled(false);\n        sqlSessionFactory.setConfiguration(configuration);\n        //PerformanceInterceptor(),OptimisticLockerInterceptor()\n        //\u6dfb\u52a0\u5206\u9875\u529f\u80fd\n        sqlSessionFactory.setPlugins(new Interceptor[]{\n                paginationInterceptor()\n        });\n        return sqlSessionFactory.getObject();\n    }\n}\n</code></pre> 3. \u65b0\u589e\u6570\u636e\u6e90\u5207\u6362\u62e6\u622a\u5668<code>DataSourceSwitchAspect.java</code></p> <pre><code>import com.dadi01.scrm.service.member.provider.util.DBTypeEnum;\nimport lombok.extern.slf4j.Slf4j;\nimport org.aspectj.lang.annotation.Aspect;\nimport org.aspectj.lang.annotation.Before;\nimport org.aspectj.lang.annotation.Pointcut;\nimport org.springframework.core.annotation.Order;\nimport org.springframework.stereotype.Component;\n\n@Component\n@Order(value = -100)\n@Slf4j\n@Aspect\npublic class DataSourceSwitchAspect {\n    @Pointcut(\"execution(* com.dadi01.scrm.service.member.provider.mapper.db1..*.*(..))\")\n    private void db1Aspect() {\n    }\n\n    @Pointcut(\"execution(* com.dadi01.scrm.service.member.provider.mapper.db2..*.*(..))\")\n    private void db2Aspect() {\n    }\n\n    @Pointcut(\"execution(* com.dadi01.scrm.service.member.provider.mapper.db3..*.*(..))\")\n    private void db3Aspect() {\n    }\n\n    @Before(\"db1Aspect()\")\n    public void db1() {\n        log.info(\"\u5207\u6362\u5230db1 \u6570\u636e\u6e90...\");\n        DbContextHolder.setDbType(DBTypeEnum.db1);\n    }\n\n    @Before(\"db2Aspect()\")\n    public void db2() {\n        log.info(\"\u5207\u6362\u5230db2 \u6570\u636e\u6e90...\");\n        DbContextHolder.setDbType(DBTypeEnum.db2);\n    }\n\n    @Before(\"db3Aspect()\")\n    public void db3() {\n        log.info(\"\u5207\u6362\u5230db3 \u6570\u636e\u6e90...\");\n        DbContextHolder.setDbType(DBTypeEnum.db3);\n    }\n}\n</code></pre> <ol> <li>\u8bbe\u7f6e\u4e0a\u4e0b\u6587\u6570\u636e\u6e90<code>DbContextHolder.java</code></li> </ol> <pre><code>import com.dadi01.scrm.service.member.provider.util.DBTypeEnum;\npublic class DbContextHolder {\n    private static final ThreadLocal contextHolder = new ThreadLocal&lt;&gt;();\n    /**\n     * \u8bbe\u7f6e\u6570\u636e\u6e90\n     * @param dbTypeEnum\n     */\n    public static void setDbType(DBTypeEnum dbTypeEnum) {\n        contextHolder.set(dbTypeEnum.getValue());\n    }\n\n    /**\n     * \u53d6\u5f97\u5f53\u524d\u6570\u636e\u6e90\n     * @return\n     */\n    public static String getDbType() {\n        return (String) contextHolder.get();\n    }\n\n    /**\n     * \u6e05\u9664\u4e0a\u4e0b\u6587\u6570\u636e\n     */\n    public static void clearDbType() {\n        contextHolder.remove();\n    }\n}\n</code></pre> <ol> <li>\u5b9e\u73b0\u6570\u636e\u6e90\u5207\u6362<code>DynamicDataSource.java</code></li> </ol> <p><pre><code>import org.springframework.jdbc.datasource.lookup.AbstractRoutingDataSource;\n\npublic class DynamicDataSource extends AbstractRoutingDataSource {\n    @Override\n    protected Object determineCurrentLookupKey() {\n        return  DbContextHolder.getDbType();\n    }\n}\n</code></pre> 6. \u591a\u6570\u636e\u6e90\u679a\u4e3e\u7c7b<code>DBTypeEnum.java</code></p> <pre><code>public enum DBTypeEnum {\n    db1(\"db1\"), db2(\"db2\"), db3(\"db3\");\n    private String value;\n\n    DBTypeEnum(String value) {\n        this.value = value;\n    }\n\n    public String getValue() {\n        return value;\n    }\n}\n</code></pre> <ol> <li>mapper\u5185\u6587\u4ef6\u7ed3\u6784\u4e3a <pre><code>-- mapper\n    -- db1\n        -- MemberRepository.java\n    -- db2\n        -- OrderRepository.java\n    -- db3\n        -- ShoppingRepository.java\n</code></pre></li> </ol> <p>\u53c2\u8003\uff1ahttps://baomidou.com/guide/dynamic-datasource.html#%E6%96%87%E6%A1%A3-documentation \u53c2\u8003\uff1ahttps://cloud.tencent.com/developer/article/1181415</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/Mysql%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/","title":"Mysql\u5206\u5e93\u5206\u8868","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/Mysql%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#ddyw7000","title":"DDYW\u9700\u8981\u5b58\u50a87000\u4e07+\u4f1a\u5458\u6570\u636e","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/Mysql%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#_1","title":"\u80cc\u666f","text":"<p>\u8d77\u521d\u4f1a\u5458\u6570\u636e\u7531\u6570\u636e\u4fa7\u5b58\u50a8\uff0c\u56e0\u4e3a\u4e1a\u52a1\u7684\u53d1\u5c55\uff0c\u9700\u8981\u5c06\u4f1a\u5458\u6570\u636e\u5b58\u653e\u81f3\u4e1a\u52a1\u4fa7\uff0c\u6240\u4ee5\u9700\u8981\u5e94\u7528\u6280\u672f\u65b9\u6848\u6765\u5b9e\u73b0\u4f1a\u5458\u6570\u636e\u7684\u589e\u5220\u6539\u67e5</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/Mysql%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#_2","title":"\u65b9\u6848\u8bbe\u8ba1\u9636\u6bb5","text":"<ol> <li>\u91c7\u7528\u6570\u636e\u5e93\u8bfb\u5199\u5206\u79bb\uff0c\u5199\u5e93\u64cd\u4f5c\u5728\u4e3b\u5e93\uff0c\u8bfb\u5e93\u64cd\u4f5c\u5728\u4ece\u5e93\uff08\u5f53\u6709\u5927\u91cf\u7684\u5199\u64cd\u4f5c\uff09\uff0c\u52a0\u4e00\u4e2aMaster\u4e0d\u80fd\u89e3\u51b3\u95ee\u9898\uff0c\u56e0\u4e3a\u6570\u636e\u8981\u4e00\u81f4\u6027\uff0c\u5199\u64cd\u4f5c\u9700\u89812\u4e2a\u751a\u81f3\u591a\u4e2aMaster\u4e4b\u95f4\u540c\u6b65\uff0c\u76f8\u5f53\u4e8e\u91cd\u590d</li> <li>\u8003\u91cf\u6570\u636e\u5e93\u5206\u5e93\u5206\u8868\u65b9\u6848\uff08sharding\uff09\uff0c\u5bf9\u5199\u64cd\u4f5c\u8fdb\u884c\u5207\u5206</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/Mysql%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#_3","title":"\u7b80\u5355\u7684\u8bfb\u5199\u5206\u79bb","text":"<p>mysql\u7684\u4e3b\u4ece\u590d\u5236\uff0c\u7ed3\u5c40\u4e86\u6570\u636e\u5e93\u7684\u8bfb\u5199\u5206\u79bb\uff0c\u63d0\u5347\u4e86\u8bfb\u7684\u6027\u80fd</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/Mysql%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#_4","title":"\u8bfb\u5199\u5206\u79bb\u9020\u6210\u7684\u6027\u80fd\u74f6\u9888","text":"<ol> <li>\u5199\u5165\u65e0\u6cd5\u6269\u5c55\uff0c\u9700\u8981\u6269\u5c55master</li> <li>\u5199\u5165\u65e0\u6cd5\u7f13\u5b58</li> <li>\u9501\u8868\u7387\u4e0a\u5347</li> <li>\u8868\u53d8\u5927\uff0c\u7f13\u5b58\u7387\u4e0b\u964d</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/Mysql%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#_5","title":"\u5206\u5e93\u5206\u8868","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/Mysql%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#_6","title":"\u5355\u5e93\u592a\u5927","text":"<p>\u5355\u4e2a\u6570\u636e\u5e93\u5904\u7406\u80fd\u529b\u6709\u9650\uff1b\u5355\u5e93\u6240\u5728\u670d\u52a1\u5668\u4e0a\u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3\uff1b\u5355\u5e93\u4e0a\u64cd\u4f5c\u7684IO\u74f6\u9888 \u89e3\u51b3\u65b9\u6cd5\uff1a\u5207\u5206\u6210\u66f4\u591a\u66f4\u5c0f\u7684\u5e93</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/Mysql%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#_7","title":"\u5355\u8868\u592a\u5927","text":"<p>CRUD\u90fd\u6210\u95ee\u9898\uff1b\u7d22\u5f15\u81a8\u80c0\uff0c\u67e5\u8be2\u8d85\u65f6 \u89e3\u51b3\u65b9\u6cd5\uff1a\u5207\u5206\u6210\u591a\u4e2a\u6570\u636e\u96c6\u66f4\u5c0f\u7684\u8868\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/Mysql%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#_8","title":"\u5206\u5e93\u5206\u8868\u65b9\u5f0f","text":"<p>\u5206\u5e93\u5206\u8868\u7684\u987a\u5e8f\u5e94\u8be5\u662f\u5148\u5782\u76f4\u5206\uff0c\u540e\u6c34\u5e73\u5206 - \u5782\u76f4\u62c6\u5206     1. \u5782\u76f4\u5206\u8868         - \u5927\u8868\u62c6\u5c0f\u8868\uff0c\u57fa\u4e8e\u5217\u5b57\u6bb5\uff0c\u5c06\u4e0d\u5e38\u7528\u7684\uff0c\u6570\u636e\u8f83\u5927\uff0c\u957f\u5ea6\u8f83\u957f\u7684\u5b57\u6bb5\u62c6\u5206\u5230\u6269\u5c55\u8868\uff0c\u4e00\u822c\u9488\u5bf9\u51e0\u767e\u5217\u7684\u5927\u8868\u3002     2. \u5782\u76f4\u5206\u5e93         - \u4e00\u4e2a\u7cfb\u7edf\u4e2d\u4e0d\u540c\u4e1a\u52a1\u8fdb\u884c\u62c6\u5206\uff0c\u6bd4\u5982user\u5e93\uff0cproduct\u5e93\uff0corder\u5e93\uff0c\u5207\u5206\u653e\u5728\u591a\u4e2a\u670d\u52a1\u5668\u4e0a\uff0c\u800c\u4e0d\u662f\u540c\u4e00\u4e2a\u670d\u52a1\u5668\u3002\u5355\u6570\u636e\u670d\u52a1\u5668\u4e0a\u7684\u6027\u80fd\u74f6\u9888\u4f1a\u5c06\u7528\u6237\u8ba2\u5355\u7684crud\u4f1a\u8ba9\u5f53\u4e2a\u670d\u52a1\u5668\u7684\u78c1\u76d8\u7a7a\u95f4\uff0c\u5185\u5b58\uff0ctps\u7b49\u8d44\u6e90\u4e0d\u8db3\u3002\u9ad8\u5e76\u53d1\u573a\u666f\u4e0b\uff0c\u5782\u76f4\u5206\u5e93\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u80fd\u591f\u7a81\u7834IO,\u8fde\u63a5\u6570\u53ca\u5355\u673a\u786c\u4ef6\u8d44\u6e90\u7684\u74f6\u9888 - \u6c34\u5e73\u62c6\u5206     1. \u6c34\u5e73\u5206\u8868         - \u9488\u5bf9\u6570\u636e\u91cf\u5de8\u5927\u7684\u5355\u5f20\u8868\uff0c\u6309\u7167\u67d0\u79cd\u89c4\u5219\uff08hash\uff0crange\u7b49\uff09\uff0c\u5207\u5206\u5230\u591a\u5f20\u8868\uff0c\u4f46\u662f\u8868\u4ecd\u7136\u5728\u540c\u4e00\u4e2a\u5e93\uff0c\u6240\u4ee5\u5e93\u7ea7\u522b\u7684\u64cd\u4f5c\u8fd8\u662fIO\u74f6\u9888     2. \u6c34\u5e73\u5206\u5e93\u5206\u8868         - \u5c06\u5355\u5f20\u8868\u6570\u636e\u5207\u5206\u5230\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\uff0c\u6bcf\u4e2a\u670d\u52a1\u5668\u6709\u76f8\u5e94\u7684\u5e93\u8868\uff0c\u80fd\u591f\u6709\u6548\u7f13\u89e3\u5355\u673a\u548c\u5355\u5e93\u7684\u6027\u80fd\u74f6\u9888\u548c\u538b\u529b     3. \u6c34\u5e73\u5206\u5e93\u5206\u8868\u5207\u5206\u89c4\u5219         - range:\u4ece0-10000\u4e00\u4e2a\u8868\uff0c10001-20000\u4e00\u4e2a\u8868         - Hash\u53d6\u6a21\uff1a\u5c06\u7528\u6237\uff0c\u8ba2\u5355\u4f5c\u4e3a\u4e3b\u8868\uff0c\u7136\u540e\u5c06\u548c\u5b83\u4eec\u76f8\u5173\u7684\u4f5c\u4e3a\u9644\u8868\uff0c\u8fd9\u6837\u4e0d\u4f1a\u9020\u6210\u8de8\u5e93\u4e8b\u52a1\u4e4b\u7c7b\u7684\u95ee\u9898\u3002\u53d6\u7528\u6237id\uff0c\u7136\u540ehash\u53d6\u6a21\uff0c\u5206\u914d\u5230\u4e0d\u540c\u7684\u6570\u636e\u5e93\u4e0a         - \u5730\u7406\u533a\u57df\uff1a\u6309\u7167\u534e\u4e1c\u3001\u534e\u5357\u3001\u534e\u5317\u8fd9\u6837\u6765\u533a\u5206         - \u65f6\u95f4\uff1a\u6309\u7167\u65f6\u95f4\u5207\u5206\uff0c\u4e00\u5e74\u524d\u6570\u636e\u5207\u5206\u653e\u5230\u53e6\u5916\u7684\u8868\uff0c\u51b7\u70ed\u6570\u636e\u5206\u79bb</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/Mysql%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#_9","title":"\u5206\u5e93\u5206\u8868\u4ea7\u751f\u7684\u95ee\u9898","text":"<ol> <li>\u7ef4\u5ea6\u95ee\u9898     \u5047\u5982\u7528\u6237\u8d2d\u4e70\u5546\u54c1A,\u9700\u8981\u4fdd\u5b58\u4ea4\u6613\u8bb0\u5f55\uff0c\u5982\u679c\u6309\u7167\u7528\u6237\u7ef4\u5ea6\u62c6\u5206\uff0c\u5219\u6bcf\u4e2a\u7528\u6237\u4ea4\u6613\u8bb0\u5f55\u90fd\u5728\u540c\u4e00\u4e2a\u8868\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f88\u5feb\u67e5\u8be2\u67d0\u4e2a\u7528\u6237\u7ef4\u5ea6\u7684\u4ea4\u6613\u8bb0\u5f55\uff1b\u4f46\u662f\u8981\u67e5\u67d0\u4ef6\u5546\u54c1\u7684\u88ab\u8d2d\u4e70\u60c5\u51b5\uff0c\u5219\u6bd4\u8f83\u9ebb\u70e6\u3002\u5e38\u89c1\u89e3\u51b3\u65b9\u6848\uff1a1.\u8bb0\u5f55\u4e24\u4efd\u6570\u636e\uff0c\u4e00\u4efd\u6309\u7528\u6237\u7ef4\u5ea6\uff0c\u4e00\u4efd\u6309\u5546\u54c1\u7ef4\u5ea6\u30022.\u641c\u7d22\u5f15\u64ce</li> <li>\u8054\u5408\u67e5\u8be2\u95ee\u9898     \u57fa\u672c\u4e0d\u53ef\u80fd\uff0c\u56e0\u4e3a\u5173\u8054\u8868\u53ef\u80fd\u4e0d\u5728\u540c\u4e00\u4e2a\u5e93</li> <li>\u907f\u514d\u8de8\u5e93\u4e8b\u52a1\uff0c\u907f\u514d\u5728\u4fee\u6539db1\u7684\u65f6\u5019\u540c\u6b65\u4fee\u6539db2\u7684\u64cd\u4f5c\uff0c\u6548\u7387\u4f1a\u6709\u5f71\u54cd</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/Mysql%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/#_10","title":"\u5206\u5e93\u5206\u8868\u591a\u5c11\u5408\u9002","text":"<p>\u5355\u88681000\u4e07\u6761\u8bb0\u5f55\u4e00\u4e0b,\u5199\u5165\u8bfb\u53d6\u6027\u80fd\u662f\u6bd4\u8f83\u597d\u7684.\u8fd9\u6837\u5728\u7559\u70b9buffer,\u90a3\u4e48\u5355\u8868\u5168\u662f\u6570\u636e\u5b57\u578b\u7684\u4fdd\u6301\u5728800\u4e07\u6761\u8bb0\u5f55\u4ee5\u4e0b, \u6709\u5b57\u7b26\u578b\u7684\u5355\u8868\u4fdd\u6301\u5728500\u4e07\u4ee5\u4e0b\u3002 \u5982\u679c\u6309 100\u5e93100\u8868\u6765\u89c4\u5212,\u5982\u7528\u6237\u4e1a\u52a1:500\u4e07100100 = 50000000\u4e07 = 5000\u4ebf\u8bb0\u5f55</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/OAuth2.0%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E8%B0%83%E7%A0%94/","title":"OAuth2.0\u6388\u6743\u767b\u5f55\u8c03\u7814","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/OAuth2.0%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E8%B0%83%E7%A0%94/#oauth2","title":"oauth2\u6388\u6743\u767b\u5f55","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/OAuth2.0%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E8%B0%83%E7%A0%94/#oauth","title":"Oauth\u662f\u4ec0\u4e48","text":"<p>OAuth \u5f15\u5165\u4e86\u4e00\u4e2a\u6388\u6743\u5c42\uff0c\u7528\u6765\u5206\u79bb\u4e24\u79cd\u4e0d\u540c\u7684\u89d2\u8272\uff1a\u5ba2\u6237\u7aef\u548c\u8d44\u6e90\u6240\u6709\u8005\u3002......\u8d44\u6e90\u6240\u6709\u8005\u540c\u610f\u4ee5\u540e\uff0c\u8d44\u6e90\u670d\u52a1\u5668\u53ef\u4ee5\u5411\u5ba2\u6237\u7aef\u9881\u53d1\u4ee4\u724c\u3002\u5ba2\u6237\u7aef\u901a\u8fc7\u4ee4\u724c\uff0c\u53bb\u8bf7\u6c42\u6570\u636e\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/OAuth2.0%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E8%B0%83%E7%A0%94/#oauth_1","title":"Oauth\u5b9a\u4e49\u4e86\u56db\u79cd\u89d2\u8272","text":"<ul> <li>client,\u8fd9\u91cc\u7684\u201c\u5ba2\u6237\u7aef\"\u4e0d\u5305\u542b\u4efb\u4f55\u7279\u5b9a\u7684\u5b9e\u73b0\u7279\u6027,\u6bd4\u5982\u8fb0\u661f\u5c31\u662f\u4e00\u4e2a\u5ba2\u6237\u7aef.</li> <li>resource owner \u8d44\u6e90\u62e5\u6709\u8005\uff0c\u77e5\u84dd\u8ba4\u8bc1. \u6b64\u65f6\u4f60\u5c31\u662f\u8d44\u6e90\u62e5\u6709\u8005.</li> <li>authorization server \u6388\u6743\u670d\u52a1\u5668\uff0c\u6211\u4eec\u63d0\u4f9b\u7684\u767b\u5f55\u6388\u6743\u670d\u52a1\u5668</li> <li>resource server \u8d44\u6e90\u670d\u52a1\u5668, \u5f53\u4f60\u70b9\u51fb\u540c\u610f\u6388\u6743\u4e4b\u540e\uff0c\u8d44\u6e90\u670d\u52a1\u5668\u4f1a\u5c06\u4f60\u7684\u4fe1\u606f\u53d1\u5f80client.</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/OAuth2.0%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E8%B0%83%E7%A0%94/#oauth_2","title":"Oauth\u63d0\u4f9b\u56db\u79cd\u83b7\u5f97\u4ee4\u724c\u7684\u6d41\u7a0b\uff0c\u5411\u7b2c\u4e09\u65b9\u5e94\u7528\u9881\u5e03","text":"<ul> <li>\u6388\u6743\u7801\uff08authorization-code\uff09</li> <li>\u9690\u85cf\u5f0f\uff08implicit\uff09</li> <li>\u5bc6\u7801\u5f0f\uff08resource owner password credentials\uff09</li> <li>\u5ba2\u6237\u7aef\u51ed\u8bc1\uff08client credentials\uff09</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/OAuth2.0%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E8%B0%83%E7%A0%94/#_1","title":"\u56db\u79cd\u6a21\u5f0f\u4e0d\u540c\u7684\u5e94\u7528\u573a\u666f","text":"<ul> <li>\u6388\u6743\u7801\uff08authorization code\uff09\u65b9\u5f0f\uff0c\u6307\u7684\u662f\u7b2c\u4e09\u65b9\u5e94\u7528\u5148\u7533\u8bf7\u4e00\u4e2a\u6388\u6743\u7801\uff0c\u7136\u540e\u518d\u7528\u8be5\u7801\u83b7\u53d6\u4ee4\u724c\uff0c\u6700\u5e38\u7528\u7684\u6d41\u7a0b\uff0c\u5b89\u5168\u6027\u4e5f\u6700\u9ad8\uff0c\u5b83\u9002\u7528\u4e8e\u90a3\u4e9b\u6709\u540e\u7aef\u7684Web\u5e94\u7528\uff0c\u6388\u6743\u7801\u901a\u8fc7\u524d\u7aef\u4f20\u9001\uff0c\u4ee4\u724c\u5219\u662f\u50a8\u5b58\u5728\u540e\u7aef\uff0c\u800c\u4e14\u6240\u6709\u4e0e\u8d44\u6e90\u670d\u52a1\u5668\u7684\u901a\u4fe1\u90fd\u5728\u540e\u7aef\u5b8c\u6210\u3002\u8fd9\u6837\u7684\u524d\u540e\u7aef\u5206\u79bb\uff0c\u53ef\u4ee5\u907f\u514d\u4ee4\u724c\u6cc4\u6f0f</li> <li>\u9690\u85cf\u5f0f\uff0c\u6709\u4e9b Web \u5e94\u7528\u662f\u7eaf\u524d\u7aef\u5e94\u7528\uff0c\u6ca1\u6709\u540e\u7aef\u3002\u8fd9\u65f6\u5c31\u4e0d\u80fd\u7528\u4e0a\u9762\u7684\u65b9\u5f0f\u4e86\uff0c\u5fc5\u987b\u5c06\u4ee4\u724c\u50a8\u5b58\u5728\u524d\u7aef\u3002RFC 6749 \u5c31\u89c4\u5b9a\u4e86\u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff0c\u5141\u8bb8\u76f4\u63a5\u5411\u524d\u7aef\u9881\u53d1\u4ee4\u724c\u3002\u8fd9\u79cd\u65b9\u5f0f\u6ca1\u6709\u6388\u6743\u7801\u8fd9\u4e2a\u4e2d\u95f4\u6b65\u9aa4\uff0c\u6240\u4ee5\u79f0\u4e3a\uff08\u6388\u6743\u7801\uff09\"\u9690\u85cf\u5f0f\"\uff08implicit\uff09</li> <li>\u5bc6\u7801\u5f0f\uff0c\u5982\u679c\u4f60\u9ad8\u5ea6\u4fe1\u4efb\u67d0\u4e2a\u5e94\u7528\uff0cRFC6749\u4e5f\u5141\u8bb8\u7528\u6237\u628a\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u76f4\u63a5\u544a\u8bc9\u8be5\u5e94\u7528\u3002\u8be5\u5e94\u7528\u5c31\u4f7f\u7528\u4f60\u7684\u5bc6\u7801\uff0c\u7533\u8bf7\u4ee4\u724c\uff0c\u8fd9\u79cd\u65b9\u5f0f\u79f0\u4e3a\"\u5bc6\u7801\u5f0f\"\uff08password\uff09</li> <li>\u51ed\u8bc1\u5f0f\uff0c\u9002\u7528\u4e8e\u6ca1\u6709\u524d\u7aef\u7684\u547d\u4ee4\u884c\u5e94\u7528\uff0c\u5373\u5728\u547d\u4ee4\u884c\u4e0b\u8bf7\u6c42\u4ee4\u724c</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/OAuth2.0%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E8%B0%83%E7%A0%94/#_2","title":"\u6388\u6743\u7801\u6a21\u5f0f","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/OAuth2.0%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E8%B0%83%E7%A0%94/#_3","title":"\u8bf7\u6c42\u53c2\u6570","text":"<ul> <li>response_type(\u5fc5\u987b\u643a\u5e26)\uff0c\u5728\u6388\u6743\u7801\u6a21\u5f0f\u4e2dresponse_type\u7684\u53c2\u6570\u503c\u5fc5\u987b\u4e3a\"code\".(\u4e3a\u4e86\u533a\u5206\u548c\u5176\u4ed6\u4e09\u79cd\u8bf7\u6c42\u6a21\u5f0f\u7684\u533a\u522b, \u800c\u4e14\u4ece\u5b57\u9762\u4e0a\u4e5f\u65b9\u4fbf\u7406\u89e3, \"code\" \u610f\u601d\u662f\u5148\u62ff\u5230\u6388\u6743\u7801\u5728\u62fftoken)</li> <li>client_id(\u5fc5\u987b\u643a\u5e26)\uff0c\u5ba2\u6237\u7aef\u6807\u8bc6\u7b26</li> <li>redirect_uri(\u53ef\u9009\u53c2\u6570)\uff0c\u8868\u793a\u91cd\u5b9a\u5411\u7684uri(\u53ef\u4ee5\u7406\u89e3\u4e3a\u5f53\u6388\u6743\u670d\u52a1\u5668\u8fd4\u56decode\u65f6\u7684\u8fd4\u56de\u5730\u5740)</li> <li>scope(\u53ef\u9009\u53c2\u6570)\uff0c\u8868\u793a\u7533\u8bf7\u6743\u9650\u7684\u8303\u56f4</li> <li>state(\u63a8\u8350\u53c2\u6570)\uff0cstate\u53c2\u6570\u901a\u5e38\u662f\u4e00\u4e2a\u5ba2\u6237\u7aef\u968f\u673a\u503c\uff0c\u53d1\u9001\u7ed9\u6388\u6743\u670d\u52a1\u5668,\u6388\u6743\u670d\u52a1\u5668\u5728\u539f\u5c01\u4e0d\u52a8\u7684\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002\u8fd9\u6837\u505a\u662f\u4e3a\u4e86\u9884\u9632CSRF\u653b\u51fb\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/OAuth2.0%E6%8E%88%E6%9D%83%E7%99%BB%E5%BD%95%E8%B0%83%E7%A0%94/#_4","title":"\u63a5\u53e3\u8bbe\u8ba1","text":"<ul> <li>\u7b2c\u4e00\u6b65\uff1a\u83b7\u53d6code\uff1a eg\uff1aoauthServer+\"/oauth/authorize?client_id=\"+clientId+\"&amp;response_type=code&amp;redirect_uri=\"+redirectUrl+\"&amp;scope=all\" \u5982\u679c\u6ca1\u6709\u767b\u5f55\uff0c\u5219\u4f1a\u8df3\u8f6c\u5230\u7edf\u4e00\u8eab\u4efd\u8ba4\u8bc1\u767b\u5f55\u9875\u9762\u3002\u5982\u679c\u7528\u6237\u767b\u5f55\u4e86\uff0c\u8c03\u7528\u63a5\u53e3\u540e\uff0c\u4f1a\u91cd\u5b9a\u5411\u5230redirect_uri\uff0c\u6388\u6743\u7801\u4f1a\u4f5c\u4e3a\u5b83\u7684\u53c2\u6570\uff08\u8fd4\u56de\u7ed9\u5f53\u524d\u8bf7\u6c42\u6388\u6743\u7684\u5ba2\u6237\u7aef\u7684\u6388\u6743\u7801\uff0c\u901a\u5e38\u8bbe\u7f6e\u4e3a10\u5206\u949f,\u5e76\u4e14\u53ea\u80fd\u4f7f\u7528\u4e00\u6b21\uff09</li> <li>\u7b2c\u4e8c\u6b65\uff1a\u83b7\u53d6access_token eg\uff1aoauthServer+\"/oauth/token?code=\"+code+\"&amp;grant_type=authorization_code&amp;client_secret=\"+clientSecret+\"&amp;redirect_uri=\"+redirectUri+\"&amp;client_id=\"+clientId <pre><code>{\n    \"access_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1ODk1MzQ5NzMsInVzZXJfbmFtZSI6Im5pY2t5IiwiYXV0aG9yaXRpZXMiOlsiUk9MRV9hZG1pbiJdLCJqdGkiOiJmMjM0M2Q0NC1hODViLTQyOGYtOWE1ZS1iNTE4NTAwNTM5ODgiLCJjbGllbnRfaWQiOiJvYSIsInNjb3BlIjpbImFsbCJdfQ.LWkN2gC2dBrGTn5uSPzfdW6yRj7jhlX87EE8scY02hI\",\n    \"token_type\": \"bearer\",\n    \"expires_in\": 59,\n    \"scope\": \"all\",\n    \"user_name\": \"nicky\",\n    \"jti\": \"f2343d44-a85b-428f-9a5e-b51850053988\"\n}\n</code></pre> token_type\u7684\u503c\u5927\u5c0f\u5199\u4e0d\u654f\u611f\uff0c\u901a\u5e38\u662fbearer\u7c7b\u578b\u6216mac\u7c7b\u578b refresh_token(\u53ef\u9009)\uff0c\u7528\u6765\u83b7\u53d6\u65b0\u7684\u6388\u6743\u4ee4\u724c</li> <li>\u7b2c\u4e09\u6b65\uff1a\u8bbf\u95ee\u7cfb\u7edf\u8d44\u6e90\uff0c\u6b64\u65f6\u7edf\u4e00\u8ba4\u8bc1\u670d\u52a1\u4f1a\u6839\u636e\u8be5\u8ba4\u8bc1\u5ba2\u6237\u7aef\u6743\u9650\u4fe1\u606f\u5224\u65ad\uff0c\u51b3\u5b9a\u662f\u5426\u8fd4\u56de\u4fe1\u606f\u3002 eg:http://localhost:8084/api/userinfo?access_token=${accept_token}</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/","title":"TiDB\u6027\u80fd\u6d4b\u8bd5","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#tidb","title":"TIDB \u6027\u80fd\u6d4b\u8bd5","text":"<p>\u611f\u8c22\u5927\u4f6c</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#tidb_1","title":"TIDB\u6574\u4f53\u67b6\u6784","text":"<p>\u4e0e\u4f20\u7edf\u7684\u5355\u673a\u6570\u636e\u5e93\u76f8\u6bd4\uff0cTiDB \u5177\u6709\u4ee5\u4e0b\u4f18\u52bf\uff1a</p> <ul> <li>\u7eaf\u5206\u5e03\u5f0f\u67b6\u6784\uff0c\u62e5\u6709\u826f\u597d\u7684\u6269\u5c55\u6027\uff0c\u652f\u6301\u5f39\u6027\u7684\u6269\u7f29\u5bb9</li> <li>\u652f\u6301 SQL\uff0c\u5bf9\u5916\u66b4\u9732 MySQL \u7684\u7f51\u7edc\u534f\u8bae\uff0c\u5e76\u517c\u5bb9\u5927\u591a\u6570 MySQL \u7684\u8bed\u6cd5\uff0c\u5728\u5927\u591a\u6570\u573a\u666f\u4e0b\u53ef\u4ee5\u76f4\u63a5\u66ff\u6362 MySQL</li> <li>\u9ed8\u8ba4\u652f\u6301\u9ad8\u53ef\u7528\uff0c\u5728\u5c11\u6570\u526f\u672c\u5931\u6548\u7684\u60c5\u51b5\u4e0b\uff0c\u6570\u636e\u5e93\u672c\u8eab\u80fd\u591f\u81ea\u52a8\u8fdb\u884c\u6570\u636e\u4fee\u590d\u548c\u6545\u969c\u8f6c\u79fb\uff0c\u5bf9\u4e1a\u52a1\u900f\u660e</li> <li>\u652f\u6301 ACID \u4e8b\u52a1\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u6709\u5f3a\u4e00\u81f4\u9700\u6c42\u7684\u573a\u666f\u53cb\u597d\uff0c\u4f8b\u5982\uff1a\u94f6\u884c\u8f6c\u8d26</li> <li>\u5177\u6709\u4e30\u5bcc\u7684\u5de5\u5177\u94fe\u751f\u6001\uff0c\u8986\u76d6\u6570\u636e\u8fc1\u79fb\u3001\u540c\u6b65\u3001\u5907\u4efd\u7b49\u591a\u79cd\u573a\u666f</li> </ul> <p>\u5728\u5185\u6838\u8bbe\u8ba1\u4e0a\uff0cTiDB \u5206\u5e03\u5f0f\u6570\u636e\u5e93\u5c06\u6574\u4f53\u67b6\u6784\u62c6\u5206\u6210\u4e86\u591a\u4e2a\u6a21\u5757\uff0c\u5404\u6a21\u5757\u4e4b\u95f4\u4e92\u76f8\u901a\u4fe1\uff0c\u7ec4\u6210\u5b8c\u6574\u7684 TiDB \u7cfb\u7edf\u3002\u5bf9\u5e94\u7684\u67b6\u6784\u56fe\u5982\u4e0b\uff1a</p> <p></p> <ul> <li>TiDB Server\uff1aSQL \u5c42\uff0c\u5bf9\u5916\u66b4\u9732 MySQL \u534f\u8bae\u7684\u8fde\u63a5 endpoint\uff0c\u8d1f\u8d23\u63a5\u53d7\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\uff0c\u6267\u884c SQL \u89e3\u6790\u548c\u4f18\u5316\uff0c\u6700\u7ec8\u751f\u6210\u5206\u5e03\u5f0f\u6267\u884c\u8ba1\u5212\u3002TiDB \u5c42\u672c\u8eab\u662f\u65e0\u72b6\u6001\u7684\uff0c\u5b9e\u8df5\u4e2d\u53ef\u4ee5\u542f\u52a8\u591a\u4e2a TiDB \u5b9e\u4f8b\uff0c\u901a\u8fc7\u8d1f\u8f7d\u5747\u8861\u7ec4\u4ef6\uff08\u5982 LVS\u3001HAProxy \u6216 F5\uff09\u5bf9\u5916\u63d0\u4f9b\u7edf\u4e00\u7684\u63a5\u5165\u5730\u5740\uff0c\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u53ef\u4ee5\u5747\u5300\u5730\u5206\u644a\u5728\u591a\u4e2a TiDB \u5b9e\u4f8b\u4e0a\u4ee5\u8fbe\u5230\u8d1f\u8f7d\u5747\u8861\u7684\u6548\u679c\u3002TiDB Server \u672c\u8eab\u5e76\u4e0d\u5b58\u50a8\u6570\u636e\uff0c\u53ea\u662f\u89e3\u6790 SQL\uff0c\u5c06\u5b9e\u9645\u7684\u6570\u636e\u8bfb\u53d6\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u5e95\u5c42\u7684\u5b58\u50a8\u8282\u70b9 TiKV\uff08\u6216 TiFlash\uff09\u3002</li> <li>PD Server\uff1a\u6574\u4e2a TiDB \u96c6\u7fa4\u7684\u5143\u4fe1\u606f\u7ba1\u7406\u6a21\u5757\uff0c\u8d1f\u8d23\u5b58\u50a8\u6bcf\u4e2a TiKV \u8282\u70b9\u5b9e\u65f6\u7684\u6570\u636e\u5206\u5e03\u60c5\u51b5\u548c\u96c6\u7fa4\u7684\u6574\u4f53\u62d3\u6251\u7ed3\u6784\uff0c\u63d0\u4f9b TiDB Dashboard \u7ba1\u63a7\u754c\u9762\uff0c\u5e76\u4e3a\u5206\u5e03\u5f0f\u4e8b\u52a1\u5206\u914d\u4e8b\u52a1 ID\u3002PD \u4e0d\u4ec5\u5b58\u50a8\u5143\u4fe1\u606f\uff0c\u540c\u65f6\u8fd8\u4f1a\u6839\u636e TiKV \u8282\u70b9\u5b9e\u65f6\u4e0a\u62a5\u7684\u6570\u636e\u5206\u5e03\u72b6\u6001\uff0c\u4e0b\u53d1\u6570\u636e\u8c03\u5ea6\u547d\u4ee4\u7ed9\u5177\u4f53\u7684 TiKV \u8282\u70b9\uff0c\u53ef\u4ee5\u8bf4\u662f\u6574\u4e2a\u96c6\u7fa4\u7684\u201c\u5927\u8111\u201d\u3002\u6b64\u5916\uff0cPD \u672c\u8eab\u4e5f\u662f\u7531\u81f3\u5c11 3 \u4e2a\u8282\u70b9\u6784\u6210\uff0c\u62e5\u6709\u9ad8\u53ef\u7528\u7684\u80fd\u529b\u3002\u5efa\u8bae\u90e8\u7f72\u5947\u6570\u4e2a PD \u8282\u70b9\u3002</li> <li>\u5b58\u50a8\u8282\u70b9</li> <li>TiKV Server\uff1a\u8d1f\u8d23\u5b58\u50a8\u6570\u636e\uff0c\u4ece\u5916\u90e8\u770b TiKV \u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u7684\u63d0\u4f9b\u4e8b\u52a1\u7684 Key-Value \u5b58\u50a8\u5f15\u64ce\u3002\u5b58\u50a8\u6570\u636e\u7684\u57fa\u672c\u5355\u4f4d\u662f Region\uff0c\u6bcf\u4e2a Region \u8d1f\u8d23\u5b58\u50a8\u4e00\u4e2a Key Range\uff08\u4ece StartKey \u5230 EndKey \u7684\u5de6\u95ed\u53f3\u5f00\u533a\u95f4\uff09\u7684\u6570\u636e\uff0c\u6bcf\u4e2a TiKV \u8282\u70b9\u4f1a\u8d1f\u8d23\u591a\u4e2a Region\u3002TiKV \u7684 API \u5728 KV \u952e\u503c\u5bf9\u5c42\u9762\u63d0\u4f9b\u5bf9\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u539f\u751f\u652f\u6301\uff0c\u9ed8\u8ba4\u63d0\u4f9b\u4e86 SI (Snapshot Isolation) \u7684\u9694\u79bb\u7ea7\u522b\uff0c\u8fd9\u4e5f\u662f TiDB \u5728 SQL \u5c42\u9762\u652f\u6301\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u6838\u5fc3\u3002TiDB \u7684 SQL \u5c42\u505a\u5b8c SQL \u89e3\u6790\u540e\uff0c\u4f1a\u5c06 SQL \u7684\u6267\u884c\u8ba1\u5212\u8f6c\u6362\u4e3a\u5bf9 TiKV API \u7684\u5b9e\u9645\u8c03\u7528\u3002\u6240\u4ee5\uff0c\u6570\u636e\u90fd\u5b58\u50a8\u5728 TiKV \u4e2d\u3002\u53e6\u5916\uff0cTiKV \u4e2d\u7684\u6570\u636e\u90fd\u4f1a\u81ea\u52a8\u7ef4\u62a4\u591a\u526f\u672c\uff08\u9ed8\u8ba4\u4e3a\u4e09\u526f\u672c\uff09\uff0c\u5929\u7136\u652f\u6301\u9ad8\u53ef\u7528\u548c\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\u3002</li> <li>TiFlash\uff1aTiFlash \u662f\u4e00\u7c7b\u7279\u6b8a\u7684\u5b58\u50a8\u8282\u70b9\u3002\u548c\u666e\u901a TiKV \u8282\u70b9\u4e0d\u4e00\u6837\u7684\u662f\uff0c\u5728 TiFlash \u5185\u90e8\uff0c\u6570\u636e\u662f\u4ee5\u5217\u5f0f\u7684\u5f62\u5f0f\u8fdb\u884c\u5b58\u50a8\uff0c\u4e3b\u8981\u7684\u529f\u80fd\u662f\u4e3a\u5206\u6790\u578b\u7684\u573a\u666f\u52a0\u901f\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#tiup","title":"\u4f7f\u7528TiUP\u96c6\u7fa4\u5728\u4e00\u53f0\u673a\u5668\u4e0a\u8bbe\u7f6e\u6d4b\u8bd5\u73af\u5883","text":"<ul> <li>\u573a\u666f\uff1a\u4f53\u9a8c\u5177\u6709\u5b8c\u6574\u62d3\u6251\u7684\u6700\u5c0fTiDB\u96c6\u7fa4\uff0c\u5e76\u5728\u5355\u4e2aLinux\u670d\u52a1\u5668\u4e0a\u6a21\u62df\u751f\u4ea7\u90e8\u7f72\u6b65\u9aa4</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_1","title":"\u51c6\u5907","text":"<p>\u5b98\u65b9\u63a8\u8350\u6700\u5c0fTIDB\u96c6\u7fa4\u62d3\u6251</p> \u5b9e\u4f8b \u526f\u672c\u6570 IP\u5730\u5740 \u7aef\u53e3 TIKV 3 10.101.16.245 20160/20180,20161/20181,20162/20182 TIDB 1 10.101.16.245 4000/10080 PD 1 10.101.16.245 2379/2380 TiFlash 1 10.101.16.245 9000/8123/3930/20170/20292/8234 Monitor prometheusgrafana 10.101.16.245 9090,3000"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_2","title":"\u90e8\u7f72","text":"<ul> <li>\u4e0b\u8f7d\u5e76\u5b89\u88c5TiUP</li> </ul> <pre><code>curl --proto '=https' --tlsv1.2 -sSf https://tiup-mirrors.pingcap.com/install.sh | sh\n</code></pre> <ul> <li>\u5b89\u88c5TiUP\u96c6\u7fa4\u7ec4\u4ef6</li> </ul> <pre><code>tiup cluster\n# \u66f4\u65b0\ntiup update --self &amp;&amp; tiup update cluster\n</code></pre> <ul> <li>\u521b\u5efa\u5e76\u542f\u52a8\u96c6\u7fa4</li> </ul> <p>\u521b\u5efa\u914d\u7f6e\u6587\u4ef6</p> <pre><code>cat &gt; topo.yaml &lt;&lt;- 'EOF' \n# # Global variables are applied to all deployments and used as the default value of\n# # the deployments if a specific deployment value is missing.\nglobal:\n user: \"tidb\"\n ssh_port: 22\n deploy_dir: \"/tidb-deploy\"\n data_dir: \"/tidb-data\"\n\n# # Monitored variables are applied to all the machines.\nmonitored:\n node_exporter_port: 9100\n blackbox_exporter_port: 9115\n\nserver_configs:\n tidb:\n   log.slow-threshold: 300\n tikv:\n   readpool.storage.use-unified-pool: false\n   readpool.coprocessor.use-unified-pool: true\n pd:\n   replication.enable-placement-rules: true\n   replication.location-labels: [\"host\"]\n tiflash:\n   logger.level: \"info\"\n\npd_servers:\n - host: 10.101.16.245\n\ntidb_servers:\n - host: 10.101.16.245\n\ntikv_servers:\n - host: 10.101.16.245\n   port: 20160\n   status_port: 20180\n   config:\n     server.labels: { host: \"logic-host-1\" }\n\n - host: 10.101.16.245\n   port: 20161\n   status_port: 20181\n   config:\n     server.labels: { host: \"logic-host-2\" }\n\n - host: 10.101.16.245\n   port: 20162\n   status_port: 20182\n   config:\n     server.labels: { host: \"logic-host-3\" }\n\ntiflash_servers:\n - host: 10.101.16.245\n\nmonitoring_servers:\n - host: 10.101.16.245\n\ngrafana_servers:\n - host: 10.101.16.245\nEOF\n</code></pre> <ul> <li>\u6267\u884c\u96c6\u7fa4\u90e8\u7f72\u547d\u4ee4</li> </ul> <pre><code>tiup cluster deploy tidb-ddyw  v4.0.8 ./topo.yaml --user root\nStarting component `cluster`: /root/.tiup/components/cluster/v1.2.5/tiup-cluster deploy tidb-ddyw v4.0.8 ./topo.yaml --user root\nPlease confirm your topology:\nCluster type:    tidb\nCluster name:    tidb-ddyw\nCluster version: v4.0.8\nType        Host           Ports                            OS/Arch       Directories\n----        ----           -----                            -------       -----------\npd          10.101.16.245  2379/2380                        linux/x86_64  /tidb-deploy/pd-2379,/tidb-data/pd-2379\ntikv        10.101.16.245  20160/20180                      linux/x86_64  /tidb-deploy/tikv-20160,/tidb-data/tikv-20160\ntikv        10.101.16.245  20161/20181                      linux/x86_64  /tidb-deploy/tikv-20161,/tidb-data/tikv-20161\ntikv        10.101.16.245  20162/20182                      linux/x86_64  /tidb-deploy/tikv-20162,/tidb-data/tikv-20162\ntidb        10.101.16.245  4000/10080                       linux/x86_64  /tidb-deploy/tidb-4000\ntiflash     10.101.16.245  9000/8123/3930/20170/20292/8234  linux/x86_64  /tidb-deploy/tiflash-9000,/tidb-data/tiflash-9000\nprometheus  10.101.16.245  9090                             linux/x86_64  /tidb-deploy/prometheus-9090,/tidb-data/prometheus-9090\ngrafana     10.101.16.245  3000                             linux/x86_64  /tidb-deploy/grafana-3000\nAttention:\n    1. If the topology is not what you expected, check your yaml file.\n    2. Please confirm there is no port/directory conflicts in same host.\nDo you want to continue? [y/N]:  y\n+ Generate SSH keys ... Done\n+ Download TiDB components\n  - Download pd:v4.0.8 (linux/amd64) ... Done\n  - Download tikv:v4.0.8 (linux/amd64) ... Done\n  - Download tidb:v4.0.8 (linux/amd64) ... Done\n  - Download tiflash:v4.0.8 (linux/amd64) ... Done\n  - Download prometheus:v4.0.8 (linux/amd64) ... Done\n  - Download grafana:v4.0.8 (linux/amd64) ... Done\n  - Download node_exporter:v0.17.0 (linux/amd64) ... Done\n  - Download blackbox_exporter:v0.12.0 (linux/amd64) ... Done\n+ Initialize target host environments\n  - Prepare 10.101.16.245:22 ... Done\n+ Copy files\n  - Copy pd -&gt; 10.101.16.245 ... Done\n  - Copy tikv -&gt; 10.101.16.245 ... Done\n  - Copy tikv -&gt; 10.101.16.245 ... Done\n  - Copy tikv -&gt; 10.101.16.245 ... Done\n  - Copy tidb -&gt; 10.101.16.245 ... Done\n  - Copy tiflash -&gt; 10.101.16.245 ... Done\n  - Copy prometheus -&gt; 10.101.16.245 ... Done\n  - Copy grafana -&gt; 10.101.16.245 ... Done\n  - Copy node_exporter -&gt; 10.101.16.245 ... Done\n  - Copy blackbox_exporter -&gt; 10.101.16.245 ... Done\n+ Check status\n\nEnabling component pd\n+ Enable cluster\n        Enable pd 10.101.16.245:2379 success\n+ Enable cluster\n+ Enable cluster\nEnabling component tikv\n    Enabling instance tikv 10.101.16.245:20162\n    Enabling instance tikv 10.101.16.245:20160\n+ Enable cluster\n+ Enable cluster\n+ Enable cluster\n        Enable tikv 10.101.16.245:20162 success\nEnabling component tidb\n+ Enable cluster\n        Enable tidb 10.101.16.245:4000 success\nEnabling component tiflash\n+ Enable cluster\n        Enable tiflash 10.101.16.245:9000 success\nEnabling component prometheus\n+ Enable cluster\n        Enable prometheus 10.101.16.245:9090 success\nEnabling component grafana\n+ Enable cluster\n+ Enable cluster\nDeployed cluster `tidb-ddyw` successfully, you can start the cluster via `tiup cluster start tidb-ddyw`\n</code></pre> <ul> <li>\u542f\u52a8\u96c6\u7fa4</li> </ul> <pre><code>tiup cluster start tidb-ddyw\nStarting component `cluster`: /root/.tiup/components/cluster/v1.2.5/tiup-cluster start tidb-ddyw\nStarting cluster tidb-ddyw...\n+ [ Serial ] - SSHKeySet: privateKey=/root/.tiup/storage/cluster/clusters/tidb-ddyw/ssh/id_rsa, publicKey=/root/.tiup/storage/cluster/clusters/tidb-ddyw/ssh/id_rsa.pub\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [ Serial ] - StartCluster\nStarting component pd\n    Starting instance pd 10.101.16.245:2379\n    Start pd 10.101.16.245:2379 success\nStarting component node_exporter\n    Starting instance 10.101.16.245\n    Start 10.101.16.245 success\nStarting component blackbox_exporter\n    Starting instance 10.101.16.245\n    Start 10.101.16.245 success\nStarting component tikv\n    Starting instance tikv 10.101.16.245:20162\n    Starting instance tikv 10.101.16.245:20160\n    Starting instance tikv 10.101.16.245:20161\n    Start tikv 10.101.16.245:20160 success\n    Start tikv 10.101.16.245:20161 success\n    Start tikv 10.101.16.245:20162 success\nStarting component tidb\n    Starting instance tidb 10.101.16.245:4000\n    Start tidb 10.101.16.245:4000 success\nStarting component tiflash\n    Starting instance tiflash 10.101.16.245:9000\n    Start tiflash 10.101.16.245:9000 success\nStarting component prometheus\n    Starting instance prometheus 10.101.16.245:9090\n    Start prometheus 10.101.16.245:9090 success\nStarting component grafana\n    Starting instance grafana 10.101.16.245:3000\n    Start grafana 10.101.16.245:3000 success\n+ [ Serial ] - UpdateTopology: cluster=tidb-ddyw\nStarted cluster `tidb-ddyw` successfully\n</code></pre> <ul> <li>\u8bbf\u95ee\u96c6\u7fa4</li> </ul> <pre><code># \u5b89\u88c5mysql client\u5ba2\u6237\u7aef\nyum install -y mysql\n# \u8bbf\u95eeTIDB,\u9ed8\u8ba4\u4e3a\u7a7a\u5bc6\u7801\nmysql -h 10.101.16.245 -P 4000 -u root\nMySQL [(none)]&gt; show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| INFORMATION_SCHEMA |\n| METRICS_SCHEMA     |\n| PERFORMANCE_SCHEMA |\n| mysql              |\n| test               |\n+--------------------+\n5 rows in set (0.00 sec)\n\n# \u67e5\u770b\u96c6\u7fa4\u5217\u8868\ntiup cluster list\nStarting component `cluster`: /root/.tiup/components/cluster/v1.2.5/tiup-cluster list\nName       User  Version  Path                                            PrivateKey\n----       ----  -------  ----                                            ----------\ntidb-ddyw  tidb  v4.0.8   /root/.tiup/storage/cluster/clusters/tidb-ddyw  /root/.tiup/storage/cluster/clusters/tidb-ddyw/ssh/id_rsa\n# \u67e5\u770b\u96c6\u7fa4\u62d3\u6251\ntiup cluster display tidb-ddyw\nStarting component `cluster`: /root/.tiup/components/cluster/v1.2.5/tiup-cluster display tidb-ddyw\nCluster type:    tidb\nCluster name:    tidb-ddyw\nCluster version: v4.0.8\nSSH type:        builtin\nID                   Role        Host           Ports                            OS/Arch       Status   Data Dir                    Deploy Dir\n--                   ----        ----           -----                            -------       ------   --------                    ----------\n10.101.16.245:3000   grafana     10.101.16.245  3000                             linux/x86_64  Up       -                           /tidb-deploy/grafana-3000\n10.101.16.245:2379   pd          10.101.16.245  2379/2380                        linux/x86_64  Up|L|UI  /tidb-data/pd-2379          /tidb-deploy/pd-2379\n10.101.16.245:9090   prometheus  10.101.16.245  9090                             linux/x86_64  Up       /tidb-data/prometheus-9090  /tidb-deploy/prometheus-9090\n10.101.16.245:4000   tidb        10.101.16.245  4000/10080                       linux/x86_64  Up       -                           /tidb-deploy/tidb-4000\n10.101.16.245:9000   tiflash     10.101.16.245  9000/8123/3930/20170/20292/8234  linux/x86_64  Up       /tidb-data/tiflash-9000     /tidb-deploy/tiflash-9000\n10.101.16.245:20160  tikv        10.101.16.245  20160/20180                      linux/x86_64  Up       /tidb-data/tikv-20160       /tidb-deploy/tikv-20160\n10.101.16.245:20161  tikv        10.101.16.245  20161/20181                      linux/x86_64  Up       /tidb-data/tikv-20161       /tidb-deploy/tikv-20161\n10.101.16.245:20162  tikv        10.101.16.245  20162/20182                      linux/x86_64  Up       /tidb-data/tikv-20162       /tidb-deploy/tikv-20162\nTotal nodes: 8\n# TIDB\u8bbf\u95ee\nTo connect TiDB: mysql --host 10.101.16.245 --port 4000 -u root\nTo view the dashboard: http://10.101.16.245:2379/dashboard\nTo view the monitor: http://10.101.16.245:9090\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_3","title":"\u5206\u5e03\u5f0f\u90e8\u7f72","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_4","title":"\u51c6\u5907","text":"<p>\u672c\u6b21\u6d4b\u8bd5\u73af\u5883TIDB\u96c6\u7fa4\u62d3\u6251</p> \u5b9e\u4f8b \u914d\u7f6e \u526f\u672c\u6570 IP\u5730\u5740 \u7aef\u53e3 TiDB 8\u683832G500G 1 10.101.16.246 4000/10080 PD 8\u683832G500G 1 10.101.16.247 2379/2380 TIKV 8\u683832G500G 3 10.101.16.24610.101.16.24710.101.16.248 20160/20180,20161/20181,20162/20182 TiFlash 8\u683832G500G 1 10.101.16.248 9000/8123/3930/20170/20292/8234 Monitor 8\u683832G500G prometheusgrafana 10.101.16.246 9090,3000"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_5","title":"\u90e8\u7f72","text":"<p>\u78c1\u76d8\u683c\u5f0f\u5316(\u4e09\u53f0\u673a\u5668\u6267\u884c)</p> <pre><code># \u6570\u636e\u76d8\u5206\u533a\nfdisk /dev/vdb\n\u6b22\u8fce\u4f7f\u7528 fdisk (util-linux 2.23.2)\u3002\n\n\u66f4\u6539\u5c06\u505c\u7559\u5728\u5185\u5b58\u4e2d\uff0c\u76f4\u5230\u60a8\u51b3\u5b9a\u5c06\u66f4\u6539\u5199\u5165\u78c1\u76d8\u3002\n\u4f7f\u7528\u5199\u5165\u547d\u4ee4\u524d\u8bf7\u4e09\u601d\u3002\n\nDevice does not contain a recognized partition table\n\u4f7f\u7528\u78c1\u76d8\u6807\u8bc6\u7b26 0xa1b68466 \u521b\u5efa\u65b0\u7684 DOS \u78c1\u76d8\u6807\u7b7e\u3002\n\n\u547d\u4ee4(\u8f93\u5165 m \u83b7\u53d6\u5e2e\u52a9)\uff1an\nPartition type:\n   p   primary (0 primary, 0 extended, 4 free)\n   e   extended\nSelect (default p): p\n\u5206\u533a\u53f7 (1-4\uff0c\u9ed8\u8ba4 1)\uff1a1\n\u8d77\u59cb \u6247\u533a (2048-943718399\uff0c\u9ed8\u8ba4\u4e3a 2048)\uff1a\n\u5c06\u4f7f\u7528\u9ed8\u8ba4\u503c 2048\nLast \u6247\u533a, +\u6247\u533a or +size{K,M,G} (2048-943718399\uff0c\u9ed8\u8ba4\u4e3a 943718399)\uff1a\n\u5c06\u4f7f\u7528\u9ed8\u8ba4\u503c 943718399\n\u5206\u533a 1 \u5df2\u8bbe\u7f6e\u4e3a Linux \u7c7b\u578b\uff0c\u5927\u5c0f\u8bbe\u4e3a 450 GiB\n\n\u547d\u4ee4(\u8f93\u5165 m \u83b7\u53d6\u5e2e\u52a9)\uff1ap\n\n\u78c1\u76d8 /dev/vdb\uff1a483.2 GB, 483183820800 \u5b57\u8282\uff0c943718400 \u4e2a\u6247\u533a\nUnits = \u6247\u533a of 1 * 512 = 512 bytes\n\u6247\u533a\u5927\u5c0f(\u903b\u8f91/\u7269\u7406)\uff1a512 \u5b57\u8282 / 512 \u5b57\u8282\nI/O \u5927\u5c0f(\u6700\u5c0f/\u6700\u4f73)\uff1a512 \u5b57\u8282 / 512 \u5b57\u8282\n\u78c1\u76d8\u6807\u7b7e\u7c7b\u578b\uff1ados\n\u78c1\u76d8\u6807\u8bc6\u7b26\uff1a0xa1b68466\n\n   \u8bbe\u5907 Boot      Start         End      Blocks   Id  System\n/dev/vdb1            2048   943718399   471858176   83  Linux\n\n\u547d\u4ee4(\u8f93\u5165 m \u83b7\u53d6\u5e2e\u52a9)\uff1aw\nThe partition table has been altered!\n\nCalling ioctl() to re-read partition table.\n\u6b63\u5728\u540c\u6b65\u78c1\u76d8\u3002\n# \u521b\u5efa\u6587\u4ef6\u7cfb\u7edf\nmkfs -t xfs /dev/vdb1\n# \u6302\u8f7d\u4f7f\u7528\nmkdir /tidbdata\nmount /dev/vdb1 /tidbdata\n# \u6302\u8f7d\u5f00\u673a\u542f\u52a8\nblkid\n/dev/vda1: UUID=\"9f2d3e15-a78a-4f3d-8385-0165b4b67864\" TYPE=\"ext4\" \n/dev/vdb1: UUID=\"b2c45077-0f11-42ff-90d1-864a6d9c7490\" TYPE=\"xfs\" \ncat &gt;&gt; /etc/fstab &lt;&lt;- 'EOF'\n&gt; UUID=b2c45077-0f11-42ff-90d1-864a6d9c7490 /tidbdata xfs default 0 0\n&gt; EOF\n</code></pre> <p>10.101.16.246 \u4e0a\u5b89\u88c5tiup\u5e76\u521d\u59cb\u5316tidb\u96c6\u7fa4</p> <ul> <li>\u4e0b\u8f7d\u5e76\u5b89\u88c5TiUP</li> </ul> <pre><code>curl --proto '=https' --tlsv1.2 -sSf https://tiup-mirrors.pingcap.com/install.sh | sh\n</code></pre> <ul> <li>\u5b89\u88c5TiUP\u96c6\u7fa4\u7ec4\u4ef6</li> </ul> <pre><code># source bash_profile\nsource ~/.bash_profile\n# \u5b89\u88c5tiup\ntiup cluster\n# \u66f4\u65b0\ntiup update --self &amp;&amp; tiup update cluster\n</code></pre> <ul> <li>\u521b\u5efa\u5e76\u542f\u52a8\u96c6\u7fa4</li> </ul> <p>\u521b\u5efa\u914d\u7f6e\u6587\u4ef6</p> <pre><code>cat &gt; topo.yaml &lt;&lt;- 'EOF' \n# # Global variables are applied to all deployments and used as the default value of\n# # the deployments if a specific deployment value is missing.\nglobal:\n user: \"tidb\"\n ssh_port: 22\n deploy_dir: \"/tidbdata/tidb-deploy\"\n data_dir: \"/tidbdata/tidb-data\"\n\n# # Monitored variables are applied to all the machines.\nmonitored:\n node_exporter_port: 9100\n blackbox_exporter_port: 9115\n\nserver_configs:\n tidb:\n   log.slow-threshold: 300\n tikv:\n   readpool.storage.use-unified-pool: false\n   readpool.coprocessor.use-unified-pool: true\n pd:\n   replication.enable-placement-rules: true\n   replication.location-labels: [\"host\"]\n tiflash:\n   logger.level: \"info\"\n\npd_servers:\n - host: 10.101.16.247\n\ntidb_servers:\n - host: 10.101.16.246\n\ntikv_servers:\n - host: 10.101.16.246\n   port: 20160\n   status_port: 20180\n   config:\n     server.labels: { host: \"tidb-node01\" }\n\n - host: 10.101.16.247\n   port: 20161\n   status_port: 20181\n   config:\n     server.labels: { host: \"tidb-node02\" }\n\n - host: 10.101.16.248\n   port: 20162\n   status_port: 20182\n   config:\n     server.labels: { host: \"tidb-node03\" }\n\ntiflash_servers:\n - host: 10.101.16.248\n\nmonitoring_servers:\n - host: 10.101.16.246\n\ngrafana_servers:\n - host: 10.101.16.246\nEOF\n</code></pre> <ul> <li>\u6267\u884c\u96c6\u7fa4\u90e8\u7f72\u547d\u4ee4</li> </ul> <pre><code>tiup cluster deploy tidb-ddyw  v4.0.8 ./topo.yaml --user root\nDeployed cluster `tidb-ddyw` successfully, you can start the cluster via `tiup cluster start tidb-ddyw`\n</code></pre> <ul> <li>\u542f\u52a8\u96c6\u7fa4</li> </ul> <pre><code>tiup cluster start tidb-ddyw\nStarted cluster `tidb-ddyw` successfully\n</code></pre> <ul> <li>\u8bbf\u95ee\u96c6\u7fa4</li> </ul> <pre><code># \u5b89\u88c5mysql client\u5ba2\u6237\u7aef\nyum install -y mysql\n# \u8bbf\u95eeTIDB,\u9ed8\u8ba4\u4e3a\u7a7a\u5bc6\u7801\nmysql -h 10.101.16.246 -P 4000 -u root\nMySQL [(none)]&gt; show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| INFORMATION_SCHEMA |\n| METRICS_SCHEMA     |\n| PERFORMANCE_SCHEMA |\n| mysql              |\n| test               |\n+--------------------+\n5 rows in set (0.00 sec)\n\n# \u67e5\u770b\u96c6\u7fa4\u5217\u8868\ntiup cluster display tidb-ddyw\nStarting component `cluster`: /root/.tiup/components/cluster/v1.2.5/tiup-cluster display tidb-ddyw\nCluster type:    tidb\nCluster name:    tidb-ddyw\nCluster version: v4.0.8\nSSH type:        builtin\nID                   Role        Host           Ports                            OS/Arch       Status   Data Dir                             Deploy Dir\n--                   ----        ----           -----                            -------       ------   --------                             ----------\n10.101.16.246:3000   grafana     10.101.16.246  3000                             linux/x86_64  Up       -                                    /tidbdata/tidb-deploy/grafana-3000\n10.101.16.247:2379   pd          10.101.16.247  2379/2380                        linux/x86_64  Up|L|UI  /tidbdata/tidb-data/pd-2379          /tidbdata/tidb-deploy/pd-2379\n10.101.16.246:9090   prometheus  10.101.16.246  9090                             linux/x86_64  Up       /tidbdata/tidb-data/prometheus-9090  /tidbdata/tidb-deploy/prometheus-9090\n10.101.16.246:4000   tidb        10.101.16.246  4000/10080                       linux/x86_64  Up       -                                    /tidbdata/tidb-deploy/tidb-4000\n10.101.16.248:9000   tiflash     10.101.16.248  9000/8123/3930/20170/20292/8234  linux/x86_64  Up       /tidbdata/tidb-data/tiflash-9000     /tidbdata/tidb-deploy/tiflash-9000\n10.101.16.246:20160  tikv        10.101.16.246  20160/20180                      linux/x86_64  Up       /tidbdata/tidb-data/tikv-20160       /tidbdata/tidb-deploy/tikv-20160\n10.101.16.247:20161  tikv        10.101.16.247  20161/20181                      linux/x86_64  Up       /tidbdata/tidb-data/tikv-20161       /tidbdata/tidb-deploy/tikv-20161\n10.101.16.248:20162  tikv        10.101.16.248  20162/20182                      linux/x86_64  Up       /tidbdata/tidb-data/tikv-20162       /tidbdata/tidb-deploy/tikv-20162\nTotal nodes: 8\n# TIDB\u8bbf\u95ee\n## \u5185\u7f51\u8bbf\u95ee\nTo connect TiDB: mysql --host 10.101.16.246 --port 4000 -u root\nTo view the dashboard: http://10.101.16.246:2379/dashboard\nTo view the monitor: http://10.101.16.246:9090\n## \u5916\u7f51\u8bbf\u95ee\nTo connect TiDB: mysql --host 47.93.55.89 --port 32002 -u root\nTo view the dashboard: http://47.93.55.89:32003/dashboard\nTo view the monitor prometheus: http://47.93.55.89:32004\nTo view the monitor grafana: http://47.93.55.89:32001 admin admin\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#tidb_2","title":"TIDB\u96c6\u7fa4\u7ba1\u7406","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_6","title":"\u96c6\u7fa4\u91cd\u542f","text":"<p>\u5728\u505c\u6b62node_exporter\u65f6,\u51fa\u73b0\u8d85\u65f6\u73b0\u8c61\u62a5\u9519,\u5bfc\u81f4\u96c6\u7fa4\u76f4\u63a5\u6545\u969c,\u9700\u8981\u624b\u52a8\u542f\u52a8\u96c6\u7fa4,\u624d\u53ef\u56de\u590d\u6b63\u5e38,\u67e5\u770b\u5b98\u65b9\u63d0\u4f9b\u7684tiup\u90e8\u7f72\u5de5\u5177\u4e3a\u4e8c\u8fdb\u5236\u5305,\u6240\u4ee5\u9700\u8981\u4fee\u6539\u6e90\u7801\u624d\u53ef\u4ee5\u89e3\u51b3\u6b64\u95ee\u9898.</p> <pre><code># \u96c6\u7fa4\u91cd\u542f\n## \u51fa\u73b0\u8d85\u65f6\u62a5\u9519\ntiup cluster restart tidb-ddyw\nStarting component `cluster`: /root/.tiup/components/cluster/v1.2.5/tiup-cluster restart tidb-ddyw\n+ [ Serial ] - SSHKeySet: privateKey=/root/.tiup/storage/cluster/clusters/tidb-ddyw/ssh/id_rsa, publicKey=/root/.tiup/storage/cluster/clusters/tidb-ddyw/ssh/id_rsa.pub\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [ Serial ] - RestartCluster\nStopping component grafana\n    Stopping instance 10.101.16.245\n    Stop grafana 10.101.16.245:3000 success\nStopping component prometheus\n    Stopping instance 10.101.16.245\n    Stop prometheus 10.101.16.245:9090 success\nStopping component tiflash\n    Stopping instance 10.101.16.245\n    Stop tiflash 10.101.16.245:9000 success\nStopping component tidb\n    Stopping instance 10.101.16.245\n    Stop tidb 10.101.16.245:4000 success\nStopping component tikv\n    Stopping instance 10.101.16.245\n    Stopping instance 10.101.16.245\n    Stopping instance 10.101.16.245\n    Stop tikv 10.101.16.245:20162 success\n    Stop tikv 10.101.16.245:20160 success\n    Stop tikv 10.101.16.245:20161 success\nStopping component pd\n    Stopping instance 10.101.16.245\n    Stop pd 10.101.16.245:2379 success\nStopping component node_exporter\nretry error: operation timed out after 2m0s\n    pd 10.101.16.245:2379 failed to stop: timed out waiting for port 9100 to be stopped after 2m0s\n\nError: failed to stop:  pd 10.101.16.245:2379 failed to stop: timed out waiting for port 9100 to be stopped after 2m0s: timed out waiting for port 9100 to be stopped after 2m0s\n\nVerbose debug logs has been written to /tidb-data/tikv-20160/logs/tiup-cluster-debug-2020-12-02-10-50-06.log.\nError: run `/root/.tiup/components/cluster/v1.2.5/tiup-cluster` (wd:/root/.tiup/data/SHyfGAX) failed: exit status 1\n## \u518d\u6b21\u67e5\u770b\u96c6\u7fa4\u62d3\u6251,\u51fa\u73b0\u5f02\u5e38\nStarting component `cluster`: /root/.tiup/components/cluster/v1.2.5/tiup-cluster display tidb-ddyw\nCluster type:    tidb\nCluster name:    tidb-ddyw\nCluster version: v4.0.8\nSSH type:        builtin\nID                   Role        Host           Ports                            OS/Arch       Status    Data Dir                    Deploy Dir\n--                   ----        ----           -----                            -------       ------    --------                    ----------\n10.101.16.245:3000   grafana     10.101.16.245  3000                             linux/x86_64  inactive  -                           /tidb-deploy/grafana-3000\n10.101.16.245:2379   pd          10.101.16.245  2379/2380                        linux/x86_64  Down      /tidb-data/pd-2379          /tidb-deploy/pd-2379\n10.101.16.245:9090   prometheus  10.101.16.245  9090                             linux/x86_64  inactive  /tidb-data/prometheus-9090  /tidb-deploy/prometheus-9090\n10.101.16.245:4000   tidb        10.101.16.245  4000/10080                       linux/x86_64  Down      -                           /tidb-deploy/tidb-4000\n10.101.16.245:9000   tiflash     10.101.16.245  9000/8123/3930/20170/20292/8234  linux/x86_64  Down      /tidb-data/tiflash-9000     /tidb-deploy/tiflash-9000\n10.101.16.245:20160  tikv        10.101.16.245  20160/20180                      linux/x86_64  Down      /tidb-data/tikv-20160       /tidb-deploy/tikv-20160\n10.101.16.245:20161  tikv        10.101.16.245  20161/20181                      linux/x86_64  Down      /tidb-data/tikv-20161       /tidb-deploy/tikv-20161\n10.101.16.245:20162  tikv        10.101.16.245  20162/20182                      linux/x86_64  Down      /tidb-data/tikv-20162       /tidb-deploy/tikv-20162\nTotal nodes: 8\n\nWARN: get location labels from pd failed: Get http://10.101.16.245:2379/pd/api/v1/config/replicate: dial tcp 10.101.16.245:2379: connect: connection refused\n## \u518d\u542f\u52a8TIDB,\u6062\u590d\u6b63\u5e38\ntiup cluster start tidb-ddyw\ntiup cluster display tidb-ddyw\nStarting component `cluster`: /root/.tiup/components/cluster/v1.2.5/tiup-cluster display tidb-ddyw\nCluster type:    tidb\nCluster name:    tidb-ddyw\nCluster version: v4.0.8\nSSH type:        builtin\nID                   Role        Host           Ports                            OS/Arch       Status        Data Dir                    Deploy Dir\n--                   ----        ----           -----                            -------       ------        --------                    ----------\n10.101.16.245:3000   grafana     10.101.16.245  3000                             linux/x86_64  Up            -                           /tidb-deploy/grafana-3000\n10.101.16.245:2379   pd          10.101.16.245  2379/2380                        linux/x86_64  Up|L|UI       /tidb-data/pd-2379          /tidb-deploy/pd-2379\n10.101.16.245:9090   prometheus  10.101.16.245  9090                             linux/x86_64  Up            /tidb-data/prometheus-9090  /tidb-deploy/prometheus-9090\n10.101.16.245:4000   tidb        10.101.16.245  4000/10080                       linux/x86_64  Up            -                           /tidb-deploy/tidb-4000\n10.101.16.245:9000   tiflash     10.101.16.245  9000/8123/3930/20170/20292/8234  linux/x86_64  Disconnected  /tidb-data/tiflash-9000     /tidb-deploy/tiflash-9000\n10.101.16.245:20160  tikv        10.101.16.245  20160/20180                      linux/x86_64  Up            /tidb-data/tikv-20160       /tidb-deploy/tikv-20160\n10.101.16.245:20161  tikv        10.101.16.245  20161/20181                      linux/x86_64  Up            /tidb-data/tikv-20161       /tidb-deploy/tikv-20161\n10.101.16.245:20162  tikv        10.101.16.245  20162/20182                      linux/x86_64  Up            /tidb-data/tikv-20162       /tidb-deploy/tikv-20162\nTotal nodes: 8\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_7","title":"\u66f4\u65b0\u914d\u7f6e","text":"<p>\u5b98\u65b9\u63d0\u4f9b\u793a\u4f8b\u914d\u7f6e\u53c2\u8003\u5982\u4e0b</p> <pre><code>curl -sL https://raw.githubusercontent.com/pingcap/tidb/master/config/config.toml.example -o config.toml.example\n</code></pre> <p>\u96c6\u7fa4\u66f4\u65b0\u914d\u7f6e\u5e76\u91cd\u542f\u7ec4\u4ef6</p> <pre><code># \u67e5\u770brole\u548cnode\ntiup cluster display tidb-ddyw \nStarting component `cluster`: /root/.tiup/components/cluster/v1.2.5/tiup-cluster display tidb-ddyw\nCluster type:    tidb\nCluster name:    tidb-ddyw\nCluster version: v4.0.8\nSSH type:        builtin\nID                   Role        Host           Ports                            OS/Arch       Status   Data Dir                    Deploy Dir\n--                   ----        ----           -----                            -------       ------   --------                    ----------\n10.101.16.245:3000   grafana     10.101.16.245  3000                             linux/x86_64  Up       -                           /tidb-deploy/grafana-3000\n10.101.16.245:2379   pd          10.101.16.245  2379/2380                        linux/x86_64  Up|L|UI  /tidb-data/pd-2379          /tidb-deploy/pd-2379\n10.101.16.245:9090   prometheus  10.101.16.245  9090                             linux/x86_64  Up       /tidb-data/prometheus-9090  /tidb-deploy/prometheus-9090\n10.101.16.245:4000   tidb        10.101.16.245  4000/10080                       linux/x86_64  Up       -                           /tidb-deploy/tidb-4000\n10.101.16.245:9000   tiflash     10.101.16.245  9000/8123/3930/20170/20292/8234  linux/x86_64  Up       /tidb-data/tiflash-9000     /tidb-deploy/tiflash-9000\n10.101.16.245:20160  tikv        10.101.16.245  20160/20180                      linux/x86_64  Up       /tidb-data/tikv-20160       /tidb-deploy/tikv-20160\n10.101.16.245:20161  tikv        10.101.16.245  20161/20181                      linux/x86_64  Up       /tidb-data/tikv-20161       /tidb-deploy/tikv-20161\n10.101.16.245:20162  tikv        10.101.16.245  20162/20182                      linux/x86_64  Up       /tidb-data/tikv-20162       /tidb-deploy/tikv-20162\nTotal nodes: 8\n# \u91cd\u542f\u6574\u4e2a\u96c6\u7fa4\ntiup cluster reload tidb-ddyw\nStarting component `cluster`: /root/.tiup/components/cluster/v1.2.5/tiup-cluster reload tidb-ddyw\n+ [ Serial ] - SSHKeySet: privateKey=/root/.tiup/storage/cluster/clusters/tidb-ddyw/ssh/id_rsa, publicKey=/root/.tiup/storage/cluster/clusters/tidb-ddyw/ssh/id_rsa.pub\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ Refresh instance configs\n  - Refresh config pd -&gt; 10.101.16.245:2379 ... Done\n  - Refresh config tikv -&gt; 10.101.16.245:20160 ... Done\n  - Refresh config tikv -&gt; 10.101.16.245:20161 ... Done\n  - Refresh config tikv -&gt; 10.101.16.245:20162 ... Done\n  - Refresh config tidb -&gt; 10.101.16.245:4000 ... Done\n  - Refresh config tiflash -&gt; 10.101.16.245:9000 ... Done\n  - Refresh config prometheus -&gt; 10.101.16.245:9090 ... Done\n  - Refresh config grafana -&gt; 10.101.16.245:3000 ... Done\n+ Refresh monitor configs\n  - Refresh config node_exporter -&gt; 10.101.16.245 ... Done\n  - Refresh config blackbox_exporter -&gt; 10.101.16.245 ... Done\n+ [ Serial ] - UpgradeCluster\nRestarting component tiflash\n    Restarting instance 10.101.16.245\n    Restart 10.101.16.245 success\nRestarting component pd\n    Restarting instance 10.101.16.245\n    Restart 10.101.16.245 success\nRestarting component tikv\nStill waitting for the PD leader to be elected\nEvicting 9 leaders from store 10.101.16.245:20160...\nStill waitting for 9 store leaders to transfer...\nStill waitting for 9 store leaders to transfer...\nStill waitting for 9 store leaders to transfer...\nStill waitting for 9 store leaders to transfer...\nStill waitting for 9 store leaders to transfer...\nStill waitting for 9 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\nStill waitting for 8 store leaders to transfer...\n    Restarting instance 10.101.16.245\n    Restart 10.101.16.245 success\nDelete leader evicting scheduler of store 4 success\nRemoved store leader evicting scheduler from 10.101.16.245:20160.\nEvicting 12 leaders from store 10.101.16.245:20161...\nStill waitting for 12 store leaders to transfer...\nStill waitting for 12 store leaders to transfer...\nStill waitting for 12 store leaders to transfer...\n    Restarting instance 10.101.16.245\n    Restart 10.101.16.245 success\nDelete leader evicting scheduler of store 5 success\nRemoved store leader evicting scheduler from 10.101.16.245:20161.\nEvicting 14 leaders from store 10.101.16.245:20162...\nStill waitting for 14 store leaders to transfer...\nStill waitting for 14 store leaders to transfer...\nStill waitting for 14 store leaders to transfer...\n    Restarting instance 10.101.16.245\n    Restart 10.101.16.245 success\nDelete leader evicting scheduler of store 1 success\nRemoved store leader evicting scheduler from 10.101.16.245:20162.\nRestarting component tidb\n    Restarting instance 10.101.16.245\n    Restart 10.101.16.245 success\nRestarting component prometheus\n    Restarting instance 10.101.16.245\n    Restart 10.101.16.245 success\nRestarting component grafana\n    Restarting instance 10.101.16.245\n    Restart 10.101.16.245 success\nReloaded cluster `tidb-ddyw` successfully\n# \u6839\u636enode\u91cd\u542f\u7ec4\u4ef6\ntiup cluster reload tidb-ddyw -N 10.101.16.245:9090\nStarting component `cluster`: /root/.tiup/components/cluster/v1.2.5/tiup-cluster reload tidb-ddyw -N 10.101.16.245:9090\n+ [ Serial ] - SSHKeySet: privateKey=/root/.tiup/storage/cluster/clusters/tidb-ddyw/ssh/id_rsa, publicKey=/root/.tiup/storage/cluster/clusters/tidb-ddyw/ssh/id_rsa.pub\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ Refresh instance configs\n  - Refresh config pd -&gt; 10.101.16.245:2379 ... Done\n  - Refresh config tikv -&gt; 10.101.16.245:20160 ... Done\n  - Refresh config tikv -&gt; 10.101.16.245:20161 ... Done\n  - Refresh config tikv -&gt; 10.101.16.245:20162 ... Done\n  - Refresh config tidb -&gt; 10.101.16.245:4000 ... Done\n  - Refresh config tiflash -&gt; 10.101.16.245:9000 ... Done\n  - Refresh config prometheus -&gt; 10.101.16.245:9090 ... Done\n  - Refresh config grafana -&gt; 10.101.16.245:3000 ... Done\n+ Refresh monitor configs\n  - Refresh config node_exporter -&gt; 10.101.16.245 ... Done\n  - Refresh config blackbox_exporter -&gt; 10.101.16.245 ... Done\n+ [ Serial ] - UpgradeCluster\nRestarting component prometheus\n    Restarting instance 10.101.16.245\n    Restart 10.101.16.245 success\nReloaded cluster `tidb-ddyw` successfully\n# \u6839\u636erole\u91cd\u542f\u7ec4\u4ef6\ntiup cluster reload tidb-ddyw -R prometheus\nStarting component `cluster`: /root/.tiup/components/cluster/v1.2.5/tiup-cluster reload tidb-ddyw -R prometheus\n+ [ Serial ] - SSHKeySet: privateKey=/root/.tiup/storage/cluster/clusters/tidb-ddyw/ssh/id_rsa, publicKey=/root/.tiup/storage/cluster/clusters/tidb-ddyw/ssh/id_rsa.pub\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ [Parallel] - UserSSH: user=tidb, host=10.101.16.245\n+ Refresh instance configs\n  - Refresh config pd -&gt; 10.101.16.245:2379 ... Done\n  - Refresh config tikv -&gt; 10.101.16.245:20160 ... Done\n  - Refresh config tikv -&gt; 10.101.16.245:20161 ... Done\n  - Refresh config tikv -&gt; 10.101.16.245:20162 ... Done\n  - Refresh config tidb -&gt; 10.101.16.245:4000 ... Done\n  - Refresh config tiflash -&gt; 10.101.16.245:9000 ... Done\n  - Refresh config prometheus -&gt; 10.101.16.245:9090 ... Done\n  - Refresh config grafana -&gt; 10.101.16.245:3000 ... Done\n+ Refresh monitor configs\n  - Refresh config node_exporter -&gt; 10.101.16.245 ... Done\n  - Refresh config blackbox_exporter -&gt; 10.101.16.245 ... Done\n+ [ Serial ] - UpgradeCluster\nRestarting component prometheus\n    Restarting instance 10.101.16.245\n    Restart 10.101.16.245 success\nReloaded cluster `tidb-ddyw` successfully\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_8","title":"\u67e5\u770b\u914d\u7f6e","text":"<pre><code># \u67e5\u770b\u914d\u7f6e\u6587\u4ef6\npwd;tree tidb-* pd-* tikv-* tiflash-*/conf;\n/tidb-deploy\ntidb-4000\n\u251c\u2500\u2500 bin\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tidb-server\n\u251c\u2500\u2500 conf\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tidb.toml\n\u251c\u2500\u2500 log\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tidb.log\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tidb_slow_query.log\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tidb_stderr.log\n\u2514\u2500\u2500 scripts\n    \u2514\u2500\u2500 run_tidb.sh\npd-2379\n\u251c\u2500\u2500 bin\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 pd-server\n\u251c\u2500\u2500 conf\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 pd.toml\n\u251c\u2500\u2500 log\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 pd.log\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 pd_stderr.log\n\u2514\u2500\u2500 scripts\n    \u2514\u2500\u2500 run_pd.sh\ntikv-20160\n\u251c\u2500\u2500 bin\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tikv-server\n\u251c\u2500\u2500 conf\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tikv.toml\n\u251c\u2500\u2500 log\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tikv.log\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tikv_stderr.log\n\u2514\u2500\u2500 scripts\n    \u2514\u2500\u2500 run_tikv.sh\ntikv-20161\n\u251c\u2500\u2500 bin\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tikv-server\n\u251c\u2500\u2500 conf\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tikv.toml\n\u251c\u2500\u2500 log\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tikv.log\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tikv_stderr.log\n\u2514\u2500\u2500 scripts\n    \u2514\u2500\u2500 run_tikv.sh\ntikv-20162\n\u251c\u2500\u2500 bin\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tikv-server\n\u251c\u2500\u2500 conf\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tikv.toml\n\u251c\u2500\u2500 log\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tikv.log\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tikv_stderr.log\n\u2514\u2500\u2500 scripts\n    \u2514\u2500\u2500 run_tikv.sh\ntiflash-9000/conf\n\u251c\u2500\u2500 tiflash-learner.toml\n\u251c\u2500\u2500 tiflash-preprocessed.toml\n\u2514\u2500\u2500 tiflash.toml\n\n20 directories, 29 files\n# \u67e5\u770b\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9\ntree tidb-*/conf/*.toml &amp;&amp; cat tidb-*/conf/*.toml &amp;&amp; echo -e \"\\n+++++++++++++++++++++++++++++++++++++++++++++++\\n\";tree pd-*/conf/*.toml &amp;&amp; cat pd-*/conf/*.toml &amp;&amp; echo -e \"\\n+++++++++++++++++++++++++++++++++++++++++++++++\\n\";tree tikv-*/conf/*.toml &amp;&amp; cat tikv-*/conf/*.toml &amp;&amp; echo -e \"\\n+++++++++++++++++++++++++++++++++++++++++++++++\\n\";tree tiflash-*/conf/*.toml &amp;&amp; cat tiflash-*/conf/*.toml;\n\ntidb-4000/conf/tidb.toml [error opening dir]\n\n0 directories, 0 files\n# WARNING: This file is auto-generated. Do not edit! All your modification will be overwritten!\n# You can use 'tiup cluster edit-config' and 'tiup cluster reload' to update the configuration\n# All configuration items you want to change can be added to:\n# server_configs:\n#   tidb:\n#     aa.b1.c3: value\n#     aa.b2.c4: value\n[log]\nslow-threshold = 300\n\n+++++++++++++++++++++++++++++++++++++++++++++++\n\npd-2379/conf/pd.toml [error opening dir]\n\n0 directories, 0 files\n# WARNING: This file is auto-generated. Do not edit! All your modification will be overwritten!\n# You can use 'tiup cluster edit-config' and 'tiup cluster reload' to update the configuration\n# All configuration items you want to change can be added to:\n# server_configs:\n#   pd:\n#     aa.b1.c3: value\n#     aa.b2.c4: value\n[pd-server]\nmetric-storage = \"http://10.101.16.245:9090\"\n\n[replication]\nenable-placement-rules = true\nlocation-labels = [\"host\"]\n\n+++++++++++++++++++++++++++++++++++++++++++++++\n\ntikv-20160/conf/tikv.toml [error opening dir]\ntikv-20161/conf/tikv.toml [error opening dir]\ntikv-20162/conf/tikv.toml [error opening dir]\n\n0 directories, 0 files\n# WARNING: This file is auto-generated. Do not edit! All your modification will be overwritten!\n# You can use 'tiup cluster edit-config' and 'tiup cluster reload' to update the configuration\n# All configuration items you want to change can be added to:\n# server_configs:\n#   tikv:\n#     aa.b1.c3: value\n#     aa.b2.c4: value\n[readpool]\n[readpool.coprocessor]\nuse-unified-pool = true\n[readpool.storage]\nuse-unified-pool = false\n\n[server]\n[server.labels]\nhost = \"logic-host-1\"\n# WARNING: This file is auto-generated. Do not edit! All your modification will be overwritten!\n# You can use 'tiup cluster edit-config' and 'tiup cluster reload' to update the configuration\n# All configuration items you want to change can be added to:\n# server_configs:\n#   tikv:\n#     aa.b1.c3: value\n#     aa.b2.c4: value\n[readpool]\n[readpool.coprocessor]\nuse-unified-pool = true\n[readpool.storage]\nuse-unified-pool = false\n\n[server]\n[server.labels]\nhost = \"logic-host-2\"\n# WARNING: This file is auto-generated. Do not edit! All your modification will be overwritten!\n# You can use 'tiup cluster edit-config' and 'tiup cluster reload' to update the configuration\n# All configuration items you want to change can be added to:\n# server_configs:\n#   tikv:\n#     aa.b1.c3: value\n#     aa.b2.c4: value\n[readpool]\n[readpool.coprocessor]\nuse-unified-pool = true\n[readpool.storage]\nuse-unified-pool = false\n\n[server]\n[server.labels]\nhost = \"logic-host-3\"\n\n+++++++++++++++++++++++++++++++++++++++++++++++\n\ntiflash-9000/conf/tiflash-learner.toml [error opening dir]\ntiflash-9000/conf/tiflash-preprocessed.toml [error opening dir]\ntiflash-9000/conf/tiflash.toml [error opening dir]\n\n0 directories, 0 files\n# WARNING: This file is auto-generated. Do not edit! All your modification will be overwritten!\n# You can use 'tiup cluster edit-config' and 'tiup cluster reload' to update the configuration\n# All configuration items you want to change can be added to:\n# server_configs:\n#   tiflash-learner:\n#     aa.b1.c3: value\n#     aa.b2.c4: value\nlog-file = \"/tidb-deploy/tiflash-9000/log/tiflash_tikv.log\"\n\n[raftstore]\napply-pool-size = 4\nstore-pool-size = 4\n\n[rocksdb]\nwal-dir = \"\"\n\n[security]\nca-path = \"\"\ncert-path = \"\"\nkey-path = \"\"\n\n[server]\naddr = \"0.0.0.0:20170\"\nadvertise-addr = \"10.101.16.245:20170\"\nadvertise-status-addr = \"10.101.16.245:20292\"\nengine-addr = \"10.101.16.245:3930\"\nstatus-addr = \"0.0.0.0:20292\"\n\n[storage]\ndata-dir = \"/tidb-data/tiflash-9000/flash\"\ntmp_path = \"/tidb-data/tiflash-9000/tmp\"\ntcp_port = 9000\ndisplay_name = \"TiFlash\"\ndefault_profile = \"default\"\nmark_cache_size = 5368709120\nhttp_port = 8123\nlisten_host = \"0.0.0.0\"\npath = \"/tidb-data/tiflash-9000\"\n[users]\n    [users.readonly]\n        quota = \"default\"\n        password = \"\"\n        profile = \"readonly\"\n        [users.readonly.networks]\n            ip = \"::/0\"\n    [users.default]\n        quota = \"default\"\n        password = \"\"\n        profile = \"default\"\n        [users.default.networks]\n            ip = \"::/0\"\n[status]\n    metrics_port = 8234\n[profiles]\n    [profiles.readonly]\n        readonly = 1\n    [profiles.default]\n        use_uncompressed_cache = 0\n        load_balancing = \"random\"\n        max_memory_usage = 10000000000\n[quotas]\n    [quotas.default]\n        [quotas.default.interval]\n            result_rows = 0\n            read_rows = 0\n            queries = 0\n            execution_time = 0\n            duration = 3600\n            errors = 0\n[raft]\n    pd_addr = \"10.101.16.245:2379\"\n[flash]\n    service_addr = \"10.101.16.245:3930\"\n    tidb_status_addr = \"10.101.16.245:10080\"\n    [flash.proxy]\n        config = \"/tidb-deploy/tiflash-9000/conf/tiflash-learner.toml\"\n    [flash.flash_cluster]\n        update_rule_interval = 5\n        master_ttl = 60\n        refresh_interval = 20\n        cluster_manager_path = \"/tidb-deploy/tiflash-9000/bin/tiflash/flash_cluster_manager\"\n        log = \"/tidb-deploy/tiflash-9000/log/tiflash_cluster_manager.log\"\n[application]\n    runAsDaemon = true\n[logger]\n    log = \"/tidb-deploy/tiflash-9000/log/tiflash.log\"\n    level = \"info\"\n    size = \"1000M\"\n    count = 20\n    errorlog = \"/tidb-deploy/tiflash-9000/log/tiflash_error.log\"\n# WARNING: This file is auto-generated. Do not edit! All your modification will be overwritten!\n# You can use 'tiup cluster edit-config' and 'tiup cluster reload' to update the configuration\n# All configuration items you want to change can be added to:\n# server_configs:\n#   tiflash:\n#     aa.b1.c3: value\n#     aa.b2.c4: value\ndefault_profile = \"default\"\ndisplay_name = \"TiFlash\"\nhttp_port = 8123\nlisten_host = \"0.0.0.0\"\nmark_cache_size = 5368709120\npath = \"/tidb-data/tiflash-9000\"\ntcp_port = 9000\ntmp_path = \"/tidb-data/tiflash-9000/tmp\"\n\n[application]\nrunAsDaemon = true\n\n[flash]\nservice_addr = \"10.101.16.245:3930\"\ntidb_status_addr = \"10.101.16.245:10080\"\n[flash.flash_cluster]\ncluster_manager_path = \"/tidb-deploy/tiflash-9000/bin/tiflash/flash_cluster_manager\"\nlog = \"/tidb-deploy/tiflash-9000/log/tiflash_cluster_manager.log\"\nmaster_ttl = 60\nrefresh_interval = 20\nupdate_rule_interval = 5\n[flash.proxy]\nconfig = \"/tidb-deploy/tiflash-9000/conf/tiflash-learner.toml\"\n\n[logger]\ncount = 20\nerrorlog = \"/tidb-deploy/tiflash-9000/log/tiflash_error.log\"\nlevel = \"info\"\nlog = \"/tidb-deploy/tiflash-9000/log/tiflash.log\"\nsize = \"1000M\"\n\n[profiles]\n[profiles.default]\nload_balancing = \"random\"\nmax_memory_usage = 10000000000\nuse_uncompressed_cache = 0\n[profiles.readonly]\nreadonly = 1\n\n[quotas]\n[quotas.default]\n[quotas.default.interval]\nduration = 3600\nerrors = 0\nexecution_time = 0\nqueries = 0\nread_rows = 0\nresult_rows = 0\n\n[raft]\npd_addr = \"10.101.16.245:2379\"\n\n[status]\nmetrics_port = 8234\n\n[users]\n[users.default]\npassword = \"\"\nprofile = \"default\"\nquota = \"default\"\n[users.default.networks]\nip = \"::/0\"\n[users.readonly]\npassword = \"\"\nprofile = \"readonly\"\nquota = \"default\"\n[users.readonly.networks]\nip = \"::/0\"\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_9","title":"\u6570\u636e\u8fc1\u79fb","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_10","title":"\u6570\u636e\u5bfc\u5165","text":"<pre><code># \u4e0b\u8f7d\u793a\u4f8b\u6570\u636e\nmkdir -p bikeshare-data &amp;&amp; cd bikeshare-data\ncurl -L --remote-name-all https://s3.amazonaws.com/capitalbikeshare-data/{2010..2017}-capitalbikeshare-tripdata.zip\nunzip \\*-tripdata.zip\n# \u52a0\u8f7d\u6570\u636e\u5230TIDB\u4e2d\n## \u521b\u5efa\u8868\nCREATE DATABASE bikeshare;\nUSE bikeshare;\n\nCREATE TABLE trips (\n trip_id bigint NOT NULL PRIMARY KEY AUTO_INCREMENT,\n duration integer not null,\n start_date datetime,\n end_date datetime,\n start_station_number integer,\n start_station varchar(255),\n end_station_number integer,\n end_station varchar(255),\n bike_number varchar(255),\n member_type varchar(255)\n);\n## \u5bfc\u5165\u5355\u4e2a\u6587\u4ef6\u6570\u636e\nLOAD DATA LOCAL INFILE '2017Q1-capitalbikeshare-tripdata.csv' INTO TABLE trips\n  FIELDS TERMINATED BY ',' ENCLOSED BY '\"'\n  LINES TERMINATED BY '\\r\\n'\n  IGNORE 1 LINES\n(duration, start_date, end_date, start_station_number, start_station,\nend_station_number, end_station, bike_number, member_type);\n## \u6279\u91cf\u5bfc\u5165\nfor FILE in `ls *.csv`; do\n echo \"== $FILE ==\"\n mysql bikeshare --local-infile=1 -e \"LOAD DATA LOCAL INFILE '${FILE}' INTO TABLE trips FIELDS TERMINATED BY ',' ENCLOSED BY '\\\"' LINES TERMINATED BY '\\r\\n' IGNORE 1 LINES (duration, start_date, end_date, start_station_number, start_station, end_station_number, end_station, bike_number, member_type);\"\ndone;\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#sysbenchtidb","title":"Sysbench\u6d4b\u8bd5TIDB","text":"<p>IDC\u673a\u5668\uff1a</p> \u7c7b\u578b \u540d\u79f0 \u64cd\u4f5c\u7cfb\u7edf \u4e2d\u592e\u5904\u7406\u5668 \u5185\u5b58 \u78c1\u76d8 \u7f51\u5361"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_11","title":"\u96c6\u7fa4\u62d3\u6251","text":"\u673a\u5668IP \u90e8\u7f72\u5b9e\u4f8b 10.101.16.246 sysbench 10.101.16.246 tidb tikv 10.101.16.247 tikv pd 10.101.16.248 tikv tiflash"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#tidb_3","title":"TIDB\u914d\u7f6e","text":"<pre><code>[log]\nlevel = \"error\"\n[prepared-plan-cache]\nenabled = true\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#tikv","title":"TIKV\u914d\u7f6e","text":"<p>\u9ed8\u8ba4CF\uff1a\u5199\u5165CF = 4\uff1a1</p> <pre><code>log-level = \"error\"\n[rocksdb.defaultcf]\nblock-cache-size = \"8GB\"\n[rocksdb.writecf]\nblock-cache-size = \"2GB\"\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#reload","title":"Reload \u914d\u7f6e","text":"<pre><code>tiup cluster reload tidb-ddyw\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_12","title":"\u6d4b\u8bd5","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#sysbench","title":"\u5b89\u88c5Sysbench","text":"<pre><code>curl -s https://packagecloud.io/install/repositories/akopytov/sysbench/script.rpm.sh | bash\nyum -y install sysbench\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#sysbench_1","title":"Sysbench\u914d\u7f6e","text":"<pre><code># \u914d\u7f6e8\u4e2a\u7ebf\u7a0b\ncat &gt; config &lt;&lt;- 'EOF'\nmysql-host=10.101.16.246\nmysql-port=4000\nmysql-user=root\n#mysql-password=password\nmysql-password=''\nmysql-db=sbtest\ntime=600\n#threads={8, 16, 32, 64, 128, 256}\nthreads=8\nreport-interval=10\ndb-driver=mysql\nEOF\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#tidb_4","title":"\u914d\u7f6eTIDB","text":"<pre><code># \u767b\u5f55\u6570\u636e\u5e93,\u914d\u7f6e\u53c2\u6570\nset global tidb_disable_txn_auto_retry = off;\n# \u521b\u5efa\u6570\u636e\u5e93\ncreate database sbtest;\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_13","title":"\u5bfc\u5165\u6570\u636e","text":"<pre><code># \u5bfc\u5165\u6570\u636e(32\u5f20\u8868,5000\u4e07\u6570\u636e)\nsysbench --config-file=config oltp_point_select --tables=24 --table-size=50000000 prepare\n# \u67e5\u770b\u521b\u5efa\u6570\u636e\u8868\nMySQL [sbtest]&gt; show tables;\n+------------------+\n| Tables_in_sbtest |\n+------------------+\n| sbtest1          |\n| sbtest2          |\n| sbtest3          |\n| sbtest4          |\n| sbtest5          |\n| sbtest6          |\n| sbtest7          |\n| sbtest8          |\n+------------------+\n8 rows in set (0.01 sec)\n\n# \u67e5\u770b\u8868\u7ed3\u6784\nMySQL [sbtest]&gt; desc sbtest1;\n+-------+-----------+------+------+---------+----------------+\n| Field | Type      | Null | Key  | Default | Extra          |\n+-------+-----------+------+------+---------+----------------+\n| id    | int(11)   | NO   | PRI  | NULL    | auto_increment |\n| k     | int(11)   | NO   |      | 0       |                |\n| c     | char(120) | NO   |      |         |                |\n| pad   | char(60)  | NO   |      |         |                |\n+-------+-----------+------+------+---------+----------------+\n4 rows in set (0.00 sec)\n\n# \u67e5\u770b\u6570\u636e\u8bb0\u5f55,\u7531\u4e8e\u5206\u5e03\u5f0f\u67e5\u8be2\u65f6\u95f4\u4e0d\u56fa\u5b9a\nMySQL [sbtest]&gt; select count(*) from sbtest1;\n+----------+\n| count(*) |\n+----------+\n|   588081 |\n+----------+\n1 row in set (2.07 sec)\n\nMySQL [sbtest]&gt; select count(*) from sbtest1;\n+----------+\n| count(*) |\n+----------+\n|   588081 |\n+----------+\n1 row in set (1.22 sec)\n\n# \u5355\u8868\u67e5\u8be2\u6d4b\u8bd5\nMySQL [sbtest]&gt; select count(id) from sbtest4;\n</code></pre> <p>sysbench mysql \u7684\u6d4b\u8bd5\u7c7b\u578b\uff1a</p> <pre><code>#1. bulk_insert.lua  \u6279\u91cf\u5199\u5165\u64cd\u4f5c\n#2. oltp_delete.lua \u5199\u5165\u548c\u5220\u9664\u5e76\u884c\u64cd\u4f5c\n#3. oltp_insert.lua  \u7eaf\u5199\u5165\u64cd\u4f5c\n#4. oltp_point_select.lua  \u53ea\u8bfb\u64cd\u4f5c\uff0c\u6761\u4ef6\u4e3a\u552f\u4e00\u7d22\u5f15\u5217\n#5. oltp_read_only.lua  \u53ea\u8bfb\u64cd\u4f5c\uff0c\u5305\u542b\u805a\u5408\uff0c\u53bb\u91cd\u7b49\u64cd\u4f5c \u5927\u591a\u6570\u60c5\u51b5\u7528\u4e8e\u7edf\u8ba1\u7684\u538b\u6d4b\n#6. oltp_read_write.lua \u8bfb\u5199\u6df7\u5408\u64cd\u4f5c\uff0c\u6700\u5e38\u7528\u7684\u811a\u672c  \u7528\u4e8eoltp\u7cfb\u7edf\u7684\u538b\u6d4b\u3002\n#7. oltp_update_index.lua \u66f4\u65b0\u64cd\u4f5c\uff0c\u901a\u8fc7\u4e3b\u952e\u8fdb\u884c\u66f4\u65b0\n#8. oltp_update_non_index.lua \u66f4\u65b0\u64cd\u4f5c\uff0c\u4e0d\u901a\u8fc7\u7d22\u5f15\u5217\n#9. oltp_write_only.lua \u7eaf\u5199\u64cd\u4f5c\uff0c\u5e38\u7528\u811a\u672c\uff0c\u5305\u62ecinsert update delete\n#10. select_random_points.lua \u968f\u673a\u96c6\u5408\u53ea\u8bfb\u64cd\u4f5c\uff0c\u5e38\u7528\u811a\u672c\uff0c\u805a\u96c6\u7d22\u5f15\u5217\u7684selete in\u64cd\u4f5c\n#11. select_random_ranges.lua \u968f\u673a\u8303\u56f4\u53ea\u8bfb\u64cd\u4f5c\uff0c\u5e38\u7528\u811a\u672c\uff0c\u805a\u96c6\u7d22\u5f15\u5217\u7684selete between\u64cd\u4f5c\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#select","title":"SELECT \u6d4b\u8bd5","text":"<pre><code># selct\u6d4b\u8bd5 8\u7ebf\u7a0b,\u6d4b\u8bd5\u65f6\u95f410\u5206\u949f\nsed -i 's/^threads=.*/threads=8/g' config\nsysbench --config-file=config oltp_point_select --tables=24 --table-size=50000000 run\n# \u6d4b\u8bd5\u7ed3\u679c\u5982\u4e0b\n[ 10s ] thds: 8 tps: 3911.12 qps: 3911.12 (r/w/o: 3911.12/0.00/0.00) lat (ms,95%): 6.09 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 8 tps: 6136.49 qps: 6136.49 (r/w/o: 6136.49/0.00/0.00) lat (ms,95%): 3.62 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 8 tps: 6236.03 qps: 6236.03 (r/w/o: 6236.03/0.00/0.00) lat (ms,95%): 3.68 \nSQL statistics:\n    queries performed:\n        read:                            3908017\n        write:                           0\n        other:                           0\n        total:                           3908017\n    transactions:                        3908017 (6512.09 per sec.)\n    queries:                             3908017 (6512.09 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.1155s\n    total number of events:              3908017\n\nLatency (ms):\n         min:                                    0.16\n         avg:                                    1.23\n         max:                                  630.21\n         95th percentile:                        3.30\n         sum:                              4796344.69\n\nThreads fairness:\n    events (avg/stddev):           488502.1250/1422.83\n    execution time (avg/stddev):   599.5431/0.05\n# selct\u6d4b\u8bd5 16\u7ebf\u7a0b,\u6d4b\u8bd5\u65f6\u95f410\u5206\u949f\nsed -i 's/^threads=.*/threads=16/g' config\nsysbench --config-file=config oltp_point_select --tables=24 --table-size=50000000 run\n[ 10s ] thds: 16 tps: 11403.36 qps: 11403.36 (r/w/o: 11403.36/0.00/0.00) lat (ms,95%): 4.49 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 16 tps: 12498.39 qps: 12498.39 (r/w/o: 12498.39/0.00/0.00) lat (ms,95%): 3.68 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 16 tps: 11772.82 qps: 11772.82 (r/w/o: 11772.82/0.00/0.00) lat (ms,95%): 4.25 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 16 tps: 10885.84 qps: 10885.84 (r/w/o: 10885.84/0.00/0.00) lat (ms,95%): 5.00 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 16 tps: 9687.64 qps: 9687.64 (r/w/o: 9687.64/0.00/0.00) lat (ms,95%): 5.57 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            6845695\n        write:                           0\n        other:                           0\n        total:                           6845695\n    transactions:                        6845695 (11408.77 per sec.)\n    queries:                             6845695 (11408.77 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0364s\n    total number of events:              6845695\n\nLatency (ms):\n         min:                                    0.18\n         avg:                                    1.40\n         max:                                 1114.67\n         95th percentile:                        4.10\n         sum:                              9593800.55\n\nThreads fairness:\n    events (avg/stddev):           427855.9375/1035.31\n    execution time (avg/stddev):   599.6125/0.01\n# selct\u6d4b\u8bd5 32\u7ebf\u7a0b,\u6d4b\u8bd5\u65f6\u95f410\u5206\u949f\nsed -i 's/^threads=.*/threads=32/g' config\nsysbench --config-file=config oltp_point_select --tables=24 --table-size=50000000 run\n[ 10s ] thds: 32 tps: 10895.10 qps: 10895.10 (r/w/o: 10895.10/0.00/0.00) lat (ms,95%): 8.28 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 32 tps: 15195.12 qps: 15195.12 (r/w/o: 15195.12/0.00/0.00) lat (ms,95%): 6.32 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 32 tps: 20718.77 qps: 20718.77 (r/w/o: 20718.77/0.00/0.00) lat (ms,95%): 4.49 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 32 tps: 20349.07 qps: 20349.07 (r/w/o: 20349.07/0.00/0.00) lat (ms,95%): 4.18 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 32 tps: 20807.25 qps: 20807.25 (r/w/o: 20807.25/0.00/0.00) lat (ms,95%): 4.57 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 32 tps: 22122.78 qps: 22122.78 (r/w/o: 22122.78/0.00/0.00) lat (ms,95%): 4.49 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            10320806\n        write:                           0\n        other:                           0\n        total:                           10320806\n    transactions:                        10320806 (17198.11 per sec.)\n    queries:                             10320806 (17198.11 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.1112s\n    total number of events:              10320806\n\nLatency (ms):\n         min:                                    0.16\n         avg:                                    1.86\n         max:                                 1632.43\n         95th percentile:                        5.67\n         sum:                             19192033.79\n\nThreads fairness:\n    events (avg/stddev):           322525.1875/1060.65\n    execution time (avg/stddev):   599.7511/0.00\n# selct\u6d4b\u8bd5 64\u7ebf\u7a0b,\u6d4b\u8bd5\u65f6\u95f410\u5206\u949f\nsed -i 's/^threads=.*/threads=64/g' config\nsysbench --config-file=config oltp_point_select --tables=24 --table-size=50000000 run\n[ 10s ] thds: 64 tps: 6306.33 qps: 6306.33 (r/w/o: 6306.33/0.00/0.00) lat (ms,95%): 30.26 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 64 tps: 18739.97 qps: 18739.97 (r/w/o: 18739.97/0.00/0.00) lat (ms,95%): 9.06 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 64 tps: 20780.49 qps: 20780.49 (r/w/o: 20780.49/0.00/0.00) lat (ms,95%): 8.28 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 64 tps: 19896.00 qps: 19896.00 (r/w/o: 19896.00/0.00/0.00) lat (ms,95%): 9.91 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 64 tps: 17163.66 qps: 17163.66 (r/w/o: 17163.66/0.00/0.00) lat (ms,95%): 11.04 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 64 tps: 22208.62 qps: 22208.62 (r/w/o: 22208.62/0.00/0.00) lat (ms,95%): 8.43 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            12871444\n        write:                           0\n        other:                           0\n        total:                           12871444\n    transactions:                        12871444 (21451.15 per sec.)\n    queries:                             12871444 (21451.15 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0336s\n    total number of events:              12871444\n\nLatency (ms):\n         min:                                    0.16\n         avg:                                    2.98\n         max:                                 1493.53\n         95th percentile:                        8.43\n         sum:                             38391016.53\n\nThreads fairness:\n    events (avg/stddev):           201116.3125/503.93\n    execution time (avg/stddev):   599.8596/0.00\n# selct\u6d4b\u8bd5 128\u7ebf\u7a0b,\u6d4b\u8bd5\u65f6\u95f410\u5206\u949f\nsed -i 's/^threads=.*/threads=128/g' config\nsysbench --config-file=config oltp_point_select --tables=24 --table-size=50000000 run\n[ 10s ] thds: 128 tps: 23254.21 qps: 23254.21 (r/w/o: 23254.21/0.00/0.00) lat (ms,95%): 16.12 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 128 tps: 24602.03 qps: 24602.03 (r/w/o: 24602.03/0.00/0.00) lat (ms,95%): 13.22 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 128 tps: 27695.07 qps: 27695.07 (r/w/o: 27695.07/0.00/0.00) lat (ms,95%): 13.46 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 128 tps: 26395.86 qps: 26395.86 (r/w/o: 26395.86/0.00/0.00) lat (ms,95%): 12.98 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 128 tps: 28633.02 qps: 28633.02 (r/w/o: 28633.02/0.00/0.00) lat (ms,95%): 12.75 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 128 tps: 28279.46 qps: 28279.46 (r/w/o: 28279.46/0.00/0.00) lat (ms,95%): 12.98 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            15867653\n        write:                           0\n        other:                           0\n        total:                           15867653\n    transactions:                        15867653 (26426.46 per sec.)\n    queries:                             15867653 (26426.46 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.4442s\n    total number of events:              15867653\n\nLatency (ms):\n         min:                                    0.16\n         avg:                                    4.84\n         max:                                 1295.69\n         95th percentile:                       13.46\n         sum:                             76797738.06\n\nThreads fairness:\n    events (avg/stddev):           123966.0391/421.67\n    execution time (avg/stddev):   599.9823/0.08\n# selct\u6d4b\u8bd5 256\u7ebf\u7a0b,\u6d4b\u8bd5\u65f6\u95f410\u5206\u949f\nsed -i 's/^threads=.*/threads=256/g' config\nsysbench --config-file=config oltp_point_select --tables=24 --table-size=50000000 run\n[ 10s ] thds: 256 tps: 3956.05 qps: 3956.05 (r/w/o: 3956.05/0.00/0.00) lat (ms,95%): 244.38 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 256 tps: 10995.73 qps: 10995.73 (r/w/o: 10995.73/0.00/0.00) lat (ms,95%): 75.82 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 256 tps: 15475.90 qps: 15475.90 (r/w/o: 15475.90/0.00/0.00) lat (ms,95%): 55.82 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 256 tps: 14701.82 qps: 14701.82 (r/w/o: 14701.82/0.00/0.00) lat (ms,95%): 59.99 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 256 tps: 12388.89 qps: 12388.89 (r/w/o: 12388.89/0.00/0.00) lat (ms,95%): 89.16 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 256 tps: 25637.06 qps: 25637.06 (r/w/o: 25637.06/0.00/0.00) lat (ms,95%): 25.28 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            15188519\n        write:                           0\n        other:                           0\n        total:                           15188519\n    transactions:                        15188519 (25311.42 per sec.)\n    queries:                             15188519 (25311.42 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0643s\n    total number of events:              15188519\n\nLatency (ms):\n         min:                                    0.16\n         avg:                                   10.11\n         max:                                 2198.00\n         95th percentile:                       27.17\n         sum:                            153591443.49\n\nThreads fairness:\n    events (avg/stddev):           59330.1523/254.59\n    execution time (avg/stddev):   599.9666/0.02\n\n# \u53ea\u8bfb\u6d4b\u8bd5\nsysbench --config-file=config oltp_read_only --tables=24 --table-size=50000000 run\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#update","title":"UPDATE \u4e3b\u952e\u66f4\u65b0\u6d4b\u8bd5","text":"<pre><code># update index 8\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=8/g' config\nsysbench --config-file=config oltp_update_index --tables=24 --table-size=50000000 run\n[ 10s ] thds: 8 tps: 105.97 qps: 105.97 (r/w/o: 0.00/104.87/1.10) lat (ms,95%): 257.95 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 8 tps: 185.20 qps: 185.20 (r/w/o: 0.00/183.00/2.20) lat (ms,95%): 80.03 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 8 tps: 171.99 qps: 171.99 (r/w/o: 0.00/170.69/1.30) lat (ms,95%): 92.42 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 8 tps: 219.92 qps: 219.92 (r/w/o: 0.00/217.82/2.10) lat (ms,95%): 80.03 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 8 tps: 293.50 qps: 293.50 (r/w/o: 0.00/289.90/3.60) lat (ms,95%): 42.61 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 8 tps: 358.60 qps: 358.60 (r/w/o: 0.00/355.40/3.20) lat (ms,95%): 36.24 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           150714\n        other:                           1363\n        total:                           152077\n    transactions:                        152077 (253.45 per sec.)\n    queries:                             152077 (253.45 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0337s\n    total number of events:              152077\n\nLatency (ms):\n         min:                                    0.45\n         avg:                                   31.56\n         max:                                 2484.02\n         95th percentile:                       62.19\n         sum:                              4799864.38\n\nThreads fairness:\n    events (avg/stddev):           19009.6250/71.48\n    execution time (avg/stddev):   599.9830/0.01\n\n# update index 16\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=16/g' config\nsysbench --config-file=config oltp_update_index --tables=24 --table-size=50000000 run\n[ 10s ] thds: 16 tps: 286.55 qps: 286.55 (r/w/o: 0.00/284.45/2.10) lat (ms,95%): 144.97 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 16 tps: 374.59 qps: 374.59 (r/w/o: 0.00/371.19/3.40) lat (ms,95%): 78.60 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 16 tps: 325.80 qps: 325.80 (r/w/o: 0.00/321.50/4.30) lat (ms,95%): 101.13 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 16 tps: 223.41 qps: 223.41 (r/w/o: 0.00/221.51/1.90) lat (ms,95%): 287.38 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 16 tps: 372.00 qps: 372.00 (r/w/o: 0.00/368.10/3.90) lat (ms,95%): 65.65 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 16 tps: 435.20 qps: 435.20 (r/w/o: 0.00/432.20/3.00) lat (ms,95%): 65.65 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           273213\n        other:                           2444\n        total:                           275657\n    transactions:                        275657 (459.40 per sec.)\n    queries:                             275657 (459.40 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0415s\n    total number of events:              275657\n\nLatency (ms):\n         min:                                    0.42\n         avg:                                   34.83\n         max:                                 2363.14\n         95th percentile:                       75.82\n         sum:                              9599848.16\n\nThreads fairness:\n    events (avg/stddev):           17228.5625/61.31\n    execution time (avg/stddev):   599.9905/0.01\n\n# update index 16\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=32/g' config\nsysbench --config-file=config oltp_update_index --tables=24 --table-size=50000000 run\n[ 10s ] thds: 32 tps: 640.93 qps: 640.93 (r/w/o: 0.00/635.83/5.10) lat (ms,95%): 80.03 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 32 tps: 637.31 qps: 637.31 (r/w/o: 0.00/631.81/5.50) lat (ms,95%): 94.10 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 32 tps: 825.59 qps: 825.59 (r/w/o: 0.00/818.39/7.20) lat (ms,95%): 66.84 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 32 tps: 677.69 qps: 677.69 (r/w/o: 0.00/671.79/5.90) lat (ms,95%): 95.81 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 32 tps: 986.00 qps: 986.00 (r/w/o: 0.00/976.30/9.70) lat (ms,95%): 64.47 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 32 tps: 1095.82 qps: 1095.82 (r/w/o: 0.00/1085.52/10.30) lat (ms,95%): 52.89 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           674705\n        other:                           6017\n        total:                           680722\n    transactions:                        680722 (1134.22 per sec.)\n    queries:                             680722 (1134.22 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.1651s\n    total number of events:              680722\n\nLatency (ms):\n         min:                                    0.38\n         avg:                                   28.21\n         max:                                 1179.24\n         95th percentile:                       53.85\n         sum:                             19201507.50\n\nThreads fairness:\n    events (avg/stddev):           21272.5625/57.52\n    execution time (avg/stddev):   600.0471/0.04\n# update index 64\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=64/g' config\nsysbench --config-file=config oltp_update_index --tables=24 --table-size=50000000 run\n[ 10s ] thds: 64 tps: 2180.69 qps: 2180.69 (r/w/o: 0.00/2158.20/22.49) lat (ms,95%): 47.47 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 64 tps: 1979.82 qps: 1979.82 (r/w/o: 0.00/1960.52/19.30) lat (ms,95%): 52.89 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 64 tps: 1898.09 qps: 1898.09 (r/w/o: 0.00/1882.09/16.00) lat (ms,95%): 65.65 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 64 tps: 1968.12 qps: 1968.12 (r/w/o: 0.00/1951.42/16.70) lat (ms,95%): 50.11 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 64 tps: 2244.30 qps: 2244.30 (r/w/o: 0.00/2224.10/20.20) lat (ms,95%): 44.17 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 64 tps: 1448.81 qps: 1448.81 (r/w/o: 0.00/1436.21/12.60) lat (ms,95%): 118.92 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           1145001\n        other:                           10176\n        total:                           1155177\n    transactions:                        1155177 (1925.14 per sec.)\n    queries:                             1155177 (1925.14 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0474s\n    total number of events:              1155177\n\nLatency (ms):\n         min:                                    0.45\n         avg:                                   33.24\n         max:                                 2247.91\n         95th percentile:                       56.84\n         sum:                             38399975.13\n\nThreads fairness:\n    events (avg/stddev):           18049.6406/49.49\n    execution time (avg/stddev):   599.9996/0.01\n# update index 128\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=128/g' config\nsysbench --config-file=config oltp_update_index --tables=24 --table-size=50000000 run\n[ 10s ] thds: 128 tps: 2940.58 qps: 2940.58 (r/w/o: 0.00/2915.20/25.38) lat (ms,95%): 87.56 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 128 tps: 2761.92 qps: 2761.92 (r/w/o: 0.00/2737.02/24.90) lat (ms,95%): 80.03 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 128 tps: 2847.77 qps: 2847.77 (r/w/o: 0.00/2823.67/24.10) lat (ms,95%): 84.47 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 128 tps: 2562.89 qps: 2562.89 (r/w/o: 0.00/2539.79/23.10) lat (ms,95%): 74.46 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 128 tps: 2779.34 qps: 2779.34 (r/w/o: 0.00/2754.14/25.20) lat (ms,95%): 101.13 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 128 tps: 3990.12 qps: 3990.12 (r/w/o: 0.00/3952.02/38.10) lat (ms,95%): 59.99 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           2381625\n        other:                           21414\n        total:                           2403039\n    transactions:                        2403039 (4004.38 per sec.)\n    queries:                             2403039 (4004.38 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.1009s\n    total number of events:              2403039\n\nLatency (ms):\n         min:                                    0.44\n         avg:                                   31.96\n         max:                                 2111.37\n         95th percentile:                       58.92\n         sum:                             76804828.46\n\nThreads fairness:\n    events (avg/stddev):           18773.7422/47.75\n    execution time (avg/stddev):   600.0377/0.02\n# update index 256\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=256/g' config\nsysbench --config-file=config oltp_update_index --tables=24 --table-size=50000000 run\n[ 10s ] thds: 256 tps: 3950.63 qps: 3950.63 (r/w/o: 0.00/3916.67/33.95) lat (ms,95%): 142.39 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 256 tps: 3807.87 qps: 3807.87 (r/w/o: 0.00/3775.37/32.50) lat (ms,95%): 134.90 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 256 tps: 4390.40 qps: 4390.40 (r/w/o: 0.00/4348.90/41.50) lat (ms,95%): 112.67 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 256 tps: 4877.34 qps: 4877.34 (r/w/o: 0.00/4833.34/44.00) lat (ms,95%): 106.75 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 256 tps: 5416.16 qps: 5416.16 (r/w/o: 0.00/5371.16/45.00) lat (ms,95%): 94.10 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 256 tps: 5808.93 qps: 5808.93 (r/w/o: 0.00/5759.15/49.77) lat (ms,95%): 81.48 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           3129355\n        other:                           27823\n        total:                           3157178\n    transactions:                        3157178 (5258.48 per sec.)\n    queries:                             3157178 (5258.48 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.3958s\n    total number of events:              3157178\n\nLatency (ms):\n         min:                                    0.44\n         avg:                                   48.67\n         max:                                 2368.23\n         95th percentile:                       97.55\n         sum:                            153649411.42\n\nThreads fairness:\n    events (avg/stddev):           12332.7266/50.73\n    execution time (avg/stddev):   600.1930/0.11\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_14","title":"\u8bfb\u5199\u6df7\u5408\u6d4b\u8bd5","text":"<pre><code># select insert 8\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=8/g' config\nsysbench --config-file=config oltp_read_write --tables=24 --table-size=50000000 run\n[ 10s ] thds: 8 tps: 172.47 qps: 3460.48 (r/w/o: 2423.67/685.78/351.04) lat (ms,95%): 65.65 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 8 tps: 207.91 qps: 4156.23 (r/w/o: 2908.69/825.93/421.61) lat (ms,95%): 49.21 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 8 tps: 206.40 qps: 4132.20 (r/w/o: 2893.50/819.30/419.40) lat (ms,95%): 50.11 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 8 tps: 216.10 qps: 4320.19 (r/w/o: 3024.00/858.60/437.60) lat (ms,95%): 47.47 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 8 tps: 215.40 qps: 4310.49 (r/w/o: 3017.10/856.80/436.60) lat (ms,95%): 47.47 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 8 tps: 213.40 qps: 4264.18 (r/w/o: 2985.18/845.50/433.50) lat (ms,95%): 48.34 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            1439326\n        write:                           408522\n        other:                           208332\n        total:                           2056180\n    transactions:                        102809 (171.34 per sec.)\n    queries:                             2056180 (3426.83 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0231s\n    total number of events:              102809\n\nLatency (ms):\n         min:                                   20.55\n         avg:                                   46.69\n         max:                                 1381.74\n         95th percentile:                       78.60\n         sum:                              4799764.06\n\nThreads fairness:\n    events (avg/stddev):           12851.1250/18.58\n    execution time (avg/stddev):   599.9705/0.01\n\n# select insert 16\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=16/g' config\nsysbench --config-file=config oltp_read_write --tables=24 --table-size=50000000 run\n[ 10s ] thds: 16 tps: 169.97 qps: 3421.92 (r/w/o: 2398.22/676.66/347.03) lat (ms,95%): 144.97 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 16 tps: 231.90 qps: 4637.37 (r/w/o: 3246.15/921.22/470.00) lat (ms,95%): 104.84 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 16 tps: 311.78 qps: 6237.09 (r/w/o: 4366.92/1237.01/633.17) lat (ms,95%): 65.65 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 16 tps: 287.50 qps: 5753.82 (r/w/o: 4026.51/1145.20/582.10) lat (ms,95%): 69.29 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 16 tps: 284.10 qps: 5680.37 (r/w/o: 3977.48/1127.59/575.30) lat (ms,95%): 69.29 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 16 tps: 303.70 qps: 6073.10 (r/w/o: 4250.10/1206.90/616.10) lat (ms,95%): 68.05 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            2325722\n        write:                           660088\n        other:                           336650\n        total:                           3322460\n    transactions:                        166123 (276.84 per sec.)\n    queries:                             3322460 (5536.80 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0672s\n    total number of events:              166123\n\nLatency (ms):\n         min:                                   24.50\n         avg:                                   57.79\n         max:                                 1233.54\n         95th percentile:                       95.81\n         sum:                              9599917.16\n\nThreads fairness:\n    events (avg/stddev):           10382.6875/22.65\n    execution time (avg/stddev):   599.9948/0.01\n\n# select insert 32\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=32/g' config\nsysbench --config-file=config oltp_read_write --tables=24 --table-size=50000000 run\n[ 10s ] thds: 32 tps: 444.80 qps: 8941.18 (r/w/o: 6264.55/1774.02/902.60) lat (ms,95%): 95.81 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 32 tps: 447.59 qps: 8959.13 (r/w/o: 6272.58/1779.86/906.69) lat (ms,95%): 86.00 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 32 tps: 440.89 qps: 8805.90 (r/w/o: 6161.66/1752.06/892.18) lat (ms,95%): 87.56 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 32 tps: 505.40 qps: 10106.91 (r/w/o: 7073.90/2008.90/1024.10) lat (ms,95%): 82.96 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 32 tps: 486.40 qps: 9739.97 (r/w/o: 6820.75/1934.91/984.31) lat (ms,95%): 84.47 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 32 tps: 477.10 qps: 9532.05 (r/w/o: 6671.67/1894.19/966.20) lat (ms,95%): 87.56 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            3419850\n        write:                           970844\n        other:                           494806\n        total:                           4885500\n    transactions:                        244275 (407.05 per sec.)\n    queries:                             4885500 (8141.05 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.1055s\n    total number of events:              244275\n\nLatency (ms):\n         min:                                   23.04\n         avg:                                   78.60\n         max:                                 1441.26\n         95th percentile:                      121.08\n         sum:                             19200207.50\n\nThreads fairness:\n    events (avg/stddev):           7633.5938/16.54\n    execution time (avg/stddev):   600.0065/0.02\n# select insert 64\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=64/g' config\nsysbench --config-file=config oltp_read_write --tables=24 --table-size=50000000 run\n[ 10s ] thds: 64 tps: 424.39 qps: 8593.20 (r/w/o: 6026.48/1700.35/866.37) lat (ms,95%): 253.35 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 64 tps: 451.41 qps: 9010.57 (r/w/o: 6308.92/1786.73/914.92) lat (ms,95%): 193.38 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 64 tps: 417.90 qps: 8363.85 (r/w/o: 5852.16/1664.29/847.39) lat (ms,95%): 272.27 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 64 tps: 539.30 qps: 10782.19 (r/w/o: 7547.89/2141.50/1092.80) lat (ms,95%): 161.51 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 64 tps: 515.10 qps: 10305.70 (r/w/o: 7214.40/2047.30/1044.00) lat (ms,95%): 164.45 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 64 tps: 546.27 qps: 10927.74 (r/w/o: 7649.00/2174.09/1104.64) lat (ms,95%): 158.63 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            4306274\n        write:                           1222527\n        other:                           623019\n        total:                           6151820\n    transactions:                        307591 (512.48 per sec.)\n    queries:                             6151820 (10249.68 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.1948s\n    total number of events:              307591\n\nLatency (ms):\n         min:                                   26.25\n         avg:                                  124.86\n         max:                                 1593.38\n         95th percentile:                      183.21\n         sum:                             38406426.60\n\nThreads fairness:\n    events (avg/stddev):           4806.1094/14.48\n    execution time (avg/stddev):   600.1004/0.05\n\n# select insert 128\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=128/g' config\nsysbench --config-file=config oltp_read_write --tables=24 --table-size=50000000 run\n[ 10s ] thds: 128 tps: 590.39 qps: 12021.37 (r/w/o: 8442.39/2367.34/1211.63) lat (ms,95%): 292.60 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 128 tps: 534.41 qps: 10671.02 (r/w/o: 7462.98/2124.82/1083.21) lat (ms,95%): 511.33 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 128 tps: 589.19 qps: 11736.22 (r/w/o: 8211.87/2329.76/1194.58) lat (ms,95%): 320.17 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 128 tps: 610.91 qps: 12240.69 (r/w/o: 8574.63/2428.44/1237.62) lat (ms,95%): 282.25 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 128 tps: 570.00 qps: 11418.01 (r/w/o: 7991.91/2271.00/1155.10) lat (ms,95%): 308.84 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 128 tps: 543.47 qps: 10845.10 (r/w/o: 7586.78/2158.68/1099.64) lat (ms,95%): 404.61 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            4876886\n        write:                           1384663\n        other:                           705431\n        total:                           6966980\n    transactions:                        348349 (580.43 per sec.)\n    queries:                             6966980 (11608.66 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.1523s\n    total number of events:              348349\n\nLatency (ms):\n         min:                                   21.36\n         avg:                                  220.50\n         max:                                 1633.75\n         95th percentile:                      325.98\n         sum:                             76810380.95\n\nThreads fairness:\n    events (avg/stddev):           2721.4766/12.10\n    execution time (avg/stddev):   600.0811/0.03\n\n# select insert 256\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=256/g' config\nsysbench --config-file=config oltp_read_write --tables=24 --table-size=50000000 run\n[ 10s ] thds: 256 tps: 481.34 qps: 9985.82 (r/w/o: 7030.71/1956.00/999.11) lat (ms,95%): 1327.91 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 256 tps: 601.64 qps: 11971.39 (r/w/o: 8379.42/2375.18/1216.79) lat (ms,95%): 590.56 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 256 tps: 626.57 qps: 12537.25 (r/w/o: 8779.05/2488.98/1269.23) lat (ms,95%): 601.29 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 256 tps: 605.78 qps: 12177.38 (r/w/o: 8511.77/2438.34/1227.27) lat (ms,95%): 634.66 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 256 tps: 575.83 qps: 11480.88 (r/w/o: 8046.78/2268.63/1165.47) lat (ms,95%): 707.07 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 256 tps: 603.38 qps: 12011.43 (r/w/o: 8397.97/2393.81/1219.65) lat (ms,95%): 612.21 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            5317970\n        write:                           1510266\n        other:                           768864\n        total:                           7597100\n    transactions:                        379855 (632.73 per sec.)\n    queries:                             7597100 (12654.61 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.3413s\n    total number of events:              379855\n\nLatency (ms):\n         min:                                   22.27\n         avg:                                  404.48\n         max:                                 2959.56\n         95th percentile:                      580.02\n         sum:                            153642558.00\n\nThreads fairness:\n    events (avg/stddev):           1483.8086/7.28\n    execution time (avg/stddev):   600.1662/0.09\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_15","title":"\u66f4\u65b0\u64cd\u4f5c\u4e0d\u901a\u8fc7\u7d22\u5f15\u5217","text":"<pre><code># select insert 8\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=8/g' config\nsysbench --config-file=config oltp_update_non_index --tables=24 --table-size=50000000 run\n[ 10s ] thds: 8 tps: 1022.25 qps: 1022.25 (r/w/o: 0.00/1013.55/8.70) lat (ms,95%): 11.04 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 8 tps: 1022.90 qps: 1022.90 (r/w/o: 0.00/1015.90/7.00) lat (ms,95%): 10.84 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 8 tps: 1051.90 qps: 1051.90 (r/w/o: 0.00/1044.10/7.80) lat (ms,95%): 10.27 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 8 tps: 1059.20 qps: 1059.20 (r/w/o: 0.00/1050.70/8.50) lat (ms,95%): 10.46 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 8 tps: 994.00 qps: 994.00 (r/w/o: 0.00/985.90/8.10) lat (ms,95%): 10.27 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 8 tps: 1067.00 qps: 1067.00 (r/w/o: 0.00/1058.10/8.90) lat (ms,95%): 10.46 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           577971\n        other:                           4621\n        total:                           582592\n    transactions:                        582592 (970.97 per sec.)\n    queries:                             582592 (970.97 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0085s\n    total number of events:              582592\n\nLatency (ms):\n         min:                                    0.38\n         avg:                                    8.24\n         max:                                  588.56\n         95th percentile:                       12.52\n         sum:                              4799235.71\n\nThreads fairness:\n    events (avg/stddev):           72824.0000/62.01\n    execution time (avg/stddev):   599.9045/0.00\n\n# select insert 16\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=16/g' config\nsysbench --config-file=config oltp_update_non_index --tables=24 --table-size=50000000 run\n[ 10s ] thds: 16 tps: 1894.52 qps: 1894.52 (r/w/o: 0.00/1878.92/15.60) lat (ms,95%): 12.30 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 16 tps: 1848.30 qps: 1848.30 (r/w/o: 0.00/1833.90/14.40) lat (ms,95%): 11.45 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 16 tps: 1949.59 qps: 1949.59 (r/w/o: 0.00/1933.69/15.90) lat (ms,95%): 10.84 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 16 tps: 1944.80 qps: 1944.80 (r/w/o: 0.00/1929.80/15.00) lat (ms,95%): 10.84 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 16 tps: 1871.71 qps: 1871.71 (r/w/o: 0.00/1857.21/14.50) lat (ms,95%): 11.45 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 16 tps: 1762.30 qps: 1762.30 (r/w/o: 0.00/1748.40/13.90) lat (ms,95%): 11.45 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           1080035\n        other:                           8856\n        total:                           1088891\n    transactions:                        1088891 (1814.79 per sec.)\n    queries:                             1088891 (1814.79 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0077s\n    total number of events:              1088891\n\nLatency (ms):\n         min:                                    0.41\n         avg:                                    8.82\n         max:                                  757.97\n         95th percentile:                       13.22\n         sum:                              9598670.78\n\nThreads fairness:\n    events (avg/stddev):           68055.6875/61.00\n    execution time (avg/stddev):   599.9169/0.00\n# select insert 32\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=32/g' config\nsysbench --config-file=config oltp_update_non_index --tables=24 --table-size=50000000 run\n[ 10s ] thds: 32 tps: 3248.33 qps: 3248.33 (r/w/o: 0.00/3224.63/23.70) lat (ms,95%): 13.95 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 32 tps: 3178.02 qps: 3178.02 (r/w/o: 0.00/3153.52/24.50) lat (ms,95%): 12.98 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 32 tps: 3405.79 qps: 3405.79 (r/w/o: 0.00/3376.89/28.90) lat (ms,95%): 12.52 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 32 tps: 3367.72 qps: 3367.72 (r/w/o: 0.00/3339.32/28.40) lat (ms,95%): 12.52 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 32 tps: 3265.01 qps: 3265.01 (r/w/o: 0.00/3238.41/26.60) lat (ms,95%): 13.22 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 32 tps: 3237.49 qps: 3237.49 (r/w/o: 0.00/3213.79/23.70) lat (ms,95%): 12.98 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           1957338\n        other:                           15562\n        total:                           1957338\n    transactions:                        1957338 (3262.18 per sec.)\n    queries:                             1957338 (3262.18 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0078s\n    total number of events:              1957338\n\nLatency (ms):\n         min:                                    0.41\n         avg:                                    9.81\n         max:                                  902.52\n         95th percentile:                       13.46\n         sum:                             19197804.63\n\nThreads fairness:\n    events (avg/stddev):           61166.8125/61.01\n    execution time (avg/stddev):   599.9314/0.00\n# select insert 64\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=64/g' config\nsysbench --config-file=config oltp_update_non_index --tables=24 --table-size=50000000 run\n[ 10s ] thds: 64 tps: 5254.99 qps: 5254.99 (r/w/o: 0.00/5212.31/42.68) lat (ms,95%): 17.95 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 64 tps: 5625.60 qps: 5625.60 (r/w/o: 0.00/5581.80/43.80) lat (ms,95%): 16.12 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 64 tps: 5203.48 qps: 5203.48 (r/w/o: 0.00/5162.28/41.20) lat (ms,95%): 19.29 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 64 tps: 3663.77 qps: 3663.77 (r/w/o: 0.00/3633.67/30.10) lat (ms,95%): 33.72 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 64 tps: 5478.25 qps: 5478.25 (r/w/o: 0.00/5434.95/43.30) lat (ms,95%): 20.00 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 64 tps: 5174.52 qps: 5174.52 (r/w/o: 0.00/5129.92/44.60) lat (ms,95%): 17.63 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           3042486\n        other:                           24646\n        total:                           3067132\n    transactions:                        3067132 (5111.78 per sec.)\n    queries:                             3067132 (5111.78 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0115s\n    total number of events:              3067132\n\nLatency (ms):\n         min:                                    0.41\n         avg:                                   12.52\n         max:                                 1070.55\n         95th percentile:                       18.95\n         sum:                             38396613.65\n\nThreads fairness:\n    events (avg/stddev):           47923.9375/58.56\n    execution time (avg/stddev):   599.9471/0.00\n# select insert 128\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=128/g' config\nsysbench --config-file=config oltp_update_non_index --tables=24 --table-size=50000000 run\n[ 10s ] thds: 128 tps: 7684.84 qps: 7684.84 (r/w/o: 0.00/7622.50/62.35) lat (ms,95%): 27.66 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 128 tps: 7721.65 qps: 7721.65 (r/w/o: 0.00/7660.55/61.10) lat (ms,95%): 27.17 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 128 tps: 8408.18 qps: 8408.18 (r/w/o: 0.00/8343.68/64.50) lat (ms,95%): 25.74 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 128 tps: 7419.08 qps: 7419.08 (r/w/o: 0.00/7358.58/60.50) lat (ms,95%): 31.37 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 128 tps: 5580.22 qps: 5580.22 (r/w/o: 0.00/5537.53/42.70) lat (ms,95%): 51.02 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 128 tps: 6943.18 qps: 6943.18 (r/w/o: 0.00/6883.98/59.20) lat (ms,95%): 41.10 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           4387663\n        other:                           35553\n        total:                           4423216\n    transactions:                        4423216 (7371.75 per sec.)\n    queries:                             4423216 (7371.75 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0212s\n    total number of events:              4423216\n\nLatency (ms):\n         min:                                    0.43\n         avg:                                   17.36\n         max:                                  809.63\n         95th percentile:                       32.53\n         sum:                             76796124.53\n\nThreads fairness:\n    events (avg/stddev):           34556.3750/76.45\n    execution time (avg/stddev):   599.9697/0.01\n# select insert 256\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=256/g' config\nsysbench --config-file=config oltp_update_non_index --tables=24 --table-size=50000000 run\n[ 10s ] thds: 256 tps: 10767.47 qps: 10767.57 (r/w/o: 0.00/10679.60/87.97) lat (ms,95%): 44.98 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 256 tps: 9622.65 qps: 9622.55 (r/w/o: 0.00/9538.56/84.00) lat (ms,95%): 49.21 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 256 tps: 9375.97 qps: 9375.97 (r/w/o: 0.00/9301.17/74.80) lat (ms,95%): 52.89 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 256 tps: 10087.61 qps: 10087.61 (r/w/o: 0.00/10003.91/83.70) lat (ms,95%): 54.83 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 256 tps: 9808.50 qps: 9808.50 (r/w/o: 0.00/9731.70/76.80) lat (ms,95%): 51.02 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 256 tps: 10201.78 qps: 10201.78 (r/w/o: 0.00/10119.98/81.80) lat (ms,95%): 53.85 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           5666278\n        other:                           45899\n        total:                           5712177\n    transactions:                        5712177 (9519.67 per sec.)\n    queries:                             5712177 (9519.67 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0379s\n    total number of events:              5712177\n\nLatency (ms):\n         min:                                    0.47\n         avg:                                   26.89\n         max:                                 1339.52\n         95th percentile:                       55.82\n         sum:                            153596923.52\n\nThreads fairness:\n    events (avg/stddev):           22313.1914/73.30\n    execution time (avg/stddev):   599.9880/0.01\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_16","title":"\u53ea\u5199\u5165\u6d4b\u8bd5","text":"<pre><code># select insert 8\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=8/g' config\nsysbench --config-file=config oltp_write_only --tables=24 --table-size=50000000 run\n[ 10s ] thds: 8 tps: 383.63 qps: 2303.99 (r/w/o: 0.00/1526.03/777.96) lat (ms,95%): 26.20 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 8 tps: 362.21 qps: 2173.16 (r/w/o: 0.00/1441.24/731.92) lat (ms,95%): 27.17 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 8 tps: 394.80 qps: 2369.40 (r/w/o: 0.00/1570.70/798.70) lat (ms,95%): 26.20 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 8 tps: 397.40 qps: 2384.51 (r/w/o: 0.00/1579.81/804.70) lat (ms,95%): 25.74 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 8 tps: 395.30 qps: 2371.51 (r/w/o: 0.00/1570.11/801.40) lat (ms,95%): 25.74 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 8 tps: 384.20 qps: 2305.99 (r/w/o: 0.00/1529.09/776.90) lat (ms,95%): 26.20 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           710760\n        other:                           361812\n        total:                           1072572\n    transactions:                        178762 (297.90 per sec.)\n    queries:                             1072572 (1787.37 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0819s\n    total number of events:              178762\n\nLatency (ms):\n         min:                                   11.69\n         avg:                                   26.85\n         max:                                 1572.86\n         95th percentile:                       41.85\n         sum:                              4799929.32\n\nThreads fairness:\n    events (avg/stddev):           22345.2500/21.72\n    execution time (avg/stddev):   599.9912/0.02\n# select insert 16\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=16/g' config\nsysbench --config-file=config oltp_write_only --tables=24 --table-size=50000000 run\n[ 10s ] thds: 16 tps: 576.19 qps: 3462.96 (r/w/o: 0.00/2294.47/1168.48) lat (ms,95%): 33.72 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 16 tps: 565.92 qps: 3394.51 (r/w/o: 0.00/2248.58/1145.94) lat (ms,95%): 34.95 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 16 tps: 554.40 qps: 3326.81 (r/w/o: 0.00/2204.10/1122.70) lat (ms,95%): 38.25 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 16 tps: 517.70 qps: 3105.10 (r/w/o: 0.00/2055.60/1049.50) lat (ms,95%): 40.37 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 16 tps: 543.60 qps: 3264.38 (r/w/o: 0.00/2163.99/1100.39) lat (ms,95%): 37.56 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 16 tps: 599.00 qps: 3592.12 (r/w/o: 0.00/2382.41/1209.71) lat (ms,95%): 36.24 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           1056694\n        other:                           537968\n        total:                           1594662\n    transactions:                        265777 (442.93 per sec.)\n    queries:                             1594662 (2657.57 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0444s\n    total number of events:              265777\n\nLatency (ms):\n         min:                                    9.65\n         avg:                                   36.12\n         max:                                 1488.15\n         95th percentile:                       75.82\n         sum:                              9599571.75\n\nThreads fairness:\n    events (avg/stddev):           16611.0625/27.35\n    execution time (avg/stddev):   599.9732/0.01\n# select insert 32\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=32/g' config\nsysbench --config-file=config oltp_write_only --tables=24 --table-size=50000000 run\n[ 10s ] thds: 32 tps: 859.62 qps: 5170.24 (r/w/o: 0.00/3428.50/1741.74) lat (ms,95%): 45.79 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 32 tps: 885.10 qps: 5307.11 (r/w/o: 0.00/3514.91/1792.20) lat (ms,95%): 45.79 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 32 tps: 799.70 qps: 4799.20 (r/w/o: 0.00/3182.60/1616.60) lat (ms,95%): 51.02 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 32 tps: 868.30 qps: 5211.60 (r/w/o: 0.00/3455.90/1755.70) lat (ms,95%): 48.34 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 32 tps: 818.26 qps: 4908.36 (r/w/o: 0.00/3254.14/1654.22) lat (ms,95%): 53.85 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 32 tps: 753.32 qps: 4520.79 (r/w/o: 0.00/2996.16/1524.63) lat (ms,95%): 56.84 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           1971854\n        other:                           1003240\n        total:                           2975094\n    transactions:                        495849 (826.37 per sec.)\n    queries:                             2975094 (4958.20 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0342s\n    total number of events:              495849\n\nLatency (ms):\n         min:                                   12.46\n         avg:                                   38.72\n         max:                                 1465.32\n         95th percentile:                       61.08\n         sum:                             19199052.08\n\nThreads fairness:\n    events (avg/stddev):           15495.2812/20.61\n    execution time (avg/stddev):   599.9704/0.01\n# select insert 64\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=64/g' config\nsysbench --config-file=config oltp_write_only --tables=24 --table-size=50000000 run\n[ 10s ] thds: 64 tps: 1093.67 qps: 6581.09 (r/w/o: 0.00/4362.47/2218.62) lat (ms,95%): 81.48 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 64 tps: 1178.65 qps: 7073.00 (r/w/o: 0.00/4689.40/2383.60) lat (ms,95%): 81.48 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 64 tps: 1192.91 qps: 7155.27 (r/w/o: 0.00/4743.05/2412.22) lat (ms,95%): 78.60 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 64 tps: 1112.55 qps: 6676.09 (r/w/o: 0.00/4427.20/2248.88) lat (ms,95%): 97.55 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 64 tps: 1235.21 qps: 7412.53 (r/w/o: 0.00/4919.91/2492.62) lat (ms,95%): 71.83 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 64 tps: 1168.49 qps: 7011.36 (r/w/o: 0.00/4650.08/2361.29) lat (ms,95%): 75.82 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           2584664\n        other:                           1313014\n        total:                           3897678\n    transactions:                        649613 (1082.59 per sec.)\n    queries:                             3897678 (6495.57 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0507s\n    total number of events:              649613\n\nLatency (ms):\n         min:                                   13.69\n         avg:                                   59.11\n         max:                                 1652.85\n         95th percentile:                       97.55\n         sum:                             38399561.18\n\nThreads fairness:\n    events (avg/stddev):           10150.2031/19.65\n    execution time (avg/stddev):   599.9931/0.01\n\n# select insert 128\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=128/g' config\nsysbench --config-file=config oltp_write_only --tables=24 --table-size=50000000 run\n[ 10s ] thds: 128 tps: 1556.63 qps: 9380.96 (r/w/o: 0.00/6225.83/3155.12) lat (ms,95%): 123.28 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 128 tps: 1487.15 qps: 8921.02 (r/w/o: 0.00/5918.31/3002.71) lat (ms,95%): 127.81 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 128 tps: 1570.02 qps: 9419.09 (r/w/o: 0.00/6244.46/3174.63) lat (ms,95%): 118.92 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 128 tps: 1491.44 qps: 8948.62 (r/w/o: 0.00/5938.95/3009.67) lat (ms,95%): 142.39 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 128 tps: 1623.63 qps: 9748.36 (r/w/o: 0.00/6465.61/3282.75) lat (ms,95%): 121.08 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 128 tps: 1580.54 qps: 9487.24 (r/w/o: 0.00/6290.56/3196.69) lat (ms,95%): 127.81 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           3509747\n        other:                           1781467\n        total:                           5291214\n    transactions:                        881869 (1469.53 per sec.)\n    queries:                             5291214 (8817.17 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.1021s\n    total number of events:              881869\n\nLatency (ms):\n         min:                                   14.31\n         avg:                                   87.09\n         max:                                 2300.36\n         95th percentile:                      137.35\n         sum:                             76803193.61\n\nThreads fairness:\n    events (avg/stddev):           6889.6016/17.75\n    execution time (avg/stddev):   600.0250/0.03\n\n# select insert 256\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=256/g' config\nsysbench --config-file=config oltp_write_only --tables=24 --table-size=50000000 run\n[ 10s ] thds: 256 tps: 1466.07 qps: 8894.63 (r/w/o: 0.00/5909.39/2985.24) lat (ms,95%): 363.18 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 256 tps: 1367.40 qps: 8193.03 (r/w/o: 0.00/5432.02/2761.01) lat (ms,95%): 580.02 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 256 tps: 1569.85 qps: 9425.41 (r/w/o: 0.00/6254.20/3171.20) lat (ms,95%): 227.40 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 256 tps: 938.90 qps: 5636.79 (r/w/o: 0.00/3741.69/1895.10) lat (ms,95%): 877.61 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 256 tps: 1494.38 qps: 8950.90 (r/w/o: 0.00/5931.53/3019.37) lat (ms,95%): 277.21 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 256 tps: 1281.90 qps: 7691.88 (r/w/o: 0.00/5101.29/2590.59) lat (ms,95%): 493.24 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           3973855\n        other:                           2015555\n        total:                           5989410\n    transactions:                        998235 (1663.36 per sec.)\n    queries:                             5989410 (9980.18 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.1287s\n    total number of events:              998235\n\nLatency (ms):\n         min:                                   14.18\n         avg:                                  153.88\n         max:                                 3163.24\n         95th percentile:                      287.38\n         sum:                            153611743.50\n\nThreads fairness:\n    events (avg/stddev):           3899.3555/16.97\n    execution time (avg/stddev):   600.0459/0.04\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_17","title":"\u5199\u5165\u548c\u5220\u9664\u5e76\u884c","text":"<pre><code># select insert 8\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=8/g' config\nsysbench --config-file=config oltp_delete --tables=24 --table-size=50000000 run\n[ 10s ] thds: 8 tps: 348.04 qps: 348.04 (r/w/o: 0.00/345.34/2.70) lat (ms,95%): 38.25 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 8 tps: 544.31 qps: 544.31 (r/w/o: 0.00/541.51/2.80) lat (ms,95%): 23.52 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 8 tps: 716.41 qps: 716.41 (r/w/o: 0.00/711.31/5.10) lat (ms,95%): 17.95 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 8 tps: 831.29 qps: 831.29 (r/w/o: 0.00/825.79/5.50) lat (ms,95%): 13.95 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 8 tps: 808.50 qps: 808.50 (r/w/o: 0.00/802.50/6.00) lat (ms,95%): 13.95 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 8 tps: 853.80 qps: 853.80 (r/w/o: 0.00/847.00/6.80) lat (ms,95%): 13.70 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           399568\n        other:                           7832\n        total:                           407400\n    transactions:                        407400 (678.99 per sec.)\n    queries:                             407400 (678.99 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0086s\n    total number of events:              407400\n\nLatency (ms):\n         min:                                    0.42\n         avg:                                   11.78\n         max:                                  613.16\n         95th percentile:                       21.50\n         sum:                              4799469.44\n\nThreads fairness:\n    events (avg/stddev):           50925.0000/81.12\n    execution time (avg/stddev):   599.9337/0.00\n\n# select insert 16\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=16/g' config\nsysbench --config-file=config oltp_delete --tables=24 --table-size=50000000 run\n[ 10s ] thds: 16 tps: 1207.72 qps: 1207.72 (r/w/o: 0.00/1168.83/38.89) lat (ms,95%): 23.52 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 16 tps: 1433.40 qps: 1433.40 (r/w/o: 0.00/1380.60/52.80) lat (ms,95%): 15.83 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 16 tps: 1440.80 qps: 1440.80 (r/w/o: 0.00/1393.40/47.40) lat (ms,95%): 15.55 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 16 tps: 1304.10 qps: 1304.10 (r/w/o: 0.00/1261.30/42.80) lat (ms,95%): 16.12 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 16 tps: 1359.79 qps: 1359.79 (r/w/o: 0.00/1312.89/46.90) lat (ms,95%): 16.71 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 16 tps: 1305.90 qps: 1305.90 (r/w/o: 0.00/1258.40/47.50) lat (ms,95%): 17.32 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           706819\n        other:                           40642\n        total:                           747461\n    transactions:                        747461 (1245.71 per sec.)\n    queries:                             747461 (1245.71 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0255s\n    total number of events:              747461\n\nLatency (ms):\n         min:                                    0.43\n         avg:                                   12.84\n         max:                                  670.51\n         95th percentile:                       26.20\n         sum:                              9599297.16\n\nThreads fairness:\n    events (avg/stddev):           46716.3125/67.97\n    execution time (avg/stddev):   599.9561/0.01\n\n# select insert 32\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=32/g' config\nsysbench --config-file=config oltp_delete --tables=24 --table-size=50000000 run\n[ 10s ] thds: 32 tps: 1224.24 qps: 1224.24 (r/w/o: 0.00/1130.06/94.18) lat (ms,95%): 62.19 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 32 tps: 1434.09 qps: 1434.09 (r/w/o: 0.00/1321.99/112.10) lat (ms,95%): 57.87 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 32 tps: 1347.71 qps: 1347.71 (r/w/o: 0.00/1242.32/105.39) lat (ms,95%): 59.99 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 32 tps: 1515.80 qps: 1515.80 (r/w/o: 0.00/1389.79/126.01) lat (ms,95%): 57.87 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 32 tps: 1355.64 qps: 1355.64 (r/w/o: 0.00/1248.84/106.80) lat (ms,95%): 56.84 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 32 tps: 2596.62 qps: 2596.62 (r/w/o: 0.00/2384.71/211.91) lat (ms,95%): 19.29 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           1200197\n        other:                           155257\n        total:                           1355454\n    transactions:                        1355454 (2259.03 per sec.)\n    queries:                             1355454 (2259.03 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0144s\n    total number of events:              1355454\n\nLatency (ms):\n         min:                                    0.40\n         avg:                                   14.16\n         max:                                  994.74\n         95th percentile:                       31.37\n         sum:                             19198477.28\n\nThreads fairness:\n    events (avg/stddev):           42357.9375/92.54\n    execution time (avg/stddev):   599.9524/0.00\n\n# select insert 64\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=64/g' config\nsysbench --config-file=config oltp_delete --tables=24 --table-size=50000000 run\n[ 10s ] thds: 64 tps: 3905.66 qps: 3905.66 (r/w/o: 0.00/3305.53/600.14) lat (ms,95%): 26.68 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 64 tps: 4473.34 qps: 4473.34 (r/w/o: 0.00/3772.41/700.93) lat (ms,95%): 23.10 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 64 tps: 4169.47 qps: 4169.47 (r/w/o: 0.00/3521.56/647.91) lat (ms,95%): 24.38 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 64 tps: 3177.36 qps: 3177.36 (r/w/o: 0.00/2673.27/504.09) lat (ms,95%): 50.11 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 64 tps: 4199.14 qps: 4199.14 (r/w/o: 0.00/3525.13/674.01) lat (ms,95%): 29.19 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 64 tps: 3963.50 qps: 3963.50 (r/w/o: 0.00/3330.60/632.90) lat (ms,95%): 29.19 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           1899872\n        other:                           501168\n        total:                           2401040\n    transactions:                        2401040 (4001.57 per sec.)\n    queries:                             2401040 (4001.57 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0238s\n    total number of events:              2401040\n\nLatency (ms):\n         min:                                    0.42\n         avg:                                   15.99\n         max:                                 1186.76\n         95th percentile:                       34.95\n         sum:                             38397943.33\n\nThreads fairness:\n    events (avg/stddev):           37516.2500/103.31\n    execution time (avg/stddev):   599.9679/0.01\n\n# select insert 128\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=128/g' config\nsysbench --config-file=config oltp_delete --tables=24 --table-size=50000000 run\n[ 10s ] thds: 128 tps: 6033.46 qps: 6033.46 (r/w/o: 0.00/4447.60/1585.86) lat (ms,95%): 38.94 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 128 tps: 6400.79 qps: 6400.79 (r/w/o: 0.00/4686.63/1714.16) lat (ms,95%): 38.25 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 128 tps: 6386.65 qps: 6386.65 (r/w/o: 0.00/4668.27/1718.38) lat (ms,95%): 39.65 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 128 tps: 6619.81 qps: 6619.81 (r/w/o: 0.00/4822.01/1797.80) lat (ms,95%): 38.94 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 128 tps: 6397.74 qps: 6397.74 (r/w/o: 0.00/4629.15/1768.58) lat (ms,95%): 40.37 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 128 tps: 6618.83 qps: 6618.83 (r/w/o: 0.00/4771.96/1846.87) lat (ms,95%): 39.65 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           2502286\n        other:                           1256654\n        total:                           3758940\n    transactions:                        3758940 (6264.62 per sec.)\n    queries:                             3758940 (6264.62 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0259s\n    total number of events:              3758940\n\nLatency (ms):\n         min:                                    0.41\n         avg:                                   20.43\n         max:                                 1379.84\n         95th percentile:                       50.11\n         sum:                             76796715.81\n\nThreads fairness:\n    events (avg/stddev):           29366.7188/123.76\n    execution time (avg/stddev):   599.9743/0.01\n\n# select insert 256\u7ebf\u7a0b\u300010\u5206\u949f\nsed -i 's/^threads=.*/threads=256/g' config\nsysbench --config-file=config oltp_delete --tables=24 --table-size=50000000 run\n[ 10s ] thds: 256 tps: 4187.74 qps: 4187.74 (r/w/o: 0.00/2502.24/1685.50) lat (ms,95%): 231.53 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 256 tps: 8577.92 qps: 8577.92 (r/w/o: 0.00/5148.07/3429.85) lat (ms,95%): 73.13 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 256 tps: 9409.80 qps: 9409.80 (r/w/o: 0.00/5631.80/3778.00) lat (ms,95%): 71.83 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 256 tps: 8414.93 qps: 8414.93 (r/w/o: 0.00/4979.84/3435.09) lat (ms,95%): 74.46 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 256 tps: 9383.60 qps: 9383.60 (r/w/o: 0.00/5558.87/3824.73) lat (ms,95%): 71.83 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 256 tps: 9210.60 qps: 9210.60 (r/w/o: 0.00/5412.52/3798.09) lat (ms,95%): 74.46 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            0\n        write:                           2847913\n        other:                           2531947\n        total:                           5379860\n    transactions:                        5379860 (8965.40 per sec.)\n    queries:                             5379860 (8965.40 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nGeneral statistics:\n    total time:                          600.0677s\n    total number of events:              5379860\n\nLatency (ms):\n         min:                                    0.40\n         avg:                                   28.55\n         max:                                 1388.04\n         95th percentile:                       81.48\n         sum:                            153602514.04\n\nThreads fairness:\n    events (avg/stddev):           21015.0781/128.10\n    execution time (avg/stddev):   600.0098/0.02\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_18","title":"\u6d4b\u8bd5\u7ed3\u679c","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_19","title":"\u4e3b\u952e\u67e5\u8be2","text":"\u7ebf\u7a0b QPS \u67e5\u8be2\u603b\u6570 TPS \u4e8b\u7269\u603b\u6570 95% latency (ms) \uff18 6512.09 3908017 6512.09 3908017 3.30 16 11408.77 6845695 11408.77 6845695 4.10 32 17198.11 10320806 17198.11 10320806 5.67 64 21451.15 12871444 21451.15 12871444 8.43 128 26426.46 15867653 26426.46 15867653 13.46 256 25311.42 15188519 25311.42 15188519 27.17"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_20","title":"\u4e3b\u952e\u66f4\u65b0","text":"\u7ebf\u7a0b QPS \u67e5\u8be2\u603b\u6570 TPS \u4e8b\u7269\u603b\u6570 \u5199\u5165\u6570 95% latency (ms) \uff18 253.45 152077 253.45 152077 150714 62.19 16 459.40 275657 459.40 275657 273213 75.82 32 1134.22 680722 1134.22 680722 674705 53.85 64 1925.14 1155177 1925.14 1155177 1145001 56.84 128 4004.38 2403039 4004.38 2403039 2381625 58.92 256 5258.48 3157178 5258.48 3157178 3129355 97.55"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_21","title":"\u8bfb\u5199\u6df7\u5408","text":"\u7ebf\u7a0b QPS \u67e5\u8be2\u603b\u6570 TPS \u4e8b\u7269\u603b\u6570 \u8bfb\u5165\u6570 \u5199\u5165\u6570 95% latency (ms) \uff18 3426.83 2056180 171.34 102809 1439326 408522 78.60 16 5536.80 3322460 276.84 166123 2325722 660088 95.81 32 8141.05 4885500 407.05 244275 3419850 970844 121.08 64 10249.68 6151820 512.48 307591 4306274 1222527 183.21 128 11608.66 6966980 580.43 348349 4876886 1384663 325.98 256 12654.61 7597100 632.73 379855 5317970 1510266 580.02"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_22","title":"\u66f4\u65b0\u4e0d\u901a\u8fc7\u7d22\u5f15","text":"\u7ebf\u7a0b QPS \u67e5\u8be2\u603b\u6570 TPS \u4e8b\u7269\u603b\u6570 \u5199\u5165\u6570 95% latency (ms) \uff18 970.97 582592 970.97 582592 577971 12.52 16 1814.79 1088891 1814.79 1088891 1080035 13.22 32 3262.18 1957338 3262.18 1957338 1957338 13.46 64 5111.78 3067132 5111.78 3067132 3042486 18.95 128 7371.75 4423216 7371.75 4423216 4387663 32.53 256 9519.67 5712177 9519.67 5712177 5666278 55.82"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_23","title":"\u53ea\u5199\u5165","text":"\u7ebf\u7a0b QPS \u67e5\u8be2\u603b\u6570 TPS \u4e8b\u7269\u603b\u6570 \u5199\u5165\u6570 95% latency (ms) \uff18 1787.37 1072572 297.90 178762 710760 41.85 16 2657.57 1594662 442.93 265777 1056694 75.82 32 4958.20 2975094 826.37 495849 1971854 61.08 64 6495.57 3897678 1082.59 649613 2584664 97.55 128 8817.17 5291214 1469.53 881869 3509747 137.35 256 9980.18 5989410 1663.36 998235 3973855 287.38"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#_24","title":"\u5199\u5165\u548c\u5220\u9664\u5e76\u884c","text":"\u7ebf\u7a0b QPS \u67e5\u8be2\u603b\u6570 TPS \u4e8b\u7269\u603b\u6570 \u5199\u5165\u6570 95% latency (ms) \uff18 678.99 407400 678.99 407400 399568 21.50 16 1245.71 747461 1245.71 747461 706819 26.2 32 2259.03 1355454 2259.03 1355454 1200197 31.37 64 4001.57 2401040 4001.57 2401040 1899872 34.95 128 6264.62 3758940 6264.62 3758940 2502286 50.11 256 8965.40 5379860 8965.40 5379860 2847913 81.48"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/TiDB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/#95","title":"\u524d95%\u6beb\u79d2\u6570","text":"\u7ebf\u7a0b \u4e3b\u952e\u67e5\u8be2 \u4e3b\u952e\u66f4\u65b0 \u8bfb\u5199\u6df7\u5408 \u66f4\u65b0\u975e\u7d22\u5f15 \u53ea\u5199\u5165 \u5199\u5165\u548c\u5220\u9664\u5e76\u884c \uff18 3.30 62.19 78.60 12.52 41.85 21.50 16 4.10 75.82 95.81 13.22 75.82 26.2 32 5.67 53.85 121.08 13.46 61.08 31.37 64 8.43 56.84 183.21 18.95 97.55 34.95 128 13.46 58.92 325.98 32.53 137.35 50.11 256 27.17 97.55 580.02 55.82 287.38 81.48"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/","title":"Nacos\u4f7f\u7528\u6587\u6863\u8bf4\u660e\u7b80\u4ecb","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#nacos","title":"\u4ec0\u4e48\u662fNacos","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#nacos_1","title":"Nacos \u6982\u89c8","text":"<p>Nacos \u81f4\u529b\u4e8e\u5e2e\u52a9\u60a8\u53d1\u73b0\u3001\u914d\u7f6e\u548c\u7ba1\u7406\u5fae\u670d\u52a1\u3002Nacos \u63d0\u4f9b\u4e86\u4e00\u7ec4\u7b80\u5355\u6613\u7528\u7684\u7279\u6027\u96c6\uff0c\u5e2e\u52a9\u60a8\u5feb\u901f\u5b9e\u73b0\u52a8\u6001\u670d\u52a1\u53d1\u73b0\u3001\u670d\u52a1\u914d\u7f6e\u3001\u670d\u52a1\u5143\u6570\u636e\u53ca\u6d41\u91cf\u7ba1\u7406\u3002</p> <p>Nacos \u5e2e\u52a9\u60a8\u66f4\u654f\u6377\u548c\u5bb9\u6613\u5730\u6784\u5efa\u3001\u4ea4\u4ed8\u548c\u7ba1\u7406\u5fae\u670d\u52a1\u5e73\u53f0\u3002 Nacos \u662f\u6784\u5efa\u4ee5\u201c\u670d\u52a1\u201d\u4e3a\u4e2d\u5fc3\u7684\u73b0\u4ee3\u5e94\u7528\u67b6\u6784 (\u4f8b\u5982\u5fae\u670d\u52a1\u8303\u5f0f\u3001\u4e91\u539f\u751f\u8303\u5f0f) \u7684\u670d\u52a1\u57fa\u7840\u8bbe\u65bd\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#nacos_2","title":"Nacos \u529f\u80fd","text":"<p>\u670d\u52a1\uff08Service\uff09\u662f Nacos \u4e16\u754c\u7684\u4e00\u7b49\u516c\u6c11\u3002Nacos \u652f\u6301\u51e0\u4e4e\u6240\u6709\u4e3b\u6d41\u7c7b\u578b\u7684\u201c\u670d\u52a1\u201d\u7684\u53d1\u73b0\u3001\u914d\u7f6e\u548c\u7ba1\u7406\uff1a</p> <p>Kubernetes Service</p> <p>gRPC &amp; Dubbo RPC Service</p> <p>Spring Cloud RESTful Service</p> <p>Nacos \u7684\u5173\u952e\u7279\u6027\u5305\u62ec:</p> <ul> <li>\u670d\u52a1\u53d1\u73b0\u548c\u670d\u52a1\u5065\u5eb7\u76d1\u6d4b</li> </ul> <p>Nacos \u652f\u6301\u57fa\u4e8e DNS \u548c\u57fa\u4e8e RPC \u7684\u670d\u52a1\u53d1\u73b0\u3002\u670d\u52a1\u63d0\u4f9b\u8005\u4f7f\u7528 \u539f\u751fSDK\u3001OpenAPI\u3001\u6216\u4e00\u4e2a\u72ec\u7acb\u7684Agent TODO\u6ce8\u518c Service \u540e\uff0c\u670d\u52a1\u6d88\u8d39\u8005\u53ef\u4ee5\u4f7f\u7528DNS TODO \u6216HTTP&amp;API\u67e5\u627e\u548c\u53d1\u73b0\u670d\u52a1\u3002</p> <p>Nacos \u63d0\u4f9b\u5bf9\u670d\u52a1\u7684\u5b9e\u65f6\u7684\u5065\u5eb7\u68c0\u67e5\uff0c\u963b\u6b62\u5411\u4e0d\u5065\u5eb7\u7684\u4e3b\u673a\u6216\u670d\u52a1\u5b9e\u4f8b\u53d1\u9001\u8bf7\u6c42\u3002Nacos \u652f\u6301\u4f20\u8f93\u5c42 (PING \u6216 TCP)\u548c\u5e94\u7528\u5c42 (\u5982 HTTP\u3001MySQL\u3001\u7528\u6237\u81ea\u5b9a\u4e49\uff09\u7684\u5065\u5eb7\u68c0\u67e5\u3002 \u5bf9\u4e8e\u590d\u6742\u7684\u4e91\u73af\u5883\u548c\u7f51\u7edc\u62d3\u6251\u73af\u5883\u4e2d\uff08\u5982 VPC\u3001\u8fb9\u7f18\u7f51\u7edc\u7b49\uff09\u670d\u52a1\u7684\u5065\u5eb7\u68c0\u67e5\uff0cNacos \u63d0\u4f9b\u4e86 agent \u4e0a\u62a5\u6a21\u5f0f\u548c\u670d\u52a1\u7aef\u4e3b\u52a8\u68c0\u6d4b2\u79cd\u5065\u5eb7\u68c0\u67e5\u6a21\u5f0f\u3002Nacos \u8fd8\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684\u5065\u5eb7\u68c0\u67e5\u4eea\u8868\u76d8\uff0c\u5e2e\u52a9\u60a8\u6839\u636e\u5065\u5eb7\u72b6\u6001\u7ba1\u7406\u670d\u52a1\u7684\u53ef\u7528\u6027\u53ca\u6d41\u91cf\u3002</p> <ul> <li>\u52a8\u6001\u914d\u7f6e\u670d\u52a1</li> </ul> <p>\u52a8\u6001\u914d\u7f6e\u670d\u52a1\u53ef\u4ee5\u8ba9\u60a8\u4ee5\u4e2d\u5fc3\u5316\u3001\u5916\u90e8\u5316\u548c\u52a8\u6001\u5316\u7684\u65b9\u5f0f\u7ba1\u7406\u6240\u6709\u73af\u5883\u7684\u5e94\u7528\u914d\u7f6e\u548c\u670d\u52a1\u914d\u7f6e\u3002</p> <p>\u52a8\u6001\u914d\u7f6e\u6d88\u9664\u4e86\u914d\u7f6e\u53d8\u66f4\u65f6\u91cd\u65b0\u90e8\u7f72\u5e94\u7528\u548c\u670d\u52a1\u7684\u9700\u8981\uff0c\u8ba9\u914d\u7f6e\u7ba1\u7406\u53d8\u5f97\u66f4\u52a0\u9ad8\u6548\u548c\u654f\u6377\u3002</p> <p>\u914d\u7f6e\u4e2d\u5fc3\u5316\u7ba1\u7406\u8ba9\u5b9e\u73b0\u65e0\u72b6\u6001\u670d\u52a1\u53d8\u5f97\u66f4\u7b80\u5355\uff0c\u8ba9\u670d\u52a1\u6309\u9700\u5f39\u6027\u6269\u5c55\u53d8\u5f97\u66f4\u5bb9\u6613\u3002</p> <p>Nacos \u63d0\u4f9b\u4e86\u4e00\u4e2a\u7b80\u6d01\u6613\u7528\u7684UI (\u63a7\u5236\u53f0\u6837\u4f8b Demo) \u5e2e\u52a9\u60a8\u7ba1\u7406\u6240\u6709\u7684\u670d\u52a1\u548c\u5e94\u7528\u7684\u914d\u7f6e\u3002Nacos \u8fd8\u63d0\u4f9b\u5305\u62ec\u914d\u7f6e\u7248\u672c\u8ddf\u8e2a\u3001\u91d1\u4e1d\u96c0\u53d1\u5e03\u3001\u4e00\u952e\u56de\u6eda\u914d\u7f6e\u4ee5\u53ca\u5ba2\u6237\u7aef\u914d\u7f6e\u66f4\u65b0\u72b6\u6001\u8ddf\u8e2a\u5728\u5185\u7684\u4e00\u7cfb\u5217\u5f00\u7bb1\u5373\u7528\u7684\u914d\u7f6e\u7ba1\u7406\u7279\u6027\uff0c\u5e2e\u52a9\u60a8\u66f4\u5b89\u5168\u5730\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u7ba1\u7406\u914d\u7f6e\u53d8\u66f4\u548c\u964d\u4f4e\u914d\u7f6e\u53d8\u66f4\u5e26\u6765\u7684\u98ce\u9669\u3002</p> <ul> <li>\u52a8\u6001DNS\u670d\u52a1</li> </ul> <p>\u52a8\u6001 DNS \u670d\u52a1\u652f\u6301\u6743\u91cd\u8def\u7531\uff0c\u8ba9\u60a8\u66f4\u5bb9\u6613\u5730\u5b9e\u73b0\u4e2d\u95f4\u5c42\u8d1f\u8f7d\u5747\u8861\u3001\u66f4\u7075\u6d3b\u7684\u8def\u7531\u7b56\u7565\u3001\u6d41\u91cf\u63a7\u5236\u4ee5\u53ca\u6570\u636e\u4e2d\u5fc3\u5185\u7f51\u7684\u7b80\u5355DNS\u89e3\u6790\u670d\u52a1\u3002\u52a8\u6001DNS\u670d\u52a1\u8fd8\u80fd\u8ba9\u60a8\u66f4\u5bb9\u6613\u5730\u5b9e\u73b0\u4ee5 DNS \u534f\u8bae\u4e3a\u57fa\u7840\u7684\u670d\u52a1\u53d1\u73b0\uff0c\u4ee5\u5e2e\u52a9\u60a8\u6d88\u9664\u8026\u5408\u5230\u5382\u5546\u79c1\u6709\u670d\u52a1\u53d1\u73b0 API \u4e0a\u7684\u98ce\u9669\u3002</p> <p>Nacos \u63d0\u4f9b\u4e86\u4e00\u4e9b\u7b80\u5355\u7684 DNS APIs TODO \u5e2e\u52a9\u60a8\u7ba1\u7406\u670d\u52a1\u7684\u5173\u8054\u57df\u540d\u548c\u53ef\u7528\u7684 IP:PORT \u5217\u8868.</p> <ul> <li>\u670d\u52a1\u53ca\u5176\u5143\u6570\u636e\u7ba1\u7406</li> </ul> <p>Nacos \u80fd\u8ba9\u60a8\u4ece\u5fae\u670d\u52a1\u5e73\u53f0\u5efa\u8bbe\u7684\u89c6\u89d2\u7ba1\u7406\u6570\u636e\u4e2d\u5fc3\u7684\u6240\u6709\u670d\u52a1\u53ca\u5143\u6570\u636e\uff0c\u5305\u62ec\u7ba1\u7406\u670d\u52a1\u7684\u63cf\u8ff0\u3001\u751f\u547d\u5468\u671f\u3001\u670d\u52a1\u7684\u9759\u6001\u4f9d\u8d56\u5206\u6790\u3001\u670d\u52a1\u7684\u5065\u5eb7\u72b6\u6001\u3001\u670d\u52a1\u7684\u6d41\u91cf\u7ba1\u7406\u3001\u8def\u7531\u53ca\u5b89\u5168\u7b56\u7565\u3001\u670d\u52a1\u7684 SLA \u4ee5\u53ca\u6700\u9996\u8981\u7684 metrics \u7edf\u8ba1\u6570\u636e\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#nacos_3","title":"Nacos \u67b6\u6784","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#service","title":"\u670d\u52a1 (Service)","text":"<p>\u670d\u52a1\u662f\u6307\u4e00\u4e2a\u6216\u4e00\u7ec4\u8f6f\u4ef6\u529f\u80fd\uff08\u4f8b\u5982\u7279\u5b9a\u4fe1\u606f\u7684\u68c0\u7d22\u6216\u4e00\u7ec4\u64cd\u4f5c\u7684\u6267\u884c\uff09\uff0c\u5176\u76ee\u7684\u662f\u4e0d\u540c\u7684\u5ba2\u6237\u7aef\u53ef\u4ee5\u4e3a\u4e0d\u540c\u7684\u76ee\u7684\u91cd\u7528\uff08\u4f8b\u5982\u901a\u8fc7\u8de8\u8fdb\u7a0b\u7684\u7f51\u7edc\u8c03\u7528\uff09\u3002Nacos \u652f\u6301\u4e3b\u6d41\u7684\u670d\u52a1\u751f\u6001\uff0c\u5982 Kubernetes Service\u3001gRPC|Dubbo RPC Service \u6216\u8005 Spring Cloud RESTful Service.</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#service-registry","title":"\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3 (Service Registry)","text":"<p>\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\uff0c\u5b83\u662f\u670d\u52a1\uff0c\u5176\u5b9e\u4f8b\u53ca\u5143\u6570\u636e\u7684\u6570\u636e\u5e93\u3002\u670d\u52a1\u5b9e\u4f8b\u5728\u542f\u52a8\u65f6\u6ce8\u518c\u5230\u670d\u52a1\u6ce8\u518c\u8868\uff0c\u5e76\u5728\u5173\u95ed\u65f6\u6ce8\u9500\u3002\u670d\u52a1\u548c\u8def\u7531\u5668\u7684\u5ba2\u6237\u7aef\u67e5\u8be2\u670d\u52a1\u6ce8\u518c\u8868\u4ee5\u67e5\u627e\u670d\u52a1\u7684\u53ef\u7528\u5b9e\u4f8b\u3002\u670d\u52a1\u6ce8\u518c\u4e2d\u5fc3\u53ef\u80fd\u4f1a\u8c03\u7528\u670d\u52a1\u5b9e\u4f8b\u7684\u5065\u5eb7\u68c0\u67e5 API \u6765\u9a8c\u8bc1\u5b83\u662f\u5426\u80fd\u591f\u5904\u7406\u8bf7\u6c42\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#service-metadata","title":"\u670d\u52a1\u5143\u6570\u636e (Service Metadata)","text":"<p>\u670d\u52a1\u5143\u6570\u636e\u662f\u6307\u5305\u62ec\u670d\u52a1\u7aef\u70b9(endpoints)\u3001\u670d\u52a1\u6807\u7b7e\u3001\u670d\u52a1\u7248\u672c\u53f7\u3001\u670d\u52a1\u5b9e\u4f8b\u6743\u91cd\u3001\u8def\u7531\u89c4\u5219\u3001\u5b89\u5168\u7b56\u7565\u7b49\u63cf\u8ff0\u670d\u52a1\u7684\u6570\u636e</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#service-provider","title":"\u670d\u52a1\u63d0\u4f9b\u65b9 (Service Provider)","text":"<p>\u662f\u6307\u63d0\u4f9b\u53ef\u590d\u7528\u548c\u53ef\u8c03\u7528\u670d\u52a1\u7684\u5e94\u7528\u65b9</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#service-consumer","title":"\u670d\u52a1\u6d88\u8d39\u65b9 (Service Consumer)","text":"<p>\u662f\u6307\u4f1a\u53d1\u8d77\u5bf9\u67d0\u4e2a\u670d\u52a1\u8c03\u7528\u7684\u5e94\u7528\u65b9</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#configuration","title":"\u914d\u7f6e (Configuration)","text":"<p>\u5728\u7cfb\u7edf\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u901a\u5e38\u4f1a\u5c06\u4e00\u4e9b\u9700\u8981\u53d8\u66f4\u7684\u53c2\u6570\u3001\u53d8\u91cf\u7b49\u4ece\u4ee3\u7801\u4e2d\u5206\u79bb\u51fa\u6765\u72ec\u7acb\u7ba1\u7406\uff0c\u4ee5\u72ec\u7acb\u7684\u914d\u7f6e\u6587\u4ef6\u7684\u5f62\u5f0f\u5b58\u5728\u3002\u76ee\u7684\u662f\u8ba9\u9759\u6001\u7684\u7cfb\u7edf\u5de5\u4ef6\u6216\u8005\u4ea4\u4ed8\u7269\uff08\u5982 WAR\uff0cJAR \u5305\u7b49\uff09\u66f4\u597d\u5730\u548c\u5b9e\u9645\u7684\u7269\u7406\u8fd0\u884c\u73af\u5883\u8fdb\u884c\u9002\u914d\u3002\u914d\u7f6e\u7ba1\u7406\u4e00\u822c\u5305\u542b\u5728\u7cfb\u7edf\u90e8\u7f72\u7684\u8fc7\u7a0b\u4e2d\uff0c\u7531\u7cfb\u7edf\u7ba1\u7406\u5458\u6216\u8005\u8fd0\u7ef4\u4eba\u5458\u5b8c\u6210\u8fd9\u4e2a\u6b65\u9aa4\u3002\u914d\u7f6e\u53d8\u66f4\u662f\u8c03\u6574\u7cfb\u7edf\u8fd0\u884c\u65f6\u7684\u884c\u4e3a\u7684\u6709\u6548\u624b\u6bb5\u4e4b\u4e00\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#configuration-management","title":"\u914d\u7f6e\u7ba1\u7406 (Configuration Management)","text":"<p>\u5728\u6570\u636e\u4e2d\u5fc3\u4e2d\uff0c\u7cfb\u7edf\u4e2d\u6240\u6709\u914d\u7f6e\u7684\u7f16\u8f91\u3001\u5b58\u50a8\u3001\u5206\u53d1\u3001\u53d8\u66f4\u7ba1\u7406\u3001\u5386\u53f2\u7248\u672c\u7ba1\u7406\u3001\u53d8\u66f4\u5ba1\u8ba1\u7b49\u6240\u6709\u4e0e\u914d\u7f6e\u76f8\u5173\u7684\u6d3b\u52a8\u7edf\u79f0\u4e3a\u914d\u7f6e\u7ba1\u7406\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#naming-service","title":"\u540d\u5b57\u670d\u52a1 (Naming Service)","text":"<p>\u63d0\u4f9b\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u6240\u6709\u5bf9\u8c61(Object)\u3001\u5b9e\u4f53(Entity)\u7684\u201c\u540d\u5b57\u201d\u5230\u5173\u8054\u7684\u5143\u6570\u636e\u4e4b\u95f4\u7684\u6620\u5c04\u7ba1\u7406\u670d\u52a1\uff0c\u4f8b\u5982 ServiceName -&gt; Endpoints Info, Distributed Lock Name -&gt; Lock Owner/Status Info, DNS Domain Name -&gt; IP List, \u670d\u52a1\u53d1\u73b0\u548c DNS \u5c31\u662f\u540d\u5b57\u670d\u52a1\u76842\u5927\u573a\u666f\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#configuration-service","title":"\u914d\u7f6e\u670d\u52a1 (Configuration Service)","text":"<p>\u5728\u670d\u52a1\u6216\u8005\u5e94\u7528\u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u63d0\u4f9b\u52a8\u6001\u914d\u7f6e\u6216\u8005\u5143\u6570\u636e\u4ee5\u53ca\u914d\u7f6e\u7ba1\u7406\u7684\u670d\u52a1\u63d0\u4f9b\u8005\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#_1","title":"\u903b\u8f91\u67b6\u6784\u53ca\u5176\u7ec4\u4ef6","text":"<ul> <li>\u670d\u52a1\u7ba1\u7406\uff1a\u5b9e\u73b0\u670d\u52a1CRUD\uff0c\u57df\u540dCRUD\uff0c\u670d\u52a1\u5065\u5eb7\u72b6\u6001\u68c0\u67e5\uff0c\u670d\u52a1\u6743\u91cd\u7ba1\u7406\u7b49\u529f\u80fd</li> <li>\u914d\u7f6e\u7ba1\u7406\uff1a\u5b9e\u73b0\u914d\u7f6e\u7ba1CRUD\uff0c\u7248\u672c\u7ba1\u7406\uff0c\u7070\u5ea6\u7ba1\u7406\uff0c\u76d1\u542c\u7ba1\u7406\uff0c\u63a8\u9001\u8f68\u8ff9\uff0c\u805a\u5408\u6570\u636e\u7b49\u529f\u80fd</li> <li>\u5143\u6570\u636e\u7ba1\u7406\uff1a\u63d0\u4f9b\u5143\u6570\u636eCURD \u548c\u6253\u6807\u80fd\u529b</li> <li>\u63d2\u4ef6\u673a\u5236\uff1a\u5b9e\u73b0\u4e09\u4e2a\u6a21\u5757\u53ef\u5206\u53ef\u5408\u80fd\u529b\uff0c\u5b9e\u73b0\u6269\u5c55\u70b9SPI\u673a\u5236</li> <li>\u4e8b\u4ef6\u673a\u5236\uff1a\u5b9e\u73b0\u5f02\u6b65\u5316\u4e8b\u4ef6\u901a\u77e5\uff0csdk\u6570\u636e\u53d8\u5316\u5f02\u6b65\u901a\u77e5\u7b49\u903b\u8f91</li> <li>\u65e5\u5fd7\u6a21\u5757\uff1a\u7ba1\u7406\u65e5\u5fd7\u5206\u7c7b\uff0c\u65e5\u5fd7\u7ea7\u522b\uff0c\u65e5\u5fd7\u53ef\u79fb\u690d\u6027\uff08\u5c24\u5176\u907f\u514d\u51b2\u7a81\uff09\uff0c\u65e5\u5fd7\u683c\u5f0f\uff0c\u5f02\u5e38\u7801+\u5e2e\u52a9\u6587\u6863</li> <li>\u56de\u8c03\u673a\u5236\uff1asdk\u901a\u77e5\u6570\u636e\uff0c\u901a\u8fc7\u7edf\u4e00\u7684\u6a21\u5f0f\u56de\u8c03\u7528\u6237\u5904\u7406\u3002\u63a5\u53e3\u548c\u6570\u636e\u7ed3\u6784\u9700\u8981\u5177\u5907\u53ef\u6269\u5c55\u6027</li> <li>\u5bfb\u5740\u6a21\u5f0f\uff1a\u89e3\u51b3ip\uff0c\u57df\u540d\uff0cnameserver\u3001\u5e7f\u64ad\u7b49\u591a\u79cd\u5bfb\u5740\u6a21\u5f0f\uff0c\u9700\u8981\u53ef\u6269\u5c55</li> <li>\u63a8\u9001\u901a\u9053\uff1a\u89e3\u51b3server\u4e0e\u5b58\u50a8\u3001server\u95f4\u3001server\u4e0esdk\u95f4\u63a8\u9001\u6027\u80fd\u95ee\u9898</li> <li>\u5bb9\u91cf\u7ba1\u7406\uff1a\u7ba1\u7406\u6bcf\u4e2a\u79df\u6237\uff0c\u5206\u7ec4\u4e0b\u7684\u5bb9\u91cf\uff0c\u9632\u6b62\u5b58\u50a8\u88ab\u5199\u7206\uff0c\u5f71\u54cd\u670d\u52a1\u53ef\u7528\u6027</li> <li>\u6d41\u91cf\u7ba1\u7406\uff1a\u6309\u7167\u79df\u6237\uff0c\u5206\u7ec4\u7b49\u591a\u4e2a\u7ef4\u5ea6\u5bf9\u8bf7\u6c42\u9891\u7387\uff0c\u957f\u94fe\u63a5\u4e2a\u6570\uff0c\u62a5\u6587\u5927\u5c0f\uff0c\u8bf7\u6c42\u6d41\u63a7\u8fdb\u884c\u63a7\u5236</li> <li>\u7f13\u5b58\u673a\u5236\uff1a\u5bb9\u707e\u76ee\u5f55\uff0c\u672c\u5730\u7f13\u5b58\uff0cserver\u7f13\u5b58\u673a\u5236\u3002\u5bb9\u707e\u76ee\u5f55\u4f7f\u7528\u9700\u8981\u5de5\u5177</li> <li>\u542f\u52a8\u6a21\u5f0f\uff1a\u6309\u7167\u5355\u673a\u6a21\u5f0f\uff0c\u914d\u7f6e\u6a21\u5f0f\uff0c\u670d\u52a1\u6a21\u5f0f\uff0cdns\u6a21\u5f0f\uff0c\u6216\u8005all\u6a21\u5f0f\uff0c\u542f\u52a8\u4e0d\u540c\u7684\u7a0b\u5e8f+UI</li> <li>\u4e00\u81f4\u6027\u534f\u8bae\uff1a\u89e3\u51b3\u4e0d\u540c\u6570\u636e\uff0c\u4e0d\u540c\u4e00\u81f4\u6027\u8981\u6c42\u60c5\u51b5\u4e0b\uff0c\u4e0d\u540c\u4e00\u81f4\u6027\u673a\u5236</li> <li>\u5b58\u50a8\u6a21\u5757\uff1a\u89e3\u51b3\u6570\u636e\u6301\u4e45\u5316\u3001\u975e\u6301\u4e45\u5316\u5b58\u50a8\uff0c\u89e3\u51b3\u6570\u636e\u5206\u7247\u95ee\u9898</li> <li>Nameserver\uff1a\u89e3\u51b3namespace\u5230clusterid\u7684\u8def\u7531\u95ee\u9898\uff0c\u89e3\u51b3\u7528\u6237\u73af\u5883\u4e0enacos\u7269\u7406\u73af\u5883\u6620\u5c04\u95ee\u9898</li> <li>CMDB\uff1a\u89e3\u51b3\u5143\u6570\u636e\u5b58\u50a8\uff0c\u4e0e\u4e09\u65b9cmdb\u7cfb\u7edf\u5bf9\u63a5\u95ee\u9898\uff0c\u89e3\u51b3\u5e94\u7528\uff0c\u4eba\uff0c\u8d44\u6e90\u5173\u7cfb</li> <li>Metrics\uff1a\u66b4\u9732\u6807\u51c6metrics\u6570\u636e\uff0c\u65b9\u4fbf\u4e0e\u4e09\u65b9\u76d1\u63a7\u7cfb\u7edf\u6253\u901a</li> <li>Trace\uff1a\u66b4\u9732\u6807\u51c6trace\uff0c\u65b9\u4fbf\u4e0eSLA\u7cfb\u7edf\u6253\u901a\uff0c\u65e5\u5fd7\u767d\u5e73\u5316\uff0c\u63a8\u9001\u8f68\u8ff9\u7b49\u80fd\u529b\uff0c\u5e76\u4e14\u53ef\u4ee5\u548c\u8ba1\u91cf\u8ba1\u8d39\u7cfb\u7edf\u6253\u901a</li> <li>\u63a5\u5165\u7ba1\u7406\uff1a\u76f8\u5f53\u4e8e\u963f\u91cc\u4e91\u5f00\u901a\u670d\u52a1\uff0c\u5206\u914d\u8eab\u4efd\u3001\u5bb9\u91cf\u3001\u6743\u9650\u8fc7\u7a0b</li> <li>\u7528\u6237\u7ba1\u7406\uff1a\u89e3\u51b3\u7528\u6237\u7ba1\u7406\uff0c\u767b\u5f55\uff0csso\u7b49\u95ee\u9898</li> <li>\u6743\u9650\u7ba1\u7406\uff1a\u89e3\u51b3\u8eab\u4efd\u8bc6\u522b\uff0c\u8bbf\u95ee\u63a7\u5236\uff0c\u89d2\u8272\u7ba1\u7406\u7b49\u95ee\u9898</li> <li>\u5ba1\u8ba1\u7cfb\u7edf\uff1a\u6269\u5c55\u63a5\u53e3\u65b9\u4fbf\u4e0e\u4e0d\u540c\u516c\u53f8\u5ba1\u8ba1\u7cfb\u7edf\u6253\u901a</li> <li>\u901a\u77e5\u7cfb\u7edf\uff1a\u6838\u5fc3\u6570\u636e\u53d8\u66f4\uff0c\u6216\u8005\u64cd\u4f5c\uff0c\u65b9\u4fbf\u901a\u8fc7SMS\u7cfb\u7edf\u6253\u901a\uff0c\u901a\u77e5\u5230\u5bf9\u5e94\u4eba\u6570\u636e\u53d8\u66f4</li> <li>OpenAPI\uff1a\u66b4\u9732\u6807\u51c6Rest\u98ce\u683cHTTP\u63a5\u53e3\uff0c\u7b80\u5355\u6613\u7528\uff0c\u65b9\u4fbf\u591a\u8bed\u8a00\u96c6\u6210</li> <li>Console\uff1a\u6613\u7528\u63a7\u5236\u53f0\uff0c\u505a\u670d\u52a1\u7ba1\u7406\u3001\u914d\u7f6e\u7ba1\u7406\u7b49\u64cd\u4f5c</li> <li>SDK\uff1a\u591a\u8bed\u8a00sdk</li> <li>Agent\uff1adns-f\u7c7b\u4f3c\u6a21\u5f0f\uff0c\u6216\u8005\u4e0emesh\u7b49\u65b9\u6848\u96c6\u6210</li> <li>CLI\uff1a\u547d\u4ee4\u884c\u5bf9\u4ea7\u54c1\u8fdb\u884c\u8f7b\u91cf\u5316\u7ba1\u7406\uff0c\u50cfgit\u4e00\u6837\u597d\u7528</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#nacos_4","title":"Nacos \u90e8\u7f72","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#_2","title":"\u96c6\u7fa4\u90e8\u7f72\u67b6\u6784\u56fe","text":"<p>http://ip1:port/openAPI \u76f4\u8fdeip\u6a21\u5f0f\uff0c\u673a\u5668\u6302\u5219\u9700\u8981\u4fee\u6539ip\u624d\u53ef\u4ee5\u4f7f\u7528\u3002</p> <p>http://VIP:port/openAPI \u6302\u8f7dVIP\u6a21\u5f0f\uff0c\u76f4\u8fdevip\u5373\u53ef\uff0c\u4e0b\u9762\u6302server\u771f\u5b9eip\uff0c\u53ef\u8bfb\u6027\u4e0d\u597d\u3002</p> <p>http://nacos.com:port/openAPI \u57df\u540d + VIP\u6a21\u5f0f\uff0c\u53ef\u8bfb\u6027\u597d\uff0c\u800c\u4e14\u6362ip\u65b9\u4fbf\uff0c\u63a8\u8350\u6a21\u5f0f</p> <p></p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#_3","title":"\u5b89\u88c5","text":"<pre><code># helm repo \u4e0b\u8f7d\nhelm pull aliyuncs/nacos\n# \u914d\u7f6evalues \n## \u4fee\u6539\u6a21\u5f0f\u4e3a\u96c6\u7fa4\u6a21\u5f0f\nglobal:\n #mode: quickstart\n #mode: standalone\n mode: cluster \n## \u6dfb\u52a0sc\u63d0\u4f9b\u6570\u636e\u5b58\u50a8\npersistence:\n    enabled: false\n    existingClaim: mysql-slave-data\n    #existingClaim:\n    claim: \n      name: mysql-slave-data\n      spec: \n        accessModes:\n        - ReadWriteOnce\n        resources:\n          requests:\n            storage: 5G\n        storageClassName: sc-mysql-slave\n## \u4fee\u6539\u526f\u672c\u6570\nreplicaCount: 3\n## \u5229\u7528\u963f\u91cc\u4e91nas\u52a8\u6001\u5377\u521b\u5efasc\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  annotations:\n    meta.helm.sh/release-name: nacos\n    meta.helm.sh/release-namespace: middleware\n  labels:\n    app.kubernetes.io/managed-by: Helm\n  name: alibabacloud-nas-nacos\nmountOptions:\n- nolock,tcp,noresvport\n- vers=3\nparameters:\n  server: nas_server:/nacos/\n  volumeAs: subpath\nprovisioner: nasplugin.csi.alibabacloud.com\nreclaimPolicy: Delete\nvolumeBindingMode: Immediate\n# \u914d\u7f6emysql\u6570\u636e\u6e90\n## mysql \u9ad8\u53ef\u7528\u96c6\u7fa4\uff0cdb.num\u914d\u7f6e\u4e3a1\nng\nserver.servlet.contextPath=${SERVER_SERVLET_CONTEXTPATH:/nacos}\nserver.contextPath=/nacos\nserver.port=${NACOS_APPLICATION_PORT:8848}\nspring.datasource.platform=${SPRING_DATASOURCE_PLATFORM:\"\"}\nnacos.cmdb.dumpTaskInterval=3600\nnacos.cmdb.eventTaskInterval=10\nnacos.cmdb.labelTaskInterval=300\nnacos.cmdb.loadDataAtStart=false\ndb.num=${MYSQL_DATABASE_NUM:1}\ndb.url.0=jdbc:mysql://${MYSQL_SERVICE_HOST}:${MYSQL_SERVICE_PORT:3306}/${MYSQL_SERVICE_DB_NAME}?${MYSQL_SERVICE_DB_PARAM:characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true}\ndb.url.1=jdbc:mysql://${MYSQL_SERVICE_HOST}:${MYSQL_SERVICE_PORT:3306}/${MYSQL_SERVICE_DB_NAME}?${MYSQL_SERVICE_DB_PARAM:characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true}\ndb.user=${MYSQL_SERVICE_USER}\ndb.password=${MYSQL_SERVICE_PASSWORD}\n# \u5b89\u88c5\nhelm upgrade --install nacos aliyun/nacos -n ddyw-mmeber-test --debug\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#_4","title":"\u521d\u59cb\u5316\u6570\u636e\u5e93","text":"<pre><code>/*\n * Copyright 1999-2018 Alibaba Group Holding Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/******************************************/\n/*   \u6570\u636e\u5e93\u5168\u540d = nacos_config   */\n/*   \u8868\u540d\u79f0 = config_info   */\n/******************************************/\nCREATE TABLE `config_info` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'id',\n  `data_id` varchar(255) NOT NULL COMMENT 'data_id',\n  `group_id` varchar(255) DEFAULT NULL,\n  `content` longtext NOT NULL COMMENT 'content',\n  `md5` varchar(32) DEFAULT NULL COMMENT 'md5',\n  `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u4fee\u6539\u65f6\u95f4',\n  `src_user` text COMMENT 'source user',\n  `src_ip` varchar(50) DEFAULT NULL COMMENT 'source ip',\n  `app_name` varchar(128) DEFAULT NULL,\n  `tenant_id` varchar(128) DEFAULT '' COMMENT '\u79df\u6237\u5b57\u6bb5',\n  `c_desc` varchar(256) DEFAULT NULL,\n  `c_use` varchar(64) DEFAULT NULL,\n  `effect` varchar(64) DEFAULT NULL,\n  `type` varchar(64) DEFAULT NULL,\n  `c_schema` text,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_configinfo_datagrouptenant` (`data_id`,`group_id`,`tenant_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='config_info';\n\n/******************************************/\n/*   \u6570\u636e\u5e93\u5168\u540d = nacos_config   */\n/*   \u8868\u540d\u79f0 = config_info_aggr   */\n/******************************************/\nCREATE TABLE `config_info_aggr` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'id',\n  `data_id` varchar(255) NOT NULL COMMENT 'data_id',\n  `group_id` varchar(255) NOT NULL COMMENT 'group_id',\n  `datum_id` varchar(255) NOT NULL COMMENT 'datum_id',\n  `content` longtext NOT NULL COMMENT '\u5185\u5bb9',\n  `gmt_modified` datetime NOT NULL COMMENT '\u4fee\u6539\u65f6\u95f4',\n  `app_name` varchar(128) DEFAULT NULL,\n  `tenant_id` varchar(128) DEFAULT '' COMMENT '\u79df\u6237\u5b57\u6bb5',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_configinfoaggr_datagrouptenantdatum` (`data_id`,`group_id`,`tenant_id`,`datum_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='\u589e\u52a0\u79df\u6237\u5b57\u6bb5';\n\n\n/******************************************/\n/*   \u6570\u636e\u5e93\u5168\u540d = nacos_config   */\n/*   \u8868\u540d\u79f0 = config_info_beta   */\n/******************************************/\nCREATE TABLE `config_info_beta` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'id',\n  `data_id` varchar(255) NOT NULL COMMENT 'data_id',\n  `group_id` varchar(128) NOT NULL COMMENT 'group_id',\n  `app_name` varchar(128) DEFAULT NULL COMMENT 'app_name',\n  `content` longtext NOT NULL COMMENT 'content',\n  `beta_ips` varchar(1024) DEFAULT NULL COMMENT 'betaIps',\n  `md5` varchar(32) DEFAULT NULL COMMENT 'md5',\n  `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u4fee\u6539\u65f6\u95f4',\n  `src_user` text COMMENT 'source user',\n  `src_ip` varchar(50) DEFAULT NULL COMMENT 'source ip',\n  `tenant_id` varchar(128) DEFAULT '' COMMENT '\u79df\u6237\u5b57\u6bb5',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_configinfobeta_datagrouptenant` (`data_id`,`group_id`,`tenant_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='config_info_beta';\n\n/******************************************/\n/*   \u6570\u636e\u5e93\u5168\u540d = nacos_config   */\n/*   \u8868\u540d\u79f0 = config_info_tag   */\n/******************************************/\nCREATE TABLE `config_info_tag` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'id',\n  `data_id` varchar(255) NOT NULL COMMENT 'data_id',\n  `group_id` varchar(128) NOT NULL COMMENT 'group_id',\n  `tenant_id` varchar(128) DEFAULT '' COMMENT 'tenant_id',\n  `tag_id` varchar(128) NOT NULL COMMENT 'tag_id',\n  `app_name` varchar(128) DEFAULT NULL COMMENT 'app_name',\n  `content` longtext NOT NULL COMMENT 'content',\n  `md5` varchar(32) DEFAULT NULL COMMENT 'md5',\n  `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u4fee\u6539\u65f6\u95f4',\n  `src_user` text COMMENT 'source user',\n  `src_ip` varchar(50) DEFAULT NULL COMMENT 'source ip',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_configinfotag_datagrouptenanttag` (`data_id`,`group_id`,`tenant_id`,`tag_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='config_info_tag';\n\n/******************************************/\n/*   \u6570\u636e\u5e93\u5168\u540d = nacos_config   */\n/*   \u8868\u540d\u79f0 = config_tags_relation   */\n/******************************************/\nCREATE TABLE `config_tags_relation` (\n  `id` bigint(20) NOT NULL COMMENT 'id',\n  `tag_name` varchar(128) NOT NULL COMMENT 'tag_name',\n  `tag_type` varchar(64) DEFAULT NULL COMMENT 'tag_type',\n  `data_id` varchar(255) NOT NULL COMMENT 'data_id',\n  `group_id` varchar(128) NOT NULL COMMENT 'group_id',\n  `tenant_id` varchar(128) DEFAULT '' COMMENT 'tenant_id',\n  `nid` bigint(20) NOT NULL AUTO_INCREMENT,\n  PRIMARY KEY (`nid`),\n  UNIQUE KEY `uk_configtagrelation_configidtag` (`id`,`tag_name`,`tag_type`),\n  KEY `idx_tenant_id` (`tenant_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='config_tag_relation';\n\n/******************************************/\n/*   \u6570\u636e\u5e93\u5168\u540d = nacos_config   */\n/*   \u8868\u540d\u79f0 = group_capacity   */\n/******************************************/\nCREATE TABLE `group_capacity` (\n  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '\u4e3b\u952eID',\n  `group_id` varchar(128) NOT NULL DEFAULT '' COMMENT 'Group ID\uff0c\u7a7a\u5b57\u7b26\u8868\u793a\u6574\u4e2a\u96c6\u7fa4',\n  `quota` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u914d\u989d\uff0c0\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u503c',\n  `usage` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u4f7f\u7528\u91cf',\n  `max_size` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u5355\u4e2a\u914d\u7f6e\u5927\u5c0f\u4e0a\u9650\uff0c\u5355\u4f4d\u4e3a\u5b57\u8282\uff0c0\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u503c',\n  `max_aggr_count` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u805a\u5408\u5b50\u914d\u7f6e\u6700\u5927\u4e2a\u6570\uff0c\uff0c0\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u503c',\n  `max_aggr_size` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u5355\u4e2a\u805a\u5408\u6570\u636e\u7684\u5b50\u914d\u7f6e\u5927\u5c0f\u4e0a\u9650\uff0c\u5355\u4f4d\u4e3a\u5b57\u8282\uff0c0\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u503c',\n  `max_history_count` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u6700\u5927\u53d8\u66f4\u5386\u53f2\u6570\u91cf',\n  `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u4fee\u6539\u65f6\u95f4',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_group_id` (`group_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='\u96c6\u7fa4\u3001\u5404Group\u5bb9\u91cf\u4fe1\u606f\u8868';\n\n/******************************************/\n/*   \u6570\u636e\u5e93\u5168\u540d = nacos_config   */\n/*   \u8868\u540d\u79f0 = his_config_info   */\n/******************************************/\nCREATE TABLE `his_config_info` (\n  `id` bigint(64) unsigned NOT NULL,\n  `nid` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n  `data_id` varchar(255) NOT NULL,\n  `group_id` varchar(128) NOT NULL,\n  `app_name` varchar(128) DEFAULT NULL COMMENT 'app_name',\n  `content` longtext NOT NULL,\n  `md5` varchar(32) DEFAULT NULL,\n  `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  `src_user` text,\n  `src_ip` varchar(50) DEFAULT NULL,\n  `op_type` char(10) DEFAULT NULL,\n  `tenant_id` varchar(128) DEFAULT '' COMMENT '\u79df\u6237\u5b57\u6bb5',\n  PRIMARY KEY (`nid`),\n  KEY `idx_gmt_create` (`gmt_create`),\n  KEY `idx_gmt_modified` (`gmt_modified`),\n  KEY `idx_did` (`data_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='\u591a\u79df\u6237\u6539\u9020';\n\n\n/******************************************/\n/*   \u6570\u636e\u5e93\u5168\u540d = nacos_config   */\n/*   \u8868\u540d\u79f0 = tenant_capacity   */\n/******************************************/\nCREATE TABLE `tenant_capacity` (\n  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '\u4e3b\u952eID',\n  `tenant_id` varchar(128) NOT NULL DEFAULT '' COMMENT 'Tenant ID',\n  `quota` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u914d\u989d\uff0c0\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u503c',\n  `usage` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u4f7f\u7528\u91cf',\n  `max_size` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u5355\u4e2a\u914d\u7f6e\u5927\u5c0f\u4e0a\u9650\uff0c\u5355\u4f4d\u4e3a\u5b57\u8282\uff0c0\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u503c',\n  `max_aggr_count` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u805a\u5408\u5b50\u914d\u7f6e\u6700\u5927\u4e2a\u6570',\n  `max_aggr_size` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u5355\u4e2a\u805a\u5408\u6570\u636e\u7684\u5b50\u914d\u7f6e\u5927\u5c0f\u4e0a\u9650\uff0c\u5355\u4f4d\u4e3a\u5b57\u8282\uff0c0\u8868\u793a\u4f7f\u7528\u9ed8\u8ba4\u503c',\n  `max_history_count` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '\u6700\u5927\u53d8\u66f4\u5386\u53f2\u6570\u91cf',\n  `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u4fee\u6539\u65f6\u95f4',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_tenant_id` (`tenant_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='\u79df\u6237\u5bb9\u91cf\u4fe1\u606f\u8868';\n\n\nCREATE TABLE `tenant_info` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'id',\n  `kp` varchar(128) NOT NULL COMMENT 'kp',\n  `tenant_id` varchar(128) default '' COMMENT 'tenant_id',\n  `tenant_name` varchar(128) default '' COMMENT 'tenant_name',\n  `tenant_desc` varchar(256) DEFAULT NULL COMMENT 'tenant_desc',\n  `create_source` varchar(32) DEFAULT NULL COMMENT 'create_source',\n  `gmt_create` bigint(20) NOT NULL COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `gmt_modified` bigint(20) NOT NULL COMMENT '\u4fee\u6539\u65f6\u95f4',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_tenant_info_kptenantid` (`kp`,`tenant_id`),\n  KEY `idx_tenant_id` (`tenant_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='tenant_info';\n\nCREATE TABLE `users` (\n    `username` varchar(50) NOT NULL PRIMARY KEY,\n    `password` varchar(500) NOT NULL,\n    `enabled` boolean NOT NULL\n);\n\nCREATE TABLE `roles` (\n    `username` varchar(50) NOT NULL,\n    `role` varchar(50) NOT NULL,\n    UNIQUE INDEX `idx_user_role` (`username` ASC, `role` ASC) USING BTREE\n);\n\nCREATE TABLE `permissions` (\n    `role` varchar(50) NOT NULL,\n    `resource` varchar(255) NOT NULL,\n    `action` varchar(8) NOT NULL,\n    UNIQUE INDEX `uk_role_permission` (`role`,`resource`,`action`) USING BTREE\n);\n\nINSERT INTO users (username, password, enabled) VALUES ('nacos', '123', TRUE);\n\nINSERT INTO roles (username, role) VALUES ('nacos', 'ROLE_ADMIN');\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#_5","title":"\u670d\u52a1\u6ce8\u518c&amp;\u53d1\u73b0\u914d\u7f6e\u7ba1\u7406","text":"<p>\u670d\u52a1\u6ce8\u518c</p> <pre><code># \u6ce8\u518c\u670d\u52a1\ncurl -X PUT 'http://127.0.0.1:8848/nacos/v1/ns/instance\uff1fserviceName=nacos.naming.serviceName&amp;ip=20.18.7.10&amp;port=8080'\n\u8fd4\u56de\uff1aok\n</code></pre> <p>\u670d\u52a1\u53d1\u73b0</p> <pre><code># \u67e5\u8be2\u670d\u52a1\ncurl -X GET 'http://127.0.0.1:8848/nacos/v1/ns/instance/list?serviceName=nacos.naming.serviceName'\n{\"dom\":\"nacos.naming.serviceName\",\"name\":\"DEFAULT_GROUP@@nacos.naming.serviceName\",\"cacheMillis\":3000,\"lastRefTime\":1611892884808,\"checksum\":\"7f882d81002bc22181203d423a20a16d\",\"useSpecifiedURL\":false,\"clusters\":\"\",\"env\":\"\",\"hosts\":[],\"metadata\":{}}\n</code></pre> <p>\u53d1\u5e03\u914d\u7f6e</p> <pre><code># \u53d1\u5e03\u914d\u7f6e\ncurl -X POST \"http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=nacos.cfg.dataId&amp;group=test&amp;content=helloWorld\"\n\u8fd4\u56de\uff1atrue\n</code></pre> <p>\u83b7\u53d6\u914d\u7f6e</p> <pre><code># \u83b7\u53d6\u914d\u7f6e\ncurl -X GET \"http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=nacos.cfg.dataId&amp;group=test\"\n\u8fd4\u56de\uff1ahelloWorld\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#nacos_5","title":"Nacos \u5e94\u7528","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#dubbo","title":"\u63a5\u5165dubbo","text":"<p>\u9879\u76ee\u7ed3\u6784\u5982\u4e0b\uff1a</p> <p></p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#provider","title":"provider \u670d\u52a1\u63d0\u4f9b\u8005","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#_6","title":"\u5f15\u5165\u4f9d\u8d56","text":"<pre><code>&lt;!-- \u4f7f\u7528 Nacos \u4f5c\u4e3a\u6ce8\u518c\u4e2d\u5fc3 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.nacos&lt;/groupId&gt;\n    &lt;artifactId&gt;nacos-client&lt;/artifactId&gt;\n    &lt;version&gt;1.4.0&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\n    &lt;artifactId&gt;dubbo-registry-nacos&lt;/artifactId&gt;\n    &lt;version&gt;2.7.5&lt;/version&gt;\n&lt;/dependency&gt;\n# \u5b8c\u6574pom\u6587\u4ef6\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;2.4.2&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;artifactId&gt;user-service-provider&lt;/artifactId&gt;\n\n    &lt;dependencies&gt;\n        &lt;!-- \u5f15\u5165\u5b9a\u4e49\u7684 Dubbo API \u63a5\u53e3 --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;top.mikel.springboot.users&lt;/groupId&gt;\n            &lt;artifactId&gt;user-service-api&lt;/artifactId&gt;\n            &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- \u5f15\u5165 Spring Boot \u4f9d\u8d56 --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- \u5b9e\u73b0\u5bf9 Dubbo \u7684\u81ea\u52a8\u5316\u914d\u7f6e --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\n            &lt;artifactId&gt;dubbo&lt;/artifactId&gt;\n            &lt;version&gt;2.7.5&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\n            &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt;\n            &lt;version&gt;2.7.5&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- \u4f7f\u7528 Zookeeper \u4f5c\u4e3a\u6ce8\u518c\u4e2d\u5fc3 --&gt;\n&lt;!--        &lt;dependency&gt;--&gt;\n&lt;!--            &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;--&gt;\n&lt;!--            &lt;artifactId&gt;curator-framework&lt;/artifactId&gt;--&gt;\n&lt;!--            &lt;version&gt;2.13.0&lt;/version&gt;--&gt;\n&lt;!--        &lt;/dependency&gt;--&gt;\n&lt;!--        &lt;dependency&gt;--&gt;\n&lt;!--            &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;--&gt;\n&lt;!--            &lt;artifactId&gt;curator-recipes&lt;/artifactId&gt;--&gt;\n&lt;!--            &lt;version&gt;2.13.0&lt;/version&gt;--&gt;\n&lt;!--        &lt;/dependency&gt;--&gt;&lt;!-- \u4f7f\u7528 Nacos \u4f5c\u4e3a\u6ce8\u518c\u4e2d\u5fc3 --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.alibaba.nacos&lt;/groupId&gt;\n            &lt;artifactId&gt;nacos-client&lt;/artifactId&gt;\n            &lt;version&gt;1.4.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\n            &lt;artifactId&gt;dubbo-registry-nacos&lt;/artifactId&gt;\n            &lt;version&gt;2.7.5&lt;/version&gt;\n        &lt;/dependency&gt;\n\n\n\n    &lt;/dependencies&gt;\n\n\n&lt;/project&gt;\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#_7","title":"\u4fee\u6539\u914d\u7f6e\u6587\u4ef6","text":"<pre><code># dubbo \u914d\u7f6e\u9879\uff0c\u5bf9\u5e94 DubboConfigurationProperties \u914d\u7f6e\u7c7b\ndubbo:\n  # Dubbo \u5e94\u7528\u914d\u7f6e\n  application:\n    name: user-service-provider # \u5e94\u7528\u540d\n  # Dubbo \u6ce8\u518c\u4e2d\u5fc3\u914d\n  registry:\n    address: nacos://127.0.0.1:8848 # \u6ce8\u518c\u4e2d\u5fc3\u5730\u5740\u3002\u4e2a\u97a5\u591a\u6ce8\u518c\u4e2d\u5fc3\uff0c\u53ef\u89c1 http://dubbo.apache.org/zh-cn/docs/user/references/registry/introduction.html \u6587\u6863\u3002\n  # Dubbo \u670d\u52a1\u63d0\u4f9b\u8005\u534f\u8bae\u914d\u7f6e\n  protocol:\n    port: -1 # \u534f\u8bae\u7aef\u53e3\u3002\u4f7f\u7528 -1 \u8868\u793a\u968f\u673a\u7aef\u53e3\u3002\n    name: dubbo # \u4f7f\u7528 `dubbo://` \u534f\u8bae\u3002\u66f4\u591a\u534f\u8bae\uff0c\u53ef\u89c1 http://dubbo.apache.org/zh-cn/docs/user/references/protocol/introduction.html \u6587\u6863\n  # Dubbo \u670d\u52a1\u63d0\u4f9b\u8005\u914d\u7f6e\n  provider:\n    timeout: 1000 # \u3010\u91cd\u8981\u3011\u8fdc\u7a0b\u670d\u52a1\u8c03\u7528\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\uff1a\u6beb\u79d2\u3002\u9ed8\u8ba4\u4e3a 1000 \u6beb\u79d2\uff0c\u80d6\u53cb\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u4e1a\u52a1\u4fee\u6539\n    UserRpcService:\n      version: 1.0.0\n  # \u914d\u7f6e\u626b\u63cf Dubbo \u81ea\u5b9a\u4e49\u7684 @Service \u6ce8\u89e3\uff0c\u66b4\u9732\u6210 Dubbo \u670d\u52a1\u63d0\u4f9b\u8005\n  scan:\n    base-packages: top.mikel.springboot.users.service.service\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#consumer","title":"consumer \u6d88\u8d39\u8005","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#_8","title":"\u5f15\u5165\u4f9d\u8d56","text":"<pre><code>&lt;!-- \u4f7f\u7528 Nacos \u4f5c\u4e3a\u6ce8\u518c\u4e2d\u5fc3 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.nacos&lt;/groupId&gt;\n    &lt;artifactId&gt;nacos-client&lt;/artifactId&gt;\n    &lt;version&gt;1.4.0&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\n    &lt;artifactId&gt;dubbo-registry-nacos&lt;/artifactId&gt;\n    &lt;version&gt;2.7.5&lt;/version&gt;\n&lt;/dependency&gt;\n# \u5b8c\u6574pom\u6587\u4ef6\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;2.4.2&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;artifactId&gt;user-service-consumer&lt;/artifactId&gt;\n\n    &lt;dependencies&gt;\n        &lt;!-- \u5f15\u5165\u5b9a\u4e49\u7684 Dubbo API \u63a5\u53e3 --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;top.mikel.springboot.users&lt;/groupId&gt;\n            &lt;artifactId&gt;user-service-api&lt;/artifactId&gt;\n            &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- \u5f15\u5165 Spring Boot \u4f9d\u8d56 --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- \u5b9e\u73b0\u5bf9 Dubbo \u7684\u81ea\u52a8\u5316\u914d\u7f6e --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\n            &lt;artifactId&gt;dubbo&lt;/artifactId&gt;\n            &lt;version&gt;2.7.5&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\n            &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt;\n            &lt;version&gt;2.7.5&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- \u4f7f\u7528 Zookeeper \u4f5c\u4e3a\u6ce8\u518c\u4e2d\u5fc3 --&gt;\n&lt;!--        &lt;dependency&gt;--&gt;\n&lt;!--            &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;--&gt;\n&lt;!--            &lt;artifactId&gt;curator-framework&lt;/artifactId&gt;--&gt;\n&lt;!--            &lt;version&gt;2.13.0&lt;/version&gt;--&gt;\n&lt;!--        &lt;/dependency&gt;--&gt;\n&lt;!--        &lt;dependency&gt;--&gt;\n&lt;!--            &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;--&gt;\n&lt;!--            &lt;artifactId&gt;curator-recipes&lt;/artifactId&gt;--&gt;\n&lt;!--            &lt;version&gt;2.13.0&lt;/version&gt;--&gt;\n&lt;!--        &lt;/dependency&gt;--&gt;&lt;!-- \u4f7f\u7528 Nacos \u4f5c\u4e3a\u6ce8\u518c\u4e2d\u5fc3 --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.alibaba.nacos&lt;/groupId&gt;\n            &lt;artifactId&gt;nacos-client&lt;/artifactId&gt;\n            &lt;version&gt;1.4.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;\n            &lt;artifactId&gt;dubbo-registry-nacos&lt;/artifactId&gt;\n            &lt;version&gt;2.7.5&lt;/version&gt;\n        &lt;/dependency&gt;\n\n\n\n    &lt;/dependencies&gt;\n\n\n&lt;/project&gt;\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#_9","title":"\u4fee\u6539\u914d\u7f6e\u6587\u4ef6","text":"<pre><code># dubbo \u914d\u7f6e\u9879\uff0c\u5bf9\u5e94 DubboConfigurationProperties \u914d\u7f6e\u7c7b\ndubbo:\n  # Dubbo \u5e94\u7528\u914d\u7f6e\n  application:\n    name: user-service-consumer # \u5e94\u7528\u540d\n  # Dubbo \u6ce8\u518c\u4e2d\u5fc3\u914d\u7f6e\n  registry:\n    address: nacos://127.0.0.1:8848 # \u6ce8\u518c\u4e2d\u5fc3\u5730\u5740\u3002\u4e2a\u97a5\u591a\u6ce8\u518c\u4e2d\u5fc3\uff0c\u53ef\u89c1 http://dubbo.apache.org/zh-cn/docs/user/references/registry/introduction.html \u6587\u6863\u3002\n  # Dubbo \u6d88\u8d39\u8005\u914d\u7f6e\n  consumer:\n    timeout: 50000 # \u3010\u91cd\u8981\u3011\u8fdc\u7a0b\u670d\u52a1\u8c03\u7528\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\uff1a\u6beb\u79d2\u3002\u9ed8\u8ba4\u4e3a 1000 \u6beb\u79d2\uff0c\u80d6\u53cb\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u4e1a\u52a1\u4fee\u6539\n    UserService:\n      version: 1.0.0\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/nacos%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E%E7%AE%80%E4%BB%8B/#_10","title":"\u6d4b\u8bd5","text":"<ul> <li>\u4f7f\u7528 ProviderApplication \u542f\u52a8\u670d\u52a1\u63d0\u4f9b\u8005\u3002\u5728 Nacos \u63a7\u53f0\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4ee5 provider \u4e3a\u5f00\u5934\u7684\u670d\u52a1\u6d88\u8d39\u8005\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</li> </ul> <p>\u670d\u52a1\u63d0\u4f9b\u8005\uff1aprovider</p> <p>\u670d\u52a1\u540d\u79f0\uff1atop.mikel.springboot.users.service.api.UserService (\u5305\u540d)</p> <p>\u7248\u672c\u53f7\uff1a1.0.0</p> <pre><code># \u67e5\u8be2\u6ce8\u518c\u7684\u670d\u52a1\ncurl -sX GET 'http://127.0.0.1:8848/nacos/v1/ns/instance/list?serviceName=providers:top.mikel.springboot.users.service.api.UserService:1.0.0:' | jq\n{\n  \"hosts\": [\n    {\n      \"ip\": \"10.11.1.70\",\n      \"port\": 20880,\n      \"valid\": true,\n      \"healthy\": true,\n      \"marked\": false,\n      \"instanceId\": \"10.11.1.70#20880#DEFAULT#DEFAULT_GROUP@@providers:top.mikel.springboot.users.service.api.UserService:1.0.0:\",\n      \"metadata\": {\n        \"side\": \"provider\",\n        \"methods\": \"get\",\n        \"release\": \"2.7.5\",\n        \"deprecated\": \"false\",\n        \"dubbo\": \"2.0.2\",\n        \"pid\": \"22139\",\n        \"interface\": \"top.mikel.springboot.users.service.api.UserService\",\n        \"version\": \"1.0.0\",\n        \"generic\": \"false\",\n        \"timeout\": \"50000\",\n        \"revision\": \"1.0.0\",\n        \"path\": \"top.mikel.springboot.users.service.api.UserService\",\n        \"protocol\": \"dubbo\",\n        \"application\": \"user-service-provider\",\n        \"dynamic\": \"true\",\n        \"category\": \"providers\",\n        \"anyhost\": \"true\",\n        \"timestamp\": \"1611904293326\"\n      },\n      \"enabled\": true,\n      \"weight\": 1,\n      \"clusterName\": \"DEFAULT\",\n      \"serviceName\": \"providers:top.mikel.springboot.users.service.api.UserService:1.0.0:\",\n      \"ephemeral\": true\n    }\n  ],\n  \"dom\": \"providers:top.mikel.springboot.users.service.api.UserService:1.0.0:\",\n  \"name\": \"DEFAULT_GROUP@@providers:top.mikel.springboot.users.service.api.UserService:1.0.0:\",\n  \"cacheMillis\": 3000,\n  \"lastRefTime\": 1611904380175,\n  \"checksum\": \"f1cecd4e4e713b97a0d5079a036971d3\",\n  \"useSpecifiedURL\": false,\n  \"clusters\": \"\",\n  \"env\": \"\",\n  \"metadata\": {}\n}\n</code></pre> <p></p> <p>\u53ef\u67e5\u770b\u670d\u52a1\u63d0\u4f9b\u8005\u8be6\u60c5\u4fe1\u606f\uff0c\u53ef\u7f16\u8f91\u548c\u4e0b\u7ebf\u64cd\u4f5c</p> <ul> <li>\u4f7f\u7528 ConsumerApplication \u542f\u52a8\u670d\u52a1\u6d88\u8d39\u8005\u3002\u5728 Nacos \u63a7\u53f0\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4ee5 <code>consumers</code> \u4e3a\u5f00\u5934\u7684\u670d\u52a1\u6d88\u8d39\u8005\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</li> </ul> <p></p> <p>\u670d\u52a1\u6d88\u8d39\u8005\uff1aconsumer</p> <p>\u670d\u52a1\u540d\u79f0\uff1atop.mikel.springboot.users.service.api.UserService</p> <p>\u7248\u672c\u53f7\uff1a1.0.0</p> <pre><code>curl -sX GET 'http://127.0.0.1:8848/nacos/v1/ns/instance/list?serviceName=consumers:top.mikel.springboot.users.service.api.UserService:1.0.0:' | {\n  \"hosts\": [\n    {\n      \"ip\": \"10.11.1.70\",\n      \"port\": 0,\n      \"valid\": true,\n      \"healthy\": true,\n      \"marked\": false,\n      \"instanceId\": \"10.11.1.70#0#DEFAULT#DEFAULT_GROUP@@consumers:top.mikel.springboot.users.service.api.UserService:1.0.0:\",\n      \"metadata\": {\n        \"init\": \"false\",\n        \"side\": \"consumer\",\n        \"methods\": \"get\",\n        \"release\": \"2.7.5\",\n        \"logger\": \"slf4j\",\n        \"dubbo\": \"2.0.2\",\n        \"pid\": \"24431\",\n        \"check\": \"false\",\n        \"interface\": \"top.mikel.springboot.users.service.api.UserService\",\n        \"version\": \"1.0.0\",\n        \"qos.enable\": \"false\",\n        \"timeout\": \"50000\",\n        \"revision\": \"1.0.0\",\n        \"path\": \"top.mikel.springboot.users.service.api.UserService\",\n        \"protocol\": \"consumer\",\n        \"application\": \"user-service-consumer\",\n        \"sticky\": \"false\",\n        \"category\": \"consumers\",\n        \"timestamp\": \"1611909492701\"\n      },\n      \"enabled\": true,\n      \"weight\": 1,\n      \"clusterName\": \"DEFAULT\",\n      \"serviceName\": \"consumers:top.mikel.springboot.users.service.api.UserService:1.0.0:\",\n      \"ephemeral\": true\n    }\n  ],\n  \"dom\": \"consumers:top.mikel.springboot.users.service.api.UserService:1.0.0:\",\n  \"name\": \"DEFAULT_GROUP@@consumers:top.mikel.springboot.users.service.api.UserService:1.0.0:\",\n  \"cacheMillis\": 3000,\n  \"lastRefTime\": 1611909945384,\n  \"checksum\": \"014c1cf9537cf92ce5ca74881024c6a4\",\n  \"useSpecifiedURL\": false,\n  \"clusters\": \"\",\n  \"env\": \"\",\n  \"metadata\": {}\n}\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/","title":"\u5ef6\u8fdf\u961f\u5217\u89e3\u51b3\u65b9\u6848","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/#_1","title":"\u5ef6\u8fdf\u961f\u5217\u5b9e\u73b0\u65b9\u5f0f\u603b\u7ed3","text":"<ol> <li>\u5982\u57fa\u4e8eRabbitMQ\u7684\u961f\u5217ttl+\u6b7b\u4fe1\u8def\u7531\u7b56\u7565\uff1a\u901a\u8fc7\u8bbe\u7f6e\u4e00\u4e2a\u961f\u5217\u7684\u8d85\u65f6\u672a\u6d88\u8d39\u65f6\u95f4\uff0c\u914d\u5408\u6b7b\u4fe1\u8def\u7531\u7b56\u7565\uff0c\u5230\u8fbe\u65f6\u95f4\u672a\u6d88\u8d39\u540e\uff0c\u56de\u4f1a\u5c06\u6b64\u6d88\u606f\u8def\u7531\u5230\u6307\u5b9a\u961f\u5217</li> <li>\u57fa\u4e8eRabbitMQ\u5ef6\u8fdf\u961f\u5217\u63d2\u4ef6\uff08rabbitmq-delayed-message-exchange\uff09\uff1a\u53d1\u9001\u6d88\u606f\u65f6\u901a\u8fc7\u5728\u8bf7\u6c42\u5934\u6dfb\u52a0\u5ef6\u65f6\u53c2\u6570\uff08headers.put(\"x-delay\", 5000)\uff09\u5373\u53ef\u8fbe\u5230\u5ef6\u8fdf\u961f\u5217\u7684\u6548\u679c</li> <li>\u4f7f\u7528redis\u7684zset\u6709\u5e8f\u6027\uff0c\u8f6e\u8be2zset\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\uff0c\u5230\u70b9\u540e\u5c06\u5185\u5bb9\u8fc1\u79fb\u81f3\u5f85\u6d88\u8d39\u7684\u961f\u5217\uff0credisson\u5df2\u6709\u5b9e\u73b0</li> <li>\u4f7f\u7528redis\u7684key\u7684\u8fc7\u671f\u901a\u77e5\u7b56\u7565\uff0c\u8bbe\u7f6e\u4e00\u4e2akey\u7684\u8fc7\u671f\u65f6\u95f4\u4e3a\u5ef6\u8fdf\u65f6\u95f4\uff0c\u8fc7\u671f\u540e\u901a\u77e5\u5ba2\u6237\u7aef</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/#redis","title":"Redis\u5b9e\u73b0\u5ef6\u8fdf\u961f\u5217","text":"<ol> <li>\u5931\u6548\u76d1\u542c</li> <li>redisson\u5b9e\u73b0\u53d1\u5e03\u8ba2\u9605\u5ef6\u8fdf</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/#redis_1","title":"redis\u5931\u6548\u76d1\u542c\u4e8b\u4ef6","text":"<p>\u96c6\u6210KeyExpirationEventMessageListener\u7c7b\u5b9e\u73b0redis\u5931\u6548\u76d1\u542c\u4e8b\u4ef6</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/#_2","title":"\u6b64\u79cd\u5b9e\u73b0\u9762\u4e34\u7684\u95ee\u9898","text":"<ol> <li>redis\u7684\u5931\u6548\u76d1\u542c\u4e8b\u4ef6\u4f1a\u5b58\u5728\u4e00\u5b9a\u7684\u65f6\u95f4\u5dee\uff0c\u5e76\u4e14\u5f53\u6570\u636e\u91cf\u8d8a\u5927\u65f6\uff0c\u8bef\u5dee\u4f1a\u8d8a\u5927\u3002</li> <li>redis\u7684\u5931\u6548\u76d1\u542c\u4e8b\u4ef6\u4f1a\u5c06\u6240\u6709key\u5931\u6548\u90fd\u4f1a\u901a\u77e5\u5230onMessage,\u5982\u679c\u9488\u5bf9\u4e00\u4e2akey\uff0c\u5206\u5e03\u5f0f\u4e1a\u52a1\u7684\u573a\u666f\u4e0b\uff0c\u4f1a\u51fa\u73b0\u91cd\u590d\u6d88\u8d39\u7684\u95ee\u9898\u3002\uff08\u53ef\u4ee5\u589e\u52a0\u5206\u5e03\u5f0f\u9501\u7684\u5b9e\u73b0\uff0c\u4f46\u662fredisson\u5206\u5e03\u5f0f\u9501\u63d0\u4f9b\u4e86\u53e6\u4e00\u79cd\u5ef6\u8fdf\u961f\u5217\u7684\u5b9e\u73b0\u65b9\u5f0f\uff09</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/#_3","title":"\u5f00\u53d1\u51c6\u5907","text":"<p>redis\u9700\u8981\u5728\u670d\u52a1\u7aef\u5f00\u542f\u914d\u7f6e\uff0c\u6253\u5f00redis\u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6   \u6dfb\u52a0<code>notify-keyspace-events Ex</code> - \u76f8\u5173\u53c2\u6570\u5982\u4e0b\uff1a <pre><code>K\uff1akeyspace\u4e8b\u4ef6\uff0c\u4e8b\u4ef6\u4ee5__keyspace@&lt;db&gt;__\u4e3a\u524d\u7f00\u8fdb\u884c\u53d1\u5e03\uff1b        \nE\uff1akeyevent\u4e8b\u4ef6\uff0c\u4e8b\u4ef6\u4ee5__keyevent@&lt;db&gt;__\u4e3a\u524d\u7f00\u8fdb\u884c\u53d1\u5e03\uff1b        \ng\uff1a\u4e00\u822c\u6027\u7684\uff0c\u975e\u7279\u5b9a\u7c7b\u578b\u7684\u547d\u4ee4\uff0c\u6bd4\u5982del\uff0cexpire\uff0crename\u7b49\uff1b       \n$\uff1a\u5b57\u7b26\u4e32\u7279\u5b9a\u547d\u4ee4\uff1b        \nl\uff1a\u5217\u8868\u7279\u5b9a\u547d\u4ee4\uff1b        \ns\uff1a\u96c6\u5408\u7279\u5b9a\u547d\u4ee4\uff1b        \nh\uff1a\u54c8\u5e0c\u7279\u5b9a\u547d\u4ee4\uff1b        \nz\uff1a\u6709\u5e8f\u96c6\u5408\u7279\u5b9a\u547d\u4ee4\uff1b        \nx\uff1a\u8fc7\u671f\u4e8b\u4ef6\uff0c\u5f53\u67d0\u4e2a\u952e\u8fc7\u671f\u5e76\u5220\u9664\u65f6\u4f1a\u4ea7\u751f\u8be5\u4e8b\u4ef6\uff1b        \ne\uff1a\u9a71\u9010\u4e8b\u4ef6\uff0c\u5f53\u67d0\u4e2a\u952e\u56e0maxmemore\u7b56\u7565\u800c\u88ab\u5220\u9664\u65f6\uff0c\u4ea7\u751f\u8be5\u4e8b\u4ef6\uff1b        \nA\uff1ag$lshzxe\u7684\u522b\u540d\uff0c\u56e0\u6b64\u201dAKE\u201d\u610f\u5473\u7740\u6240\u6709\u4e8b\u4ef6\u3002\n</code></pre></p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/#_4","title":"\u57fa\u7840\u5b9e\u73b0","text":"<ol> <li>\u52a0\u5165\u4f9d\u8d56 <pre><code>&lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre></li> <li>\u53ef\u6b63\u5e38\u8fde\u63a5\u5b58\u53d6redis\u6570\u636e\u4e4b\u540e\uff0c\u521b\u5efa\u76d1\u542c\u7c7b<code>RedisKeyExpirationListener</code>\u7ee7\u627f<code>KeyExpirationEventMessageListener</code>\uff0c\u91cd\u5199<code>onMessage</code>\u65b9\u6cd5\u3002\uff08key\u5931\u6548\u4e4b\u540e\uff0c\u4f1a\u53d1\u51faonMessage\u65b9\u6cd5\uff0c\u4e4b\u5462\u4e2a\u83b7\u53d6\u5931\u6548\u7684key\u503c\uff0c\u4e0d\u80fd\u83b7\u53d6key\u5bf9\u5e94\u7684value\u503c\uff09\u3002</li> </ol> <p><pre><code>import com.dadi01.scrm.service.member.api.common.MemberStatusEnum;\nimport com.dadi01.scrm.service.member.provider.service.base.IBaseMemberService;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.data.redis.connection.Message;\nimport org.springframework.data.redis.listener.KeyExpirationEventMessageListener;\nimport org.springframework.data.redis.listener.RedisMessageListenerContainer;\nimport org.springframework.stereotype.Component;\n\n/**\n * @author lviter\n */\n@Component\n@Slf4j\npublic class RedisKeyExpirationListener extends KeyExpirationEventMessageListener {\n    private final IBaseMemberService baseMemberService;\n\n\n    private final static String MEMBER_LOCK_ACCOUNT_SUFFIX = \".lock_account\";\n    private final static String MEMBER_LOCK_ACCOUNT_DOMAIN_SUFFIX = \"T\";\n    private final static String MEMBER_LOCK_ACCOUNT_MEMBER_SUFFIX = \"M\";\n    private final static String MEMBER_REDISSON_LOCK = \".member_lock_redisson\";\n    private final static int WAIT_TIME = 5;\n    private final static int LEASE_TIME = 10;\n\n    public RedisKeyExpirationListener(RedisMessageListenerContainer redisMessageListenerContainer, IBaseMemberService baseMemberService) {\n        super(redisMessageListenerContainer);\n        this.baseMemberService = baseMemberService;\n    }\n\n    @Override\n    public void onMessage(Message message, byte[] pattern) {\n        //\u83b7\u53d6\u5931\u6548\u7684key\n        String expiredKey = message.toString();\n        log.info(\"================================get on message:{}====================\", expiredKey);\n        if (expiredKey.endsWith(MEMBER_LOCK_ACCOUNT_SUFFIX)) {\n            log.info(\"================================on message:{}====================\", expiredKey);\n            try {\n                log.info(\"=======\u5f85\u89e3\u9501\u8d26\u53f7\u89e3\u9501======expiredKey:{}\", expiredKey);\n                String tenantId = expiredKey.substring(expiredKey.indexOf(MEMBER_LOCK_ACCOUNT_DOMAIN_SUFFIX) + 1, expiredKey.indexOf(MEMBER_LOCK_ACCOUNT_MEMBER_SUFFIX));\n                String memberId = expiredKey.substring(expiredKey.indexOf(MEMBER_LOCK_ACCOUNT_MEMBER_SUFFIX) + 1, expiredKey.indexOf(MEMBER_LOCK_ACCOUNT_SUFFIX));\n                baseMemberService.updateAccount(Integer.parseInt(tenantId), Long.parseLong(memberId), MemberStatusEnum.NORMAL.getCode(), null);\n            } catch (Exception exception) {\n                log.info(\"auto unlock fail,expired key:{},exception:{}\", expiredKey, exception.getMessage());\n            }\n        }\n    }\n}\n</code></pre> 3. \u521b\u5efa\u4e00\u4e2a\u914d\u7f6e\u7c7b<code>RedisConfig</code></p> <pre><code>/**\n * @author lviter\n */\n@Configuration\npublic class RedisConfig {\n\n    @Value(\"${redis.dbIndex}\")\n    private Integer dbIndex;\n\n    private final String TOPIC = \"__keyevent@\" + dbIndex + \"__:expired\";\n    private final RedisConnectionFactory redisConnectionFactory;\n\n    public RedisConfig(RedisConnectionFactory redisConnectionFactory) {\n        this.redisConnectionFactory = redisConnectionFactory;\n    }\n\n\n    @Bean\n    public RedisMessageListenerContainer redisMessageListenerContainer() {\n        RedisMessageListenerContainer redisMessageListenerContainer = new RedisMessageListenerContainer();\n        redisMessageListenerContainer.setConnectionFactory(redisConnectionFactory);\n        //keyevent\u4e8b\u4ef6\uff0c\u4e8b\u4ef6\u4ee5__keyevent@&lt;db&gt;__\u4e3a\u524d\u7f00\u8fdb\u884c\u53d1\u5e03\n        //db\u4e3aredis\u7b2c\u51e0\u4e2a\u5e93 db2...\n//        redisMessageListenerContainer.addMessageListener(redisKeyExpirationListener, new PatternTopic(TOPIC));\n        return redisMessageListenerContainer;\n    }\n}\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/#redisson","title":"\u4f7f\u7528redisson\u5b9e\u73b0\u5ef6\u8fdf\u961f\u5217","text":"<p>\u7531\u4e8e\u5ef6\u65f6\u961f\u5217\u6301\u4e45\u5316\u5728redis\u4e2d\uff0c\u6240\u4ee5\u673a\u5668\u5b95\u673a\u6570\u636e\u4e0d\u4f1a\u5f02\u5e38\u4e22\u5931\uff0c\u673a\u5668\u91cd\u542f\u540e\uff0c\u4f1a\u6b63\u5e38\u6d88\u8d39\u961f\u5217\u4e2d\u79ef\u7d2f\u7684\u4efb\u52a1</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/#redisson_1","title":"redisson\u5b9e\u73b0\u5ef6\u8fdf\u961f\u5217\u7684\u539f\u7406","text":"<p>\u4f7f\u7528redis\u7684zset\u6709\u5e8f\u6027\uff0c\u8f6e\u8be2zset\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\uff0c\u5230\u70b9\u540e\u5c06\u5185\u5bb9\u8fc1\u79fb\u81f3\u5f85\u6d88\u8d39\u7684\u961f\u5217</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/#_5","title":"\u5ef6\u8fdf\u961f\u5217\u914d\u7f6e","text":"<pre><code>package com.dadi01.scrm.service.member.provider.config.redisson.delay;\n\nimport org.redisson.api.RBlockingQueue;\nimport org.redisson.api.RDelayedQueue;\nimport org.redisson.api.RedissonClient;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n/**\n * @author lviter\n * redisson\u5ef6\u8fdf\u961f\u5217\n */\n@Configuration\npublic class RedissonQueueConfig {\n\n    private final String queueName = \"queue\";\n\n    @Bean\n    public RBlockingQueue&lt;String&gt; rBlockingQueue(@Qualifier(\"redissonSingle\") RedissonClient redissonClient) {\n        return redissonClient.getBlockingQueue(queueName);\n    }\n\n    @Bean(name = \"rDelayedQueue\")\n    public RDelayedQueue&lt;String&gt; rDelayedQueue(@Qualifier(\"redissonSingle\") RedissonClient redissonClient,\n                                               @Qualifier(\"rBlockingQueue\") RBlockingQueue&lt;String&gt; blockQueue) {\n        return redissonClient.getDelayedQueue(blockQueue);\n    }\n}\n</code></pre> <ul> <li>\u5b9a\u4e49\u961f\u5217\u4f7f\u7528\u63a5\u53e3</li> </ul> <pre><code>package com.dadi01.scrm.service.member.provider.config.redisson.delay;\n\nimport java.util.concurrent.TimeUnit;\n\n/**\n * @author lviter\n */\npublic interface DelayQueue {\n\n    /**\n     * \u53d1\u5e03\n     *\n     * @param object\n     * @return\n     */\n    Boolean offer(Object object);\n\n    /**\n     * \u5e26\u5ef6\u8fdf\u529f\u80fd\u7684\u961f\u5217\n     *\n     * @param object\n     * @param time\n     * @param timeUnit\n     */\n    void offer(Object object, Long time, TimeUnit timeUnit);\n\n    void offerAsync(Object object, Long time, TimeUnit timeUnit);\n\n    Boolean offerAsync(Object object);\n}\n</code></pre> <ul> <li>\u5ef6\u8fdf\u961f\u5217\u5b9e\u73b0</li> </ul> <pre><code>package com.dadi01.scrm.service.member.provider.config.redisson.delay;\n\nimport org.redisson.api.RDelayedQueue;\nimport org.redisson.api.RFuture;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.Resource;\nimport java.util.concurrent.ExecutionException;\nimport java.util.concurrent.TimeUnit;\n\n/**\n * @author lviter\n */\n@Component\npublic class RedissonDelayQueue implements DelayQueue {\n\n    private static Logger log = LoggerFactory.getLogger(RedissonDelayQueue.class);\n\n    @Resource(name = \"rDelayedQueue\")\n    private RDelayedQueue&lt;Object&gt; rDelayedQueue;\n\n\n    @Override\n    public Boolean offer(Object object) {\n        return rDelayedQueue.offer(object);\n    }\n\n    @Override\n    public void offer(Object object, Long time, TimeUnit timeUnit) {\n        rDelayedQueue.offer(object, time, timeUnit);\n    }\n\n    @Override\n    public void offerAsync(Object object, Long time, TimeUnit timeUnit) {\n        rDelayedQueue.offerAsync(object, time, timeUnit);\n    }\n\n    @Override\n    public Boolean offerAsync(Object object) {\n        boolean flag = false;\n        RFuture&lt;Boolean&gt; rFuture = rDelayedQueue.offerAsync(object);\n        try {\n            flag = rFuture.get();\n        } catch (InterruptedException | ExecutionException e) {\n            log.info(\"offerAsync exception:{}\", e.getMessage());\n            e.printStackTrace();\n        }\n        return flag;\n    }\n}\n</code></pre> <ul> <li>\u542f\u52a8\u4e00\u4e2a\u540e\u53f0\u76d1\u63a7\u7ebf\u7a0b</li> </ul> <pre><code>package com.dadi01.scrm.service.member.provider.config.redisson.delay;\n\nimport org.redisson.api.RBlockingQueue;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.PostConstruct;\nimport javax.annotation.Resource;\n\n/**\n * @author lviter\n */\n@Component\npublic class RedissonTask {\n    @Resource(name = \"rBlockingQueue\")\n    private RBlockingQueue&lt;Object&gt; rBlockingQueue;\n\n    @PostConstruct\n    public void take() {\n        new Thread(() -&gt; {\n            while (true) {\n                try {\n                    System.out.println(\"=========================\" + rBlockingQueue.take());\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }).start();\n    }\n}\n</code></pre> <ul> <li>\u4f7f\u7528\u5ef6\u8fdf\u961f\u5217\u53d1\u9001</li> </ul> <pre><code>package com.dadi01.scrm.service.member.provider.impl;\n\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.mybatis.spring.annotation.MapperScan;\nimport org.redisson.api.RDelayedQueue;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.test.context.ActiveProfiles;\nimport org.springframework.test.context.junit4.SpringRunner;\n\nimport javax.annotation.Resource;\nimport java.util.concurrent.TimeUnit;\n\n@RunWith(SpringRunner.class)\n@SpringBootTest\n@ActiveProfiles(value = \"llh\")\n@MapperScan(\"com.dadi01.scrm.service.member.provider.mapper\")\npublic class RDelayQueueTests {\n\n    @Resource(name = \"rDelayedQueue\")\n    private RDelayedQueue&lt;Object&gt; rDelayedQueue;\n\n    @Test\n    public void offerAsync() {\n\n        rDelayedQueue.offerAsync(\"llh send message\", 20, TimeUnit.SECONDS);\n    }\n}\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E7%8A%B6%E6%80%81%E6%9C%BA%E5%9B%BE/","title":"\u72b6\u6001\u673a\u56fe","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/Transaction-rollback-only/","title":"Transaction rollback only","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/Transaction-rollback-only/#transaction-rolled-back","title":"Transaction rolled back","text":"<ul> <li>\u5f02\u5e38\u62a5\u9519\uff1aTransaction rolled back because it has been marked as rollback-only</li> </ul> <pre><code>@Transactional\npublic class ServiceA {\n    @Autowired\n    private ServiceB serviceB;\n\n    public void methodA() {\n        try {\n            serviceB.methodB();\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n\n@Transactional\npublic class serviceB {\n    public void methodB() {\n        throw new RuntimeException();\n    }\n}\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/Transaction-rollback-only/#_1","title":"\u539f\u56e0","text":"<p>@Transactional(propagation= Propagation.REQUIRED) \uff1a\u5982\u679c\u5f53\u524d\u5b58\u5728\u4e8b\u52a1\uff0c\u5219\u52a0\u5165\u8be5\u4e8b\u52a1\uff1b\u5982\u679c\u5f53\u524d\u6ca1\u6709\u4e8b\u52a1\uff0c\u5219\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4e8b\u52a1\u3002\u8fd9\u662f@Transactional\u7684\u9ed8\u8ba4\u65b9\u5f0f\u3002\u88f8\u7684@Transactional\u6ce8\u89e3\u5c31\u662f\u8fd9\u79cd\u65b9\u5f0f\u3002 \u5916\u5c42\u4e8b\u52a1\uff08ServiceA\uff09\u548c\u5185\u5c42\u4e8b\u52a1\uff08ServiceB\uff09\u5c31\u662f\u4e00\u4e2a\u4e8b\u52a1\uff0c\u4efb\u4f55\u4e00\u4e2a\u51fa\u73b0\u5f02\u5e38\uff0c\u90fd\u4f1a\u5728methodA\u6267\u884c\u5b8c\u6bd5\u540e\u56de\u6eda\u3002\u5982\u679c\u5185\u5c42\u4e8b\u52a1B\u629b\u51fa\u5f02\u5e38e\uff08\u6ca1\u6709catch\uff0c\u7ee7\u7eed\u5411\u5916\u5c42\u629b\u51fa\uff09\uff0c\u5728\u5185\u5c42\u4e8b\u52a1\u7ed3\u675f\u65f6\uff0cspring\u4f1a\u628a\u4e8b\u52a1B\u6807\u8bb0\u4e3a\u201crollback-only\u201d\uff1b\u8fd9\u65f6\u5916\u5c42\u4e8b\u52a1A\u53d1\u73b0\u4e86\u5f02\u5e38e\uff0c\u5982\u679c\u5916\u5c42\u4e8b\u52a1A catch\u4e86\u5f02\u5e38\u5e76\u5904\u7406\u6389\uff0c\u90a3\u4e48\u5916\u5c42\u4e8b\u52a1A\u7684\u65b9\u6cd5\u4f1a\u7ee7\u7eed\u6267\u884c\u4ee3\u7801\uff0c\u76f4\u5230\u5916\u5c42\u4e8b\u52a1\u4e5f\u7ed3\u675f\u65f6\uff0c\u8fd9\u65f6\u5916\u5c42\u4e8b\u52a1A\u60f3commit\uff0c\u56e0\u4e3a\u6b63\u5e38\u7ed3\u675f\u6ca1\u6709\u5411\u5916\u629b\u5f02\u5e38\uff0c\u4f46\u662f\u5185\u5916\u5c42\u4e8b\u52a1AB\u662f\u540c\u4e00\u4e2a\u4e8b\u52a1\uff0c\u4e8b\u52a1B\uff08\u540c\u65f6\u4e5f\u662f\u4e8b\u52a1A\uff09\u5df2\u7ecf\u88ab\u5185\u5c42\u65b9\u6cd5\u6807\u8bb0\u4e3a\u201crollback-only\u201d\uff0c\u9700\u8981\u56de\u6eda\uff0c\u65e0\u6cd5commit\uff0c\u8fd9\u65f6spring\u5c31\u4f1a\u629b\u51faorg.springframework.transaction.UnexpectedRollbackException: Transaction rolled back because it has been marked as rollback-only\uff0c\u610f\u601d\u662f\u201c\u4e8b\u52a1\u5df2\u7ecf\u88ab\u6807\u8bb0\u4e3a\u56de\u6eda\uff0c\u65e0\u6cd5\u63d0\u4ea4\u201d</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/Transaction-rollback-only/#_2","title":"\u89e3\u51b3\u65b9\u6cd5","text":"<ol> <li>\u5982\u679c\u5e0c\u671b\u5185\u5c42\u4e8b\u52a1\u56de\u6eda\uff0c\u4f46\u4e0d\u5f71\u54cd\u5916\u5c42\u4e8b\u52a1\u63d0\u4ea4\uff0c\u9700\u8981\u5c06\u5185\u5c42\u4e8b\u52a1\u7684\u4f20\u64ad\u65b9\u5f0f\u6307\u5b9a\u4e3a@Transactional(propagation= Propagation.NESTED)    \uff0c\u5916\u5c42\u4e8b\u52a1\u7684\u63d0\u4ea4\u548c\u56de\u6eda\u80fd\u591f\u63a7\u5236\u5d4c\u5957\u7684\u5185\u5c42\u4e8b\u52a1\u56de\u6eda\uff1b\u800c\u5185\u5c42\u4e8b\u52a1\u62a5\u9519\u65f6\uff0c\u53ea\u56de\u6eda\u5185\u5c42\u4e8b\u52a1\uff0c\u5916\u5c42\u4e8b\u52a1\u53ef\u4ee5\u7ee7\u7eed\u63d0\u4ea4\u3002\uff08JPA\u4e0d\u652f\u6301NESTED\uff0c\u6709\u65f6\u53ef\u4ee5\u7528REQUIRES_NEW\u66ff\u4ee3\u4e00\u4e0b\uff09</li> <li>\u5982\u679c\u8fd9\u4e2a\u5f02\u5e38\u53d1\u751f\u65f6\uff0c\u5185\u5c42\u9700\u8981\u4e8b\u52a1\u56de\u6eda\u7684\u4ee3\u7801\u8fd8\u6ca1\u6709\u6267\u884c\uff0c\u5219\u53ef\u4ee5@Transactional(noRollbackFor = {\u5185\u5c42\u629b\u51fa\u7684\u5f02\u5e38}.class)\uff0c\u6307\u5b9a\u5185\u5c42\u4e5f\u4e0d\u4e3a\u8fd9\u4e2a\u5f02\u5e38\u56de\u6eda</li> <li>\u56de\u6eda\u6574\u4e2a\u65b9\u6cd5 TransactionAspectSupport.currentTransactionStatus().setRollbackOnly();</li> </ol> <p>\u5982\u679c\u9047\u6b64\u95ee\u9898\uff0c\u8bf4\u660e\u662fspring\u4e8b\u52a1\u539f\u7406\u4e0d\u6e05\u6670\uff0c\u5efa\u8bae\u79fb\u6b65\u81f3 Spring\u4e8b\u52a1</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/MYSQL%E7%83%AD%E8%A1%A8%E5%8A%A0%E5%AD%97%E6%AE%B5/","title":"MYSQL\u70ed\u8868\u52a0\u5b57\u6bb5","text":"<p>\u573a\u666f\uff1a\u751f\u4ea7mysql\u4e00\u5f20\u5343\u4e07\u6570\u636e\u70ed\u8868\uff0c\u65b0\u52a0\u5b57\u6bb5\u52a0\u4e0d\u4e0a\uff0c\u662f\u4ec0\u4e48\u539f\u56e0\uff0c\u4ee5\u53ca\u6709\u4ec0\u4e48\u89e3\u51b3\u65b9\u6848</p> <p>\u5206\u6790\uff1a\u8fd9\u79cd\u60c5\u51b5\u7684\u6838\u5fc3\u77db\u76fe\u5728\u4e8e\uff1aDDL\uff08\u6570\u636e\u5b9a\u4e49\u8bed\u8a00\uff09\u64cd\u4f5c\u9700\u8981\u9501\u8868\uff0c\u800c\u9ad8\u5e76\u53d1\u7684\u70ed\u8868\u7531\u4e8e\u957f\u4e8b\u52a1\u6216\u5927\u91cf\u67e5\u8be2\uff0c\u5bfc\u81f4\u9501\u7b49\u5f85\u8d85\u65f6\u6216\u76f4\u63a5\u9020\u6210\u6570\u636e\u5e93\u762b\u75ea\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/MYSQL%E7%83%AD%E8%A1%A8%E5%8A%A0%E5%AD%97%E6%AE%B5/#_1","title":"\u6838\u5fc3\u539f\u56e0\u6392\u67e5","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/MYSQL%E7%83%AD%E8%A1%A8%E5%8A%A0%E5%AD%97%E6%AE%B5/#1-mdl","title":"1. MDL\uff08\u5143\u6570\u636e\u9501\uff09\u51b2\u7a81","text":"<p>\u8fd9\u662f\u6700\u5e38\u89c1\u7684\u539f\u56e0\u3002MySQL \u5728\u5bf9\u8868\u8fdb\u884c DDL \u64cd\u4f5c\u65f6\uff0c\u9700\u8981\u83b7\u53d6 MDL \u5199\u9501\u3002</p> <ul> <li>\u73b0\u8c61\uff1a \u5982\u679c\u6b64\u65f6\u8868\u4e0a\u6709\u672a\u63d0\u4ea4\u7684\u957f\u4e8b\u52a1\uff0c\u6216\u8005\u6709\u5927\u91cf\u7684\u67e5\u8be2\u6b63\u5728\u8fd0\u884c\uff0cDDL \u5c31\u4f1a\u88ab\u963b\u585e\uff08Waiting for table metadata lock\uff09\u3002</li> <li>\u8fde\u9501\u53cd\u5e94\uff1a \u66f4\u6709\u8da3\uff08\u4e5f\u66f4\u5371\u9669\uff09\u7684\u662f\uff0cDDL \u7533\u8bf7\u5199\u9501\u4f1a\u6392\u5728\u961f\u5217\u91cc\uff0c\u5b83\u4f1a\u963b\u585e\u540e\u7eed\u6240\u6709\u5bf9\u8be5\u8868\u7684\u8bfb\u5199\u8bf7\u6c42\uff0c\u5bfc\u81f4\u6574\u4e2a\u4e1a\u52a1\u7ebf\u77ac\u95f4\u201c\u5361\u6b7b\u201d\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/MYSQL%E7%83%AD%E8%A1%A8%E5%8A%A0%E5%AD%97%E6%AE%B5/#2-lock-wait-timeout","title":"2. \u9501\u8d85\u65f6 (Lock Wait Timeout)","text":"<p>\u5982\u679c\u4f60\u7684 <code>innodb_lock_wait_timeout</code> \u8bbe\u7f6e\u5f97\u8f83\u77ed\uff0c\u800c DDL \u4e00\u76f4\u62ff\u4e0d\u5230\u9501\uff0c\u64cd\u4f5c\u5c31\u4f1a\u76f4\u63a5\u62a5\u9519\u5931\u8d25\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/MYSQL%E7%83%AD%E8%A1%A8%E5%8A%A0%E5%AD%97%E6%AE%B5/#3-copy-table-io","title":"3. Copy Table \u673a\u5236\u5bfc\u81f4\u7684 I/O \u74f6\u9888","text":"<p>\u867d\u7136 MySQL 5.6 \u4ee5\u540e\u5f15\u5165\u4e86 Online DDL\uff0c\u4f46\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff08\u5982\u4fee\u6539\u5b57\u6bb5\u7c7b\u578b\u3001\u5168\u8868\u91cd\u5efa\uff09\uff0cMySQL \u4f9d\u7136\u4f1a\u91c7\u7528 <code>COPY</code> \u7b97\u6cd5\u3002</p> <ul> <li>\u73b0\u8c61\uff1a \u7cfb\u7edf\u4f1a\u521b\u5efa\u4e00\u4e2a\u4e34\u65f6\u8868\uff0c\u628a\u5343\u4e07\u884c\u6570\u636e\u4e00\u884c\u884c\u62f7\u8fc7\u53bb\u3002\u5728\u70ed\u8868\u4e0a\uff0c\u8fd9\u4f1a\u6d88\u8017\u6781\u9ad8\u7684 CPU \u548c I/O\uff0c\u53ef\u80fd\u5bfc\u81f4\u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3\u6216\u4e3b\u4ece\u5ef6\u8fdf\u7206\u70b8\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/MYSQL%E7%83%AD%E8%A1%A8%E5%8A%A0%E5%AD%97%E6%AE%B5/#performance_schema","title":"\u67e5\u8be2\u5206\u6790\uff1a\u5f00\u542f <code>performance_schema</code> \u7684\u76f8\u5173\u76d1\u63a7\u9879","text":"<ol> <li>\u67e5\u8be2\u5f53\u524d\u7684\u9501\u963b\u585e\u5173\u7cfb\uff1aMySql5.7\u4e4b\u540e\uff0c\u8be6\u7ec6\u7684\u5143\u6570\u636e\u9501\u76d1\u63a7</li> </ol> <pre><code>SELECT\n    waiting_thread_id AS waiting_tid,\n    waiting_pid AS waiting_query_id,\n    waiting_query AS waiting_sql,\n    blocking_thread_id AS blocking_tid,\n    blocking_pid AS blocking_query_id,\n    blocking_query AS blocking_sql\nFROM sys.schema_table_lock_waits\nWHERE waiting_query LIKE '%ALTER TABLE%'; -- \u66ff\u6362\u6210\u4f60\u7684\u8868\u540d\u6216\u64cd\u4f5c\n</code></pre> <ol> <li>\u67e5\u770b\u6d3b\u8dc3\u7ebf\u7a0b\u72b6\u6001\uff08\u6700\u5e38\u7528\uff09:\u5982\u679c\u5728\u52a0\u5b57\u6bb5\u65f6\u53d1\u73b0\u5361\u4f4f\u4e86\uff0c\u76f4\u63a5\u8fd0\u884c\u8fd9\u4e2a\u547d\u4ee4\u3002\u91cd\u70b9\u5173\u6ce8 <code>State</code> \u5217\u4e3a <code>Waiting for table metadata lock</code> \u7684\u8bb0\u5f55\u3002</li> </ol> <pre><code>SELECT \n    ID, USER, HOST, DB, COMMAND, TIME, STATE, INFO \nFROM information_schema.processlist \nWHERE STATE = 'Waiting for table metadata lock' \n   OR INFO LIKE '%ALTER TABLE%';\n</code></pre> <p>\u5982\u4f55\u5904\u7406\uff1a \u627e\u5230\u90a3\u4e2a <code>Time</code> \u5f88\u5927\uff08\u8fd0\u884c\u5f88\u4e45\uff09\u4e14\u72b6\u6001\u4e3a <code>Sleep</code> \u6216\u6267\u884c\u67e5\u8be2\u7684 <code>ID</code>\uff0c\u7136\u540e\u6839\u636e\u4e1a\u52a1\u60c5\u51b5\u8003\u8651\u662f\u5426\u4f7f\u7528 <code>KILL [ID];</code> \u91ca\u653e\u9501\u3002</p> <ol> <li>\u7cbe\u51c6\u67e5\u627e\u6301\u6709\u9501\u7684 Session (\u5e95\u5c42\u6392\u67e5)\uff1a</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/MYSQL%E7%83%AD%E8%A1%A8%E5%8A%A0%E5%AD%97%E6%AE%B5/#_2","title":"\u89e3\u51b3\u65b9\u6848","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/MYSQL%E7%83%AD%E8%A1%A8%E5%8A%A0%E5%AD%97%E6%AE%B5/#_3","title":"\u65b9\u6848\u4e00\uff1a\u4f7f\u7528\u4e13\u4e1a\u5de5\u5177 (\u63a8\u8350)","text":"<p>\u5bf9\u4e8e\u751f\u4ea7\u73af\u5883\u7684\u70ed\u8868\uff0c\u76f4\u63a5\u6267\u884c <code>ALTER TABLE</code> \u662f\u6781\u5177\u98ce\u9669\u7684\u3002\u63a8\u8350\u4f7f\u7528\u201c\u5f71\u5b50\u8868\u201d\u65b9\u6848\uff1a</p> <ul> <li>gh-ost (GitHub \u5f00\u6e90): * \u539f\u7406\uff1a \u901a\u8fc7\u6a21\u62df\u4ece\u5e93\u89e3\u6790 Binlog\uff0c\u5c06\u589e\u91cf\u6570\u636e\u540c\u6b65\u5230\u65b0\u8868\uff0c\u4e0d\u9700\u8981\u89e6\u53d1\u5668\uff0c\u5bf9\u6027\u80fd\u5f71\u54cd\u6700\u5c0f\uff0c\u652f\u6301\u968f\u65f6\u6682\u505c\u3002</li> <li>\u4f18\u70b9\uff1a \u6781\u5176\u5b89\u5168\uff0c\u4e0d\u4f1a\u4ea7\u751f MDL \u9501\u6b7b\u3002</li> <li>pt-online-schema-change (Percona Toolkit):</li> <li>\u539f\u7406\uff1a \u521b\u5efa\u89e6\u53d1\u5668\uff0c\u5728\u539f\u8868\u8fdb\u884c\u589e\u5220\u6539\u65f6\u540c\u6b65\u5230\u65b0\u8868\u3002</li> <li>\u4f18\u70b9\uff1a \u7ecf\u5178\u7a33\u5b9a\uff0c\u4f46\u89e6\u53d1\u5668\u5728\u6781\u9ad8\u5e76\u53d1\u4e0b\u4f1a\u6709\u4e00\u5b9a\u7684\u6027\u80fd\u635f\u8017\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/MYSQL%E7%83%AD%E8%A1%A8%E5%8A%A0%E5%AD%97%E6%AE%B5/#online-ddl","title":"\u65b9\u6848\u4e8c\uff1a\u4f18\u5316 Online DDL \u6267\u884c\u7b56\u7565","text":"<p>\u5982\u679c\u4f60\u4e00\u5b9a\u8981\u7528 SQL \u6267\u884c\uff0c\u8bf7\u52a1\u5fc5\u9075\u5faa\u4ee5\u4e0b\u6b65\u9aa4\uff1a</p> <ol> <li> <p>\u68c0\u67e5\u957f\u4e8b\u52a1\uff1a \u6267\u884c\u524d\u5148\u6740\u6389\u6240\u6709\u6d3b\u8dc3\u7684\u957f\u67e5\u8be2\u6216\u4e8b\u52a1\u3002</p> </li> <li> <p>\u663e\u5f0f\u6307\u5b9a\u7b97\u6cd5\uff1a ```sql ALTER TABLE your_table ADD COLUMN new_col INT, ALGORITHM=INPLACE, LOCK=NONE;</p> </li> </ol> <pre><code>* `ALGORITHM=INPLACE`\uff1a\u5c3d\u91cf\u539f\u5730\u4fee\u6539\u3002\n* `LOCK=NONE`\uff1a\u786e\u4fdd\u4e0d\u963b\u585e\u8bfb\u5199\uff08\u5982\u679c\u8be5\u53d8\u66f4\u4e0d\u652f\u6301\u6b64\u6a21\u5f0f\uff0cSQL \u4f1a\u76f4\u63a5\u62a5\u9519\uff0c\u800c\u4e0d\u662f\u9501\u8868\uff09\u3002\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/MYSQL%E7%83%AD%E8%A1%A8%E5%8A%A0%E5%AD%97%E6%AE%B5/#_4","title":"\u65b9\u6848\u4e09\uff1a\u5206\u65f6\u6bb5\u4e0e\u5c0f\u6b65\u5feb\u8dd1","text":"<ul> <li>\u4f4e\u5cf0\u671f\u64cd\u4f5c\uff1a \u907f\u5f00\u4e1a\u52a1\u9ad8\u5cf0\u3002</li> <li>\u8bbe\u7f6e\u9501\u8d85\u65f6\uff1a \u5728\u5f53\u524d Session \u4fee\u6539 <code>lock_wait_timeout</code>\uff0c\u9632\u6b62\u957f\u65f6\u95f4\u963b\u585e\u3002</li> <li>\u4e3b\u4ece\u5207\u6362\uff1a \u5728\u4ece\u5e93\u52a0\u5b57\u6bb5\uff0c\u7136\u540e\u8fdb\u884c\u4e3b\u4ece\u5207\u6362\uff08\u8fd9\u79cd\u65b9\u6cd5\u64cd\u4f5c\u590d\u6742\uff0c\u98ce\u9669\u8f83\u9ad8\uff0c\u901a\u5e38\u4f5c\u4e3a\u5907\u9009\uff09\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E4%BF%83%E6%88%90%E4%BA%A4%E6%98%93%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/","title":"\u4fc3\u6210\u4ea4\u6613\u7cfb\u7edf\u642d\u5efa","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E4%BF%83%E6%88%90%E4%BA%A4%E6%98%93%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_1","title":"\u4fc3\u6210\u4ea4\u6613\u7cfb\u7edf","text":"<p>\u573a\u666f\uff1a\u4fc3\u6210\u4ea4\u6613\u7cfb\u7edf\u5982\u4f55\u642d\u5efa\uff0c\u4e5f\u662f\u7269\u6d41\u884c\u4e1a\uff0c\u7531\u8d27\u4e3b\u4e0b\u8ba2\u5355\uff0c\u9700\u8981\u627e\u53f8\u673a\uff0c\u5e73\u53f0\u53d1\u5e03\u8d27\u6e90\uff0c\u4fc3\u6210\u53f8\u673a\u6210\u4ea4\uff0c\u53f8\u673a\u4e2d\u6807\u540e\u53ef\u4ee5\u627f\u8fd0\uff0c\u8fd0\u8f93\u5b8c\u7ed3\u8d70\u7ed3\u7b97\u6d41\u7a0b\u3002\u6b64\u5957\u4e00\u7968\u8d27\u6d41\u7a0b\u4e2d\u4fc3\u6210\u4ea4\u6613\u7684\u73af\u5883\u5e94\u8be5\u5982\u4f55\u8bbe\u8ba1</p> <p>\u5206\u6790\uff1a\u5728\u7269\u6d41\u884c\u4e1a\u4e2d\uff0c\u4fc3\u6210\u4ea4\u6613\u7cfb\u7edf\u662f\u8fde\u63a5\u8d27\u4e3b\uff08\u9700\u6c42\u65b9\uff09\u4e0e\u53f8\u673a\uff08\u4f9b\u7ed9\u65b9\uff09\u7684\u6838\u5fc3\u67a2\u7ebd\u3002\u5b83\u4e0d\u4ec5\u662f\u4e00\u4e2a\u4fe1\u606f\u53d1\u5e03\u5e73\u53f0\uff0c\u66f4\u662f\u4e00\u4e2a\u9ad8\u5e76\u53d1\u7684\u3001\u5bf9\u4e00\u81f4\u6027\u8981\u6c42\u6781\u9ad8\u7684\u64ae\u5408\u5f15\u64ce\u3002\u5c06\u8fd9\u5957\u7cfb\u7edf\u62c6\u89e3\u4e3a\u8d27\u6e90\u6c60\u3001\u5339\u914d\u5f15\u64ce\u3001\u6210\u4ea4\u9501\u5b9a\u4e09\u4e2a\u6838\u5fc3\u9636\u6bb5\uff0c\u5e76\u4e3a\u4f60\u8bbe\u8ba1\u4e24\u5957\u4e3b\u6d41\u7684\u4ea4\u6613\u6a21\u578b\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E4%BF%83%E6%88%90%E4%BA%A4%E6%98%93%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_2","title":"\u4e00\u3001 \u4fc3\u6210\u4ea4\u6613\u7cfb\u7edf\u6838\u5fc3\u67b6\u6784\u56fe","text":"<p>\u6211\u4eec\u91c7\u7528\u9886\u57df\u9a71\u52a8\u8bbe\u8ba1\uff08DDD\uff09\uff0c\u5c06\u4ea4\u6613\u64ae\u5408\u4e0e\u540e\u7eed\u7684\u8fd0\u8f93\u6267\u884c\uff08TMS\uff09\u8fdb\u884c\u89e3\u8026\u3002</p> <pre><code>graph TD\n    A[\u8d27\u4e3b\u4e0b\u5355] --&gt; B{\u4ea4\u6613\u64ae\u5408\u4e2d\u5fc3}\n    subgraph \u64ae\u5408\u6a21\u5f0f\n        B --&gt; B1[\u62a2\u5355\u6a21\u5f0f: \u77ac\u65f6\u9ad8\u5e76\u53d1]\n        B --&gt; B2[\u7ade\u4ef7\u6a21\u5f0f: \u4ef7\u683c\u535a\u5f08]\n        B --&gt; B3[\u5185\u90e8\u8f66\u6d3e\u5355\u6a21\u5f0f: \u7b97\u6cd5\u6307\u6d3e]\n    end\n    B1 &amp; B2 &amp; B3 --&gt; C[\u6210\u4ea4\u9501\u5b9a/\u7b7e\u7ea6]\n    C --&gt; D[\u8fdb\u5165\u8fd0\u8f93\u6267\u884c\u6d41]\n    C --&gt; E[\u89e6\u53d1\u8fd0\u8d39\u9884\u51bb\u7ed3]</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E4%BF%83%E6%88%90%E4%BA%A4%E6%98%93%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_3","title":"\u4e8c\u3001 \u4e24\u79cd\u4e3b\u6d41\u6210\u4ea4\u6a21\u5f0f\u8bbe\u8ba1","text":"<p>\u5728\u7269\u6d41\u573a\u666f\u4e0b\uff0c\u4f60\u9700\u8981\u6839\u636e\u4e1a\u52a1\u5c5e\u6027\uff08\u662f\u57ce\u914d\u8fd8\u662f\u5e72\u7ebf\uff09\u9009\u62e9\u4e0d\u540c\u7684\u8bbe\u8ba1\u65b9\u6848\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E4%BF%83%E6%88%90%E4%BA%A4%E6%98%93%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#a","title":"\u65b9\u6848 A\uff1a\u62a2\u5355\u6a21\u5f0f","text":"<ul> <li>\u573a\u666f\uff1a\u4ef7\u683c\u6807\u51c6\u5316\u3001\u8d27\u6e90\u7d27\u6025\u3002</li> <li>\u6280\u672f\u6838\u5fc3\uff1a\u5229\u7528 Redis + \u5206\u5e03\u5f0f\u9501\u3002</li> <li>\u6d41\u7a0b\uff1a\u8d27\u6e90\u53d1\u5e03\u81f3 Redis \u961f\u5217\uff0c\u591a\u540d\u53f8\u673a\u540c\u65f6\u201c\u79d2\u6740\u201d\u3002</li> <li>\u5229\u5f0a\uff1a</li> <li>\u4f18\u70b9\uff1a\u6210\u4ea4\u6548\u7387\u6781\u9ad8\u3002</li> <li>\u7f3a\u70b9\uff1a\u5bf9\u7cfb\u7edf\u5e76\u53d1\u538b\u529b\u5927\uff0c\u5bb9\u6613\u4ea7\u751f\u201c\u8bef\u62a2\u201d\uff0c\u9700\u4e25\u683c\u5904\u7406\u5e42\u7b49\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E4%BF%83%E6%88%90%E4%BA%A4%E6%98%93%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#b","title":"\u65b9\u6848 B\uff1a\u7ade\u4ef7\u6a21\u5f0f","text":"<ul> <li>\u573a\u666f\uff1a\u5927\u5b97\u8d27\u6e90\u3001\u4ef7\u683c\u4e0d\u900f\u660e\u3001\u957f\u9014\u5e72\u7ebf\u3002</li> <li>\u6280\u672f\u6838\u5fc3\uff1a\u5b9a\u65f6\u7684\u201c\u6807\u4e66\u201d\u7ba1\u7406 + \u4ef7\u683c\u6392\u5e8f\u7b56\u7565\u3002</li> <li>\u6d41\u7a0b\uff1a\u8d27\u4e3b\u53d1\u5e03\u8d27\u6e90\uff0c\u8bbe\u5b9a\u7ade\u4ef7\u65f6\u957f\uff08\u5982 30 \u5206\u949f\uff09\u3002\u53f8\u673a\u51fa\u4ef7\uff0c\u7cfb\u7edf\u8bb0\u5f55\u6240\u6709\u62a5\u4ef7\uff0c\u65f6\u95f4\u7ed3\u675f\u540e\u7531\u8d27\u4e3b\u9009\u62e9\u6216\u7cfb\u7edf\u81ea\u52a8\u6309\u201c\u6700\u4f18\u4ef7\u201d\u4e2d\u6807\u3002</li> <li>\u5229\u5f0a\uff1a</li> <li>\u4f18\u70b9\uff1a\u80fd\u6709\u6548\u964d\u4f4e\u8d27\u4e3b\u6210\u672c\uff0c\u63d0\u9ad8\u5e73\u53f0\u76c8\u5229</li> <li>\u7f3a\u70b9\uff1a\u4ea4\u6613\u95ed\u73af\u5468\u671f\u957f\uff0c\u5bf9\u201c\u5f03\u6807\u201d\u884c\u4e3a\u9700\u8981\u4e25\u82db\u7684\u4fe1\u7528\u60e9\u6212\u673a\u5236\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E4%BF%83%E6%88%90%E4%BA%A4%E6%98%93%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_4","title":"\u4e09\u3001 \u5173\u952e\u7ec4\u4ef6\u8bbe\u8ba1","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E4%BF%83%E6%88%90%E4%BA%A4%E6%98%93%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#1","title":"1. \u8d27\u6e90\u6c60 \u4e0e\u7d22\u5f15","text":"<ul> <li>\u8bbe\u8ba1\uff1a\u4e0d\u8981\u76f4\u63a5\u67e5\u8be2 MySQL \u4e1a\u52a1\u8868\u3002</li> <li>\u5b9e\u73b0\uff1a\u4f7f\u7528 Elasticsearch (ES) \u5b58\u50a8\u8d27\u6e90\u4fe1\u606f\uff0c\u652f\u6301\u53f8\u673a\u7684\u591a\u7ef4\u5ea6\u68c0\u7d22\uff08\u6309\u88c5\u8d27\u5730\u3001\u5378\u8d27\u5730\u3001\u8f66\u578b\u3001\u5428\u4f4d\u3001\u8ddd\u79bb\uff09\u3002</li> <li>\u5730\u7406\u4f4d\u7f6e\uff1a\u5229\u7528 ES \u7684 <code>geo_point</code> \u8fdb\u884c\u534a\u5f84 50km \u5185\u7684\u8d27\u6e90\u63a8\u9001\uff0c\u8fd9\u662f\u4fc3\u6210\u4ea4\u6613\u7684\u7cbe\u51c6\u5316\u524d\u63d0\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E4%BF%83%E6%88%90%E4%BA%A4%E6%98%93%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#2","title":"2. \u72b6\u6001\u673a\u9a71\u52a8","text":"<p>\u4fc3\u6210\u4ea4\u6613\u8fc7\u7a0b\u72b6\u6001\u590d\u6742\uff0c\u5fc5\u987b\u4f7f\u7528\u72b6\u6001\u673a\uff08\u5982 Spring Statemachine\uff09\u5f3a\u7ba1\u63a7\uff1a</p> <ul> <li><code>PUBLISHED</code> (\u5df2\u53d1\u5e03) -&gt; <code>BIDDING</code> (\u7ade\u4ef7\u4e2d) -&gt; <code>MATCHED</code> (\u5df2\u6210\u4ea4) -&gt; <code>CONFIRMED</code> (\u53f8\u673a\u5230\u573a\u786e\u8ba4)\u3002</li> <li>\u539f\u5219\uff1a\u72b6\u6001\u4e0d\u53ef\u9006\u4e14\u552f\u4e00\u3002\u4f8b\u5982\uff0c\u4e00\u65e6\u8ba2\u5355\u8fdb\u5165 <code>MATCHED</code>\uff0c\u5fc5\u987b\u901a\u8fc7\u5206\u5e03\u5f0f\u9501\u9501\u5b9a <code>order_id</code>\uff0c\u9632\u6b62\u7b2c\u4e8c\u4e2a\u53f8\u673a\u4e2d\u6807\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E4%BF%83%E6%88%90%E4%BA%A4%E6%98%93%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#3","title":"3. \u5206\u5e03\u5f0f\u4e8b\u52a1\u4e0e\u4e00\u81f4\u6027","text":"<ul> <li>\u75db\u70b9\uff1a\u53f8\u673a\u4e2d\u6807\u7684\u4e00\u77ac\u95f4\uff0c\u9700\u8981\uff1a1. \u66f4\u65b0\u8ba2\u5355\u72b6\u6001\uff1b2. \u51bb\u7ed3\u8d27\u4e3b\u4f59\u989d/\u6388\u4fe1\u989d\u5ea6\uff08\u5b9e\u65f6\u7ed3\u7b97\uff09\uff1b3. \u5f02\u6b65\u901a\u77e5\u5176\u4ed6\u672a\u4e2d\u6807\u53f8\u673a\u3002</li> <li>\u67b6\u6784\u5efa\u8bae\uff1a\u4f7f\u7528 RocketMQ \u4e8b\u52a1\u6d88\u606f\u3002</li> <li>\u7b2c\u4e00\u9636\u6bb5\uff1a\u53d1\u9001\u201c\u786e\u8ba4\u6210\u4ea4\u201d\u534a\u6d88\u606f\u3002</li> <li>\u7b2c\u4e8c\u9636\u6bb5\uff1a\u6267\u884c\u672c\u5730\u6570\u636e\u5e93\u4fee\u6539\uff08\u8ba2\u5355\u72b6\u6001\uff09\u3002</li> <li>\u7b2c\u4e09\u9636\u6bb5\uff1a\u63d0\u4ea4\u6d88\u606f\uff0c\u4e0b\u6e38\u8d22\u52a1\u7cfb\u7edf\u8ba2\u9605\u6d88\u606f\u5e76\u6267\u884c\u8d44\u91d1\u51bb\u7ed3\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E4%BF%83%E6%88%90%E4%BA%A4%E6%98%93%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_5","title":"\u56db\u3001 \u515c\u5e95\u65b9\u6848\u4e0e\u5f02\u5e38\u5904\u7406","text":"<p>\u7269\u6d41\u4ea4\u6613\u53d7\u7ebf\u4e0b\u56e0\u7d20\u5f71\u54cd\u6781\u5927\uff0c\u5fc5\u987b\u6709\u4ee5\u4e0b\u201c\u9632\u5fa1\u6027\u8bbe\u8ba1\u201d\uff1a</p> \u5f02\u5e38\u573a\u666f \u67b6\u6784\u5bf9\u7b56 \u53f8\u673a\u6bc1\u7ea6 (\u5f03\u6807) \u5f15\u5165\u4fdd\u8bc1\u91d1\u6263\u9664\u673a\u5236\u3002\u5f03\u6807\u751f\u6210\u5bf9\u5e94\u8d39\u7528\uff0c\u7ed3\u7b97\u65f6\u6263\u9664\u53f8\u673a\u4fdd\u8bc1\u91d1\u3002\u9488\u5bf9\u9ad8\u4ef7\u503c\u8ba2\u5355\u53ef\u4ee5\u91c7\u7528\u5185\u90e8\u8f66\u7b49\u522b\u7684\u9700\u6c42\u65b9\u6848\u8bbe\u8ba1 \u8d27\u6e90\u65e0\u4eba\u95ee\u6d25 \u9636\u68af\u5f0f\u964d\u7ea7\u7b56\u7565\u3002\u82e5 1 \u5c0f\u65f6\u672a\u6210\u4ea4\uff0c\u7cfb\u7edf\u81ea\u52a8\u6269\u5927\u63a8\u9001\u534a\u5f84\uff0850km -&gt; 100km\uff09\uff0c\u6216\u81ea\u52a8\u89e6\u53d1\u201c\u5e73\u53f0\u8865\u5dee\u4ef7\u201d\u903b\u8f91\u3002 \u5e76\u53d1\u8d85\u5356 \u6570\u636e\u5e93\u7248\u672c\u53f7\u3002\u5728\u6267\u884c <code>UPDATE order SET driver_id = xxx WHERE id = yyy AND driver_id IS NULL</code> \u65f6\uff0c\u901a\u8fc7\u5f71\u54cd\u884c\u6570\u5224\u65ad\u662f\u5426\u6210\u4ea4\u6210\u529f\u3002"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E4%BF%83%E6%88%90%E4%BA%A4%E6%98%93%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_6","title":"\u4e94\u3001 \u64ae\u5408\u7684\u201c\u4fe1\u4efb\u6a21\u578b\u201d","text":"<p>\u5728\u4fc3\u6210\u4ea4\u6613\u7cfb\u7edf\u4e2d\uff0c\u201c\u4fe1\u606f\u4e0d\u5bf9\u79f0\u201d\u662f\u6700\u5927\u7684\u654c\u624b\u3002</p> <ul> <li>\u5efa\u8bae\uff1a\u5728\u53f8\u673a\u4e2d\u6807\u524d\uff0c\u5f15\u5165\u201c\u753b\u50cf\u7cfb\u7edf\u201d\u3002\u7cfb\u7edf\u4e0d\u4ec5\u770b\u4ef7\u683c\uff0c\u8fd8\u8981\u6839\u636e\u53f8\u673a\u7684\u5386\u53f2\u8f68\u8ff9\u3001\u51c6\u65f6\u7387\u3001\u8fdd\u89c4\u8bb0\u5f55\u8fdb\u884c\u81ea\u52a8\u8bc4\u5206\u3002</li> <li>\u7ed3\u8bba\uff1a\u6700\u597d\u7684\u4fc3\u6210\u4ea4\u6613\u4e0d\u662f\u6700\u5feb\u7684\uff0c\u800c\u662f\u6700\u7a33\u7684\u3002 \u9891\u7e41\u7684\u7ebf\u4e0b\u6bc1\u7ea6\u4f1a\u5f7b\u5e95\u6467\u6bc1\u4e2d\u53f0\u7cfb\u7edf\u7684\u4ef7\u503c\u3002</li> </ul> <p>\u4ea4\u6613\u7cfb\u7edf\u7684\u642d\u5efa\uff0c\u5207\u8bb0\u4e0d\u8981\u4e00\u4e0a\u6765\u5c31\u641e\u5927\u800c\u5168\u3002</p> <ol> <li>\u5148\u505a\u201c\u7a33\u5b9a\u6210\u4ea4\u201d\uff1a\u4fdd\u8bc1\u5e42\u7b49\u548c\u5e93\u5b58\u9884\u6263\u3002</li> <li>\u518d\u505a\u201c\u667a\u80fd\u5339\u914d\u201d\uff1a\u5728\u57fa\u7840\u64ae\u5408\u4e0a\u589e\u52a0\u6743\u91cd\u7b97\u6cd5\u3002</li> <li>\u6700\u540e\u505a\u201c\u7ed3\u7b97\u8054\u52a8\u201d\uff1a\u5728\u6210\u4ea4\u540e\u7684\u5f02\u6b65\u5904\u7406\u4e2d\uff0c\u6ce8\u5165\u8d39\u7387\u6a21\u578b\u3002</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%94%AF%E4%BB%98%E4%B8%AD%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/","title":"\u652f\u4ed8\u4e2d\u53f0\u7cfb\u7edf","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%94%AF%E4%BB%98%E4%B8%AD%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_2","title":"\u652f\u4ed8","text":"<p>\u573a\u666f\uff1a\u652f\u4ed8\u7cfb\u7edf\uff0c\u5c5e\u4e8e\u4e1a\u52a1\u4e2d\u53f0\uff0c\u4e0d\u76f4\u63a5\u5bf9\u63a5\u652f\u4ed8\uff0c\u4f46\u662f\u4f1a\u5bf9\u63a5\u591a\u79cd\u652f\u4ed8\u65b9\u5f0f\uff0c\u6bd4\u5982\u5feb\u6377\u652f\u4ed8\u7cfb\u7edf\uff08\u5fae\u4fe1/\u652f\u4ed8\u5b9d\uff09\uff0c\u5bf9\u63a5\u7b2c\u4e09\u65b9\u652f\u4ed8\u5e73\u53f0\uff0c\u4e00\u822c\u662f\u63d0\u4f9b\u67e5\u8be2\u652f\u4ed8\u7ed3\u679c\uff0c\u53d1\u8d77\u652f\u4ed8\uff0c\u652f\u4ed8\u56de\u8c03\u7b49\u4ea4\u4e92\u3002\u8981\u600e\u4e48\u8bbe\u8ba1\u8fd9\u4e2a\u652f\u4ed8\u7cfb\u7edf\uff0c\u5e94\u5bf9\u9ad8\u53ef\u7528\uff0c\u4e14\u5e42\u7b49\uff0c\u786e\u4fdd\u652f\u4ed8\u65e0\u95ee\u9898\u3002\u4ecd\u7136\u662f\u7269\u6d41\u7cfb\u7edf\uff0c\u5fae\u670d\u52a1\u67b6\u6784</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%94%AF%E4%BB%98%E4%B8%AD%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_3","title":"\u4e00\u3001 \u6838\u5fc3\u67b6\u6784\u65b9\u6848\u6743\u8861","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%94%AF%E4%BB%98%E4%B8%AD%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_4","title":"\u65b9\u6848\u4e00\uff1a\u57fa\u4e8e\u72b6\u6001\u673a\u5f3a\u63a7\u5236\u7684\u540c\u6b65\u4ea4\u6613\u6a21\u578b","text":"<ul> <li>\u63a8\u5bfc\u903b\u8f91\uff1a\u652f\u4ed8\u8bf7\u6c42\u8fdb\u5165\u7cfb\u7edf\u540e\uff0c\u901a\u8fc7\u6570\u636e\u5e93\u4e8b\u52a1\u4fdd\u8bc1\u652f\u4ed8\u5355\u521b\u5efa\u4e0e\u72b6\u6001\u9501\u5b9a\u7684\u539f\u5b50\u6027\u3002\u5229\u7528\u652f\u4ed8\u6e20\u9053\u7684\u72b6\u6001\u673a\uff08State Machine\uff09\u9a71\u52a8\u4e1a\u52a1\u6d41\u8f6c\u3002</li> <li>\u4f18\u70b9\uff1a\u903b\u8f91\u76f4\u89c2\uff0c\u6570\u636e\u5f3a\u4e00\u81f4\u6027\u9ad8\uff0c\u9002\u7528\u4e8e\u5bf9\u652f\u4ed8\u5b9e\u65f6\u6027\u8981\u6c42\u6781\u9ad8\u7684\u573a\u666f\u3002</li> <li>\u7f3a\u70b9\uff1a\u5728\u9ad8\u5e76\u53d1\u4e0b\u5bf9\u6570\u636e\u5e93\u538b\u529b\u5927\uff1b\u82e5\u7b2c\u4e09\u65b9\u63a5\u53e3\u5ef6\u8fdf\uff0c\u4f1a\u5360\u7528\u5927\u91cf\u5bb9\u5668\u7ebf\u7a0b\uff0c\u5bfc\u81f4\u7cfb\u7edf\u541e\u5410\u91cf\u4e0b\u964d\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%94%AF%E4%BB%98%E4%B8%AD%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#eda","title":"\u65b9\u6848\u4e8c\uff1a\u57fa\u4e8e\u4e8b\u4ef6\u9a71\u52a8\uff08EDA\uff09\u7684\u5f02\u6b65\u4ea4\u6613\u6a21\u578b\uff08\u63a8\u8350\uff09","text":"<ul> <li>\u63a8\u5bfc\u903b\u8f91\uff1a\u652f\u4ed8\u53d1\u8d77\u540e\u7acb\u5373\u8fd4\u56de\u201c\u652f\u4ed8\u4e2d\u201d\uff0c\u540e\u7eed\u901a\u8fc7 RocketMQ \u9a71\u52a8\u72b6\u6001\u66f4\u65b0\u3002\u5c06\u201c\u53d1\u8d77\u652f\u4ed8\u201d\u3001\u201c\u63a5\u6536\u56de\u8c03\u201d\u3001\u201c\u4e3b\u52a8\u5bf9\u8d26\u201d\u89e3\u8026\u3002</li> <li>\u4f18\u70b9\uff1a\u6781\u9ad8\u7684\u541e\u5410\u91cf\u4e0e\u6269\u5c55\u6027\uff1b\u7b2c\u4e09\u65b9\u5e73\u53f0\u6296\u52a8\u65f6\uff0c\u901a\u8fc7\u6d88\u606f\u91cd\u8bd5\u673a\u5236\u5b9e\u73b0\u81ea\u6211\u4fee\u590d\u3002</li> <li>\u7f3a\u70b9\uff1a\u5b58\u5728\u77ed\u6682\u7684\u4e2d\u95f4\u6001\uff0c\u5bf9\u4e1a\u52a1\u7aef\u67e5\u8be2\u903b\u8f91\u6709\u8981\u6c42\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%94%AF%E4%BB%98%E4%B8%AD%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_5","title":"\u4e8c\u3001 \u5173\u952e\u6280\u672f\u5b9e\u73b0\uff1a\u5982\u4f55\u786e\u4fdd\u201c\u4e07\u65e0\u4e00\u5931\u201d","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%94%AF%E4%BB%98%E4%B8%AD%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#1","title":"1. \u5e42\u7b49\u8bbe\u8ba1","text":"<p>\u91cd\u590d\u652f\u4ed8\u662f\u7ea2\u7ebf\u3002\u6211\u4eec\u5fc5\u987b\u5728\u591a\u4e2a\u5c42\u9762\u6784\u5efa\u9632\u7ebf\uff1a</p> <ul> <li> <p>\u4e1a\u52a1\u5c42\u5e42\u7b49\uff08\u53bb\u91cd\u8868\uff09\uff1a\u4f7f\u7528 <code>order_id + scene_code</code>\uff08\u8ba2\u5355\u53f7+\u573a\u666f\u7801\uff09\u4f5c\u4e3a\u552f\u4e00\u7d22\u5f15\u3002</p> </li> <li> <p>\u652f\u4ed8\u6d41\u6c34\u5c42\uff1a\u6bcf\u4e00\u7b14\u53d1\u5f80\u7b2c\u4e09\u65b9\u7684\u8bf7\u6c42\uff0c\u751f\u6210\u5168\u5c40\u552f\u4e00\u7684 <code>request_no</code>\u3002\u5373\u4fbf\u7528\u6237\u591a\u6b21\u70b9\u51fb\uff0c\u53d1\u5f80\u5fae\u4fe1/\u652f\u4ed8\u5b9d\u7684\u6d41\u6c34\u53f7\u4fdd\u6301\u4e00\u81f4\uff0c\u5229\u7528\u7b2c\u4e09\u65b9\u5e73\u53f0\u7684\u5e42\u7b49\u673a\u5236\u9632\u91cd\u3002</p> </li> <li> <p>\u72b6\u6001\u673a\u63a7\u5236\uff1a</p> </li> </ul> <p>SQL</p> <pre><code>-- \u4f7f\u7528\u4e50\u89c2\u9501\u66f4\u65b0\u72b6\u6001\nUPDATE payment_order SET status = 'SUCCESS', update_time = NOW() \nWHERE pay_no = 'P123' AND status = 'PENDING';\n</code></pre> <p>\u53ea\u6709\u72b6\u6001\u4e3a <code>PENDING</code> \u65f6\u624d\u5141\u8bb8\u53d8\u66f4\u4e3a\u6210\u529f\uff0c\u9632\u6b62\u56de\u8c03\u91cd\u590d\u5904\u7406\u5bfc\u81f4\u903b\u8f91\u91cd\u5165\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%94%AF%E4%BB%98%E4%B8%AD%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#2","title":"2. \u9ad8\u53ef\u7528\u6027\u4fdd\u969c","text":"<ul> <li>\u591a\u6e20\u9053\u667a\u80fd\u8def\u7531\uff1a\u5982\u679c\u7b2c\u4e09\u65b9\u652f\u4ed8 A \u63a5\u53e3\u5927\u91cf\u8d85\u65f6\uff0c\u8def\u7531\u6a21\u5757\u81ea\u52a8\u7194\u65ad\u5e76\u5207\u6362\u81f3\u5907\u7528\u6e20\u9053 B\uff08\u4f8b\u5982\u4ece\u5fae\u4fe1\u5207\u6362\u81f3\u94f6\u8054\u5feb\u6377\u652f\u4ed8\uff09\u3002\uff08\u6b64\u573a\u666f\u4e0d\u63a8\u8350\uff0c\u8d85\u65f6\u53ef\u80fd\u4e5f\u5df2\u7ecf\u53d1\u8d77\u4e86\uff0c\u5982\u679c\u5728\u4e0d\u786e\u4fdd\u53d1\u8d77\u652f\u4ed8\u6210\u529f\u4e4b\u65f6\u5207\u6362\u5230\u4e86\u522b\u7684\u652f\u4ed8\u6e20\u9053\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u91cd\u590d\u652f\u4ed8\u573a\u666f\uff09</li> <li>\u7070\u5ea6\u4e0e\u9694\u79bb\uff1a\u5c06\u4e0d\u540c\u4e1a\u52a1\u7ebf\uff08\u5982\uff1a\u8fd0\u8d39\u652f\u4ed8\u3001\u62bc\u91d1\u652f\u4ed8\uff09\u7684\u6267\u884c\u94fe\u8def\u5728\u5fae\u670d\u52a1\u5c42\u9762\u8fdb\u884c\u7269\u7406\u9694\u79bb\uff0c\u9632\u6b62\u67d0\u4e00\u8fb9\u4e1a\u52a1\u6fc0\u589e\u62d6\u57ae\u6574\u4e2a\u652f\u4ed8\u4e2d\u53f0\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%94%AF%E4%BB%98%E4%B8%AD%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_6","title":"\u4e09\u3001 \u515c\u5e95\u65b9\u6848\uff1a\u4e3b\u52a8\u5bf9\u8d26\u7cfb\u7edf","text":"<p>\u6838\u5fc3\u8bbe\u8ba1\uff1a\u4f60\u4e0d\u80fd\u5b8c\u5168\u4fe1\u4efb\u7b2c\u4e09\u65b9\u7684\u56de\u8c03\uff08\u53ef\u80fd\u4f1a\u4e22\u5931\u3001\u5ef6\u8fdf\u6216\u88ab\u5899\uff09\u3002</p> <ul> <li>\u65b9\u6848\uff1a\u5ef6\u8fdf\u961f\u5217\u8f6e\u8be2 + T+1 \u5168\u91cf\u5bf9\u8d26\u3002</li> <li>\u5b9a\u65f6\u8865\u5355\uff08T+N min\uff09\uff1a\u652f\u4ed8\u5355\u521b\u5efa\u540e\uff0c\u82e5 5 \u5206\u949f\u5185\u672a\u6536\u5230\u56de\u8c03\uff0c\u542f\u52a8\u5b9a\u65f6\u4efb\u52a1\u4e3b\u52a8\u8c03\u7528\u7b2c\u4e09\u65b9\u201c\u67e5\u8be2\u652f\u4ed8\u7ed3\u679c\u201d\u63a5\u53e3\u3002</li> <li>\u5dee\u9519\u5904\u7406\u903b\u8f91\uff1a<ol> <li>\u672c\u5730\u6210\u529f/\u7b2c\u4e09\u65b9\u5931\u8d25\uff1a\u6781\u7aef\u5f02\u5e38\uff0c\u9700\u4eba\u5de5\u4ecb\u5165\u51b2\u6b63\u3002</li> <li>\u672c\u5730\u5ef6\u8fdf/\u7b2c\u4e09\u65b9\u6210\u529f\uff1a\u81ea\u52a8\u540c\u6b65\u72b6\u6001\uff0c\u89e6\u53d1\u4e1a\u52a1\u540e\u7eed\u3002</li> <li>\u53cc\u5411\u4e0d\u4e00\u81f4\uff1a\u4ee5\u7b2c\u4e09\u65b9\u8d22\u52a1\u8d26\u5355\u4e3a\u51c6\uff08T+1 \u6838\u5fc3\u903b\u8f91\uff09\u3002</li> </ol> </li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%94%AF%E4%BB%98%E4%B8%AD%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_7","title":"\u56db\u3001\u652f\u4ed8\u56de\u8c03","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%94%AF%E4%BB%98%E4%B8%AD%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#1_1","title":"1. \u7b7e\u540d\u9a8c\u8bc1\u903b\u8f91\u6d41","text":"<p>\u5176\u6838\u5fc3\u903b\u8f91\u5728\u4e8e\uff1a\u4e09\u65b9\u5e73\u53f0\u7528\u79c1\u94a5\u52a0\u7b7e\uff0c\u652f\u4ed8\u4e2d\u53f0\u7528\u516c\u94a5\u9a8c\u7b7e\u3002</p> <pre><code>sequenceDiagram\n    participant TP as \u7b2c\u4e09\u65b9\u652f\u4ed8 (WeChat/Alipay)\n    participant PS as \u652f\u4ed8\u4e2d\u53f0 (Pay Service)\n\n    TP-&gt;&gt;TP: 1. \u5c06\u6240\u6709\u53c2\u6570\u6309\u5b57\u5178\u5e8f\u6392\u5e8f\n    TP-&gt;&gt;TP: 2. \u62fc\u63a5\u6210\u5f85\u7b7e\u540d\u5b57\u7b26\u4e32 (Plaintext)\n    TP-&gt;&gt;TP: 3. \u4f7f\u7528\u79c1\u94a5\u751f\u6210\u7b7e\u540d (Signature)\n    TP--&gt;&gt;PS: 4. \u53d1\u9001\u56de\u8c03 (Payload + Signature)\n    PS-&gt;&gt;PS: 5. \u83b7\u53d6\u539f\u59cb\u62a5\u6587\uff0c\u6309\u540c\u6837\u89c4\u5219\u6392\u5e8f\u62fc\u63a5\n    PS-&gt;&gt;PS: 6. \u83b7\u53d6\u5e73\u53f0\u516c\u94a5 (Public Key)\n    PS-&gt;&gt;PS: 7. \u6267\u884c\u9a8c\u7b7e (verify)\n    alt \u9a8c\u7b7e\u901a\u8fc7\n        PS--&gt;&gt;TP: \u8fd4\u56de success\n    else \u9a8c\u7b7e\u5931\u8d25\n        PS--&gt;&gt;TP: \u8fd4\u56de fail (\u4e22\u5f03\u8bf7\u6c42\u5e76\u62a5\u8b66)\n    end</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%94%AF%E4%BB%98%E4%B8%AD%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_8","title":"\u4e00\u3001 \u67b6\u6784\u8bbe\u8ba1\u6743\u8861\uff1a\u4e24\u79cd\u65b9\u6848","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%94%AF%E4%BB%98%E4%B8%AD%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#a","title":"\u65b9\u6848 A\uff1a\u5206\u5e03\u5f0f\u62e6\u622a\u5668\u9a8c\u7b7e\uff08\u901a\u7528\u6027\u5f3a\uff09","text":"<ul> <li>\u5b9e\u73b0\uff1a\u5728\u652f\u4ed8\u7f51\u5173\u6216 Spring Interceptor \u4e2d\u62e6\u622a <code>/callback/**</code> \u8def\u5f84\uff0c\u7edf\u4e00\u8fdb\u884c\u9a8c\u7b7e\u3002</li> <li>\u5229\u5f0a\uff1a\u5bf9\u4e1a\u52a1\u4ee3\u7801\u65e0\u4fb5\u5165\uff0c\u80fd\u6709\u6548\u9694\u79bb\u5b89\u5168\u903b\u8f91\u3002</li> <li>\u98ce\u9669\uff1a\u4e0d\u540c\u652f\u4ed8\u6e20\u9053\u7684\u7b7e\u540d\u89c4\u5219\uff08\u5982\u7b97\u6cd5\u3001\u6392\u5e8f\u89c4\u5219\u3001Header\u540d\uff09\u5dee\u5f02\u5de8\u5927\uff0c\u4f1a\u5bfc\u81f4\u62e6\u622a\u5668\u903b\u8f91\u8fc7\u4e8e\u81c3\u80bf\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%94%AF%E4%BB%98%E4%B8%AD%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#b","title":"\u65b9\u6848 B\uff1a\u9886\u57df\u9a71\u52a8\u7b56\u7565\u6a21\u5f0f\uff08\u63a8\u8350\uff09","text":"<ul> <li>\u5b9e\u73b0\uff1a\u5b9a\u4e49 <code>PayChannelHandler</code> \u63a5\u53e3\uff0c\u6bcf\u4e2a\u652f\u4ed8\u6e20\u9053\u5b9e\u73b0\u81ea\u5df1\u7684 <code>verifyCallback()</code>\u3002</li> <li>\u4f18\u52bf\uff1a\u903b\u8f91\u5185\u805a\u3002\u5fae\u4fe1\u3001\u652f\u4ed8\u5b9d\u3001\u94f6\u8054\u7684\u9a8c\u7b7e\u903b\u8f91\u5404\u81ea\u72ec\u7acb\uff0c\u4e92\u4e0d\u5e72\u6270\uff0c\u7b26\u5408\u67b6\u6784\u7684\u5f00\u95ed\u539f\u5219\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%94%AF%E4%BB%98%E4%B8%AD%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_9","title":"\u4e8c\u3001 \u515c\u5e95\u65b9\u6848","text":"<ol> <li>\u539f\u59cb\u62a5\u6587\u5b58\u6863 \uff1a\u5728\u9a8c\u7b7e\u4e4b\u524d\uff0c\u9996\u5148\u5c06 Raw Request Body \u548c Headers \u8bb0\u5f55\u5230\u65e5\u5fd7\u6216MySQL \u4e2d\u3002</li> <li>\u4f5c\u7528\uff1a\u5982\u679c\u56e0\u4e3a\u7a0b\u5e8f Bug \u5bfc\u81f4\u9a8c\u7b7e\u5931\u8d25\uff0c\u53ef\u4ee5\u57fa\u4e8e\u539f\u59cb\u62a5\u6587\u8fdb\u884c\u201c\u4eba\u5de5\u9a8c\u7b7e\u201d\u6216\u201c\u624b\u52a8\u8865\u5355\u201d\uff0c\u4f5c\u4e3a\u6700\u540e\u7684\u8d22\u52a1\u4fdd\u969c\u3002</li> <li>IP \u767d\u540d\u5355\u9650\u5236\uff1a\u5728\u9632\u706b\u5899\u6216\u7f51\u5173\u5c42\uff0c\u4ec5\u5141\u8bb8\u652f\u4ed8\u5e73\u53f0\u5b98\u65b9\u7684 IP \u6bb5\u8bbf\u95ee\u56de\u8c03\u63a5\u53e3\u3002</li> <li>\u6700\u7ec8\u5bf9\u8d26\u515c\u5e95\uff1a\u5982\u679c\u56de\u8c03\u5f7b\u5e95\u5931\u6548\uff08\u5982\u7f51\u7edc\u88ab\u5899\uff09\uff0c\u652f\u4ed8\u4e2d\u53f0\u5fc5\u987b\u6709\u5b9a\u65f6\u4efb\u52a1\uff08T+N\u67e5\u8be2\uff09\u3002\u5bf9\u4e8e\u6240\u6709\u5904\u4e8e <code>PENDING</code> \u72b6\u6001\u8d85\u8fc7 10 \u5206\u949f\u7684\u8ba2\u5355\uff0c\u4e3b\u52a8\u8c03\u7528\u4e09\u65b9\u7684\u67e5\u8be2\u63a5\u53e3\uff08Query API\uff09\u6765\u540c\u6b65\u72b6\u6001\u3002</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%94%AF%E4%BB%98%E4%B8%AD%E5%8F%B0%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_10","title":"\u603b\u7ed3\uff1a\u5982\u4f55\u4fdd\u8bc1\u201c\u65e0\u95ee\u9898\u201d","text":"<p>\u6ca1\u6709\u4efb\u4f55\u5206\u5e03\u5f0f\u4e8b\u52a1\u65b9\u6848\u662f\u201c\u5168\u81ea\u52a8\u201d\u7684\uff0c\u76d1\u63a7\u4e0e\u5bf9\u8d26\u624d\u662f\u6700\u7ec8\u9632\u7ebf\u3002</p> <ul> <li>\u5e42\u7b49\u6027\u662f\u524d\u63d0\uff1a\u65e0\u8bba\u4f60\u9009\u7528\u54ea\u79cd\u5206\u5e03\u5f0f\u4e8b\u52a1\uff0c\u6240\u6709\u7684\u4e0b\u6e38\u63a5\u53e3\u5fc5\u987b\u5b9e\u73b0\u5f3a\u5e42\u7b49\u6027\u3002\u5982\u679c\u4e0b\u6e38\u63a5\u53e3\u4e0d\u652f\u6301\u5e42\u7b49\uff0c\u5206\u5e03\u5f0f\u4e8b\u52a1\u67b6\u6784\u5c31\u662f\u7a7a\u4e2d\u697c\u9601\u3002</li> <li>\u4e3b\u52a8\u5bf9\u8d26\u673a\u5236\uff1a\u65e0\u8bba\u591a\u4e48\u5b8c\u7f8e\u7684\u4e8b\u52a1\u67b6\u6784\uff0c\u90fd\u4f1a\u56e0\u6781\u7aef\u6545\u969c\uff08\u5982\u673a\u623f\u65ad\u7535\uff09\u5bfc\u81f4\u6570\u636e\u4e0d\u5e73\u3002\u5fc5\u987b\u5efa\u7acb\u6bcf\u65e5\u7684\u201cT+1 \u5bf9\u8d26\u811a\u672c\u201d\uff0c\u5bf9\u6bd4 <code>OrderDB</code> \u548c <code>FinanceDB</code> \u7684\u603b\u91d1\u989d\uff0c\u53d1\u73b0\u4e0d\u4e00\u81f4\u7acb\u5373\u544a\u8b66\u5e76\u89e6\u53d1\u8865\u507f\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%95%8F%E6%84%9F%E8%AF%8D%E8%BF%87%E6%BB%A4/","title":"\u654f\u611f\u8bcd\u8fc7\u6ee4","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%95%8F%E6%84%9F%E8%AF%8D%E8%BF%87%E6%BB%A4/#dfa","title":"DFA","text":"<p>\uff08JDK 1.8, Spring Boot, Redis, RocketMQ, MySQL\uff09\uff0c\u91c7\u7528 \u201c\u7ba1\u7406\u540e\u53f0\u914d\u7f6e + \u7f13\u5b58\u5206\u53d1 + \u5185\u5b58\u672c\u5730\u8fc7\u6ee4\u201d \u7684\u67b6\u6784\u65b9\u6848\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%95%8F%E6%84%9F%E8%AF%8D%E8%BF%87%E6%BB%A4/#1","title":"1. \u6838\u5fc3\u67b6\u6784\u8bbe\u8ba1","text":"<p>\u4e3a\u4e86\u4fdd\u8bc1\u751f\u4ea7\u73af\u5883\u7684\u6027\u80fd\uff0c\u654f\u611f\u8bcd\u8fc7\u6ee4\u4e0d\u80fd\u6bcf\u6b21\u90fd\u67e5\u6570\u636e\u5e93\u3002</p> <ul> <li>\u5b58\u50a8\u5c42 (MySQL)\uff1a \u6c38\u4e45\u5b58\u50a8\u654f\u611f\u8bcd\u5e93\u3001\u5206\u7c7b\u3001\u767d\u540d\u5355\u7b49\u3002</li> <li>\u7f13\u5b58\u5c42 (Redis)\uff1a \u5b58\u50a8\u654f\u611f\u8bcd\u7684\u7248\u672c\u53f7\u6216\u7b80\u5355\u7684\u589e\u91cf\u66f4\u65b0\u6807\u8bb0\u3002</li> <li>\u6d88\u606f\u5c42 (RocketMQ)\uff1a \u5f53\u540e\u53f0\u4fee\u6539\u654f\u611f\u8bcd\u65f6\uff0c\u53d1\u9001\u5e7f\u64ad\u6d88\u606f\u901a\u77e5\u6240\u6709\u5fae\u670d\u52a1\u8282\u70b9\u66f4\u65b0\u672c\u5730\u5185\u5b58\u3002</li> <li>\u8fc7\u6ee4\u5c42 (Local Memory)\uff1a \u91c7\u7528 DFA (\u786e\u5b9a\u6709\u7a77\u81ea\u52a8\u673a) \u7b97\u6cd5\u5728\u5185\u5b58\u4e2d\u6784\u5efa\u641c\u7d22\u6811\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%95%8F%E6%84%9F%E8%AF%8D%E8%BF%87%E6%BB%A4/#2-dfa","title":"2. \u6838\u5fc3\u7b97\u6cd5\u9009\u62e9\uff1aDFA","text":"<p>\u5728 Java \u4e2d\uff0c\u5904\u7406\u654f\u611f\u8bcd\u6700\u7ecf\u5178\u4e14\u9ad8\u6548\u7684\u65b9\u6cd5\u662f DFA \u7b97\u6cd5\u3002\u5b83\u5c06\u8bcd\u5e93\u6784\u5efa\u6210\u4e00\u9897\u6811\uff0c\u5339\u914d\u65f6\u95f4\u590d\u6742\u5ea6\u4ec5\u4e0e\u6587\u672c\u957f\u5ea6\u6709\u5173\uff0c\u4e0e\u8bcd\u5e93\u5927\u5c0f\u51e0\u4e4e\u65e0\u5173\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%95%8F%E6%84%9F%E8%AF%8D%E8%BF%87%E6%BB%A4/#_2","title":"\u6570\u636e\u7ed3\u6784\u793a\u4f8b","text":"<p>\u5982\u679c\u8bcd\u5e93\u6709\u201c\u5927\u8c61\u201d\u3001\u201c\u5927\u54e5\u201d\uff0c\u6811\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>{\n  \"\u8bcd\": {\n    \"\u5e93\": {\n      \"isEnd\": true\n    }\n  },\n  \"\u654f\": {\n    \"\u4e0d\": {\n      \"\u611f\": {\n        \"1\": {\n          \"isEnd\": true\n        }\n      }\n    },\n    \"\u611f\": {\n      \"isEnd\": true\n    }\n  }\n}\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%95%8F%E6%84%9F%E8%AF%8D%E8%BF%87%E6%BB%A4/#3","title":"3. \u8be6\u7ec6\u8bbe\u8ba1\u65b9\u6848","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%95%8F%E6%84%9F%E8%AF%8D%E8%BF%87%E6%BB%A4/#a-mysql","title":"A. \u6570\u636e\u5e93\u8bbe\u8ba1 (MySQL)","text":"<p>\u5efa\u7acb\u4e00\u5f20\u7b80\u5355\u7684\u8868\u6765\u7ef4\u62a4\u8bcd\u6761\u3002</p> \u5b57\u6bb5 \u7c7b\u578b \u8bf4\u660e id bigint \u4e3b\u952e word varchar \u654f\u611f\u8bcd\u5185\u5bb9 category varchar \u7c7b\u522b (\u6d89\u653f\u3001\u8272\u60c5\u3001\u66b4\u6050\u7b49) level int \u654f\u611f\u7ea7\u522b (1-\u62d2\u7edd, 2-\u4eba\u5de5\u5ba1\u6838) status int \u72b6\u6001 (0-\u542f\u7528, 1-\u7981\u7528)"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%95%8F%E6%84%9F%E8%AF%8D%E8%BF%87%E6%BB%A4/#b-rocketmq-redis","title":"B. \u5237\u65b0\u673a\u5236 (RocketMQ + Redis)","text":"<ol> <li> <p>\u540e\u53f0\u66f4\u65b0\uff1a \u7ba1\u7406\u5458\u5728\u540e\u53f0\u65b0\u589e\u4e00\u4e2a\u8bcd\u3002</p> </li> <li> <p>\u89e6\u53d1\u901a\u77e5\uff1a \u540e\u53f0\u66f4\u65b0 MySQL \u540e\uff0c\u5411 RocketMQ \u7684 <code>SENSITIVE_WORD_TOPIC</code> \u53d1\u9001\u4e00\u6761 \u5e7f\u64ad\u6d88\u606f (Broadcasting)\u3002</p> </li> <li> <p>\u8282\u70b9\u66f4\u65b0\uff1a \u6bcf\u4e2a\u5fae\u670d\u52a1\u5b9e\u4f8b\u76d1\u542c\u5230\u6d88\u606f\u540e\uff0c\u91cd\u65b0\u4ece\u6570\u636e\u5e93\u52a0\u8f7d\u6570\u636e\uff0c\u5e76\u5728\u5185\u5b58\u4e2d\u91cd\u5efa DFA \u6811\u3002</p> </li> </ol> <p>\u6ce8\u610f\uff1a \u4e5f\u53ef\u4ee5\u5728 Redis \u5b58\u4e00\u4e2a <code>last_update_time</code>\uff0c\u670d\u52a1\u542f\u52a8\u65f6\u5148\u5bf9\u6bd4\u7248\u672c\u3002</p>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%95%8F%E6%84%9F%E8%AF%8D%E8%BF%87%E6%BB%A4/#c-java","title":"C. \u6838\u5fc3\u4ee3\u7801\u903b\u8f91 (Java)","text":"<p>\u4f60\u53ef\u4ee5\u5c01\u88c5\u4e00\u4e2a <code>SensitiveWordProvider</code> \u7ec4\u4ef6\uff1a</p> <pre><code>@Component\npublic class SensitiveWordFilter {\n    // DFA \u6811\u6839\u8282\u70b9\n    private Map&lt;Object, Object&gt; nodes = new HashMap&lt;&gt;();\n\n    @PostConstruct\n    public void init() {\n        refresh(); // \u9879\u76ee\u542f\u52a8\u52a0\u8f7d\n    }\n\n    public synchronized void refresh() {\n        // 1. \u4ece\u6570\u636e\u5e93\u8bfb\u53d6\u6240\u6709\u6709\u6548\u654f\u611f\u8bcd\n        List&lt;String&gt; words = wordMapper.selectAllEnabled();\n        // 2. \u6784\u5efa\u65b0\u7684 DFA \u6811\n        Map&lt;Object, Object&gt; newNodes = new HashMap&lt;&gt;();\n        for (String word : words) {\n            addWord(newNodes, word);\n        }\n        // 3. \u5207\u6362\u5f15\u7528 (\u4fdd\u8bc1\u539f\u5b50\u6027)\n        this.nodes = newNodes;\n    }\n\n    private void addWord(Map&lt;Object, Object&gt; tree, String word) {\n        Map&lt;Object, Object&gt; current = tree;\n        for (char c : word.toCharArray()) {\n            current = (Map&lt;Object, Object&gt;) current.computeIfAbsent(c, k -&gt; new HashMap&lt;&gt;());\n        }\n        current.put(\"isEnd\", true);\n    }\n\n    public boolean contains(String text) {\n        // \u5b9e\u73b0 DFA \u67e5\u627e\u903b\u8f91...\n        return false;\n    }\n}\n</code></pre> <p>\u53cc\u91cd\u5faa\u73af\u8fc7\u6ee4\u903b\u8f91\uff1a</p> <pre><code>import java.util.HashSet;\nimport java.util.Map;\nimport java.util.Set;\n\npublic class SensitiveWordFilter {\n\n    private Map&lt;Object, Object&gt; nodes; // DFA \u6811\u6839\u8282\u70b9\n    private static final String END_FLAG = \"isEnd\"; // \u7ed3\u675f\u6807\u8bc6\n\n    /**\n     * \u5224\u65ad\u662f\u5426\u5305\u542b\u654f\u611f\u8bcd\n     * @param text \u5f85\u68c0\u6d4b\u6587\u672c\n     * @return true \u5305\u542b\n     */\n    public boolean contains(String text) {\n        if (text == null || text.isEmpty()) return false;\n\n        for (int i = 0; i &lt; text.length(); i++) {\n            // \u68c0\u67e5\u4ee5\u4f4d\u7f6e i \u5f00\u5934\u7684\u5b57\u7b26\u4e32\u662f\u5426\u5339\u914d\u654f\u611f\u8bcd\n            int matchLen = checkSensitive(text, i);\n            if (matchLen &gt; 0) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    /**\n     * \u83b7\u53d6\u6587\u672c\u4e2d\u51fa\u73b0\u7684\u6240\u6709\u654f\u611f\u8bcd\n     * @param text \u5f85\u68c0\u6d4b\u6587\u672c\n     * @return \u5339\u914d\u5230\u7684\u8bcd\u96c6\u5408\n     */\n    public Set&lt;String&gt; findAll(String text) {\n        Set&lt;String&gt; result = new HashSet&lt;&gt;();\n        for (int i = 0; i &lt; text.length(); i++) {\n            int length = checkSensitive(text, i);\n            if (length &gt; 0) {\n                result.add(text.substring(i, i + length));\n                // \u4f18\u5316\uff1ai \u76f4\u63a5\u8df3\u8fc7\u5df2\u5339\u914d\u8bcd\u7684\u957f\u5ea6\uff0c\u51cf\u5c11\u91cd\u590d\u8ba1\u7b97\n                i = i + length - 1; \n            }\n        }\n        return result;\n    }\n\n    /**\n     * \u68c0\u67e5\u4ece beginIndex \u5f00\u59cb\u662f\u5426\u662f\u654f\u611f\u8bcd\n     * @return \u5982\u679c\u5339\u914d\u6210\u529f\uff0c\u8fd4\u56de\u654f\u611f\u8bcd\u957f\u5ea6\uff1b\u5426\u5219\u8fd4\u56de 0\n     */\n    private int checkSensitive(String text, int beginIndex) {\n        Map&lt;Object, Object&gt; current = this.nodes;\n        int matchLen = 0;\n        boolean flag = false;\n\n        for (int i = beginIndex; i &lt; text.length(); i++) {\n            char c = text.charAt(i);\n\n            // 1. \u5728\u5f53\u524d\u5c42\u7ea7\u67e5\u627e\u5b57\u7b26\n            current = (Map&lt;Object, Object&gt;) current.get(c);\n\n            if (current != null) {\n                matchLen++;\n                // 2. \u68c0\u67e5\u662f\u5426\u662f\u8bcd\u7684\u7ed3\u5c3e\n                if (\"true\".equals(String.valueOf(current.get(END_FLAG)))) {\n                    flag = true; \n                    // \u8fd9\u91cc\u53ef\u4ee5\u6839\u636e\u9700\u6c42\u51b3\u5b9a\uff1a\u662f\u547d\u4e2d\u201c\u6700\u77ed\u201d\u654f\u611f\u8bcd\u5c31\u8fd4\u56de\uff0c\u8fd8\u662f\u627e\u201c\u6700\u957f\u201d\u7684\n                    // \u9ed8\u8ba4\u627e\u5230\u6700\u957f\u7684\uff0c\u6240\u4ee5\u7ee7\u7eed\u5faa\u73af\n                }\n            } else {\n                // 3. \u6ca1\u5339\u914d\u5230\uff0c\u8df3\u51fa\n                break;\n            }\n        }\n\n        return flag ? matchLen : 0;\n    }\n}\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%95%8F%E6%84%9F%E8%AF%8D%E8%BF%87%E6%BB%A4/#4","title":"4. \u73b0\u6210\u8f6e\u5b50\u63a8\u8350","text":"<p>\u5982\u679c\u4e0d\u60f3\u4ece\u96f6\u5b9e\u73b0 DFA \u6811\uff0c\u63a8\u8350\u76f4\u63a5\u96c6\u6210\u6210\u719f\u7684 Java \u5de5\u5177\u5305\uff1a</p> <ul> <li>Hutool-dfa: \u7b80\u5355\u6613\u7528\u3002</li> <li>sensitive-word: (GitHub \u4e0a\u5f88\u706b\u7684\u4e00\u4e2a\u5e93) \u652f\u6301\u62fc\u97f3\u68c0\u6d4b\u3001\u7e41\u7b80\u4f53\u8f6c\u6362\u3001\u8df3\u8bcd\u68c0\u6d4b\u7b49\u529f\u80fd\uff0c\u529f\u80fd\u975e\u5e38\u5168\u9762\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E6%95%8F%E6%84%9F%E8%AF%8D%E8%BF%87%E6%BB%A4/#5dfa","title":"5.\u672c\u5730\u6784\u5efaDFA\u6811\u793a\u4f8b","text":"<pre><code>package com.kyexpress.vts.finance.api.dto.baidu;\n\n\nimport com.kyexpress.framework.utils.JsonUtils;\n\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\npublic class Test {\n    // DFA \u6811\u6839\u8282\u70b9\n    private static Map&lt;Object, Object&gt; nodes = new HashMap&lt;&gt;();\n\n    public static void main(String[] args) {\n        String mingan = \"\u8fd9\u662f\u4e00\u4e32\u654f\u611f\u8bcd\";\n        refresh();\n        System.out.println(JsonUtils.deserializer(nodes));\n    }\n\n    private static void addWord(Map&lt;Object, Object&gt; nodes, String word) {\n        Map&lt;Object, Object&gt; current = nodes;\n        for (char c : word.toCharArray()) {\n            current = (Map&lt;Object, Object&gt;) current.computeIfAbsent(c, k -&gt; new HashMap&lt;&gt;());\n        }\n        current.put(\"isEnd\", true);\n    }\n\n    public static void refresh() {\n        // 1. \u4ece\u6570\u636e\u5e93\u8bfb\u53d6\u6240\u6709\u6709\u6548\u654f\u611f\u8bcd\n        List&lt;String&gt; words = new ArrayList&lt;&gt;();\n        words.add(\"\u654f\u611f\");\n        words.add(\"\u8bcd\u5e93\");\n        words.add(\"\u654f\u4e0d\u611f1\");\n        // 2. \u6784\u5efa\u65b0\u7684 DFA \u6811\n        Map&lt;Object, Object&gt; newNodes = new HashMap&lt;&gt;();\n        for (String word : words) {\n            addWord(newNodes, word);\n        }\n        nodes = newNodes;\n    }\n}\n</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E8%B4%B9%E7%94%A8%E9%A1%B9%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/","title":"\u8d39\u7528\u9879\u8ba1\u7b97\u7cfb\u7edf","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E8%B4%B9%E7%94%A8%E9%A1%B9%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_2","title":"\u7531\u6d45\u5165\u6df1","text":"<p>\u573a\u666f\uff1a\u6709\u4e00\u4e2a\u6bd4\u8f83\u590d\u6742\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u7cfb\u7edf\u5c5e\u4e8e\u7269\u6d41\u7cfb\u7edf\uff0c\u6709\u4e00\u7968\u8d27\u8ba2\u5355\uff0c\u8ba2\u5355\u5728\u627f\u8fd0\u8fc7\u7a0b\u4e2d\u4f1a\u56e0\u4e3a\u65f6\u6548\u6216\u8005\u76f8\u5173\u8fdd\u89c4\u7b49\u5f02\u5e38\u64cd\u4f5c\uff0c\u5728\u67d0\u4e00\u4e9b\u65f6\u95f4\u751f\u6210\u6263\u6b3e\u8d39\u7528\u9879\uff0c\u5e76\u4e14\u8d39\u7528\u9879\u9700\u8981\u7531\u4e1a\u52a1\u4eba\u5458\u540e\u53f0\u5ba1\u6838\uff0c\u53f8\u673a\u4e5f\u53ef\u4ee5\u7533\u8bc9\u3002\u8ba2\u5355\u91cf\u5927\u6982\u6708\u51e0\u5341\u4e07\u8ba2\u5355\uff0c\u652f\u6301\u7684\u8d39\u7528\u9879\u6709\u8fd1100\u4e2a\uff0c\u5404\u4e2a\u8d39\u7528\u9879\u8d70\u72ec\u7acb\u914d\u7f6e\u3002\u8fd0\u8f93\u8fc7\u7a0b\u7684\u57fa\u7840\u6570\u636e\u53ef\u80fd\u5b58\u5728\u5fae\u670d\u52a1\u7684\u591a\u4e2a\u5e93\u8868\u5185\uff0c\u8ba1\u7b97\u8d39\u7528\u9879\u9700\u8981\u53bb\u5404\u4e2a\u4e1a\u52a1\u7cfb\u7edf\u62ff\u8ba1\u7b97\u56e0\u5b50\uff0c\u5b9e\u65f6\u8ba1\u7b97\uff0c\u5e76\u4e14\u5ba1\u6279\u4eba\u5458\u4e5f\u9700\u8981\u770b\u8ba1\u7b97\u56e0\u5b50\u3002\u9700\u8981\u642d\u5efa\u4e00\u4e2a\u8d39\u7528\u9879\u7cfb\u7edf\uff0c\u5fae\u670d\u52a1\u6846\u67b6\uff0c\u6709\u4e00\u5f20\u5e94\u4ed8\u6c47\u603b\u8ba2\u5355\u4e3b\u8868\uff0c\u6240\u6709\u7684\u8d39\u7528\u9879\u90fd\u4f1a\u6302\u5728\u5e94\u4ed8\u8ba2\u5355\u4e0a\uff0c\u5ba1\u6279\u5b8c\u589e\u51cf\u7684\u8d39\u7528\u9879\uff0c\u4f1a\u6709\u4ed8\u7ed9\u53f8\u673a\u7684\u603b\u8d39\u7528\uff0c\u7531\u8ba2\u5355\u4e00\u7b14\u7b14\u652f\u4ed8\u3002\u5e2e\u6211\u8bbe\u8ba1\u660e\u786e\u7684\u5e93\u8868\u8bbe\u8ba1\uff0c\u670d\u52a1\u67b6\u6784\u91c7\u7528springboot\u5fae\u670d\u52a1\uff0crocketMQ\uff0credis\uff0c\u6570\u636e\u5e93\u4ec5\u4ec5\u6709MYSQL\u3002\u6211\u5e0c\u671b\u7684\u662f\u6709\u4e00\u5f20\u8ba1\u7b97\u56e0\u5b50\u5b58\u50a8\u8868\uff0c\u6709\u8d39\u7528\u9879\u8bb0\u5f55\u8868\uff0c\u6709\u5de5\u5355\u8868\u7b49\u5173\u952e\u4fe1\u606f\u8bb0\u5f55</p> \u65b9\u6848 \u6838\u5fc3\u601d\u60f3 \u4f18\u52bf \u52a3\u52bf \u9002\u7528\u573a\u666f 1. SpEL\u8868\u8fbe\u5f0f \u52a8\u6001\u89e3\u6790\u5b57\u7b26\u4e32\u516c\u5f0f \u6781\u5176\u8f7b\u91cf\uff1b\u65e0\u9700\u505c\u673a\u5373\u53ef\u4fee\u6539\u6570\u5b66\u516c\u5f0f\u3002 \u96be\u4ee5\u5904\u7406\u903b\u8f91\u5206\u652f\uff08If-Else\uff09\uff1b\u6709\u6ce8\u5165\u98ce\u9669\uff1b\u8c03\u8bd5\u56f0\u96be\u3002 \u7b80\u5355\u7684\u52a0\u51cf\u4e58\u9664\uff08\u5982\uff1a\u5355\u4ef7 \u00d7 \u6570\u91cf\uff09\u3002 2. \u7b56\u7565\u6a21\u5f0f + \u914d\u7f6e Java\u7c7b\u786c\u7f16\u7801\u4e1a\u52a1\u903b\u8f91 \u6027\u80fd\u6700\u9ad8\uff1b\u5229\u7528Java\u5168\u7279\u6027\u5904\u7406\u6781\u590d\u6742\u903b\u8f91\uff1b\u6613\u4e8e\u8c03\u8bd5\u3002 \u7c7b\u6570\u91cf\u968f\u4e1a\u52a1\u7206\u70b8\u589e\u957f\uff08N * M\uff09\uff1b\u903b\u8f91\u53d8\u66f4\u9700\u53d1\u5e03\u4ee3\u7801\u3002 \u4e1a\u52a1\u7ebf\u5c11\u3001\u8d39\u7528\u9879\u56fa\u5b9a\u3001\u903b\u8f91\u6781\u5176\u590d\u6742\u7684\u573a\u666f\u3002 3. \u539f\u5b50\u7b97\u5b50\u6ce8\u518c\u4e2d\u5fc3 \u903b\u8f91\u788e\u7247\u5316\u3001\u914d\u7f6e\u5316\u7f16\u6392 \u6d88\u9664\u91cd\u590d\u4ee3\u7801\uff1b\u652f\u6301\u4e1a\u52a1\u7ebf\u5feb\u901f\u6a2a\u5411\u6269\u5c55\uff1b\u914d\u7f6e\u5373\u5f00\u53d1\u3002 \u67b6\u6784\u8bbe\u8ba1\u6210\u672c\u9ad8\uff1bJSON\u7f16\u6392\u94fe\u8def\u957f\u65f6\uff0c\u6027\u80fd\u6709\u8f7b\u5fae\u635f\u8017\u3002 \u63a8\u8350\u65b9\u6848\u3002\u591a\u4e1a\u52a1\u7ebf\u3001\u591a\u8d39\u7528\u9879\u3001\u903b\u8f91\u9ad8\u5ea6\u91cd\u53e0\u3002 4. Drools\u89c4\u5219\u5f15\u64ce \u58f0\u660e\u5f0f\u89c4\u5219\u4e0e\u63a8\u7406 \u4e1a\u52a1\u903b\u8f91\u4e0e\u4ee3\u7801\u5f7b\u5e95\u5206\u79bb\uff1b\u652f\u6301\u70ed\u52a0\u8f7d\uff1b\u81ea\u52a8\u5904\u7406\u51b2\u7a81\u3002 \u5b66\u4e60\u66f2\u7ebf\u9661\u5ced\uff1b\u9ed1\u76d2\u6267\u884c\u96be\u4ee5\u6392\u67e5\uff1b\u7ef4\u62a4\u6210\u672c\u6781\u9ad8\u3002 \u89c4\u5219\u5b58\u5728\u5927\u91cf\u4ea4\u53c9\u3001\u4f18\u5148\u7ea7\u5224\u65ad\u4e14\u7531\u4e1a\u52a1\u4eba\u5458\u7ef4\u62a4\u3002"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E8%B4%B9%E7%94%A8%E9%A1%B9%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_3","title":"\u6df1\u5ea6\u5229\u5f0a\u5206\u6790","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E8%B4%B9%E7%94%A8%E9%A1%B9%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#spel","title":"\u65b9\u6848\u4e00\uff1aSpEL \u8868\u8fbe\u5f0f\uff08\u8f7b\u91cf\u7ea7\u52a8\u6001\u8ba1\u7b97\uff09","text":"<ul> <li>\u5229\uff1a\u901a\u8fc7\u6570\u636e\u5e93\u5b58\u50a8\u5b57\u7b26\u4e32\u516c\u5f0f\uff0c\u5b9e\u73b0\u201c\u96f6\u4ee3\u7801\u201d\u8c03\u6574\u8ba1\u8d39\u5355\u4ef7\u6216\u7b80\u5355\u6298\u6263\u3002</li> <li>\u5f0a\uff1a\u5f53\u6d89\u53ca\u201c\u53d6\u591a\u4e2a\u65f6\u95f4\u7684\u6700\u65e9\u503c\u201d\u8fd9\u79cd\u903b\u8f91\u5224\u65ad\u65f6\uff0cSpEL\u4f1a\u53d8\u5f97\u81c3\u80bf\u4e0d\u582a\uff0c\u4e14\u4e00\u65e6\u516c\u5f0f\u5199\u9519\uff0c\u53ea\u80fd\u5728\u8fd0\u884c\u65f6\u629b\u51fa\u5f02\u5e38\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E8%B4%B9%E7%94%A8%E9%A1%B9%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_4","title":"\u65b9\u6848\u4e8c\uff1a\u7b56\u7565\u6a21\u5f0f + \u89c4\u5219\u914d\u7f6e\uff08\u5de5\u4e1a\u7ea7\u7a33\u5065\uff09","text":"<ul> <li>\u5229\uff1a\u6bcf\u4e00\u4e2a\u8d39\u7528\u9879\u90fd\u662f\u4e00\u4e2a\u72ec\u7acb\u7684 Java \u7c7b\uff0c\u652f\u6301\u590d\u6742\u7684\u6570\u636e\u5e93\u67e5\u8be2\u3001\u591a\u7cfb\u7edf\u4ea4\u4e92\u3002</li> <li>\u5f0a\uff1a\u9488\u5bf9 7 \u4e2a\u4e1a\u52a1\u7ebf\u548c 100 \u4e2a\u8d39\u7528\u9879\uff0c\u5982\u679c\u4f60\u4e0d\u8fdb\u884c\u62bd\u8c61\uff0c\u6700\u7ec8\u4f1a\u7ef4\u62a4\u4e0a\u767e\u4e2a\u7b56\u7565\u7c7b\uff0c\u4ee3\u7801\u5197\u4f59\u5ea6\u6781\u9ad8\uff0c\u7ef4\u62a4\u6210\u672c\u968f\u4e1a\u52a1\u7ebf\u589e\u957f\u5448\u7ebf\u6027\u4e0a\u5347\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E8%B4%B9%E7%94%A8%E9%A1%B9%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_5","title":"\u65b9\u6848\u4e09\uff1a\u539f\u5b50\u7b97\u5b50\u6ce8\u518c\u4e2d\u5fc3\uff08\u67b6\u6784\u5e08\u9996\u9009\uff09","text":"<ul> <li>\u5229\uff1a\u901a\u8fc7\u201c\u9002\u914d\u5668\u201d\u7edf\u4e00\u56e0\u5b50\uff0c\u5c06\u903b\u8f91\u62c6\u89e3\u4e3a\u201c\u6bd4\u5bf9\u3001\u8ba1\u7b97\u3001\u8fc7\u6ee4\u3001\u5c01\u9876\u201d\u7b49\u539f\u5b50\uff0c\u901a\u8fc7 JSON \u52a8\u6001\u62fc\u88c5\u903b\u8f91\u94fe\u8def\u3002\u5b83\u517c\u987e\u4e86\u5f00\u53d1\u7684\u7075\u6d3b\u6027\u4e0e\u4ee3\u7801\u7684\u53ef\u7ef4\u62a4\u6027\u3002</li> <li>\u5f0a\uff1a\u9700\u8981\u5f00\u53d1\u4e00\u5957\u6210\u719f\u7684\u201c\u7b97\u5b50\u6267\u884c\u5f15\u64ce\u201d\uff0c\u521d\u671f\u6295\u5165\u8f83\u5927\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E8%B4%B9%E7%94%A8%E9%A1%B9%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#drools","title":"\u65b9\u6848\u56db\uff1aDrools \u89c4\u5219\u5f15\u64ce\uff08\u9886\u57df\u4e13\u5bb6\u7ea7\uff09","text":"<ul> <li>\u5229\uff1a\u5b83\u80fd\u5904\u7406\u201c\u5982\u679c A \u6ee1\u8db3\u4e14 B \u4e0d\u6ee1\u8db3\uff0c\u5219\u6267\u884c C\uff0c\u4f46\u5982\u679c D \u5b58\u5728\u5219\u8986\u76d6 C\u201d\u8fd9\u79cd\u6781\u5ea6\u7ea0\u7f20\u7684\u89c4\u5219\u3002</li> <li>\u5f0a\uff1a\u5bf9\u4e8e\u7269\u6d41\u7ed3\u7b97\u800c\u8a00\uff0c\u5f80\u5f80\u903b\u8f91\u662f\u7ebf\u6027\u7684\uff0c\u4f7f\u7528 Drools \u6709\u201c\u6740\u9e21\u7528\u725b\u5200\u201d\u4e4b\u5acc\uff0c\u4e14\u56e2\u961f\u4e2d\u82e5\u65e0 Drools \u4e13\u5bb6\uff0c\u540e\u7eed\u89c4\u5219\u6392\u67e5\u5c06\u6210\u4e3a\u707e\u96be\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E8%B4%B9%E7%94%A8%E9%A1%B9%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_6","title":"\u6700\u7ec8\u5efa\u8bae\uff1a\u6df7\u5408\u52a8\u529b\u65b9\u6848","text":"<p>\u5bf9\u4e8e\u4f60\u76ee\u524d\u7684\u7269\u6d41\u7cfb\u7edf\uff087\u4e1a\u52a1\u7ebf\u3001100\u8d39\u7528\u9879\uff09\uff0c\u6211\u4e0d\u5efa\u8bae\u5b64\u7acb\u5730\u9009\u62e9\u67d0\u79cd\u6a21\u5f0f\uff0c\u800c\u662f\u91c7\u7528\u201c\u7ec4\u5408\u62f3\u201d\uff1a</p> <ol> <li>\u57fa\u7840\u5c42\uff1a\u91c7\u7528\u65b9\u6848\u4e09\uff08\u539f\u5b50\u7b97\u5b50\u4e2d\u5fc3\uff09\uff0c\u5c06\u65f6\u95f4\u6bd4\u5bf9\u3001\u8f66\u957f\u8fc7\u6ee4\u3001\u4e0a\u9650\u63a7\u5236\u7b49\u505a\u6210\u6807\u51c6\u5316\u7b97\u5b50\u3002</li> <li>\u8fd0\u7b97\u5c42\uff1a\u5728\u539f\u5b50\u7b97\u5b50\u91cc\u5d4c\u5957\u65b9\u6848\u4e00\uff08SpEL\uff09\uff0c\u5904\u7406\u6700\u540e\u7684\u91d1\u989d\u8ba1\u7b97\u516c\u5f0f\u3002</li> <li>\u63a5\u5165\u5c42\uff1a\u9488\u5bf9 7 \u4e2a\u4e1a\u52a1\u7ebf\uff0c\u5229\u7528\u9002\u914d\u5668\u6a21\u5f0f\u5f52\u4e00\u5316\u8ba1\u7b97\u56e0\u5b50\uff0c\u786e\u4fdd\u540c\u4e00\u5957\u7b97\u5b50\u80fd\u8dd1\u5728\u4e0d\u540c\u4e1a\u52a1\u7ebf\u4e0a\u3002</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E8%B4%B9%E7%94%A8%E9%A1%B9%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_7","title":"\u515c\u5e95\u65b9\u6848","text":"<p>\u5728\u4efb\u4f55\u6d89\u53ca\u91d1\u94b1\u8ba1\u7b97\u7684\u7cfb\u7edf\u4e2d\uff0c\u5fc5\u987b\u8bbe\u8ba1\u4ee5\u4e0b\u4e09\u5c42\u9694\u79bb\u515c\u5e95\uff1a</p> <ul> <li>\u7b2c\u4e00\u5c42\uff1a\u6570\u636e\u955c\u50cf\uff08Snapshot\uff09\u3002\u8ba1\u7b97\u8d39\u7528\u65f6\uff0c\u5fc5\u987b\u5c06\u5f53\u65f6\u7684\u8ba1\u7b97\u56e0\u5b50\uff08\u5982\u91cc\u7a0b\u3001\u8f66\u957f\u3001\u914d\u7f6e\u53c2\u6570\uff09\u955c\u50cf\u5b58\u50a8\u3002\u5373\u4f7f\u89c4\u5219\u53d8\u4e86\uff0c\u4e5f\u80fd\u6839\u636e\u955c\u50cf\u91cd\u73b0\u5f53\u65f6\u7684\u8ba1\u7b97\u8fc7\u7a0b\u3002</li> <li>\u7b2c\u4e8c\u5c42\uff1a\u624b\u52a8\u5e72\u9884\u95e8\u63a7\u3002\u5bf9\u4e8e\u8ba1\u7b97\u5931\u8d25\u6216\u8ba1\u7b97\u7ed3\u679c\u89e6\u53d1\u201c\u5f02\u5e38\u6ce2\u52a8\uff08\u5982\u91d1\u989d\u8d85\u8fc7\u5386\u53f2\u5747\u503c3\u500d\uff09\u201d\u7684\u8ba2\u5355\uff0c\u7cfb\u7edf\u81ea\u52a8\u6302\u8d77\uff0c\u8f6c\u4e3a\u4eba\u5de5\u5ba1\u6838\uff0c\u9632\u6b62\u5927\u89c4\u6a21\u8d44\u635f\u3002</li> <li>\u7b2c\u4e09\u5c42\uff1a\u7070\u5ea6\u5f71\u5b50\u8ba1\u7b97\u3002\u65b0\u89c4\u5219\u4e0a\u7ebf\u524d\uff0c\u5728\u751f\u4ea7\u73af\u5883\u540e\u53f0\u9759\u9ed8\u8fd0\u884c\uff08\u53ea\u8ba1\u7b97\u4e0d\u5165\u5e93\uff09\uff0c\u5bf9\u6bd4\u65b0\u8001\u89c4\u5219\u4ea7\u751f\u7684\u8d39\u7528\u5dee\u5f02\uff0c\u786e\u8ba4\u65e0\u8bef\u540e\u518d\u5168\u91cf\u5207\u6362\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E8%B4%B9%E7%94%A8%E9%A1%B9%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_8","title":"\u539f\u5b50\u7b97\u5b50\u6ce8\u518c\u4e2d\u5fc3\u8bbe\u8ba1","text":"<pre><code>erDiagram\n    BUSINESS_LINE ||--o{ FEE_ITEM_CONFIG : \"\u62e5\u6709\"\n    FEE_ITEM_CONFIG ||--|| RULE_CHAIN : \"\u5173\u8054\"\n    RULE_CHAIN ||--|{ RULE_NODE : \"\u5305\u542b\"\n    OPERATOR ||--o{ RULE_NODE : \"\u88ab\u5b9e\u4f8b\u5316\"\n\n    BUSINESS_LINE {\n        string line_code PK \"\u4e1a\u52a1\u7ebf\u4ee3\u7801(\u6574\u8f66/\u5e72\u7ebf\u7b49)\"\n        string line_name \"\u4e1a\u52a1\u7ebf\u540d\u79f0\"\n    }\n\n    FEE_ITEM_CONFIG {\n        bigint id PK\n        string fee_code \"\u8d39\u7528\u9879\u7f16\u7801(\u5982:\u8d85\u65f6\u8d39)\"\n        string line_code FK \"\u6240\u5c5e\u4e1a\u52a1\u7ebf\"\n        bigint chain_id FK \"\u7ed1\u5b9a\u7684\u89c4\u5219\u94feID\"\n        int status \"1-\u751f\u6548, 0-\u5931\u6548\"\n    }\n\n    RULE_CHAIN {\n        bigint id PK\n        string chain_name \"\u94fe\u540d\u79f0\"\n        string version \"\u7248\u672c\u53f7(\u7528\u4e8e\u7070\u5ea6/\u56de\u6eaf)\"\n    }\n\n    RULE_NODE {\n        bigint id PK\n        bigint chain_id FK \"\u6240\u5c5e\u94fe\"\n        string op_code FK \"\u7b97\u5b50\u7f16\u7801\"\n        int node_order \"\u6267\u884c\u987a\u5e8f\"\n        string params_json \"\u7b97\u5b50\u79c1\u6709\u914d\u7f6e(\u5982: \u9608\u503c\u3001\u6bd4\u7387)\"\n    }\n\n    OPERATOR {\n        string op_code PK \"\u7b97\u5b50\u552f\u4e00\u6807\u8bc6\"\n        string op_name \"\u7b97\u5b50\u540d\u79f0\"\n        string bean_name \"Spring Bean ID\"\n        string input_schema \"\u671f\u671b\u8f93\u5165\u56e0\u5b50\u5b9a\u4e49(JSON)\"\n    }</code></pre>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E8%B4%B9%E7%94%A8%E9%A1%B9%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_9","title":"\u4e8c\u3001 \u5173\u952e\u6570\u636e\u8868\u8be6\u8ff0","text":""},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E8%B4%B9%E7%94%A8%E9%A1%B9%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#1-rule_node","title":"1. \u89c4\u5219\u8282\u70b9\u8868 (<code>rule_node</code>) \u2014\u2014 \u4e1a\u52a1\u903b\u8f91\u7684\u201c\u7ec4\u88c5\u673a\u201d","text":"<p>\u8fd9\u662f\u6700\u6838\u5fc3\u7684\u8868\u3002\u5b83\u5c06\u901a\u7528\u7684\u7b97\u5b50\uff08Operator\uff09\u5728\u7279\u5b9a\u4e1a\u52a1\u573a\u666f\u4e0b\u8fdb\u884c\u201c\u53c2\u6570\u5316\u201d\u3002</p> <ul> <li><code>params_json</code> \u7684\u5999\u7528\uff1a\u6bd4\u5982\u4e00\u4e2a\u901a\u7528\u7684\u201c\u9650\u989d\u7b97\u5b50\uff08LIMIT_OP\uff09\u201d\uff0c\u5728\u4e1a\u52a1\u7ebf A \u7684\u914d\u7f6e\u662f <code>{\"max\": 500}</code>\uff0c\u800c\u5728\u4e1a\u52a1\u7ebf B \u662f <code>{\"max\": 1000}</code>\u3002\u540c\u4e00\u5957\u4ee3\u7801\uff0c\u4e0d\u540c\u7684\u914d\u7f6e\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E8%B4%B9%E7%94%A8%E9%A1%B9%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#2-factor_mapping-7","title":"2. \u56e0\u5b50\u6620\u5c04\u8868 (<code>factor_mapping</code>) \u2014\u2014 \u89e3\u51b3 7 \u6761\u4e1a\u52a1\u7ebf\u5dee\u5f02","text":"<p>\u4e3a\u4e86\u4e0d\u8ba9\u7b97\u5b50\u4ee3\u7801\u91cc\u51fa\u73b0 <code>if(line == '\u6574\u8f66')</code> \u8fd9\u79cd\u5783\u573e\u4ee3\u7801\uff0c\u6211\u4eec\u9700\u8981\u4e00\u5c42\u9002\u914d\uff1a</p> <ul> <li>\u5b57\u6bb5\u8bbe\u8ba1\uff1a<code>line_code</code>, <code>standard_factor_name</code>, <code>source_field_path</code></li> <li>\u903b\u8f91\uff1a\u5c06\u4e1a\u52a1\u7ebf A \u4f20\u6765\u7684 <code>truck_mileage</code> \u7edf\u4e00\u6620\u5c04\u4e3a\u6807\u51c6\u56e0\u5b50 <code>distance</code>\u3002\u7b97\u5b50\u53ea\u8ba4 <code>distance</code>\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E8%B4%B9%E7%94%A8%E9%A1%B9%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#3-fee_calc_snapshot","title":"3. \u8ba1\u7b97\u5feb\u7167\u8868 (<code>fee_calc_snapshot</code>) \u2014\u2014 \u5ba1\u8ba1\u4e0e\u8ffd\u6eaf","text":"<ul> <li>\u5b57\u6bb5\u8bbe\u8ba1\uff1a<code>order_id</code>, <code>fee_item_id</code>, <code>calc_result</code>, <code>full_context_json</code>, <code>rule_version_snapshot</code></li> <li>\u4f5c\u7528\uff1a\u8bb0\u5f55\u6bcf\u4e00\u7b14\u94b1\u662f\u600e\u4e48\u7b97\u51fa\u6765\u7684\u3002<code>full_context_json</code> \u5b58\u50a8\u5f53\u65f6\u6240\u6709\u7684\u8f93\u5165\u56e0\u5b50\u548c\u4e2d\u95f4\u53d8\u91cf\uff0c\u54ea\u6015\u4ee5\u540e\u89c4\u5219\u6539\u4e86\uff0c\u8d22\u52a1\u5ba1\u8ba1\u65f6\u4e5f\u80fd\u539f\u6837\u8fd8\u539f\u3002</li> </ul>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E8%B4%B9%E7%94%A8%E9%A1%B9%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#_10","title":"\u4e09\u3001 \u67b6\u6784\u63a8\u5bfc\u903b\u8f91","text":"<ol> <li>\u89e3\u51b3 N * M \u7206\u70b8\uff1a</li> <li>\u65b0\u589e\u4e1a\u52a1\u7ebf\u65f6\uff0c\u53ea\u9700\u5728 <code>BUSINESS_LINE</code> \u52a0\u4e00\u884c\uff0c\u5e76\u914d\u7f6e\u5bf9\u5e94\u7684 <code>FEE_ITEM_CONFIG</code>\u3002</li> <li>\u5982\u679c\u8ba1\u7b97\u903b\u8f91\u7c7b\u4f3c\uff0c\u76f4\u63a5\u590d\u7528\u73b0\u6709\u7684 <code>RULE_CHAIN</code>\uff1b\u5982\u679c\u903b\u8f91\u7565\u6709\u4e0d\u540c\uff0c\u53ea\u9700\u5728 <code>RULE_NODE</code> \u91cc\u8c03\u6574\u987a\u5e8f\u6216\u4fee\u6539 <code>params_json</code>\u3002</li> <li>\u6781\u9ad8\u7684\u6b63\u4ea4\u6027\uff1a</li> <li>\u5f00\u53d1\u4eba\u5458\uff1a\u53ea\u8d1f\u8d23\u5f00\u53d1\u9ad8\u5185\u805a\u7684 <code>OPERATOR</code>\uff08\u7b97\u5b50\uff09\u3002</li> <li>\u4e1a\u52a1/\u8fd0\u7ef4\u4eba\u5458\uff1a\u8d1f\u8d23\u5728\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u7f16\u6392 <code>RULE_NODE</code>\uff08\u89c4\u5219\u8282\u70b9\uff09\u3002</li> </ol>"},{"location":"%E6%96%B9%E6%A1%88/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88/%E8%B4%B9%E7%94%A8%E9%A1%B9%E8%AE%A1%E7%AE%97%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/#fail-safe-plan","title":"\u56db\u3001 \u515c\u5e95\u65b9\u6848 (Fail-safe Plan)","text":"<p>\u9762\u5bf9\u8fd9\u79cd\u9ad8\u5ea6\u914d\u7f6e\u5316\u7684\u7cfb\u7edf\uff0c\u6700\u6015\u7684\u662f\u201c\u914d\u7f6e\u9519\u8bef\u5bfc\u81f4\u5168\u7ebf\u5d29\u76d8\u201d\u3002</p> <ul> <li>\u914d\u7f6e\u9a8c\u8bc1\u673a\u5236\uff1a\u5728\u4fdd\u5b58 <code>RULE_CHAIN</code> \u65f6\uff0c\u7cfb\u7edf\u5fc5\u987b\u81ea\u52a8\u8fdb\u884c\u201c\u7a7a\u8dd1\u6d4b\u8bd5\u201d\u3002\u5229\u7528\u9884\u8bbe\u7684\u6d4b\u8bd5\u7528\u4f8b\uff08Test Case\uff09\u8dd1\u4e00\u904d\u8ba1\u7b97\u94fe\u8def\uff0c\u7ed3\u679c\u7b26\u5408\u9884\u671f\u624d\u5141\u8bb8\u53d1\u5e03\u3002</li> <li>\u8f6f\u5220\u9664\u4e0e\u7248\u672c\u63a7\u5236\uff1a\u6240\u6709\u7684\u89c4\u5219\u53d8\u66f4\u4e0d\u76f4\u63a5 <code>UPDATE</code>\uff0c\u800c\u662f\u751f\u6210\u65b0\u7684 <code>version</code>\u3002\u5982\u679c\u65b0\u7248\u672c\u4e0a\u7ebf\u540e\u53d1\u73b0\u5f02\u5e38\uff0c\u4e00\u952e\u5c06 <code>FEE_ITEM_CONFIG</code> \u91cc\u7684 <code>chain_id</code> \u6307\u5411\u56de\u65e7\u7248\u672c\u3002</li> <li>\u811a\u672c\u964d\u7ea7\uff1a\u5982\u679c\u7b97\u5b50\u4e2d\u5fc3\u56e0\u4e3a Redis \u6216\u590d\u6742\u7f16\u6392\u5bfc\u81f4\u6027\u80fd\u74f6\u9888\uff0c\u7cfb\u7edf\u5e94\u652f\u6301\u9488\u5bf9\u7279\u5b9a\u4e1a\u52a1\u7ebf\u5f00\u542f\u201c\u786c\u7f16\u7801\u7b56\u7565\u6a21\u5f0f\u201d\u4f5c\u4e3a\u7d27\u6025\u66ff\u4ee3\u65b9\u6848\u3002</li> </ul>"},{"location":"%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/QPS%E6%A6%82%E5%BF%B5/","title":"QPS\u6982\u5ff5","text":"<p>QPS\uff08Queries Per Second\uff0c\u6bcf\u79d2\u67e5\u8be2\u7387\uff09\u662f\u8bc4\u4f30\u7cfb\u7edf\u6027\u80fd\u7684\u6838\u5fc3\u6307\u6807</p>"},{"location":"%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/QPS%E6%A6%82%E5%BF%B5/#_1","title":"\u5206\u6790","text":"<ol> <li>\u57fa\u7840\u8ba1\u7b97\u516c\u5f0f</li> </ol> <p>QPS = \u603b\u8bf7\u6c42\u6570/\u603b\u65f6\u95f4\uff08\u79d2\uff09</p> <ol> <li>\u9002\u7528\uff1a\u5df2\u77e5\u5177\u4f53\u8bf7\u6c42\u91cf\u548c\u573a\u666f</li> <li>\u4e3e\u4f8b\uff1a\u5982\u679c\u4e00\u4e2a\u63a5\u53e310s\u5185\u6536\u5230\u4e861000\u4e2a\u8bf7\u6c42\uff0c\u90a3\u4e48\u63a5\u53e3QPS=1000/10=100</li> <li> <p>\u573a\u666f\uff1a\u7edf\u8ba1\u5df2\u4ea7\u751f\u7684\u5386\u53f2\u6570\u636e</p> </li> <li> <p>\u6027\u80fd\u63a8\u5bfc\u516c\u5f0f</p> </li> </ol> <p>QPS = \u5e76\u53d1\u6570/\u5e73\u5747\u54cd\u5e94\u65f6\u95f4\uff08\u79d2\uff09</p> <ol> <li>\u9002\u7528\uff1a\u7cfb\u7edf\u8bbe\u8ba1\u548c\u538b\u6d4b\u4e2d\uff0c\u8fd9\u4e2a\u7cfb\u7edf\u5cf0\u503c\u66f4\u6709\u53c2\u8003\u610f\u4e49</li> <li>\u4e3e\u4f8b\uff1a\u5982\u679c\u67091000\u4e2a\u5e76\u53d1\u7ebf\u7a0b\uff0c\u6bcf\u4e2a\u8bf7\u6c42\u5904\u7406200ms\uff0c\u90a3\u4e48\u7406\u8bba\u5cf0\u503cQPS=1000/0.2=5000</li> <li> <p>\u573a\u666f\uff1a\u538b\u6d4b\u8bc4\u4f30\u3001\u7cfb\u7edf\u8c03\u4f18</p> </li> <li> <p>\u5b9e\u9645\u4e1a\u52a1\u8ba1\u7b97\u516c\u5f0f</p> </li> </ol> <p>QPS = (\u65e5\u603b\u8bf7\u6c42\u91cfx80%)/(\u65e5\u603b\u79d2\u6570x20%)</p> <ol> <li>\u9002\u7528\uff1a\u5b9e\u9645\u4e1a\u52a1\u573a\u666f\u4e2d\uff0c\u4e0d\u80fd\u53ea\u770b\u5747\u503c\uff0c\u5fc5\u987b\u8003\u8651\u5cf0\u503c\u6d41\u91cf\uff0c\u6240\u4ee5\u7535\u5546/\u793e\u4ea4\u9886\u57df\u5e38\u7528\u7684\u7ecf\u9a8c\u6cd5\u5219\u4e3a\u4e8c\u516b\u5b9a\u5f8b\uff1a\u537380%\u7684\u8bf7\u6c42\u96c6\u4e2d\u572820%\u7684\u65f6\u95f4\u5185</li> <li>\u4e3e\u4f8b\uff1a\u5168\u5929100\u4e07\u6b21\u8bf7\u6c42\uff0c\u6709\u6548\u65f6\u95f424\u5c0f\u65f6=24x3600=86400\u79d2\u3002\u90a3\u4e48\u5cf0\u503cQPS=(1000000x0.8)/(86400x0.2)=800000/17280=46.3</li> <li> <p>\u573a\u666f\uff1a\u9488\u5bf9\u65b0\u529f\u80fd\u4e0a\u7ebf\u7684\u8d44\u6e90\u50a8\u5907\u65b9\u6848</p> </li> <li> <p>\u5f71\u54cdQPS\u7684\u5173\u952e\u56e0\u7d20</p> </li> <li> <p>\u786c\u4ef6\u8d44\u6e90\uff1aCPU\u6838\u5fc3\u6570\uff0c\u5185\u5b58\u5bbd\u5e26\uff0c\u78c1\u76d8I/O\u901f\u5ea6</p> </li> <li>\u4ee3\u7801\u6548\u7387\uff1a\u7b97\u6cd5\u590d\u6742\u5ea6\uff0c\u662f\u5426\u5f02\u6b65\u5904\u7406\u7b49</li> <li>\u5916\u90e8\u4f9d\u8d56\uff1a\u6570\u636e\u5e93\u67e5\u8be2\u6548\u7387\u3001\u7f13\u5b58\u547d\u4e2d\u7387\u3001\u7b2c\u4e09\u65b9\u63a5\u53e3\u7684\u54cd\u5e94\u7b49</li> <li>\u7f51\u7edc\u5e26\u5bbd\uff1a\u5927\u6570\u636e\u91cf\u4f20\u8f93\u65f6\uff0c\u7f51\u7edc\u5e26\u5bbd\u53ef\u80fd\u6210\u4e3a\u74f6\u9888</li> </ol> <p>\u7531\u4e0a\u9762\u7684\u5173\u952e\u56e0\u7d20\uff0c\u4f18\u5316\u65b9\u5411\u4f18\u5148\u7ea7\u5e94\u8be5\u662f\uff0c4--&gt;3--&gt;2--&gt;1\u3002\u5c3d\u91cf\u4e0d\u4f7f\u7528\u5927\u6570\u636e\u91cf\u7f51\u7edc\u4f20\u8f93\uff1b\u6570\u636e\u5e93\u67e5\u8be2\u7d22\u5f15\u4f18\u5316\uff0c\u4f7f\u7528\u4e2d\u95f4\u4ef6\u7f13\u5b58\uff0c\u7b2c\u4e09\u65b9\u63a5\u53e3\u662f\u5426\u53ef\u4ee5\u5f02\u6b65\uff1b\u4ee3\u7801\u4f18\u5316\uff0c\u7cbe\u7b80\u67e5\u8be2\uff1b\u786c\u4ef6\u5347\u7ea7</p>"},{"location":"%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/QPS%E6%A6%82%E5%BF%B5/#_2","title":"\u5177\u4f53\u573a\u666f","text":"<p>\u9700\u6c42\uff1a\u63d0\u4f9b\u4e00\u4e2aAPI\uff0c\u65e5\u8c03\u7528\u91cf\u5927\u6982\u4e24\u5343\u4e07\u6b21\uff0c\u4e0a\u53489\u70b9-12\u70b9\uff0c14\u70b9\u523020\u70b9\u4e3a\u4e1a\u52a1\u9ad8\u5cf0\uff0c\u4f30\u7b97\u5bb9\u91cf</p> <p>\u89e3\u51b3\uff1a</p> <ol> <li> <p>\u6838\u5fc3\u6570\u636e\u62c6\u89e3</p> </li> <li> <p>\u65e5\u603b\u8bf7\u6c42\u91cf\uff1a20000000\uff082000\u4e07\uff09</p> </li> <li> <p>\u4e1a\u52a1\u9ad8\u5cf0\u671f\uff1a9\u5c0f\u65f6=32400\u79d2</p> <ol> <li>\u4e0a\u53489-12\uff0c3\u5c0f\u65f6</li> <li>\u4e0b\u534814-20\uff0c6\u5c0f\u65f6</li> </ol> </li> <li> <p>QPS\u68af\u5ea6\u8ba1\u7b97</p> </li> </ol> <p>A. \u7406\u8bba\u5e73\u5747QPS\uff1a\u4e0d\u8003\u8651\u5cf0\u503c\uff0c\u5168\u5929\u5747\u5206\u5e03\u7684\u60c5\u51b5\uff1a20000000/86400=231</p> <p>B. \u4e1a\u52a1\u9ad8\u5cf0\u5e73\u5747QPS\uff08\u57fa\u4e8e\u4e8c\u516b\u5b9a\u5f8b\uff09\uff1a\u5047\u8bbe80%\uff081600\u4e07\uff09\u7684\u8bf7\u6c42\u96c6\u4e2d\u57289\u4e2a\u5c0f\u65f6\u4e1a\u52a1\u9ad8\u5cf0\u671f\u5185\uff0c(20000000x0.8)/32400=494</p> <p>C. \u7cfb\u7edf\u8bbe\u8ba1\u76ee\u6807QPS\uff08\u5197\u4f59\u4e0e\u5e94\u5bf9\u7a81\u53d1\u6d41\u91cf\uff09\uff1a\u5e94\u5bf9\u77ac\u65f6\u6d41\u91cf-\u6bd4\u598210\u70b9\u521a\u4e0a\u73ed\u621614\u70b9\u521a\u5f00\u5de5\u7684\u77ac\u95f4\uff0c\u9700\u8981\u9ad8\u5cf0\u5e73\u5747\u503c\u5197\u4f592-3\u500d\u3002\u8bbe\u8ba1\u76ee\u6807QPS=500x2=1000</p> <ol> <li>\u8d44\u6e90\u5bb9\u91cf\u4f30\u7b97(\u4ee51000QPS\u4e3a\u76ee\u6807)</li> </ol> \u7ef4\u5ea6 \u53c2\u6570\u5047\u8bbe \u8ba1\u7b97\u8bf4\u660e \u5e73\u5747\u54cd\u5e94\u65f6\u95f4 (RT) 100ms \u5178\u578b\u5185\u7f51API\u8017\u65f6 \u5355\u673a\u5e76\u53d1\u80fd\u529b 100 \u5e76\u53d1 \u5047\u8bbe 4 \u6838 8G \u673a\u5668\uff0c\u5408\u7406\u5e76\u53d1\u6570\u4e3a 100 \u5355\u673a QPS \u80fd\u529b 1000 QPS 100 / 0.1s = 1000 \u6240\u9700\u5b9e\u4f8b\u6570 2 \u53f0 1 \u53f0\u627f\u8f7d\u6d41\u91cf\uff0c1 \u53f0\u4f5c\u4e3a\u9ad8\u53ef\u7528\u5197\u4f59 (N+1) <ol> <li> <p>\u5173\u952e\u7cfb\u7edf\u74f6\u9888\u6838\u67e5</p> </li> <li> <p>\u6570\u636e\u5e93Mysql</p> <ol> <li>1000QPS\u5982\u679c\u90fd\u662f\u5199\u7684\u64cd\u4f5c\uff0c\u538b\u529b\u8f83\u5927\uff0c\u9700\u8981\u8003\u8651\u8bfb\u5199\u5206\u79bb</li> <li>\u5982\u679c\u4ec5\u662f\u8bfb\u64cd\u4f5c\u4e14\u6709\u7d22\u5f15\uff0c\u5355\u673aMYSQL\u53ef\u4ee5\u4f7f\u7528\u8fde\u63a5\u6c60\u4f18\u5316</li> </ol> </li> <li>\u5e26\u5bbd<ol> <li>\u5047\u8bbe\u6bcf\u4e2aAPI\u54cd\u5e94\u62a5\u658710KB</li> <li>1000QPS x 10KB=10MB/s</li> <li>\u8f6c\u6362\u5bbd\u5e26\uff1a10MB/s x 8 = 80Mbps\u3002\u9700\u8981\u786e\u8ba4\u670d\u52a1\u5668\u51fa\u53e3\u5e26\u5bbd\u662f\u5426\u591f</li> </ol> </li> <li> <p>\u8fde\u63a5\u6c60</p> </li> <li> <p>\u603b\u7ed3</p> </li> <li> <p>\u65e5\u5e38\u9ad8\u5cf0QPS\u7ea6\u4e3a500</p> </li> <li>\u7cfb\u7edf\u5e94\u8be5\u4ee51000QPS\u8fdb\u884c\u8bbe\u8ba1\u548c\u538b\u6d4b</li> <li>\u81f3\u5c112\u53f04\u68388G\u7684\u4e91\u670d\u52a1\u5668\uff0c\u8d1f\u8f7d\u5747\u8861\u540e\uff0c\u5efa\u8bae\u5e26\u5bbd\u4e0d\u4f4e\u4e8e100Mbps</li> </ol>"},{"location":"%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/%E4%B8%8E%E3%80%81%E6%88%96%E3%80%81%E5%BC%82%E6%88%96/","title":"\u57fa\u7840\u8fd0\u7b97\u7b26","text":"<ul> <li>\u4e0e(&amp;)\uff1a\u4e24\u4f4d\u5168\u4e3a1\uff0c\u7ed3\u679c\u4e3a1</li> <li>\u6216(|)\uff1a\u4e24\u4f4d\u53ea\u8981\u6709\u4e00\u4f4d\u4e3a1\uff0c\u7ed3\u679c\u4e3a1</li> <li>\u5f02\u6216(^)\uff1a\u4e24\u4f4d\u4e3a\u5f02\uff0c\u7ed3\u679c\u4e3a1\uff0c\u5426\u5219\u4e3a0</li> <li>\u53d6\u53cd(~)\uff1a\u5c06\u4e00\u4e2a\u6570\u4f4d\u53d6\u53cd\uff0c\u5373~1=0\uff0c~0=1</li> <li>\u5de6\u79fb(&lt;&lt;)\uff1a\u5c06\u4e00\u4e2a\u6570\u5de6\u79fbx\u4f4d\uff0c\u5373\u5de6\u8fb9\u4e22\u5f03x\u4f4d\uff0c\u53f3\u8fb9\u75280\u8865x\u4f4d\u3002\u4f8b\uff1a11100111 &lt;&lt; 2 = 10011100</li> <li>\u53f3\u79fb(&gt;&gt;)\uff1a\u5c06\u4e00\u4e2a\u6570\u53f3\u79fb\u82e5\u5e72\u4f4d\uff0c\u53f3\u8fb9\u820d\u5f03\uff0c\u6b63\u6570\u5de6\u8fb9\u88650\uff0c\u8d1f\u6570\u5de6\u8fb9\u88651\u3002\u6bcf\u53f3\u79fb\u4e00\u4f4d\uff0c\u76f8\u5f53\u4e8e\u9664\u4ee5\u4e00\u6b212 \u4f8b\uff1a4 &gt;&gt; 2 = 1\uff0c-14 &gt;&gt; 2 = -4</li> </ul>"},{"location":"%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/linux/","title":"Linux\u7cfb\u7edf","text":""},{"location":"%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/linux/centos/%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4/","title":"\u57fa\u7840\u64cd\u4f5c\u547d\u4ee4","text":"<ol> <li>\u67e5\u770b\u7cfb\u7edf\u670d\u52a1\u8fdb\u7a0b <code>ps aux</code></li> <li>\u6307\u5b9a\u8fdb\u7a0b\u67e5\u770b <code>ps -ef | grep jar</code>,<code>ps -aux|grep sendmail</code></li> <li>\u67e5\u770b\u5185\u5b58\u4f7f\u7528\u60c5\u51b5 <code>free -m</code></li> <li>\u6e05\u9664\u4f7f\u7528\u7f13\u5b58<ol> <li><code>echo 1 &gt; /proc/sys/vm/drop_caches</code></li> <li><code>`echo 2 &gt; /proc/sys/vm/drop_caches</code></li> <li><code>echo 3 &gt; /proc/sys/vm/drop_caches</code></li> </ol> </li> <li>linux\u5173\u95ed\u9632\u706b\u5899</li> </ol> <pre><code>      systemctl stop firewalld.service #\u505c\u6b62firewall\n      systemctl disable firewalld.service #\u7981\u6b62firewall\u5f00\u673a\u542f\u52a8\n      firewall-cmd --state #\u67e5\u770b\u9ed8\u8ba4\u9632\u706b\u5899\u72b6\u6001\uff08\u5173\u95ed\u540e\u663e\u793anotrunning\uff0c\u5f00\u542f\u540e\u663e\u793arunning\uff09\n</code></pre> <ol> <li><code>netstat -anp|grep 21001</code>(\u67e5\u770b\u7aef\u53e3\u5728\u88ab\u54ea\u4e2a\u8fdb\u7a0b\u4f7f\u7528)</li> </ol>"},{"location":"%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%8E%9F%E7%90%86/","title":"Index","text":""},{"location":"%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%8E%9F%E7%90%86/#_1","title":"\u8ba1\u7b97\u673a\u7f51\u7edc\u4e13\u533a","text":"<ul> <li>osi\u4e03\u5c42\u53c2\u8003\u6a21\u578b</li> </ul>"},{"location":"%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%8E%9F%E7%90%86/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E6%A6%82%E8%BF%B0/","title":"\u8ba1\u7b97\u673a\u7f51\u7edc\u6982\u8ff0","text":""}]}